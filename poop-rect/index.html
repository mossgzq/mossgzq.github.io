<!doctype html>
<html build-time="2025-09-25 13:36:14">
  <head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon" />
    <script>
      var coverSupport =
        'CSS' in window &&
        typeof CSS.supports === 'function' &&
        (CSS.supports('top: env(a)') || CSS.supports('top: constant(a)'))
      document.write(
        '<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0' +
          (coverSupport ? ', viewport-fit=cover' : '') +
          '" />',
      )
    </script>
    <title>poop-rect</title>
    <!--preload-links-->
    <!--app-context-->
    <script type="module" crossorigin>var tS=Object.defineProperty,nS=Object.defineProperties;var rS=Object.getOwnPropertyDescriptors;var zl=Object.getOwnPropertySymbols,iS=Object.getPrototypeOf,um=Object.prototype.hasOwnProperty,hm=Object.prototype.propertyIsEnumerable,sS=Reflect.get;var tn=Math.pow,Th=(r,e,t)=>e in r?tS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Xe=(r,e)=>{for(var t in e||(e={}))um.call(e,t)&&Th(r,t,e[t]);if(zl)for(var t of zl(e))hm.call(e,t)&&Th(r,t,e[t]);return r},Tt=(r,e)=>nS(r,rS(e));var Gl=(r,e)=>{var t={};for(var n in r)um.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&zl)for(var n of zl(r))e.indexOf(n)<0&&hm.call(r,n)&&(t[n]=r[n]);return t};var wn=(r,e,t)=>(Th(r,typeof e!="symbol"?e+"":e,t),t);var _h=(r,e,t)=>sS(iS(r),t,e);var v=(r,e,t)=>new Promise((n,i)=>{var s=l=>{try{o(t.next(l))}catch(c){i(c)}},a=l=>{try{o(t.throw(l))}catch(c){i(c)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(r,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const aS="modulepreload",oS=function(r,e){return new URL(r,e).href},fm={},yl=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.all(t.map(l=>{if(l=oS(l,n),l in fm)return;fm[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const m=s[d];if(m.href===l&&(!c||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":aS,c||(f.as="script",f.crossOrigin=""),f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,m)=>{f.addEventListener("load",d),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}return i.then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})},gE="{heavy}KG",bE="{0}cm, {1}KG",EE="I am {name},height:{detail.height},weight:{detail.weight}",wE={"tabbar.home":"Home","tabbar.about":"About","tabbar.me":"Me","i18n.title":"En Title","alova.title":"Alova Request",weight:gE,detail:bE,introduction:EE,"stool.characteristic.shape":"Shapes","stool.shape.hard_lumps":"Separate hard lumps, like nuts","stool.shape.sausage_lumpy":"Sausage-shaped but lumpy","stool.shape.sausage_smooth":"Sausage-shaped with smooth surface","stool.shape.snake_smooth":"Sausage-shaped or snake-like, smooth and soft","stool.shape.soft_blobs":"Soft blobs with clear-cut edges","stool.shape.fluffy_mushy":"Fluffy pieces with ragged edges, mushy","stool.shape.watery":"Watery, no solid pieces","stool.characteristic.color":"color","stool.color.brown":"Brown","stool.color.green":"Green","stool.color.yellow":"Yellow","stool.color.black":"Black","stool.color.red":"Red","stool.color.pale":"Pale/White","stool.color.clay":"Clay-colored","stool.color.orange":"Orange","stool.characteristic.consistency":"Consistency","stool.characteristic.hard":"Hard","stool.characteristic.soft":"Soft","stool.characteristic.loose":"Loose","stool.characteristic.watery":"Watery","stool.characteristic.sticky":"Sticky","stool.characteristic.foamy":"Foamy","stool.characteristic.frequency":"Frequency","stool.frequency.constipation":"Constipation","stool.frequency.normal":"Normal","stool.frequency.diarrhea":"Diarrhea","stool.frequency.tenesmus":"Tenesmus","stool.characteristic.surface":"Surface","stool.surface.smooth":"Smooth","stool.surface.rough":"Rough","stool.surface.mucus":"With mucus","stool.surface.blood":"With blood streaks","stool.surface.pus":"With pus","stool.surface.undigested":"With undigested food","stool.characteristic.odor":"Odor","stool.odor.mild":"Mild","stool.odor.moderate":"Moderate","stool.odor.strong":"Strong","stool.odor.foul":"Foul","stool.odor.sour":"Sour","stool.odor.fishy":"Fishy","stool.characteristic.buoyancy":"Buoyancy","stool.buoyancy.sinking":"Sinking","stool.buoyancy.floating":"Floating","stool.characteristic.size":"Size","stool.size.small":"Small","stool.size.medium":"Medium","stool.size.large":"Large","stool.size.huge":"Huge","relativeTime.just_now":"Just now","relativeTime.minutes_ago":"{minutes} minutes ago","relativeTime.hours_ago":"{hours} hours ago","relativeTime.yesterday":"Yesterday","relativeTime.days_ago":"{days} days ago","calendar.week.sunday":"Sun","calendar.week.monday":"Mon","calendar.week.tuesday":"Tue","calendar.week.wednesday":"Wen","calendar.week.thursday":"Thu","calendar.week.friday":"Fri","calendar.week.saturday":"Sat"},lS=Object.freeze(Object.defineProperty({__proto__:null,default:wE,detail:bE,introduction:EE,weight:gE},Symbol.toStringTag,{value:"Module"})),vE="{heavy}公斤",TE="{0}cm, {1}公斤",_E="我是 {name},身高:{detail.height},体重:{detail.weight}",SE={"tabbar.home":"首页","tabbar.about":"关于","tabbar.me":"我的","i18n.title":"中文标题","alova.title":"Alova 请求",weight:vE,detail:TE,introduction:_E,"stool.characteristic.shape":"形状","stool.shape.hard_lumps":"硬球状","stool.shape.sausage_lumpy":"香肠状但表面有裂痕","stool.shape.sausage_smooth":"香肠状且表面光滑","stool.shape.snake_smooth":"香肠状或蛇状，表面光滑柔软","stool.shape.soft_blobs":"软团状，边缘清晰","stool.shape.fluffy_mushy":"蓬松粘稠状，有绒毛感","stool.shape.watery":"水样状，无固体","stool.characteristic.color":"颜色","stool.color.brown":"棕色","stool.color.green":"绿色","stool.color.yellow":"黄色","stool.color.black":"黑色","stool.color.red":"红色","stool.color.pale":"灰白色","stool.color.clay":"陶土色","stool.color.orange":"橙色","stool.characteristic.consistency":"质地特征","stool.consistency.hard":"硬","stool.consistency.soft":"软","stool.consistency.loose":"稀","stool.consistency.watery":"水样","stool.consistency.sticky":"粘稠","stool.consistency.foamy":"泡沫状","stool.characteristic.frequency":"排便频率","stool.frequency.constipation":"便秘","stool.frequency.normal":"正常","stool.frequency.diarrhea":"腹泻","stool.frequency.tenesmus":"里急后重","stool.characteristic.surface":"表面特征","stool.surface.smooth":"光滑","stool.surface.rough":"粗糙","stool.surface.mucus":"有粘液","stool.surface.blood":"有血丝","stool.surface.pus":"有脓液","stool.surface.undigested":"有未消化食物","stool.characteristic.odor":"气味","stool.odor.mild":"轻微","stool.odor.moderate":"中等","stool.odor.strong":"强烈","stool.odor.foul":"恶臭","stool.odor.sour":"酸臭","stool.odor.fishy":"腥臭","stool.characteristic.buoyancy":"浮沉性","stool.buoyancy.sinking":"下沉","stool.buoyancy.floating":"悬浮","stool.characteristic.size":"大小","stool.size.small":"小","stool.size.medium":"中等","stool.size.large":"大","stool.size.huge":"巨大","relativeTime.just_now":"刚刚","relativeTime.minutes_ago":"{minutes}分钟前","relativeTime.hours_ago":"{hours}小时前","relativeTime.yesterday":"昨天","relativeTime.days_ago":"{days}天前","calendar.week.sunday":"日","calendar.week.monday":"一","calendar.week.tuesday":"二","calendar.week.wednesday":"三","calendar.week.thursday":"四","calendar.week.friday":"五","calendar.week.saturday":"六"},cS=Object.freeze(Object.defineProperty({__proto__:null,default:SE,detail:TE,introduction:_E,weight:vE},Symbol.toStringTag,{value:"Module"}));/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fd(r,e){const t=new Set(r.split(","));return n=>t.has(n)}const an={},Na=[],Cr=()=>{},uS=()=>!1,mu=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),Ud=r=>r.startsWith("onUpdate:"),Ct=Object.assign,Vd=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},hS=Object.prototype.hasOwnProperty,It=(r,e)=>hS.call(r,e),it=Array.isArray,Aa=r=>gl(r)==="[object Map]",CE=r=>gl(r)==="[object Set]",fS=r=>gl(r)==="[object RegExp]",at=r=>typeof r=="function",xt=r=>typeof r=="string",Ga=r=>typeof r=="symbol",ln=r=>r!==null&&typeof r=="object",jd=r=>(ln(r)||at(r))&&at(r.then)&&at(r.catch),NE=Object.prototype.toString,gl=r=>NE.call(r),dS=r=>gl(r).slice(8,-1),In=r=>gl(r)==="[object Object]",Wd=r=>xt(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Do=Fd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),yu=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},pS=/-(\w)/g,Yr=yu(r=>r.replace(pS,(e,t)=>t?t.toUpperCase():"")),mS=/\B([A-Z])/g,Di=yu(r=>r.replace(mS,"-$1").toLowerCase()),gu=yu(r=>r.charAt(0).toUpperCase()+r.slice(1)),Sh=yu(r=>r?`on${gu(r)}`:""),us=(r,e)=>!Object.is(r,e),fr=(r,e)=>{for(let t=0;t<r.length;t++)r[t](e)},qc=(r,e,t)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value:t})},yS=r=>{const e=parseFloat(r);return isNaN(e)?r:e},gS=r=>{const e=xt(r)?Number(r):NaN;return isNaN(e)?r:e};let dm;const AE=()=>dm||(dm=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function yc(r){if(it(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],i=xt(n)?kc(n):yc(n);if(i)for(const s in i)e[s]=i[s]}return e}else if(xt(r)||ln(r))return r}const bS=/;(?![^(]*\))/g,ES=/:([^]+)/,wS=/\/\*[^]*?\*\//g;function kc(r){const e={};return r.replace(wS,"").split(bS).forEach(t=>{if(t){const n=t.split(ES);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function vS(r){let e="";if(!r||xt(r))return e;for(const t in r){const n=r[t],i=t.startsWith("--")?t:Di(t);(xt(n)||typeof n=="number")&&(e+=`${i}:${n};`)}return e}function xE(r){let e="";if(xt(r))e=r;else if(it(r))for(let t=0;t<r.length;t++){const n=xE(r[t]);n&&(e+=n+" ")}else if(ln(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const TS="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",_S=Fd(TS);function RE(r){return!!r||r===""}const vt=r=>xt(r)?r:r==null?"":it(r)||ln(r)&&(r.toString===NE||!at(r.toString))?JSON.stringify(r,ME,2):String(r),ME=(r,e)=>e&&e.__v_isRef?ME(r,e.value):Aa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,i],s)=>(t[Ch(n,s)+" =>"]=i,t),{})}:CE(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Ch(t))}:Ga(e)?Ch(e):ln(e)&&!it(e)&&!In(e)?String(e):e,Ch=(r,e="")=>{var t;return Ga(r)?`Symbol(${(t=r.description)!=null?t:e})`:r},SS=["ad","ad-content-page","ad-draw","audio","button","camera","canvas","checkbox","checkbox-group","cover-image","cover-view","editor","form","functional-page-navigator","icon","image","input","label","live-player","live-pusher","map","movable-area","movable-view","navigator","official-account","open-data","picker","picker-view","picker-view-column","progress","radio","radio-group","rich-text","scroll-view","slider","swiper","swiper-item","switch","text","textarea","video","view","web-view","location-picker","location-view"],CS=SS.map(r=>"uni-"+r),NS=["list-view","list-item","sticky-section","sticky-header","cloud-db-element"].map(r=>"uni-"+r),AS=["list-item"].map(r=>"uni-"+r);function xS(r){if(AS.indexOf(r)!==-1)return!1;const e="uni-"+r.replace("v-uni-","");return CS.indexOf(e)!==-1||NS.indexOf(e)!==-1}const Hd=`
`,RS=50,MS="UNI_LOCALE",Lf=["%","%"],PS=/^([a-z-]+:)?\/\//i,IS=/^data:.*,.*/,OS="WEB_INVOKE_APPSERVICE",hs="onShow",ks="onHide",PE="onLaunch",Bc="onError",bu="onThemeChange",IE="onPageNotFound",OE="onUnhandledRejection",$S="onExit",Ka="onLoad",DS="onReady",Qd="onUnload",$E="onInit",DE="onSaveExitState",Eu="onResize",Fc="onBackPress",Zo="onPageScroll",LE="onTabItemTap",wu="onReachBottom",qE="onPullDownRefresh",kE="onShareTimeline",BE="onShareChat",FE="onAddToFavorites",UE="onShareAppMessage",VE="onNavigationBarButtonTap",LS="onNavigationBarChange",jE="onNavigationBarSearchInputClicked",WE="onNavigationBarSearchInputChanged",HE="onNavigationBarSearchInputConfirmed",QE="onNavigationBarSearchInputFocusChanged",zE="onAppEnterForeground",GE="onAppEnterBackground",qS="onWebInvokeAppService",kS="onWxsInvokeCallMethod";function BS(r=""){return(""+r).replace(/[^\x00-\xff]/g,"**").length}function KE(r){return r.indexOf("/")===0}function Uc(r){return KE(r)?r:"/"+r}function FS(r){return KE(r)?r.slice(1):r}const US=(r,e)=>{let t;for(let n=0;n<r.length;n++)t=r[n](e);return t};function Ws(r,e=null){let t;return(...n)=>(r&&(t=r.apply(e,n),r=null),t)}function VS(r){let e={};return In(r)&&Object.keys(r).sort().forEach(t=>{const n=t;e[n]=r[n]}),Object.keys(e)?e:r}function jS(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;function r(){return this}return typeof r()!="undefined"?r():function(){return new Function("return this")()}()}let Kl;function YE(){return Kl||(Kl=jS(),Kl)}function JE(r){if(!r)return;let e=r.type.name;for(;e&&xS(Di(e));)r=r.parent,e=r.type.name;return r.proxy}function pm(r){return r.nodeType===1}function WS(r,e=!1){const{vnode:t}=r;if(pm(t.el))return e?t.el?[t.el]:[]:t.el;const{subTree:n}=r;if(n.shapeFlag&16){const i=n.children.filter(s=>s.el&&pm(s.el));if(i.length>0)return e?i.map(s=>s.el):i[0].el}return e?t.el?[t.el]:[]:t.el}function zt(r){const e=YE();if(e&&e.UTSJSONObject&&r instanceof e.UTSJSONObject){const t={};return e.UTSJSONObject.keys(r).forEach(n=>{t[n]=r[n]}),yc(t)}else if(r instanceof Map){const t={};return r.forEach((n,i)=>{t[i]=n}),yc(t)}else{if(xt(r))return kc(r);if(it(r)){const t={};for(let n=0;n<r.length;n++){const i=r[n],s=xt(i)?kc(i):zt(i);if(s)for(const a in s)t[a]=s[a]}return t}else return yc(r)}}function Nt(r){let e="";const t=YE();if(t&&t.UTSJSONObject&&r instanceof t.UTSJSONObject)t.UTSJSONObject.keys(r).forEach(n=>{r[n]&&(e+=n+" ")});else if(r instanceof Map)r.forEach((n,i)=>{n&&(e+=i+" ")});else if(it(r))for(let n=0;n<r.length;n++){const i=Nt(r[n]);i&&(e+=i+" ")}else e=xE(r);return e.trim()}function zd(r){if(!r)return null;let{class:e,style:t}=r;return e&&!xt(e)&&(r.class=Nt(e)),t&&(r.style=zt(t)),r}function mm(r){return Yr(r.substring(5))}const HS=Ws(r=>{r=r||(i=>i.tagName.startsWith("UNI-"));const e=HTMLElement.prototype,t=e.setAttribute;e.setAttribute=function(i,s){if(i.startsWith("data-")&&r(this)){const a=this.__uniDataset||(this.__uniDataset={});a[mm(i)]=s}t.call(this,i,s)};const n=e.removeAttribute;e.removeAttribute=function(i){this.__uniDataset&&i.startsWith("data-")&&r(this)&&delete this.__uniDataset[mm(i)],n.call(this,i)}});function QS(r){return Ct({},r.dataset,r.__uniDataset)}const zS=new RegExp(`"[^"]+"|'[^']+'|url\\([^)]+\\)|(\\d*\\.?\\d+)[r|u]px`,"g");function GS(r,e){const t=Math.pow(10,e+1),n=Math.floor(r*t);return Math.round(n/10)*10/t}const KS={unit:"rem",unitRatio:10/320,unitPrecision:5};function YS(r,e,t){return n=>n.replace(zS,(i,s)=>{if(!s)return i;const a=GS(parseFloat(s)*e,t);return a===0?"0":`${a}${r}`})}function el(r){return{passive:r}}function qf(r){const{id:e,offsetTop:t,offsetLeft:n}=r;return{id:e,dataset:QS(r),offsetTop:t,offsetLeft:n}}function kf(r){try{return decodeURIComponent(""+r)}catch(e){}return""+r}function XE(r={}){const e={};return Object.keys(r).forEach(t=>{try{e[t]=kf(r[t])}catch(n){e[t]=r[t]}}),e}const JS=/\+/g;function XS(r){const e={};if(r===""||r==="?")return e;const n=(r[0]==="?"?r.slice(1):r).split("&");for(let i=0;i<n.length;++i){const s=n[i].replace(JS," ");let a=s.indexOf("="),o=kf(a<0?s:s.slice(0,a)),l=a<0?null:kf(s.slice(a+1));if(o in e){let c=e[o];it(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function ZS(r){const[e,t]=r.split("?",2);return{path:e,query:XS(t||"")}}function ZE(r,e,{clearTimeout:t,setTimeout:n}){let i;const s=function(){t(i),i=n(()=>r.apply(this,arguments),e)};return s.cancel=function(){t(i)},s}class ew{constructor(e,t){this.id=e,this.listener={},this.emitCache=[],t&&Object.keys(t).forEach(n=>{this.on(n,t[n])})}emit(e,...t){const n=this.listener[e];if(!n)return this.emitCache.push({eventName:e,args:t});n.forEach(i=>{i.fn.apply(i.fn,t)}),this.listener[e]=n.filter(i=>i.type!=="once")}on(e,t){this._addListener(e,"on",t),this._clearCache(e)}once(e,t){this._addListener(e,"once",t),this._clearCache(e)}off(e,t){const n=this.listener[e];if(n)if(t)for(let i=0;i<n.length;)n[i].fn===t&&(n.splice(i,1),i--),i++;else delete this.listener[e]}_clearCache(e){for(let t=0;t<this.emitCache.length;t++){const n=this.emitCache[t],i=e?n.eventName===e?e:null:n.eventName;if(!i)continue;if(typeof this.emit.apply(this,[i,...n.args])=="number"){this.emitCache.pop();continue}this.emitCache.splice(t,1),t--}}_addListener(e,t,n){(this.listener[e]||(this.listener[e]=[])).push({fn:n,type:t})}}const eC=[$E,Ka,hs,ks,Qd,Fc,Zo,LE,wu,qE,kE,UE,BE,FE,DE,VE,jE,WE,HE,QE];function tC(r){return[Ka,hs].indexOf(r)>-1}function nC(r){return eC.indexOf(r)>-1}const tw=[hs,ks,PE,Bc,bu,IE,OE,$S,$E,Ka,DS,Qd,Eu,Fc,Zo,LE,wu,qE,kE,FE,UE,BE,DE,VE,jE,WE,HE,QE];function rC(r,e,t=!0){return t&&!at(e)?!1:tw.indexOf(r)>-1?!0:r.indexOf("on")===0}const iC=[];function sC(r){iC.forEach(e=>e(r))}const aC=Ws((r,e)=>e(r)),nw=function(){};nw.prototype={_id:1,on:function(r,e,t){var n=this.e||(this.e={});return(n[r]||(n[r]=[])).push({fn:e,ctx:t,_id:this._id}),this._id++},once:function(r,e,t){var n=this;function i(){n.off(r,i),e.apply(t,arguments)}return i._=e,this.on(r,i,t)},emit:function(r){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[r]||[]).slice(),n=0,i=t.length;for(n;n<i;n++)t[n].fn.apply(t[n].ctx,e);return this},off:function(r,e){var t=this.e||(this.e={}),n=t[r],i=[];if(n&&e){for(var s=n.length-1;s>=0;s--)if(n[s].fn===e||n[s].fn._===e||n[s]._id===e){n.splice(s,1);break}i=n}return i.length?t[r]=i:delete t[r],this}};var rw=nw;const ym={black:"rgba(0,0,0,0.4)",white:"rgba(255,255,255,0.4)"};function oC(r){return r&&r in ym?ym[r]:r}function lC(r){return r==="black"?"#000000":"#ffffff"}function gm(r,e,t){if(xt(e)&&e.startsWith("@")){const n=e.replace("@","");let i=r[n]||e;switch(t){case"titleColor":i=lC(i);break;case"borderStyle":i=oC(i);break}return i}return e}function Bf(r,e={},t="light"){const n=e[t],i={};return typeof n=="undefined"||!r?r:(Object.keys(r).forEach(s=>{const a=r[s],o=()=>In(a)?Bf(a,e,t):it(a)?a.map(l=>In(l)?Bf(l,e,t):gm(n,l)):gm(n,a,s);i[s]=o()}),i)}/**
* @dcloudio/uni-h5-vue v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let hr;class iw{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=hr,!e&&hr&&(this.index=(hr.scopes||(hr.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=hr;try{return hr=this,e()}finally{hr=t}}}on(){hr=this}off(){hr=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function Gd(r){return new iw(r)}function cC(r,e=hr){e&&e.active&&e.effects.push(r)}function sw(){return hr}function uC(r){hr&&hr.cleanups.push(r)}let Os;class Kd{constructor(e,t,n,i){this.fn=e,this.trigger=t,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,cC(this,i)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Hs();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(hC(t.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Qs()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=as,t=Os;try{return as=!0,Os=this,this._runnings++,bm(this),this.fn()}finally{Em(this),this._runnings--,Os=t,as=e}}stop(){var e;this.active&&(bm(this),Em(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function hC(r){return r.value}function bm(r){r._trackId++,r._depsLength=0}function Em(r){if(r.deps.length>r._depsLength){for(let e=r._depsLength;e<r.deps.length;e++)aw(r.deps[e],r);r.deps.length=r._depsLength}}function aw(r,e){const t=r.get(e);t!==void 0&&e._trackId!==t&&(r.delete(e),r.size===0&&r.cleanup())}let as=!0,Ff=0;const ow=[];function Hs(){ow.push(as),as=!1}function Qs(){const r=ow.pop();as=r===void 0?!0:r}function Yd(){Ff++}function Jd(){for(Ff--;!Ff&&Uf.length;)Uf.shift()()}function lw(r,e,t){if(e.get(r)!==r._trackId){e.set(r,r._trackId);const n=r.deps[r._depsLength];n!==e?(n&&aw(n,r),r.deps[r._depsLength++]=e):r._depsLength++}}const Uf=[];function cw(r,e,t){Yd();for(const n of r.keys()){let i;n._dirtyLevel<e&&(i!=null?i:i=r.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=e),n._shouldSchedule&&(i!=null?i:i=r.get(n)===n._trackId)&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&Uf.push(n.scheduler)))}Jd()}const uw=(r,e)=>{const t=new Map;return t.cleanup=r,t.computed=e,t},Vc=new WeakMap,$s=Symbol(""),Vf=Symbol("");function cr(r,e,t){if(as&&Os){let n=Vc.get(r);n||Vc.set(r,n=new Map);let i=n.get(t);i||n.set(t,i=uw(()=>n.delete(t))),lw(Os,i)}}function Ai(r,e,t,n,i,s){const a=Vc.get(r);if(!a)return;let o=[];if(e==="clear")o=[...a.values()];else if(t==="length"&&it(r)){const l=Number(n);a.forEach((c,u)=>{(u==="length"||!Ga(u)&&u>=l)&&o.push(c)})}else switch(t!==void 0&&o.push(a.get(t)),e){case"add":it(r)?Wd(t)&&o.push(a.get("length")):(o.push(a.get($s)),Aa(r)&&o.push(a.get(Vf)));break;case"delete":it(r)||(o.push(a.get($s)),Aa(r)&&o.push(a.get(Vf)));break;case"set":Aa(r)&&o.push(a.get($s));break}Yd();for(const l of o)l&&cw(l,4);Jd()}function fC(r,e){var t;return(t=Vc.get(r))==null?void 0:t.get(e)}const dC=Fd("__proto__,__v_isRef,__isVue"),hw=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Ga)),wm=pC();function pC(){const r={};return["includes","indexOf","lastIndexOf"].forEach(e=>{r[e]=function(...t){const n=Vt(this);for(let s=0,a=this.length;s<a;s++)cr(n,"get",s+"");const i=n[e](...t);return i===-1||i===!1?n[e](...t.map(Vt)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{r[e]=function(...t){Hs(),Yd();const n=Vt(this)[e].apply(this,t);return Jd(),Qs(),n}}),r}function mC(r){const e=Vt(this);return cr(e,"has",r),e.hasOwnProperty(r)}class fw{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return n===(i?s?xC:yw:s?mw:pw).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=it(e);if(!i){if(a&&It(wm,t))return Reflect.get(wm,t,n);if(t==="hasOwnProperty")return mC}const o=Reflect.get(e,t,n);return(Ga(t)?hw.has(t):dC(t))||(i||cr(e,"get",t),s)?o:En(o)?a&&Wd(t)?o:o.value:ln(o)?i?bw(o):nn(o):o}}class dw extends fw{constructor(e=!1){super(!1,e)}set(e,t,n,i){let s=e[t];if(!this._isShallow){const l=$a(s);if(!jc(n)&&!$a(n)&&(s=Vt(s),n=Vt(n)),!it(e)&&En(s)&&!En(n))return l?!1:(s.value=n,!0)}const a=it(e)&&Wd(t)?Number(t)<e.length:It(e,t),o=Reflect.set(e,t,n,i);return e===Vt(i)&&(a?us(n,s)&&Ai(e,"set",t,n):Ai(e,"add",t,n)),o}deleteProperty(e,t){const n=It(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&Ai(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(!Ga(t)||!hw.has(t))&&cr(e,"has",t),n}ownKeys(e){return cr(e,"iterate",it(e)?"length":$s),Reflect.ownKeys(e)}}class yC extends fw{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const gC=new dw,bC=new yC,EC=new dw(!0),Xd=r=>r,vu=r=>Reflect.getPrototypeOf(r);function Yl(r,e,t=!1,n=!1){r=r.__v_raw;const i=Vt(r),s=Vt(e);t||(us(e,s)&&cr(i,"get",e),cr(i,"get",s));const{has:a}=vu(i),o=n?Xd:t?tp:tl;if(a.call(i,e))return o(r.get(e));if(a.call(i,s))return o(r.get(s));r!==i&&r.get(e)}function Jl(r,e=!1){const t=this.__v_raw,n=Vt(t),i=Vt(r);return e||(us(r,i)&&cr(n,"has",r),cr(n,"has",i)),r===i?t.has(r):t.has(r)||t.has(i)}function Xl(r,e=!1){return r=r.__v_raw,!e&&cr(Vt(r),"iterate",$s),Reflect.get(r,"size",r)}function vm(r){r=Vt(r);const e=Vt(this);return vu(e).has.call(e,r)||(e.add(r),Ai(e,"add",r,r)),this}function Tm(r,e){e=Vt(e);const t=Vt(this),{has:n,get:i}=vu(t);let s=n.call(t,r);s||(r=Vt(r),s=n.call(t,r));const a=i.call(t,r);return t.set(r,e),s?us(e,a)&&Ai(t,"set",r,e):Ai(t,"add",r,e),this}function _m(r){const e=Vt(this),{has:t,get:n}=vu(e);let i=t.call(e,r);i||(r=Vt(r),i=t.call(e,r)),n&&n.call(e,r);const s=e.delete(r);return i&&Ai(e,"delete",r,void 0),s}function Sm(){const r=Vt(this),e=r.size!==0,t=r.clear();return e&&Ai(r,"clear",void 0,void 0),t}function Zl(r,e){return function(n,i){const s=this,a=s.__v_raw,o=Vt(a),l=e?Xd:r?tp:tl;return!r&&cr(o,"iterate",$s),a.forEach((c,u)=>n.call(i,l(c),l(u),s))}}function ec(r,e,t){return function(...n){const i=this.__v_raw,s=Vt(i),a=Aa(s),o=r==="entries"||r===Symbol.iterator&&a,l=r==="keys"&&a,c=i[r](...n),u=t?Xd:e?tp:tl;return!e&&cr(s,"iterate",l?Vf:$s),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:o?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function Wi(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function wC(){const r={get(s){return Yl(this,s)},get size(){return Xl(this)},has:Jl,add:vm,set:Tm,delete:_m,clear:Sm,forEach:Zl(!1,!1)},e={get(s){return Yl(this,s,!1,!0)},get size(){return Xl(this)},has:Jl,add:vm,set:Tm,delete:_m,clear:Sm,forEach:Zl(!1,!0)},t={get(s){return Yl(this,s,!0)},get size(){return Xl(this,!0)},has(s){return Jl.call(this,s,!0)},add:Wi("add"),set:Wi("set"),delete:Wi("delete"),clear:Wi("clear"),forEach:Zl(!0,!1)},n={get(s){return Yl(this,s,!0,!0)},get size(){return Xl(this,!0)},has(s){return Jl.call(this,s,!0)},add:Wi("add"),set:Wi("set"),delete:Wi("delete"),clear:Wi("clear"),forEach:Zl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=ec(s,!1,!1),t[s]=ec(s,!0,!1),e[s]=ec(s,!1,!0),n[s]=ec(s,!0,!0)}),[r,t,e,n]}const[vC,TC,_C,SC]=wC();function Zd(r,e){const t=e?r?SC:_C:r?TC:vC;return(n,i,s)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(It(t,i)&&i in n?t:n,i,s)}const CC={get:Zd(!1,!1)},NC={get:Zd(!1,!0)},AC={get:Zd(!0,!1)},pw=new WeakMap,mw=new WeakMap,yw=new WeakMap,xC=new WeakMap;function RC(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function MC(r){return r.__v_skip||!Object.isExtensible(r)?0:RC(dS(r))}function nn(r){return $a(r)?r:ep(r,!1,gC,CC,pw)}function gw(r){return ep(r,!1,EC,NC,mw)}function bw(r){return ep(r,!0,bC,AC,yw)}function ep(r,e,t,n,i){if(!ln(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const s=i.get(r);if(s)return s;const a=MC(r);if(a===0)return r;const o=new Proxy(r,a===2?n:t);return i.set(r,o),o}function os(r){return $a(r)?os(r.__v_raw):!!(r&&r.__v_isReactive)}function $a(r){return!!(r&&r.__v_isReadonly)}function jc(r){return!!(r&&r.__v_isShallow)}function Ew(r){return os(r)||$a(r)}function Vt(r){const e=r&&r.__v_raw;return e?Vt(e):r}function Da(r){return Object.isExtensible(r)&&qc(r,"__v_skip",!0),r}const tl=r=>ln(r)?nn(r):r,tp=r=>ln(r)?bw(r):r;class ww{constructor(e,t,n,i){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Kd(()=>e(this._value),()=>gc(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=Vt(this);return(!e._cacheable||e.effect.dirty)&&us(e._value,e._value=e.effect.run())&&gc(e,4),vw(e),e.effect._dirtyLevel>=2&&gc(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function PC(r,e,t=!1){let n,i;const s=at(r);return s?(n=r,i=Cr):(n=r.get,i=r.set),new ww(n,i,s||!i,t)}function vw(r){var e;as&&Os&&(r=Vt(r),lw(Os,(e=r.dep)!=null?e:r.dep=uw(()=>r.dep=void 0,r instanceof ww?r:void 0)))}function gc(r,e=4,t){r=Vt(r);const n=r.dep;n&&cw(n,e)}function En(r){return!!(r&&r.__v_isRef===!0)}function ge(r){return Tw(r,!1)}function IC(r){return Tw(r,!0)}function Tw(r,e){return En(r)?r:new OC(r,e)}class OC{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Vt(e),this._value=t?e:tl(e)}get value(){return vw(this),this._value}set value(e){const t=this.__v_isShallow||jc(e)||$a(e);e=t?e:Vt(e),us(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:tl(e),gc(this,4))}}function pt(r){return En(r)?r.value:r}const $C={get:(r,e,t)=>pt(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const i=r[e];return En(i)&&!En(t)?(i.value=t,!0):Reflect.set(r,e,t,n)}};function _w(r){return os(r)?r:new Proxy(r,$C)}function DC(r){const e=it(r)?new Array(r.length):{};for(const t in r)e[t]=qC(r,t);return e}class LC{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return fC(Vt(this._object),this._key)}}function qC(r,e,t){const n=r[e];return En(n)?n:new LC(r,e,t)}function ls(r,e,t,n){try{return n?r(...n):r()}catch(i){bl(i,e,t)}}function or(r,e,t,n){if(at(r)){const s=ls(r,e,t,n);return s&&jd(s)&&s.catch(a=>{bl(a,e,t)}),s}const i=[];for(let s=0;s<r.length;s++)i.push(or(r[s],e,t,n));return i}function bl(r,e,t,n=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const a=e.proxy,o=`https://vuejs.org/error-reference/#runtime-${t}`;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](r,a,o)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){ls(l,null,10,[r,a,o]);return}}}let nl=!1,jf=!1;const Vn=[];let li=0;const xa=[];let Ji=null,As=0;const Sw=Promise.resolve();let np=null;function bn(r){const e=np||Sw;return r?e.then(this?r.bind(this):r):e}function kC(r){let e=li+1,t=Vn.length;for(;e<t;){const n=e+t>>>1,i=Vn[n],s=rl(i);s<r||s===r&&i.pre?e=n+1:t=n}return e}function Tu(r){(!Vn.length||!Vn.includes(r,nl&&r.allowRecurse?li+1:li))&&(r.id==null?Vn.push(r):Vn.splice(kC(r.id),0,r),Cw())}function Cw(){!nl&&!jf&&(jf=!0,np=Sw.then(Aw))}function BC(r){const e=Vn.indexOf(r);e>li&&Vn.splice(e,1)}function FC(r){it(r)?xa.push(...r):(!Ji||!Ji.includes(r,r.allowRecurse?As+1:As))&&xa.push(r),Cw()}function Cm(r,e,t=nl?li+1:0){for(;t<Vn.length;t++){const n=Vn[t];if(n&&n.pre){if(r&&n.id!==r.uid)continue;Vn.splice(t,1),t--,n()}}}function Nw(r){if(xa.length){const e=[...new Set(xa)].sort((t,n)=>rl(t)-rl(n));if(xa.length=0,Ji){Ji.push(...e);return}for(Ji=e,As=0;As<Ji.length;As++)Ji[As]();Ji=null,As=0}}const rl=r=>r.id==null?1/0:r.id,UC=(r,e)=>{const t=rl(r)-rl(e);if(t===0){if(r.pre&&!e.pre)return-1;if(e.pre&&!r.pre)return 1}return t};function Aw(r){jf=!1,nl=!0,Vn.sort(UC);try{for(li=0;li<Vn.length;li++){const e=Vn[li];e&&e.active!==!1&&ls(e,null,14)}}finally{li=0,Vn.length=0,Nw(),nl=!1,np=null,(Vn.length||xa.length)&&Aw()}}function VC(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||an;let i=t;const s=e.startsWith("update:"),a=s&&e.slice(7);if(a&&a in n){const u=`${a==="modelValue"?"model":a}Modifiers`,{number:h,trim:f}=n[u]||an;f&&(i=t.map(d=>xt(d)?d.trim():d)),h&&(i=t.map(yS))}let o,l=n[o=Sh(e)]||n[o=Sh(Yr(e))];!l&&s&&(l=n[o=Sh(Di(e))]),l&&or(l,r,6,Nm(r,l,i));const c=n[o+"Once"];if(c){if(!r.emitted)r.emitted={};else if(r.emitted[o])return;r.emitted[o]=!0,or(c,r,6,Nm(r,c,i))}}function Nm(r,e,t){if(t.length!==1)return t;if(at(e)){if(e.length<2)return t}else if(!e.find(i=>i.length>=2))return t;const n=t[0];if(n&&It(n,"type")&&It(n,"timeStamp")&&It(n,"target")&&It(n,"currentTarget")&&It(n,"detail")){const i=r.proxy,s=i.$gcd(i,!0);s&&t.push(s)}return t}function xw(r,e,t=!1){const n=e.emitsCache,i=n.get(r);if(i!==void 0)return i;const s=r.emits;let a={},o=!1;if(!at(r)){const l=c=>{const u=xw(c,e,!0);u&&(o=!0,Ct(a,u))};!t&&e.mixins.length&&e.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!s&&!o?(ln(r)&&n.set(r,null),null):(it(s)?s.forEach(l=>a[l]=null):Ct(a,s),ln(r)&&n.set(r,a),a)}function _u(r,e){return!r||!mu(e)?!1:(e=e.slice(2).replace(/Once$/,""),It(r,e[0].toLowerCase()+e.slice(1))||It(r,Di(e))||It(r,e))}let Nn=null,Rw=null;function Wc(r){const e=Nn;return Nn=r,Rw=r&&r.type.__scopeId||null,e}function re(r,e=Nn,t){if(!e||r._n)return r;const n=(...i)=>{n._d&&Vm(-1);const s=Wc(e);let a;try{a=r(...i)}finally{Wc(s),n._d&&Vm(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Am(r){const{type:e,vnode:t,proxy:n,withProxy:i,props:s,propsOptions:[a],slots:o,attrs:l,emit:c,render:u,renderCache:h,data:f,setupState:d,ctx:m,inheritAttrs:y}=r;let T,b;const S=Wc(r);try{if(t.shapeFlag&4){const C=i||n,I=C;T=oi(u.call(I,C,h,s,d,f,m)),b=l}else{const C=e;T=oi(C.length>1?C(s,{attrs:l,slots:o,emit:c}):C(s,null)),b=e.props?l:jC(l)}}catch(C){Fo.length=0,bl(C,r,1),T=X(lr)}let N=T;if(b&&y!==!1){const C=Object.keys(b),{shapeFlag:I}=N;C.length&&I&7&&(a&&C.some(Ud)&&(b=WC(b,a)),N=Ii(N,b))}return t.dirs&&(N=Ii(N),N.dirs=N.dirs?N.dirs.concat(t.dirs):t.dirs),t.transition&&(N.transition=t.transition),T=N,Wc(S),T}const jC=r=>{let e;for(const t in r)(t==="class"||t==="style"||mu(t))&&((e||(e={}))[t]=r[t]);return e},WC=(r,e)=>{const t={};for(const n in r)(!Ud(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function HC(r,e,t){const{props:n,children:i,component:s}=r,{props:a,children:o,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?xm(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(a[f]!==n[f]&&!_u(c,f))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?xm(n,a,c):!0:!!a;return!1}function xm(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==r[s]&&!_u(t,s))return!0}return!1}function QC({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const Mw="components";function Pr(r,e){return Iw(Mw,r,!0,e)||r}const Pw=Symbol.for("v-ndc");function kn(r){return xt(r)?Iw(Mw,r,!1)||r:r||Pw}function Iw(r,e,t=!0,n=!1){const i=Nn||Tn;if(i){const s=i.type;{const o=s0(s,!1);if(o&&(o===e||o===Yr(e)||o===gu(Yr(e))))return s}const a=Rm(i[r]||s[r],e)||Rm(i.appContext[r],e);return!a&&n?s:a}}function Rm(r,e){return r&&(r[e]||r[Yr(e)]||r[gu(Yr(e))])}const Lo=r=>r.__isSuspense;function zC(r,e){e&&e.pendingBranch?it(r)?e.effects.push(...r):e.effects.push(r):FC(r)}const GC=Symbol.for("v-scx"),KC=()=>on(GC);function rp(r,e){return ip(r,null,e)}const tc={};function Ge(r,e,t){return ip(r,e,t)}function ip(r,e,{immediate:t,deep:n,flush:i,once:s,onTrack:a,onTrigger:o}=an){if(e&&s){const H=e;e=(...Q)=>{H(...Q),I()}}const l=Tn,c=H=>n===!0?H:Rs(H,n===!1?1:void 0);let u,h=!1,f=!1;if(En(r)?(u=()=>r.value,h=jc(r)):os(r)?(u=()=>c(r),h=!0):it(r)?(f=!0,h=r.some(H=>os(H)||jc(H)),u=()=>r.map(H=>{if(En(H))return H.value;if(os(H))return c(H);if(at(H))return ls(H,l,2)})):at(r)?e?u=()=>ls(r,l,2):u=()=>(d&&d(),or(r,l,3,[m])):u=Cr,e&&n){const H=u;u=()=>Rs(H())}let d,m=H=>{d=N.onStop=()=>{ls(H,l,4),d=N.onStop=void 0}},y;if(Ya)if(m=Cr,e?t&&or(e,l,3,[u(),f?[]:void 0,m]):u(),i==="sync"){const H=KC();y=H.__watcherHandles||(H.__watcherHandles=[])}else return Cr;let T=f?new Array(r.length).fill(tc):tc;const b=()=>{if(!(!N.active||!N.dirty))if(e){const H=N.run();(n||h||(f?H.some((Q,te)=>us(Q,T[te])):us(H,T)))&&(d&&d(),or(e,l,3,[H,T===tc?void 0:f&&T[0]===tc?[]:T,m]),T=H)}else N.run()};b.allowRecurse=!!e;let S;i==="sync"?S=b:i==="post"?S=()=>qn(b,l&&l.suspense):(b.pre=!0,l&&(b.id=l.uid),S=()=>Tu(b));const N=new Kd(u,Cr,S),C=sw(),I=()=>{N.stop(),C&&Vd(C.effects,N)};return e?t?b():T=N.run():i==="post"?qn(N.run.bind(N),l&&l.suspense):N.run(),y&&y.push(I),I}function YC(r,e,t){const n=this.proxy,i=xt(r)?r.includes(".")?Ow(n,r):()=>n[r]:r.bind(n,n);let s;at(e)?s=e:(s=e.handler,t=e);const a=Tl(this),o=ip(i,s.bind(n),t);return a(),o}function Ow(r,e){const t=e.split(".");return()=>{let n=r;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}function Rs(r,e,t=0,n){if(!ln(r)||r.__v_skip)return r;if(e&&e>0){if(t>=e)return r;t++}if(n=n||new Set,n.has(r))return r;if(n.add(r),En(r))Rs(r.value,e,t,n);else if(it(r))for(let i=0;i<r.length;i++)Rs(r[i],e,t,n);else if(CE(r)||Aa(r))r.forEach(i=>{Rs(i,e,t,n)});else if(In(r))for(const i in r)Rs(r[i],e,t,n);return r}function Su(r,e){if(Nn===null)return r;const t=Ru(Nn)||Nn.proxy,n=r.dirs||(r.dirs=[]);for(let i=0;i<e.length;i++){let[s,a,o,l=an]=e[i];s&&(at(s)&&(s={mounted:s,updated:s}),s.deep&&Rs(a),n.push({dir:s,instance:t,value:a,oldValue:void 0,arg:o,modifiers:l}))}return r}function Ts(r,e,t,n){const i=r.dirs,s=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let l=o.dir[n];l&&(Hs(),or(l,t,8,[r.el,o,r,e]),Qs())}}const Xi=Symbol("_leaveCb"),nc=Symbol("_enterCb");function JC(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return gn(()=>{r.isMounted=!0}),$r(()=>{r.isUnmounting=!0}),r}const gr=[Function,Array],$w={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:gr,onEnter:gr,onAfterEnter:gr,onEnterCancelled:gr,onBeforeLeave:gr,onLeave:gr,onAfterLeave:gr,onLeaveCancelled:gr,onBeforeAppear:gr,onAppear:gr,onAfterAppear:gr,onAppearCancelled:gr},XC={name:"BaseTransition",props:$w,setup(r,{slots:e}){const t=Cn(),n=JC();return()=>{const i=e.default&&Lw(e.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const f of i)if(f.type!==lr){s=f;break}}const a=Vt(r),{mode:o}=a;if(n.isLeaving)return Nh(s);const l=Mm(s);if(!l)return Nh(s);const c=Wf(l,a,n,t);Hc(l,c);const u=t.subTree,h=u&&Mm(u);if(h&&h.type!==lr&&!rs(l,h)){const f=Wf(h,a,n,t);if(Hc(h,f),o==="out-in")return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},Nh(s);o==="in-out"&&l.type!==lr&&(f.delayLeave=(d,m,y)=>{const T=Dw(n,h);T[String(h.key)]=h,d[Xi]=()=>{m(),d[Xi]=void 0,delete c.delayedLeave},c.delayedLeave=y})}return s}}},ZC=XC;function Dw(r,e){const{leavingVNodes:t}=r;let n=t.get(e.type);return n||(n=Object.create(null),t.set(e.type,n)),n}function Wf(r,e,t,n){const{appear:i,mode:s,persisted:a=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:f,onAfterLeave:d,onLeaveCancelled:m,onBeforeAppear:y,onAppear:T,onAfterAppear:b,onAppearCancelled:S}=e,N=String(r.key),C=Dw(t,r),I=(te,V)=>{te&&or(te,n,9,V)},H=(te,V)=>{const J=V[1];I(te,V),it(te)?te.every(E=>E.length<=1)&&J():te.length<=1&&J()},Q={mode:s,persisted:a,beforeEnter(te){let V=o;if(!t.isMounted)if(i)V=y||o;else return;te[Xi]&&te[Xi](!0);const J=C[N];J&&rs(r,J)&&J.el[Xi]&&J.el[Xi](),I(V,[te])},enter(te){let V=l,J=c,E=u;if(!t.isMounted)if(i)V=T||l,J=b||c,E=S||u;else return;let A=!1;const x=te[nc]=$=>{A||(A=!0,$?I(E,[te]):I(J,[te]),Q.delayedLeave&&Q.delayedLeave(),te[nc]=void 0)};V?H(V,[te,x]):x()},leave(te,V){const J=String(r.key);if(te[nc]&&te[nc](!0),t.isUnmounting)return V();I(h,[te]);let E=!1;const A=te[Xi]=x=>{E||(E=!0,V(),x?I(m,[te]):I(d,[te]),te[Xi]=void 0,C[J]===r&&delete C[J])};C[J]=r,f?H(f,[te,A]):A()},clone(te){return Wf(te,e,t,n)}};return Q}function Nh(r){if(wl(r))return r=Ii(r),r.children=null,r}function Mm(r){return wl(r)?r.children?r.children[0]:void 0:r}function Hc(r,e){r.shapeFlag&6&&r.component?Hc(r.component.subTree,e):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function Lw(r,e=!1,t){let n=[],i=0;for(let s=0;s<r.length;s++){let a=r[s];const o=t==null?a.key:String(t)+String(a.key!=null?a.key:s);a.type===Ht?(a.patchFlag&128&&i++,n=n.concat(Lw(a.children,e,o))):(e||a.type!==lr)&&n.push(o!=null?Ii(a,{key:o}):a)}if(i>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Lt(r,e){return at(r)?Ct({name:r.name},e,{setup:r}):r}const Ra=r=>!!r.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function El(r){at(r)&&(r={loader:r});const{loader:e,loadingComponent:t,errorComponent:n,delay:i=200,timeout:s,suspensible:a=!0,onError:o}=r;let l=null,c,u=0;const h=()=>(u++,l=null,f()),f=()=>{let d;return l||(d=l=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),o)return new Promise((y,T)=>{o(m,()=>y(h()),()=>T(m),u+1)});throw m}).then(m=>d!==l&&l?l:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return Lt({name:"AsyncComponentWrapper",__asyncLoader:f,get __asyncResolved(){return c},setup(){const d=Tn;if(c)return()=>Ah(c,d);const m=S=>{l=null,bl(S,d,13,!n)};if(a&&d.suspense||Ya)return f().then(S=>()=>Ah(S,d)).catch(S=>(m(S),()=>n?X(n,{error:S}):null));const y=ge(!1),T=ge(),b=ge(!!i);return i&&setTimeout(()=>{b.value=!1},i),s!=null&&setTimeout(()=>{if(!y.value&&!T.value){const S=new Error(`Async component timed out after ${s}ms.`);m(S),T.value=S}},s),f().then(()=>{y.value=!0,d.parent&&wl(d.parent.vnode)&&(d.parent.effect.dirty=!0,Tu(d.parent.update))}).catch(S=>{m(S),T.value=S}),()=>{if(y.value&&c)return Ah(c,d);if(T.value&&n)return X(n,{error:T.value});if(t&&!b.value)return X(t)}}})}function Ah(r,e){const{ref:t,props:n,children:i,ce:s}=e.vnode,a=X(r,n,i);return a.ref=t,a.ce=s,delete e.vnode.ce,a}const wl=r=>r.type.__isKeepAlive;class eN{constructor(e){this.max=e,this._cache=new Map,this._keys=new Set,this._max=parseInt(e,10)}get(e){const{_cache:t,_keys:n,_max:i}=this,s=t.get(e);if(s)n.delete(e),n.add(e);else if(n.add(e),i&&n.size>i){const a=n.values().next().value;this.pruneCacheEntry(t.get(a)),this.delete(a)}return s}set(e,t){this._cache.set(e,t)}delete(e){this._cache.delete(e),this._keys.delete(e)}forEach(e,t){this._cache.forEach(e.bind(t))}}const tN={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number],matchBy:{type:String,default:"name"},cache:Object},setup(r,{slots:e}){const t=Cn(),n=t.ctx;if(!n.renderer)return()=>{const b=e.default&&e.default();return b&&b.length===1?b[0]:b};const i=r.cache||new eN(r.max);i.pruneCacheEntry=a;let s=null;function a(b){!s||!rs(b,s)||r.matchBy==="key"&&b.key!==s.key?d(b):s&&xh(s)}const o=t.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:h}}}=n,f=h("div");n.activate=(b,S,N,C,I)=>{const H=b.component;if(H.ba){const Q=H.isDeactivated;H.isDeactivated=!1,fr(H.ba),H.isDeactivated=Q}c(b,S,N,0,o),l(H.vnode,b,S,N,H,o,C,b.slotScopeIds,I),qn(()=>{H.isDeactivated=!1,H.a&&fr(H.a);const Q=b.props&&b.props.onVnodeMounted;Q&&br(Q,H.parent,b)},o)},n.deactivate=b=>{const S=b.component;S.bda&&kw(S.bda),c(b,f,null,1,o),qn(()=>{S.bda&&aN(S.bda),S.da&&fr(S.da);const N=b.props&&b.props.onVnodeUnmounted;N&&br(N,S.parent,b),S.isDeactivated=!0},o)};function d(b){xh(b),u(b,t,o,!0)}function m(b){i.forEach((S,N)=>{const C=Pm(S,r.matchBy);C&&(!b||!b(C))&&(i.delete(N),a(S))})}Ge(()=>[r.include,r.exclude,r.matchBy],([b,S])=>{b&&m(N=>Mo(b,N)),S&&m(N=>!Mo(S,N))},{flush:"post",deep:!0});let y=null;const T=()=>{y!=null&&i.set(y,Rh(t.subTree))};return gn(T),Bw(T),$r(()=>{i.forEach((b,S)=>{i.delete(S),a(b);const{subTree:N,suspense:C}=t,I=Rh(N);if(b.type===I.type&&(r.matchBy!=="key"||b.key===I.key)){I.component.bda&&fr(I.component.bda),xh(I);const H=I.component.da;H&&qn(H,C);return}})}),()=>{if(y=null,!e.default)return null;const b=e.default(),S=b[0];if(b.length>1)return s=null,b;if(!qa(S)||!(S.shapeFlag&4)&&!Lo(S.type))return s=null,S;let N=Rh(S);const C=N.type,I=Pm(N,r.matchBy),{include:H,exclude:Q}=r;if(H&&(!I||!Mo(H,I))||Q&&I&&Mo(Q,I))return s=N,S;const te=N.key==null?C:N.key,V=i.get(te);return N.el&&(N=Ii(N),Lo(S.type)&&(S.ssContent=N)),y=te,V&&(N.el=V.el,N.component=V.component,N.transition&&Hc(N,N.transition),N.shapeFlag|=512),N.shapeFlag|=256,s=N,Lo(S.type)?S:N}}},nN=tN;function Mo(r,e){return it(r)?r.some(t=>Mo(t,e)):xt(r)?r.split(",").includes(e):fS(r)?r.test(e):!1}function rN(r,e){Nu(r,"ba",e)}function Cu(r,e){Nu(r,"a",e)}function iN(r,e){Nu(r,"bda",e)}function qw(r,e){Nu(r,"da",e)}function Nu(r,e,t=Tn){const n=r.__wdc||(r.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return r()});if(n.__called=!1,zs(e,n,t),t){let i=t.parent;for(;i&&i.parent;)wl(i.parent.vnode)&&sN(n,e,t,i),i=i.parent}}function sN(r,e,t,n){const i=zs(e,r,n,!0);vl(()=>{Vd(n[e],i)},t)}function xh(r){r.shapeFlag&=-257,r.shapeFlag&=-513}function Rh(r){return Lo(r.type)?r.ssContent:r}function Pm(r,e){if(e==="name"){const t=r.type;return s0(Ra(r)?t.__asyncResolved||{}:t)}return String(r.key)}function kw(r){for(let e=0;e<r.length;e++){const t=r[e];t.__called||(t(),t.__called=!0)}}function aN(r){r.forEach(e=>e.__called=!1)}function zs(r,e,t=Tn,n=!1){if(t){if(nC(r)&&t.$pageInstance){if(t.type.__reserved)return;if(t!==t.$pageInstance&&(t=t.$pageInstance,tC(r))){const a=t.proxy;or(e.bind(a),t,r,Ka===r?[a.$page.options]:[])}}const i=t[r]||(t[r]=[]),s=e.__weh||(e.__weh=(...a)=>{if(t.isUnmounted)return;Hs();const o=Tl(t),l=or(e,t,r,a);return o(),Qs(),l});return n?i.unshift(s):i.push(s),s}}const Li=r=>(e,t=Tn)=>(!Ya||r==="sp")&&zs(r,(...n)=>e(...n),t),Xr=Li("bm"),gn=Li("m"),oN=Li("bu"),Bw=Li("u"),$r=Li("bum"),vl=Li("um"),lN=Li("sp"),cN=Li("rtg"),uN=Li("rtc");function hN(r,e=Tn){zs("ec",r,e)}function fi(r,e,t,n){let i;const s=t;if(it(r)||xt(r)){i=new Array(r.length);for(let a=0,o=r.length;a<o;a++)i[a]=e(r[a],a,void 0,s)}else if(typeof r=="number"){i=new Array(r);for(let a=0;a<r;a++)i[a]=e(a+1,a,void 0,s)}else if(ln(r))if(r[Symbol.iterator])i=Array.from(r,(a,o)=>e(a,o,void 0,s));else{const a=Object.keys(r);i=new Array(a.length);for(let o=0,l=a.length;o<l;o++){const c=a[o];i[o]=e(r[c],c,o,s)}}else i=[];return i}function Fw(r,e){for(let t=0;t<e.length;t++){const n=e[t];if(it(n))for(let i=0;i<n.length;i++)r[n[i].name]=n[i].fn;else n&&(r[n.name]=n.key?(...i)=>{const s=n.fn(...i);return s&&(s.key=n.key),s}:n.fn)}return r}function Bt(r,e,t={},n,i){if(Nn.isCE||Nn.parent&&Ra(Nn.parent)&&Nn.parent.isCE)return e!=="default"&&(t.name=e),X("slot",t,n&&n());let s=r[e];s&&s._c&&(s._d=!1),_e();const a=s&&Uw(s(t)),o=Ne(Ht,{key:t.key||a&&a.key||`_${e}`},a||(n?n():[]),a&&r._===1?64:-2);return!i&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),s&&s._c&&(s._d=!0),o}function Uw(r){return r.some(e=>qa(e)?!(e.type===lr||e.type===Ht&&!Uw(e.children)):!0)?r:null}const Hf=r=>r?n0(r)?Ru(r)||r.proxy:Hf(r.parent):null,fN=r=>function(){r.effect.dirty=!0,Tu(r.update)},qo=Ct(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Hf(r.parent),$root:r=>Hf(r.root),$emit:r=>r.emit,$options:r=>Ww(r),$forceUpdate:r=>r.f||(r.f=fN(r)),$nextTick:r=>r.n||(r.n=bn.bind(r.proxy)),$watch:r=>YC.bind(r)}),Mh=(r,e)=>r!==an&&!r.__isScriptSetup&&It(r,e),dN={get({_:r},e){const{ctx:t,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:l}=r;let c;if(e[0]!=="$"){const d=a[e];if(d!==void 0)switch(d){case 1:return n[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(Mh(n,e))return a[e]=1,n[e];if(i!==an&&It(i,e))return a[e]=2,i[e];if((c=r.propsOptions[0])&&It(c,e))return a[e]=3,s[e];if(t!==an&&It(t,e))return a[e]=4,t[e];Qf&&(a[e]=0)}}const u=qo[e];let h,f;if(u)return e==="$attrs"&&cr(r,"get",e),u(r);if((h=o.__cssModules)&&(h=h[e]))return h;if(t!==an&&It(t,e))return a[e]=4,t[e];if(f=l.config.globalProperties,It(f,e))return f[e]},set({_:r},e,t){const{data:n,setupState:i,ctx:s}=r;return Mh(i,e)?(i[e]=t,!0):n!==an&&It(n,e)?(n[e]=t,!0):It(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(s[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:i,propsOptions:s}},a){let o;return!!t[a]||r!==an&&It(r,a)||Mh(e,a)||(o=s[0])&&It(o,a)||It(n,a)||It(qo,a)||It(i.config.globalProperties,a)},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:It(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function Vw(){return pN().slots}function pN(){const r=Cn();return r.setupContext||(r.setupContext=i0(r))}function Im(r){return it(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}let Qf=!0;function mN(r){const e=Ww(r),t=r.proxy,n=r.ctx;Qf=!1,e.beforeCreate&&Om(e.beforeCreate,r,"bc");const{data:i,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:f,beforeUpdate:d,updated:m,activated:y,deactivated:T,beforeDestroy:b,beforeUnmount:S,destroyed:N,unmounted:C,render:I,renderTracked:H,renderTriggered:Q,errorCaptured:te,serverPrefetch:V,expose:J,inheritAttrs:E,components:A,directives:x,filters:$}=e;if(c&&yN(c,n,null),a)for(const ue in a){const L=a[ue];at(L)&&(n[ue]=L.bind(t))}if(i){const ue=i.call(t,t);ln(ue)&&(r.data=nn(ue))}if(Qf=!0,s)for(const ue in s){const L=s[ue],Se=at(L)?L.bind(t,t):at(L.get)?L.get.bind(t,t):Cr,Ae=!at(L)&&at(L.set)?L.set.bind(t):Cr,ve=Me({get:Se,set:Ae});Object.defineProperty(n,ue,{enumerable:!0,configurable:!0,get:()=>ve.value,set:Ye=>ve.value=Ye})}if(o)for(const ue in o)jw(o[ue],n,t,ue);if(l){const ue=at(l)?l.call(t):l;Reflect.ownKeys(ue).forEach(L=>{Qr(L,ue[L])})}u&&Om(u,r,"c");function K(ue,L){it(L)?L.forEach(Se=>ue(Se.bind(t))):L&&ue(L.bind(t))}if(K(Xr,h),K(gn,f),K(oN,d),K(Bw,m),K(Cu,y),K(qw,T),K(hN,te),K(uN,H),K(cN,Q),K($r,S),K(vl,C),K(lN,V),it(J))if(J.length){const ue=r.exposed||(r.exposed={});J.forEach(L=>{Object.defineProperty(ue,L,{get:()=>t[L],set:Se=>t[L]=Se})})}else r.exposed||(r.exposed={});I&&r.render===Cr&&(r.render=I),E!=null&&(r.inheritAttrs=E),A&&(r.components=A),x&&(r.directives=x);const ae=r.appContext.config.globalProperties.$applyOptions;ae&&ae(e,r,t)}function yN(r,e,t=Cr){it(r)&&(r=zf(r));for(const n in r){const i=r[n];let s;ln(i)?"default"in i?s=on(i.from||n,i.default,!0):s=on(i.from||n):s=on(i),En(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[n]=s}}function Om(r,e,t){or(it(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function jw(r,e,t,n){const i=n.includes(".")?Ow(t,n):()=>t[n];if(xt(r)){const s=e[r];at(s)&&Ge(i,s)}else if(at(r))Ge(i,r.bind(t));else if(ln(r))if(it(r))r.forEach(s=>jw(s,e,t,n));else{const s=at(r.handler)?r.handler.bind(t):e[r.handler];at(s)&&Ge(i,s,r)}}function Ww(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=r.appContext,o=s.get(e);let l;return o?l=o:!i.length&&!t&&!n?l=e:(l={},i.length&&i.forEach(c=>Qc(l,c,a,!0)),Qc(l,e,a)),ln(e)&&s.set(e,l),l}function Qc(r,e,t,n=!1){const{mixins:i,extends:s}=e;s&&Qc(r,s,t,!0),i&&i.forEach(a=>Qc(r,a,t,!0));for(const a in e)if(!(n&&a==="expose")){const o=gN[a]||t&&t[a];r[a]=o?o(r[a],e[a]):e[a]}return r}const gN={data:$m,props:Dm,emits:Dm,methods:Po,computed:Po,beforeCreate:Yn,created:Yn,beforeMount:Yn,mounted:Yn,beforeUpdate:Yn,updated:Yn,beforeDestroy:Yn,beforeUnmount:Yn,destroyed:Yn,unmounted:Yn,activated:Yn,deactivated:Yn,errorCaptured:Yn,serverPrefetch:Yn,components:Po,directives:Po,watch:EN,provide:$m,inject:bN};function $m(r,e){return e?r?function(){return Ct(at(r)?r.call(this,this):r,at(e)?e.call(this,this):e)}:e:r}function bN(r,e){return Po(zf(r),zf(e))}function zf(r){if(it(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function Yn(r,e){return r?[...new Set([].concat(r,e))]:e}function Po(r,e){return r?Ct(Object.create(null),r,e):e}function Dm(r,e){return r?it(r)&&it(e)?[...new Set([...r,...e])]:Ct(Object.create(null),Im(r),Im(e!=null?e:{})):e}function EN(r,e){if(!r)return e;if(!e)return r;const t=Ct(Object.create(null),r);for(const n in e)t[n]=Yn(r[n],e[n]);return t}function Hw(){return{app:null,config:{isNativeTag:uS,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wN=0;function vN(r,e){return function(n,i=null){at(n)||(n=Ct({},n)),i!=null&&!ln(i)&&(i=null);const s=Hw(),a=new WeakSet;let o=!1;const l=s.app={_uid:wN++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:WN,get config(){return s.config},set config(c){},use(c,...u){return a.has(c)||(c&&at(c.install)?(a.add(c),c.install(l,...u)):at(c)&&(a.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!o){const f=X(n,i);return f.appContext=s,h===!0?h="svg":h===!1&&(h=void 0),r(f,c,h),o=!0,l._container=c,c.__vue_app__=l,l._instance=f.component,Ru(f.component)||f.component.proxy}},unmount(){o&&(r(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l},runWithContext(c){const u=ko;ko=l;try{return c()}finally{ko=u}}};return l}}let ko=null;function Qr(r,e){if(Tn){let t=Tn.provides;const n=Tn.parent&&Tn.parent.provides;n===t&&(t=Tn.provides=Object.create(n)),t[r]=e,Tn.type.mpType==="app"&&Tn.appContext.app.provide(r,e)}}function on(r,e,t=!1){const n=Tn||Nn;if(n||ko){const i=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:ko._context.provides;if(i&&r in i)return i[r];if(arguments.length>1)return t&&at(e)?e.call(n&&n.proxy):e}}function TN(r,e,t,n=!1){const i={},s={};qc(s,Au,1),r.propsDefaults=Object.create(null),Qw(r,e,i,s);for(const a in r.propsOptions[0])a in i||(i[a]=void 0);t?r.props=n?i:gw(i):r.type.props?r.props=i:r.props=s,r.attrs=s}function _N(r,e,t,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=r,o=Vt(i),[l]=r.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=r.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(_u(r.emitsOptions,f))continue;const d=e[f];if(l)if(It(s,f))d!==s[f]&&(s[f]=d,c=!0);else{const m=Yr(f);i[m]=Gf(l,o,m,d,r,!1)}else d!==s[f]&&(s[f]=d,c=!0)}}}else{Qw(r,e,i,s)&&(c=!0);let u;for(const h in o)(!e||!It(e,h)&&((u=Di(h))===h||!It(e,u)))&&(l?t&&(t[h]!==void 0||t[u]!==void 0)&&(i[h]=Gf(l,o,h,void 0,r,!0)):delete i[h]);if(s!==o)for(const h in s)(!e||!It(e,h))&&(delete s[h],c=!0)}c&&Ai(r,"set","$attrs")}function Qw(r,e,t,n){const[i,s]=r.propsOptions;let a=!1,o;if(e)for(let l in e){if(Do(l))continue;const c=e[l];let u;i&&It(i,u=Yr(l))?!s||!s.includes(u)?t[u]=c:(o||(o={}))[u]=c:_u(r.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(s){const l=Vt(t),c=o||an;for(let u=0;u<s.length;u++){const h=s[u];t[h]=Gf(i,l,h,c[h],r,!It(c,h))}}return a}function Gf(r,e,t,n,i,s){const a=r[t];if(a!=null){const o=It(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&at(l)){const{propsDefaults:c}=i;if(t in c)n=c[t];else{const u=Tl(i);n=c[t]=l.call(null,e),u()}}else n=l}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Di(t))&&(n=!0))}return n}function zw(r,e,t=!1){const n=e.propsCache,i=n.get(r);if(i)return i;const s=r.props,a={},o=[];let l=!1;if(!at(r)){const u=h=>{l=!0;const[f,d]=zw(h,e,!0);Ct(a,f),d&&o.push(...d)};!t&&e.mixins.length&&e.mixins.forEach(u),r.extends&&u(r.extends),r.mixins&&r.mixins.forEach(u)}if(!s&&!l)return ln(r)&&n.set(r,Na),Na;if(it(s))for(let u=0;u<s.length;u++){const h=Yr(s[u]);Lm(h)&&(a[h]=an)}else if(s)for(const u in s){const h=Yr(u);if(Lm(h)){const f=s[u],d=a[h]=it(f)||at(f)?{type:f}:Ct({},f);if(d){const m=Bm(Boolean,d.type),y=Bm(String,d.type);d[0]=m>-1,d[1]=y<0||m<y,(m>-1||It(d,"default"))&&o.push(h)}}}const c=[a,o];return ln(r)&&n.set(r,c),c}function Lm(r){return r[0]!=="$"&&!Do(r)}function qm(r){return r===null?"null":typeof r=="function"?r.name||"":typeof r=="object"&&r.constructor&&r.constructor.name||""}function km(r,e){return qm(r)===qm(e)}function Bm(r,e){return it(e)?e.findIndex(t=>km(t,r)):at(e)&&km(e,r)?0:-1}const Gw=r=>r[0]==="_"||r==="$stable",sp=r=>it(r)?r.map(oi):[oi(r)],SN=(r,e,t)=>{if(e._n)return e;const n=re((...i)=>sp(e(...i)),t);return n._c=!1,n},Kw=(r,e,t)=>{const n=r._ctx;for(const i in r){if(Gw(i))continue;const s=r[i];if(at(s))e[i]=SN(i,s,n);else if(s!=null){const a=sp(s);e[i]=()=>a}}},Yw=(r,e)=>{const t=sp(e);r.slots.default=()=>t},CN=(r,e)=>{if(r.vnode.shapeFlag&32){const t=e._;t?(r.slots=Vt(e),qc(e,"_",t)):Kw(e,r.slots={})}else r.slots={},e&&Yw(r,e);qc(r.slots,Au,1)},NN=(r,e,t)=>{const{vnode:n,slots:i}=r;let s=!0,a=an;if(n.shapeFlag&32){const o=e._;o?t&&o===1?s=!1:(Ct(i,e),!t&&o===1&&delete i._):(s=!e.$stable,Kw(e,i)),a=e}else e&&(Yw(r,e),a={default:1});if(s)for(const o in i)!Gw(o)&&a[o]==null&&delete i[o]};function Kf(r,e,t,n,i=!1){if(it(r)){r.forEach((f,d)=>Kf(f,e&&(it(e)?e[d]:e),t,n,i));return}if(Ra(n)&&!i)return;const s=n.shapeFlag&4?Ru(n.component)||n.component.proxy:n.el,a=i?null:s,{i:o,r:l}=r,c=e&&e.r,u=o.refs===an?o.refs={}:o.refs,h=o.setupState;if(c!=null&&c!==l&&(xt(c)?(u[c]=null,It(h,c)&&(h[c]=null)):En(c)&&(c.value=null)),at(l))ls(l,o,12,[a,u]);else{const f=xt(l),d=En(l);if(f||d){const m=()=>{if(r.f){const y=f?It(h,l)?h[l]:u[l]:l.value;i?it(y)&&Vd(y,s):it(y)?y.includes(s)||y.push(s):f?(u[l]=[s],It(h,l)&&(h[l]=u[l])):(l.value=[s],r.k&&(u[r.k]=l.value))}else f?(u[l]=a,It(h,l)&&(h[l]=a)):d&&(l.value=a,r.k&&(u[r.k]=a))};a?(m.id=-1,qn(m,t)):m()}}}const qn=zC;function AN(r){return xN(r)}function xN(r,e){const t=AE();t.__VUE__=!0;const{insert:n,remove:i,patchProp:s,forcePatchProp:a,createElement:o,createText:l,createComment:c,setText:u,setElementText:h,parentNode:f,nextSibling:d,setScopeId:m=Cr,insertStaticContent:y}=r,T=(M,q,se,le=null,be=null,xe=null,Le=void 0,Pe=null,oe=!!q.dynamicChildren)=>{if(M===q)return;M&&!rs(M,q)&&(le=$e(M),Ye(M,be,xe,!0),M=null),q.patchFlag===-2&&(oe=!1,q.dynamicChildren=null);const{type:fe,ref:Ve,shapeFlag:Je}=q;switch(fe){case La:b(M,q,se,le);break;case lr:S(M,q,se,le);break;case Ih:M==null&&N(q,se,le,Le);break;case Ht:x(M,q,se,le,be,xe,Le,Pe,oe);break;default:Je&1?H(M,q,se,le,be,xe,Le,Pe,oe):Je&6?$(M,q,se,le,be,xe,Le,Pe,oe):(Je&64||Je&128)&&fe.process(M,q,se,le,be,xe,Le,Pe,oe,j)}Ve!=null&&be&&Kf(Ve,M&&M.ref,xe,q||M,!q)},b=(M,q,se,le)=>{if(M==null)n(q.el=l(q.children),se,le);else{const be=q.el=M.el;q.children!==M.children&&u(be,q.children)}},S=(M,q,se,le)=>{M==null?n(q.el=c(q.children||""),se,le):q.el=M.el},N=(M,q,se,le)=>{[M.el,M.anchor]=y(M.children,q,se,le,M.el,M.anchor)},C=({el:M,anchor:q},se,le)=>{let be;for(;M&&M!==q;)be=d(M),n(M,se,le),M=be;n(q,se,le)},I=({el:M,anchor:q})=>{let se;for(;M&&M!==q;)se=d(M),i(M),M=se;i(q)},H=(M,q,se,le,be,xe,Le,Pe,oe)=>{q.type==="svg"?Le="svg":q.type==="math"&&(Le="mathml"),M==null?Q(q,se,le,be,xe,Le,Pe,oe):J(M,q,be,xe,Le,Pe,oe)},Q=(M,q,se,le,be,xe,Le,Pe)=>{let oe,fe;const{props:Ve,shapeFlag:Je,transition:ze,dirs:nt}=M;if(oe=M.el=o(M.type,xe,Ve&&Ve.is,Ve),Je&8?h(oe,M.children):Je&16&&V(M.children,oe,null,le,be,Ph(M,xe),Le,Pe),nt&&Ts(M,null,le,"created"),te(oe,M,M.scopeId,Le,le),Ve){for(const w in Ve)w!=="value"&&!Do(w)&&s(oe,w,null,Ve[w],xe,M.children,le,be,Ee);"value"in Ve&&s(oe,"value",null,Ve.value,xe),(fe=Ve.onVnodeBeforeMount)&&br(fe,le,M)}Object.defineProperty(oe,"__vueParentComponent",{value:le,enumerable:!1}),nt&&Ts(M,null,le,"beforeMount");const P=RN(be,ze);P&&ze.beforeEnter(oe),n(oe,q,se),((fe=Ve&&Ve.onVnodeMounted)||P||nt)&&qn(()=>{fe&&br(fe,le,M),P&&ze.enter(oe),nt&&Ts(M,null,le,"mounted")},be)},te=(M,q,se,le,be)=>{if(se&&m(M,se),le)for(let xe=0;xe<le.length;xe++)m(M,le[xe]);if(be){let xe=be.subTree;if(q===xe){const Le=be.vnode;te(M,Le,Le.scopeId,Le.slotScopeIds,be.parent)}}},V=(M,q,se,le,be,xe,Le,Pe,oe=0)=>{for(let fe=oe;fe<M.length;fe++){const Ve=M[fe]=Pe?Zi(M[fe]):oi(M[fe]);T(null,Ve,q,se,le,be,xe,Le,Pe)}},J=(M,q,se,le,be,xe,Le)=>{const Pe=q.el=M.el;let{patchFlag:oe,dynamicChildren:fe,dirs:Ve}=q;oe|=M.patchFlag&16;const Je=M.props||an,ze=q.props||an;let nt;if(se&&_s(se,!1),(nt=ze.onVnodeBeforeUpdate)&&br(nt,se,q,M),Ve&&Ts(q,M,se,"beforeUpdate"),se&&_s(se,!0),fe?E(M.dynamicChildren,fe,Pe,se,le,Ph(q,be),xe):Le||L(M,q,Pe,null,se,le,Ph(q,be),xe,!1),oe>0){if(oe&16)A(Pe,q,Je,ze,se,le,be);else if(oe&2&&Je.class!==ze.class&&s(Pe,"class",null,ze.class,be),oe&4&&s(Pe,"style",Je.style,ze.style,be),oe&8){const P=q.dynamicProps;for(let w=0;w<P.length;w++){const _=P[w],W=Je[_],O=ze[_];(O!==W||_==="value"||a&&a(Pe,_))&&s(Pe,_,W,O,be,M.children,se,le,Ee)}}oe&1&&M.children!==q.children&&h(Pe,q.children)}else!Le&&fe==null&&A(Pe,q,Je,ze,se,le,be);((nt=ze.onVnodeUpdated)||Ve)&&qn(()=>{nt&&br(nt,se,q,M),Ve&&Ts(q,M,se,"updated")},le)},E=(M,q,se,le,be,xe,Le)=>{for(let Pe=0;Pe<q.length;Pe++){const oe=M[Pe],fe=q[Pe],Ve=oe.el&&(oe.type===Ht||!rs(oe,fe)||oe.shapeFlag&70)?f(oe.el):se;T(oe,fe,Ve,null,le,be,xe,Le,!0)}},A=(M,q,se,le,be,xe,Le)=>{if(se!==le){if(se!==an)for(const Pe in se)!Do(Pe)&&!(Pe in le)&&s(M,Pe,se[Pe],null,Le,q.children,be,xe,Ee);for(const Pe in le){if(Do(Pe))continue;const oe=le[Pe],fe=se[Pe];(oe!==fe&&Pe!=="value"||a&&a(M,Pe))&&s(M,Pe,fe,oe,Le,q.children,be,xe,Ee)}"value"in le&&s(M,"value",se.value,le.value,Le)}},x=(M,q,se,le,be,xe,Le,Pe,oe)=>{const fe=q.el=M?M.el:l(""),Ve=q.anchor=M?M.anchor:l("");let{patchFlag:Je,dynamicChildren:ze,slotScopeIds:nt}=q;nt&&(Pe=Pe?Pe.concat(nt):nt),M==null?(n(fe,se,le),n(Ve,se,le),V(q.children||[],se,Ve,be,xe,Le,Pe,oe)):Je>0&&Je&64&&ze&&M.dynamicChildren?(E(M.dynamicChildren,ze,se,be,xe,Le,Pe),(q.key!=null||be&&q===be.subTree)&&ap(M,q,!0)):L(M,q,se,Ve,be,xe,Le,Pe,oe)},$=(M,q,se,le,be,xe,Le,Pe,oe)=>{q.slotScopeIds=Pe,M==null?q.shapeFlag&512?be.ctx.activate(q,se,le,Le,oe):B(q,se,le,be,xe,Le,oe):K(M,q,oe)},B=(M,q,se,le,be,xe,Le)=>{const Pe=M.component=BN(M,le,be);if(wl(M)&&(Pe.ctx.renderer=j),FN(Pe),Pe.asyncDep){if(be&&be.registerDep(Pe,ae),!M.el){const oe=Pe.subTree=X(lr);S(null,oe,q,se)}}else ae(Pe,M,q,se,be,xe,Le)},K=(M,q,se)=>{const le=q.component=M.component;if(HC(M,q,se))if(le.asyncDep&&!le.asyncResolved){ue(le,q,se);return}else le.next=q,BC(le.update),le.effect.dirty=!0,le.update();else q.el=M.el,le.vnode=q},ae=(M,q,se,le,be,xe,Le)=>{const Pe=()=>{if(M.isMounted){let{next:Ve,bu:Je,u:ze,parent:nt,vnode:P}=M;{const U=Jw(M);if(U){Ve&&(Ve.el=P.el,ue(M,Ve,Le)),U.asyncDep.then(()=>{M.isUnmounted||Pe()});return}}let w=Ve,_;_s(M,!1),Ve?(Ve.el=P.el,ue(M,Ve,Le)):Ve=P,Je&&fr(Je),(_=Ve.props&&Ve.props.onVnodeBeforeUpdate)&&br(_,nt,Ve,P),_s(M,!0);const W=Am(M),O=M.subTree;M.subTree=W,T(O,W,f(O.el),$e(O),M,be,xe),Ve.el=W.el,w===null&&QC(M,W.el),ze&&qn(ze,be),(_=Ve.props&&Ve.props.onVnodeUpdated)&&qn(()=>br(_,nt,Ve,P),be)}else{let Ve;const{el:Je,props:ze}=q,{bm:nt,m:P,parent:w}=M,_=Ra(q);_s(M,!1),nt&&fr(nt),!_&&(Ve=ze&&ze.onVnodeBeforeMount)&&br(Ve,w,q),_s(M,!0);{const W=M.subTree=Am(M);T(null,W,se,le,M,be,xe),q.el=W.el}if(P&&qn(P,be),!_&&(Ve=ze&&ze.onVnodeMounted)){const W=q;qn(()=>br(Ve,w,W),be)}(q.shapeFlag&256||w&&Ra(w.vnode)&&w.vnode.shapeFlag&256)&&(M.ba&&kw(M.ba),M.a&&qn(M.a,be)),M.isMounted=!0,q=se=le=null}},oe=M.effect=new Kd(Pe,Cr,()=>Tu(fe),M.scope),fe=M.update=()=>{oe.dirty&&oe.run()};fe.id=M.uid,_s(M,!0),fe()},ue=(M,q,se)=>{q.component=M;const le=M.vnode.props;M.vnode=q,M.next=null,_N(M,q.props,le,se),NN(M,q.children,se),Hs(),Cm(M),Qs()},L=(M,q,se,le,be,xe,Le,Pe,oe=!1)=>{const fe=M&&M.children,Ve=M?M.shapeFlag:0,Je=q.children,{patchFlag:ze,shapeFlag:nt}=q;if(ze>0){if(ze&128){Ae(fe,Je,se,le,be,xe,Le,Pe,oe);return}else if(ze&256){Se(fe,Je,se,le,be,xe,Le,Pe,oe);return}}nt&8?(Ve&16&&Ee(fe,be,xe),Je!==fe&&h(se,Je)):Ve&16?nt&16?Ae(fe,Je,se,le,be,xe,Le,Pe,oe):Ee(fe,be,xe,!0):(Ve&8&&h(se,""),nt&16&&V(Je,se,le,be,xe,Le,Pe,oe))},Se=(M,q,se,le,be,xe,Le,Pe,oe)=>{M=M||Na,q=q||Na;const fe=M.length,Ve=q.length,Je=Math.min(fe,Ve);let ze;for(ze=0;ze<Je;ze++){const nt=q[ze]=oe?Zi(q[ze]):oi(q[ze]);T(M[ze],nt,se,null,be,xe,Le,Pe,oe)}fe>Ve?Ee(M,be,xe,!0,!1,Je):V(q,se,le,be,xe,Le,Pe,oe,Je)},Ae=(M,q,se,le,be,xe,Le,Pe,oe)=>{let fe=0;const Ve=q.length;let Je=M.length-1,ze=Ve-1;for(;fe<=Je&&fe<=ze;){const nt=M[fe],P=q[fe]=oe?Zi(q[fe]):oi(q[fe]);if(rs(nt,P))T(nt,P,se,null,be,xe,Le,Pe,oe);else break;fe++}for(;fe<=Je&&fe<=ze;){const nt=M[Je],P=q[ze]=oe?Zi(q[ze]):oi(q[ze]);if(rs(nt,P))T(nt,P,se,null,be,xe,Le,Pe,oe);else break;Je--,ze--}if(fe>Je){if(fe<=ze){const nt=ze+1,P=nt<Ve?q[nt].el:le;for(;fe<=ze;)T(null,q[fe]=oe?Zi(q[fe]):oi(q[fe]),se,P,be,xe,Le,Pe,oe),fe++}}else if(fe>ze)for(;fe<=Je;)Ye(M[fe],be,xe,!0),fe++;else{const nt=fe,P=fe,w=new Map;for(fe=P;fe<=ze;fe++){const rt=q[fe]=oe?Zi(q[fe]):oi(q[fe]);rt.key!=null&&w.set(rt.key,fe)}let _,W=0;const O=ze-P+1;let U=!1,ee=0;const me=new Array(O);for(fe=0;fe<O;fe++)me[fe]=0;for(fe=nt;fe<=Je;fe++){const rt=M[fe];if(W>=O){Ye(rt,be,xe,!0);continue}let ft;if(rt.key!=null)ft=w.get(rt.key);else for(_=P;_<=ze;_++)if(me[_-P]===0&&rs(rt,q[_])){ft=_;break}ft===void 0?Ye(rt,be,xe,!0):(me[ft-P]=fe+1,ft>=ee?ee=ft:U=!0,T(rt,q[ft],se,null,be,xe,Le,Pe,oe),W++)}const He=U?MN(me):Na;for(_=He.length-1,fe=O-1;fe>=0;fe--){const rt=P+fe,ft=q[rt],Qe=rt+1<Ve?q[rt+1].el:le;me[fe]===0?T(null,ft,se,Qe,be,xe,Le,Pe,oe):U&&(_<0||fe!==He[_]?ve(ft,se,Qe,2):_--)}}},ve=(M,q,se,le,be=null)=>{const{el:xe,type:Le,transition:Pe,children:oe,shapeFlag:fe}=M;if(fe&6){ve(M.component.subTree,q,se,le);return}if(fe&128){M.suspense.move(q,se,le);return}if(fe&64){Le.move(M,q,se,j);return}if(Le===Ht){n(xe,q,se);for(let Je=0;Je<oe.length;Je++)ve(oe[Je],q,se,le);n(M.anchor,q,se);return}if(Le===Ih){C(M,q,se);return}if(le!==2&&fe&1&&Pe)if(le===0)Pe.beforeEnter(xe),n(xe,q,se),qn(()=>Pe.enter(xe),be);else{const{leave:Je,delayLeave:ze,afterLeave:nt}=Pe,P=()=>n(xe,q,se),w=()=>{Je(xe,()=>{P(),nt&&nt()})};ze?ze(xe,P,w):w()}else n(xe,q,se)},Ye=(M,q,se,le=!1,be=!1)=>{const{type:xe,props:Le,ref:Pe,children:oe,dynamicChildren:fe,shapeFlag:Ve,patchFlag:Je,dirs:ze}=M;if(Pe!=null&&Kf(Pe,null,se,M,!0),Ve&256){q.ctx.deactivate(M);return}const nt=Ve&1&&ze,P=!Ra(M);let w;if(P&&(w=Le&&Le.onVnodeBeforeUnmount)&&br(w,q,M),Ve&6)ut(M.component,se,le);else{if(Ve&128){M.suspense.unmount(se,le);return}nt&&Ts(M,null,q,"beforeUnmount"),Ve&64?M.type.remove(M,q,se,be,j,le):fe&&(xe!==Ht||Je>0&&Je&64)?Ee(fe,q,se,!1,!0):(xe===Ht&&Je&384||!be&&Ve&16)&&Ee(oe,q,se),le&&mt(M)}(P&&(w=Le&&Le.onVnodeUnmounted)||nt)&&qn(()=>{w&&br(w,q,M),nt&&Ts(M,null,q,"unmounted")},se)},mt=M=>{const{type:q,el:se,anchor:le,transition:be}=M;if(q===Ht){et(se,le);return}if(q===Ih){I(M);return}const xe=()=>{i(se),be&&!be.persisted&&be.afterLeave&&be.afterLeave()};if(M.shapeFlag&1&&be&&!be.persisted){const{leave:Le,delayLeave:Pe}=be,oe=()=>Le(se,xe);Pe?Pe(M.el,xe,oe):oe()}else xe()},et=(M,q)=>{let se;for(;M!==q;)se=d(M),i(M),M=se;i(q)},ut=(M,q,se)=>{const{bum:le,scope:be,update:xe,subTree:Le,um:Pe}=M;le&&fr(le),be.stop(),xe&&(xe.active=!1,Ye(Le,M,q,se)),Pe&&qn(Pe,q),qn(()=>{M.isUnmounted=!0},q),q&&q.pendingBranch&&!q.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===q.pendingId&&(q.deps--,q.deps===0&&q.resolve())},Ee=(M,q,se,le=!1,be=!1,xe=0)=>{for(let Le=xe;Le<M.length;Le++)Ye(M[Le],q,se,le,be)},$e=M=>M.shapeFlag&6?$e(M.component.subTree):M.shapeFlag&128?M.suspense.next():d(M.anchor||M.el);let z=!1;const Te=(M,q,se)=>{M==null?q._vnode&&Ye(q._vnode,null,null,!0):T(q._vnode||null,M,q,null,null,null,se),z||(z=!0,Cm(),Nw(),z=!1),q._vnode=M},j={p:T,um:Ye,m:ve,r:mt,mt:B,mc:V,pc:L,pbc:E,n:$e,o:r};return{render:Te,hydrate:void 0,createApp:vN(Te)}}function Ph({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function _s({effect:r,update:e},t){r.allowRecurse=e.allowRecurse=t}function RN(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function ap(r,e,t=!1){const n=r.children,i=e.children;if(it(n)&&it(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=Zi(i[s]),o.el=a.el),t||ap(a,o)),o.type===La&&(o.el=a.el)}}function MN(r){const e=r.slice(),t=[0];let n,i,s,a,o;const l=r.length;for(n=0;n<l;n++){const c=r[n];if(c!==0){if(i=t[t.length-1],r[i]<c){e[n]=i,t.push(n);continue}for(s=0,a=t.length-1;s<a;)o=s+a>>1,r[t[o]]<c?s=o+1:a=o;c<r[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,a=t[s-1];s-- >0;)t[s]=a,a=e[a];return t}function Jw(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Jw(e)}const PN=r=>r.__isTeleport,Bo=r=>r&&(r.disabled||r.disabled===""),Fm=r=>typeof SVGElement!="undefined"&&r instanceof SVGElement,Um=r=>typeof MathMLElement=="function"&&r instanceof MathMLElement,Yf=(r,e)=>{const t=r&&r.to;return xt(t)?e?e(t):null:t},IN={name:"Teleport",__isTeleport:!0,process(r,e,t,n,i,s,a,o,l,c){const{mc:u,pc:h,pbc:f,o:{insert:d,querySelector:m,createText:y,createComment:T}}=c,b=Bo(e.props);let{shapeFlag:S,children:N,dynamicChildren:C}=e;if(r==null){const I=e.el=y(""),H=e.anchor=y("");d(I,t,n),d(H,t,n);const Q=e.target=Yf(e.props,m),te=e.targetAnchor=y("");Q&&(d(te,Q),a==="svg"||Fm(Q)?a="svg":(a==="mathml"||Um(Q))&&(a="mathml"));const V=(J,E)=>{S&16&&u(N,J,E,i,s,a,o,l)};b?V(t,H):Q&&V(Q,te)}else{e.el=r.el;const I=e.anchor=r.anchor,H=e.target=r.target,Q=e.targetAnchor=r.targetAnchor,te=Bo(r.props),V=te?t:H,J=te?I:Q;if(a==="svg"||Fm(H)?a="svg":(a==="mathml"||Um(H))&&(a="mathml"),C?(f(r.dynamicChildren,C,V,i,s,a,o),ap(r,e,!0)):l||h(r,e,V,J,i,s,a,o,!1),b)te?e.props&&r.props&&e.props.to!==r.props.to&&(e.props.to=r.props.to):rc(e,t,I,c,1);else if((e.props&&e.props.to)!==(r.props&&r.props.to)){const E=e.target=Yf(e.props,m);E&&rc(e,E,null,c,0)}else te&&rc(e,H,Q,c,1)}Xw(e)},remove(r,e,t,n,{um:i,o:{remove:s}},a){const{shapeFlag:o,children:l,anchor:c,targetAnchor:u,target:h,props:f}=r;if(h&&s(u),a&&s(c),o&16){const d=a||!Bo(f);for(let m=0;m<l.length;m++){const y=l[m];i(y,e,t,d,!!y.dynamicChildren)}}},move:rc,hydrate:ON};function rc(r,e,t,{o:{insert:n},m:i},s=2){s===0&&n(r.targetAnchor,e,t);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=r,h=s===2;if(h&&n(a,e,t),(!h||Bo(u))&&l&16)for(let f=0;f<c.length;f++)i(c[f],e,t,2);h&&n(o,e,t)}function ON(r,e,t,n,i,s,{o:{nextSibling:a,parentNode:o,querySelector:l}},c){const u=e.target=Yf(e.props,l);if(u){const h=u._lpa||u.firstChild;if(e.shapeFlag&16)if(Bo(e.props))e.anchor=c(a(r),e,o(r),t,n,i,s),e.targetAnchor=h;else{e.anchor=a(r);let f=h;for(;f;)if(f=a(f),f&&f.nodeType===8&&f.data==="teleport anchor"){e.targetAnchor=f,u._lpa=e.targetAnchor&&a(e.targetAnchor);break}c(h,e,u,t,n,i,s)}Xw(e)}return e.anchor&&a(e.anchor)}const $N=IN;function Xw(r){const e=r.ctx;if(e&&e.ut){let t=r.children[0].el;for(;t&&t!==r.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const Ht=Symbol.for("v-fgt"),La=Symbol.for("v-txt"),lr=Symbol.for("v-cmt"),Ih=Symbol.for("v-stc"),Fo=[];let Hr=null;function _e(r=!1){Fo.push(Hr=r?null:[])}function DN(){Fo.pop(),Hr=Fo[Fo.length-1]||null}let il=1;function Vm(r){il+=r}function Zw(r){return r.dynamicChildren=il>0?Hr||Na:null,DN(),il>0&&Hr&&Hr.push(r),r}function Gn(r,e,t,n,i,s){return Zw(t0(r,e,t,n,i,s,!0))}function Ne(r,e,t,n,i){return Zw(X(r,e,t,n,i,!0))}function qa(r){return r?r.__v_isVNode===!0:!1}function rs(r,e){return r.type===e.type&&r.key===e.key}const Au="__vInternal",e0=({key:r})=>r!=null?r:null,bc=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?xt(r)||En(r)||at(r)?{i:Nn,r,k:e,f:!!t}:r:null);function t0(r,e=null,t=null,n=0,i=null,s=r===Ht?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&e0(e),ref:e&&bc(e),scopeId:Rw,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Nn};return o?(op(l,t),s&128&&r.normalize(l)):t&&(l.shapeFlag|=xt(t)?8:16),il>0&&!a&&Hr&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Hr.push(l),l}const X=LN;function LN(r,e=null,t=null,n=0,i=null,s=!1){if((!r||r===Pw)&&(r=lr),qa(r)){const o=Ii(r,e,!0);return t&&op(o,t),il>0&&!s&&Hr&&(o.shapeFlag&6?Hr[Hr.indexOf(r)]=o:Hr.push(o)),o.patchFlag|=-2,o}if(jN(r)&&(r=r.__vccOpts),e){e=xu(e);let{class:o,style:l}=e;o&&!xt(o)&&(e.class=Nt(o)),ln(l)&&(Ew(l)&&!it(l)&&(l=Ct({},l)),e.style=zt(l))}const a=xt(r)?1:Lo(r)?128:PN(r)?64:ln(r)?4:at(r)?2:0;return t0(r,e,t,n,i,a,s,!0)}function xu(r){return r?Ew(r)||Au in r?Ct({},r):r:null}function Ii(r,e,t=!1){const{props:n,ref:i,patchFlag:s,children:a}=r,o=e?di(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:o,key:o&&e0(o),ref:e&&e.ref?t&&i?it(i)?i.concat(bc(e)):[i,bc(e)]:bc(e):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==Ht?s===-1?16:s|16:s,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Ii(r.ssContent),ssFallback:r.ssFallback&&Ii(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce}}function Ze(r=" ",e=0){return X(La,null,r,e)}function gt(r="",e=!1){return e?(_e(),Ne(lr,null,r)):X(lr,null,r)}function oi(r){return r==null||typeof r=="boolean"?X(lr):it(r)?X(Ht,null,r.slice()):typeof r=="object"?Zi(r):X(La,null,String(r))}function Zi(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Ii(r)}function op(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(it(e))t=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),op(r,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!(Au in e)?e._ctx=Nn:i===3&&Nn&&(Nn.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else at(e)?(e={default:e,_ctx:Nn},t=32):(e=String(e),n&64?(t=16,e=[Ze(e)]):t=8);r.children=e,r.shapeFlag|=t}function di(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=Nt([e.class,n.class]));else if(i==="style")e.style=zt([e.style,n.style]);else if(mu(i)){const s=e[i],a=n[i];a&&s!==a&&!(it(s)&&s.includes(a))&&(e[i]=s?[].concat(s,a):a)}else i!==""&&(e[i]=n[i])}return e}function br(r,e,t,n=null){or(r,e,7,[t,n])}const qN=Hw();let kN=0;function BN(r,e,t){const n=r.type,i=(e?e.appContext:r.appContext)||qN,s={uid:kN++,vnode:r,type:n,parent:e,appContext:i,get renderer(){return n.mpType==="app"?"app":this.$pageInstance&&this.$pageInstance==s?"page":"component"},root:null,next:null,subTree:null,effect:null,update:null,scope:new iw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zw(n,i),emitsOptions:xw(n,i),emit:null,emitted:null,propsDefaults:an,inheritAttrs:n.inheritAttrs,ctx:an,data:an,props:an,attrs:an,slots:an,refs:an,setupState:an,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,bda:null,da:null,ba:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=VC.bind(null,s),s.$pageInstance=e&&e.$pageInstance,r.ce&&r.ce(s),s}let Tn=null;const Cn=()=>Tn||Nn;let zc,Jf;{const r=AE(),e=(t,n)=>{let i;return(i=r[t])||(i=r[t]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};zc=e("__VUE_INSTANCE_SETTERS__",t=>Tn=t),Jf=e("__VUE_SSR_SETTERS__",t=>Ya=t)}const Tl=r=>{const e=Tn;return zc(r),r.scope.on(),()=>{r.scope.off(),zc(e)}},jm=()=>{Tn&&Tn.scope.off(),zc(null)};function n0(r){return r.vnode.shapeFlag&4}let Ya=!1;function FN(r,e=!1){e&&Jf(e);const{props:t,children:n}=r.vnode,i=n0(r);TN(r,t,i,e),CN(r,n);const s=i?UN(r,e):void 0;return e&&Jf(!1),s}function UN(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=Da(new Proxy(r.ctx,dN));const{setup:n}=t;if(n){const i=r.setupContext=n.length>1?i0(r):null,s=Tl(r);Hs();const a=ls(n,r,0,[r.props,i]);if(Qs(),s(),jd(a)){if(a.then(jm,jm),e)return a.then(o=>{Wm(r,o)}).catch(o=>{bl(o,r,0)});r.asyncDep=a}else Wm(r,a)}else r0(r)}function Wm(r,e,t){at(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:ln(e)&&(r.setupState=_w(e)),r0(r)}function r0(r,e,t){const n=r.type;r.render||(r.render=n.render||Cr);{const i=Tl(r);Hs();try{mN(r)}finally{Qs(),i()}}}function VN(r){return r.attrsProxy||(r.attrsProxy=new Proxy(r.attrs,{get(e,t){return cr(r,"get","$attrs"),e[t]}}))}function i0(r){const e=t=>{r.exposed=t||{}};return{get attrs(){return VN(r)},slots:r.slots,emit:r.emit,expose:e}}function Ru(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(_w(Da(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in qo)return qo[t](r)},has(e,t){return t in e||t in qo}}))}function s0(r,e=!0){return at(r)?r.displayName||r.name:r.name||e&&r.__name}function jN(r){return at(r)&&"__vccOpts"in r}const Me=(r,e)=>PC(r,e,Ya);function xi(r,e,t){const n=arguments.length;return n===2?ln(e)&&!it(e)?qa(e)?X(r,null,[e]):X(r,e):X(r,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&qa(t)&&(t=[t]),X(r,e,t))}const WN="3.4.21",HN="http://www.w3.org/2000/svg",QN="http://www.w3.org/1998/Math/MathML",Si=typeof document!="undefined"?document:null,Hm=Si&&Si.createElement("template"),zN={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const i=e==="svg"?Si.createElementNS(HN,r):e==="mathml"?Si.createElementNS(QN,r):t?Si.createElement(r,{is:t}):Si.createElement(r);return r==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:r=>Si.createTextNode(r),createComment:r=>Si.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Si.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,n,i,s){const a=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{Hm.innerHTML=n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r;const o=Hm.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,t)}return[a?a.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Hi="transition",go="animation",sl=Symbol("_vtc"),lp=(r,{slots:e})=>xi(ZC,GN(r),e);lp.displayName="Transition";const a0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};lp.props=Ct({},$w,a0);const Ss=(r,e=[])=>{it(r)?r.forEach(t=>t(...e)):r&&r(...e)},Qm=r=>r?it(r)?r.some(e=>e.length>1):r.length>1:!1;function GN(r){const e={};for(const A in r)A in a0||(e[A]=r[A]);if(r.css===!1)return e;const{name:t="v",type:n,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:a=`${t}-enter-active`,enterToClass:o=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:h=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:d=`${t}-leave-to`}=r,m=KN(i),y=m&&m[0],T=m&&m[1],{onBeforeEnter:b,onEnter:S,onEnterCancelled:N,onLeave:C,onLeaveCancelled:I,onBeforeAppear:H=b,onAppear:Q=S,onAppearCancelled:te=N}=e,V=(A,x,$)=>{Cs(A,x?u:o),Cs(A,x?c:a),$&&$()},J=(A,x)=>{A._isLeaving=!1,Cs(A,h),Cs(A,d),Cs(A,f),x&&x()},E=A=>(x,$)=>{const B=A?Q:S,K=()=>V(x,A,$);Ss(B,[x,K]),zm(()=>{Cs(x,A?l:s),Qi(x,A?u:o),Qm(B)||Gm(x,n,y,K)})};return Ct(e,{onBeforeEnter(A){Ss(b,[A]),Qi(A,s),Qi(A,a)},onBeforeAppear(A){Ss(H,[A]),Qi(A,l),Qi(A,c)},onEnter:E(!1),onAppear:E(!0),onLeave(A,x){A._isLeaving=!0;const $=()=>J(A,x);Qi(A,h),XN(),Qi(A,f),zm(()=>{A._isLeaving&&(Cs(A,h),Qi(A,d),Qm(C)||Gm(A,n,T,$))}),Ss(C,[A,$])},onEnterCancelled(A){V(A,!1),Ss(N,[A])},onAppearCancelled(A){V(A,!0),Ss(te,[A])},onLeaveCancelled(A){J(A),Ss(I,[A])}})}function KN(r){if(r==null)return null;if(ln(r))return[Oh(r.enter),Oh(r.leave)];{const e=Oh(r);return[e,e]}}function Oh(r){return gS(r)}function Qi(r,e){e.split(/\s+/).forEach(t=>t&&r.classList.add(t)),(r[sl]||(r[sl]=new Set)).add(e)}function Cs(r,e){e.split(/\s+/).forEach(n=>n&&r.classList.remove(n));const t=r[sl];t&&(t.delete(e),t.size||(r[sl]=void 0))}function zm(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let YN=0;function Gm(r,e,t,n){const i=r._endId=++YN,s=()=>{i===r._endId&&n()};if(t)return setTimeout(s,t);const{type:a,timeout:o,propCount:l}=JN(r,e);if(!a)return n();const c=a+"end";let u=0;const h=()=>{r.removeEventListener(c,f),s()},f=d=>{d.target===r&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},o+1),r.addEventListener(c,f)}function JN(r,e){const t=window.getComputedStyle(r),n=m=>(t[m]||"").split(", "),i=n(`${Hi}Delay`),s=n(`${Hi}Duration`),a=Km(i,s),o=n(`${go}Delay`),l=n(`${go}Duration`),c=Km(o,l);let u=null,h=0,f=0;e===Hi?a>0&&(u=Hi,h=a,f=s.length):e===go?c>0&&(u=go,h=c,f=l.length):(h=Math.max(a,c),u=h>0?a>c?Hi:go:null,f=u?u===Hi?s.length:l.length:0);const d=u===Hi&&/\b(transform|all)(,|$)/.test(n(`${Hi}Property`).toString());return{type:u,timeout:h,propCount:f,hasTransform:d}}function Km(r,e){for(;r.length<e.length;)r=r.concat(r);return Math.max(...e.map((t,n)=>Ym(t)+Ym(r[n])))}function Ym(r){return r==="auto"?0:Number(r.slice(0,-1).replace(",","."))*1e3}function XN(){return document.body.offsetHeight}function ZN(r,e,t){const{__wxsAddClass:n,__wxsRemoveClass:i}=r;i&&i.length&&(e=(e||"").split(/\s+/).filter(a=>i.indexOf(a)===-1).join(" "),i.length=0),n&&n.length&&(e=(e||"")+" "+n.join(" "));const s=r[sl];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const Gc=Symbol("_vod"),o0=Symbol("_vsh"),Mu={beforeMount(r,{value:e},{transition:t}){r[Gc]=r.style.display==="none"?"":r.style.display,t&&e?t.beforeEnter(r):bo(r,e)},mounted(r,{value:e},{transition:t}){t&&e&&t.enter(r)},updated(r,{value:e,oldValue:t},{transition:n}){!e!=!t&&(n?e?(n.beforeEnter(r),bo(r,!0),n.enter(r)):n.leave(r,()=>{bo(r,!1)}):bo(r,e))},beforeUnmount(r,{value:e}){bo(r,e)}};function bo(r,e){r.style.display=e?r[Gc]:"none",r[o0]=!e}const eA=Symbol(""),tA=/(^|;)\s*display\s*:/;function nA(r,e,t){const n=r.style,i=xt(t);let s=!1;if(t&&!i){if(e)if(xt(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();t[l]==null&&Io(n,l,"")}else for(const o in e)t[o]==null&&Io(n,o,"");for(const o in t)o==="display"&&(s=!0),Io(n,o,t[o])}else if(i){if(e!==t){const o=n[eA];o&&(t+=";"+o),n.cssText=t,s=tA.test(t)}}else e&&r.removeAttribute("style");Gc in r&&(r[Gc]=s?n.display:"",r[o0]&&(n.display="none"));const{__wxsStyle:a}=r;if(a)for(const o in a)Io(n,o,a[o])}const Jm=/\s*!important$/;function Io(r,e,t){if(it(t))t.forEach(n=>Io(r,e,n));else if(t==null&&(t=""),t=lA(t),e.startsWith("--"))r.setProperty(e,t);else{const n=rA(r,e);Jm.test(t)?r.setProperty(Di(n),t.replace(Jm,""),"important"):r[n]=t}}const Xm=["Webkit","Moz","ms"],$h={};function rA(r,e){const t=$h[e];if(t)return t;let n=Yr(e);if(n!=="filter"&&n in r)return $h[e]=n;n=gu(n);for(let i=0;i<Xm.length;i++){const s=Xm[i]+n;if(s in r)return $h[e]=s}return e}const{unit:iA,unitRatio:sA,unitPrecision:aA}=KS,oA=YS(iA,sA,aA),lA=r=>xt(r)?oA(r):r,Zm="http://www.w3.org/1999/xlink";function cA(r,e,t,n,i){if(n&&e.startsWith("xlink:"))t==null?r.removeAttributeNS(Zm,e.slice(6,e.length)):r.setAttributeNS(Zm,e,t);else{const s=_S(e);t==null||s&&!RE(t)?r.removeAttribute(e):r.setAttribute(e,s?"":t)}}function uA(r,e,t,n,i,s,a){if(e==="innerHTML"||e==="textContent"){n&&a(n,i,s),r[e]=t==null?"":t;return}const o=r.tagName;if(e==="value"&&o!=="PROGRESS"&&!o.includes("-")){const c=o==="OPTION"?r.getAttribute("value")||"":r.value,u=t==null?"":t;(c!==u||!("_value"in r))&&(r.value=u),t==null&&r.removeAttribute(e),r._value=t;return}let l=!1;if(t===""||t==null){const c=typeof r[e];c==="boolean"?t=RE(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{r[e]=t}catch(c){}l&&r.removeAttribute(e)}function hA(r,e,t,n){r.addEventListener(e,t,n)}function fA(r,e,t,n){r.removeEventListener(e,t,n)}const ey=Symbol("_vei");function dA(r,e,t,n,i=null){const s=r[ey]||(r[ey]={}),a=s[e];if(n&&a)a.value=n;else{const[o,l]=pA(e);if(n){const c=s[e]=gA(n,i);hA(r,o,c,l)}else a&&(fA(r,o,a,l),s[e]=void 0)}}const ty=/(?:Once|Passive|Capture)$/;function pA(r){let e;if(ty.test(r)){e={};let n;for(;n=r.match(ty);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):Di(r.slice(2)),e]}let Dh=0;const mA=Promise.resolve(),yA=()=>Dh||(mA.then(()=>Dh=0),Dh=Date.now());function gA(r,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;const i=e&&e.proxy,s=i&&i.$nne,{value:a}=t;if(s&&it(a)){const o=ny(n,a);for(let l=0;l<o.length;l++){const c=o[l];or(c,e,5,c.__wwe?[n]:s(n))}return}or(ny(n,t.value),e,5,s&&!a.__wwe?s(n,a,e):[n])};return t.value=r,t.attached=yA(),t}function ny(r,e){if(it(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>{const i=s=>!s._stopped&&n&&n(s);return i.__wwe=n.__wwe,i})}else return e}function bA(r,e,t,n=null){if(!t||!n)return;const i=e.replace("change:",""),{attrs:s}=n,a=s[i],o=(r.__wxsProps||(r.__wxsProps={}))[i];if(o===a)return;r.__wxsProps[i]=a;const l=n.proxy;bn(()=>{t(a,o,l.$gcd(l,!0),l.$gcd(l,!1))})}const ry=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,EA=(r,e)=>e.indexOf("change:")===0?!0:e==="class"&&r.__wxsClassChanged?(r.__wxsClassChanged=!1,!0):e==="style"&&r.__wxsStyleChanged?(r.__wxsStyleChanged=!1,!0):!1,wA=(r,e,t,n,i,s,a,o,l)=>{if(e.indexOf("change:")===0)return bA(r,e,n,a);const c=i==="svg";e==="class"?ZN(r,n,c):e==="style"?nA(r,t,n):mu(e)?Ud(e)||dA(r,e,t,n,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):vA(r,e,n,c))?uA(r,e,n,s,a,o,l):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),cA(r,e,n,c))};function vA(r,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&ry(e)&&at(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=r.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return ry(e)&&xt(t)?!1:e in r}const TA=["ctrl","shift","alt","meta"],_A={stop:r=>r.stopPropagation(),prevent:r=>r.preventDefault(),self:r=>r.target!==r.currentTarget,ctrl:r=>!r.ctrlKey,shift:r=>!r.shiftKey,alt:r=>!r.altKey,meta:r=>!r.metaKey,left:r=>"button"in r&&r.button!==0,middle:r=>"button"in r&&r.button!==1,right:r=>"button"in r&&r.button!==2,exact:(r,e)=>TA.some(t=>r[`${t}Key`]&&!e.includes(t))},Ja=(r,e)=>{const t=r._withMods||(r._withMods={}),n=e.join(".");return t[n]||(t[n]=(i,...s)=>{for(let a=0;a<e.length;a++){const o=_A[e[a]];if(o&&o(i,e))return}return r(i,...s)})},SA=Ct({patchProp:wA,forcePatchProp:EA},zN);let iy;function CA(){return iy||(iy=AN(SA))}const l0=(...r)=>{const e=CA().createApp(...r),{mount:t}=e;return e.mount=n=>{const i=AA(n);if(!i)return;const s=e._component;!at(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const a=t(i,!1,NA(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},e};function NA(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function AA(r){return xt(r)?document.querySelector(r):r}/*!
* vue-router v4.5.1
* (c) 2025 Eduardo San Martin Morote
* @license MIT
*/const fa=typeof document!="undefined";function c0(r){return typeof r=="object"||"displayName"in r||"props"in r||"__vccOpts"in r}function xA(r){return r.__esModule||r[Symbol.toStringTag]==="Module"||r.default&&c0(r.default)}const Qt=Object.assign;function Lh(r,e){const t={};for(const n in e){const i=e[n];t[n]=Jr(i)?i.map(r):r(i)}return t}const Uo=()=>{},Jr=Array.isArray,u0=/#/g,RA=/&/g,MA=/\//g,PA=/=/g,IA=/\?/g,h0=/\+/g,OA=/%5B/g,$A=/%5D/g,f0=/%5E/g,DA=/%60/g,d0=/%7B/g,LA=/%7C/g,p0=/%7D/g,qA=/%20/g;function cp(r){return encodeURI(""+r).replace(LA,"|").replace(OA,"[").replace($A,"]")}function kA(r){return cp(r).replace(d0,"{").replace(p0,"}").replace(f0,"^")}function Xf(r){return cp(r).replace(h0,"%2B").replace(qA,"+").replace(u0,"%23").replace(RA,"%26").replace(DA,"`").replace(d0,"{").replace(p0,"}").replace(f0,"^")}function BA(r){return Xf(r).replace(PA,"%3D")}function FA(r){return cp(r).replace(u0,"%23").replace(IA,"%3F")}function UA(r){return r==null?"":FA(r).replace(MA,"%2F")}function al(r){try{return decodeURIComponent(""+r)}catch(e){}return""+r}const VA=/\/$/,jA=r=>r.replace(VA,"");function qh(r,e,t="/"){let n,i={},s="",a="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(n=e.slice(0,l),s=e.slice(l+1,o>-1?o:e.length),i=r(s)),o>-1&&(n=n||e.slice(0,o),a=e.slice(o,e.length)),n=zA(n!=null?n:e,t),{fullPath:n+(s&&"?")+s+a,path:n,query:i,hash:al(a)}}function WA(r,e){const t=e.query?r(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function sy(r,e){return!e||!r.toLowerCase().startsWith(e.toLowerCase())?r:r.slice(e.length)||"/"}function HA(r,e,t){const n=e.matched.length-1,i=t.matched.length-1;return n>-1&&n===i&&ka(e.matched[n],t.matched[i])&&m0(e.params,t.params)&&r(e.query)===r(t.query)&&e.hash===t.hash}function ka(r,e){return(r.aliasOf||r)===(e.aliasOf||e)}function m0(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(!QA(r[t],e[t]))return!1;return!0}function QA(r,e){return Jr(r)?ay(r,e):Jr(e)?ay(e,r):r===e}function ay(r,e){return Jr(e)?r.length===e.length&&r.every((t,n)=>t===e[n]):r.length===1&&r[0]===e}function zA(r,e){if(r.startsWith("/"))return r;if(!r)return e;const t=e.split("/"),n=r.split("/"),i=n[n.length-1];(i===".."||i===".")&&n.push("");let s=t.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+n.slice(a).join("/")}const zi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ol;(function(r){r.pop="pop",r.push="push"})(ol||(ol={}));var Vo;(function(r){r.back="back",r.forward="forward",r.unknown=""})(Vo||(Vo={}));function GA(r){if(!r)if(fa){const e=document.querySelector("base");r=e&&e.getAttribute("href")||"/",r=r.replace(/^\w+:\/\/[^\/]+/,"")}else r="/";return r[0]!=="/"&&r[0]!=="#"&&(r="/"+r),jA(r)}const KA=/^[^#]+#/;function YA(r,e){return r.replace(KA,"#")+e}function JA(r,e){const t=document.documentElement.getBoundingClientRect(),n=r.getBoundingClientRect();return{behavior:e.behavior,left:n.left-t.left-(e.left||0),top:n.top-t.top-(e.top||0)}}const Pu=()=>({left:window.scrollX,top:window.scrollY});function XA(r){let e;if("el"in r){const t=r.el,n=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?n?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=JA(i,r)}else e=r;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function oy(r,e){return(history.state?history.state.position-e:-1)+r}const Zf=new Map;function ZA(r,e){Zf.set(r,e)}function e1(r){const e=Zf.get(r);return Zf.delete(r),e}let t1=()=>location.protocol+"//"+location.host;function y0(r,e){const{pathname:t,search:n,hash:i}=e,s=r.indexOf("#");if(s>-1){let o=i.includes(r.slice(s))?r.slice(s).length:1,l=i.slice(o);return l[0]!=="/"&&(l="/"+l),sy(l,"")}return sy(t,r)+n+i}function n1(r,e,t,n){let i=[],s=[],a=null;const o=({state:f})=>{const d=y0(r,location),m=t.value,y=e.value;let T=0;if(f){if(t.value=d,e.value=f,a&&a===m){a=null;return}T=y?f.position-y.position:0}else n(d);i.forEach(b=>{b(t.value,m,{delta:T,type:ol.pop,direction:T?T>0?Vo.forward:Vo.back:Vo.unknown})})};function l(){a=t.value}function c(f){i.push(f);const d=()=>{const m=i.indexOf(f);m>-1&&i.splice(m,1)};return s.push(d),d}function u(){const{history:f}=window;f.state&&f.replaceState(Qt({},f.state,{scroll:Pu()}),"")}function h(){for(const f of s)f();s=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function ly(r,e,t,n=!1,i=!1){return{back:r,current:e,forward:t,replaced:n,position:window.history.length,scroll:i?Pu():null}}function r1(r){const{history:e,location:t}=window,n={value:y0(r,t)},i={value:e.state};i.value||s(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=r.indexOf("#"),f=h>-1?(t.host&&document.querySelector("base")?r:r.slice(h))+l:t1()+r+l;try{e[u?"replaceState":"pushState"](c,"",f),i.value=c}catch(d){t[u?"replace":"assign"](f)}}function a(l,c){const u=Qt({},e.state,ly(i.value.back,l,i.value.forward,!0),c,{position:i.value.position});s(l,u,!0),n.value=l}function o(l,c){const u=Qt({},i.value,e.state,{forward:l,scroll:Pu()});s(u.current,u,!0);const h=Qt({},ly(n.value,l,null),{position:u.position+1},c);s(l,h,!1),n.value=l}return{location:n,state:i,push:o,replace:a}}function i1(r){r=GA(r);const e=r1(r),t=n1(r,e.state,e.location,e.replace);function n(s,a=!0){a||t.pauseListeners(),history.go(s)}const i=Qt({location:"",base:r,go:n,createHref:YA.bind(null,r)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function s1(r){return r=location.host?r||location.pathname+location.search:"",r.includes("#")||(r+="#"),i1(r)}function a1(r){return typeof r=="string"||r&&typeof r=="object"}function g0(r){return typeof r=="string"||typeof r=="symbol"}const b0=Symbol("");var cy;(function(r){r[r.aborted=4]="aborted",r[r.cancelled=8]="cancelled",r[r.duplicated=16]="duplicated"})(cy||(cy={}));function Ba(r,e){return Qt(new Error,{type:r,[b0]:!0},e)}function ii(r,e){return r instanceof Error&&b0 in r&&(e==null||!!(r.type&e))}const uy="[^/]+?",o1={sensitive:!1,strict:!1,start:!0,end:!0},l1=/[.+*?^${}()[\]/\\]/g;function c1(r,e){const t=Qt({},o1,e),n=[];let i=t.start?"^":"";const s=[];for(const c of r){const u=c.length?[]:[90];t.strict&&!c.length&&(i+="/");for(let h=0;h<c.length;h++){const f=c[h];let d=40+(t.sensitive?.25:0);if(f.type===0)h||(i+="/"),i+=f.value.replace(l1,"\\$&"),d+=40;else if(f.type===1){const{value:m,repeatable:y,optional:T,regexp:b}=f;s.push({name:m,repeatable:y,optional:T});const S=b||uy;if(S!==uy){d+=10;try{new RegExp(`(${S})`)}catch(C){throw new Error(`Invalid custom RegExp for param "${m}" (${S}): `+C.message)}}let N=y?`((?:${S})(?:/(?:${S}))*)`:`(${S})`;h||(N=T&&c.length<2?`(?:/${N})`:"/"+N),T&&(N+="?"),i+=N,d+=20,T&&(d+=-8),y&&(d+=-20),S===".*"&&(d+=-50)}u.push(d)}n.push(u)}if(t.strict&&t.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const a=new RegExp(i,t.sensitive?"":"i");function o(c){const u=c.match(a),h={};if(!u)return null;for(let f=1;f<u.length;f++){const d=u[f]||"",m=s[f-1];h[m.name]=d&&m.repeatable?d.split("/"):d}return h}function l(c){let u="",h=!1;for(const f of r){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const d of f)if(d.type===0)u+=d.value;else if(d.type===1){const{value:m,repeatable:y,optional:T}=d,b=m in c?c[m]:"";if(Jr(b)&&!y)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const S=Jr(b)?b.join("/"):b;if(!S)if(T)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);u+=S}}return u||"/"}return{re:a,score:n,keys:s,parse:o,stringify:l}}function u1(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=e[t]-r[t];if(n)return n;t++}return r.length<e.length?r.length===1&&r[0]===80?-1:1:r.length>e.length?e.length===1&&e[0]===80?1:-1:0}function E0(r,e){let t=0;const n=r.score,i=e.score;for(;t<n.length&&t<i.length;){const s=u1(n[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-n.length)===1){if(hy(n))return 1;if(hy(i))return-1}return i.length-n.length}function hy(r){const e=r[r.length-1];return r.length>0&&e[e.length-1]<0}const h1={type:0,value:""},f1=/[a-zA-Z0-9_]/;function d1(r){if(!r)return[[]];if(r==="/")return[[h1]];if(!r.startsWith("/"))throw new Error(`Invalid path "${r}"`);function e(d){throw new Error(`ERR (${t})/"${c}": ${d}`)}let t=0,n=t;const i=[];let s;function a(){s&&i.push(s),s=[]}let o=0,l,c="",u="";function h(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;o<r.length;){if(l=r[o++],l==="\\"&&t!==2){n=t,t=4;continue}switch(t){case 0:l==="/"?(c&&h(),a()):l===":"?(h(),t=1):f();break;case 4:f(),t=n;break;case 1:l==="("?t=2:f1.test(l)?f():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),a(),i}function p1(r,e,t){const n=c1(d1(r.path),t),i=Qt(n,{record:r,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function m1(r,e){const t=[],n=new Map;e=my({strict:!1,end:!0,sensitive:!1},e);function i(h){return n.get(h)}function s(h,f,d){const m=!d,y=dy(h);y.aliasOf=d&&d.record;const T=my(e,h),b=[y];if("alias"in h){const C=typeof h.alias=="string"?[h.alias]:h.alias;for(const I of C)b.push(dy(Qt({},y,{components:d?d.record.components:y.components,path:I,aliasOf:d?d.record:y})))}let S,N;for(const C of b){const{path:I}=C;if(f&&I[0]!=="/"){const H=f.record.path,Q=H[H.length-1]==="/"?"":"/";C.path=f.record.path+(I&&Q+I)}if(S=p1(C,f,T),d?d.alias.push(S):(N=N||S,N!==S&&N.alias.push(S),m&&h.name&&!py(S)&&a(h.name)),w0(S)&&l(S),y.children){const H=y.children;for(let Q=0;Q<H.length;Q++)s(H[Q],S,d&&d.children[Q])}d=d||S}return N?()=>{a(N)}:Uo}function a(h){if(g0(h)){const f=n.get(h);f&&(n.delete(h),t.splice(t.indexOf(f),1),f.children.forEach(a),f.alias.forEach(a))}else{const f=t.indexOf(h);f>-1&&(t.splice(f,1),h.record.name&&n.delete(h.record.name),h.children.forEach(a),h.alias.forEach(a))}}function o(){return t}function l(h){const f=b1(h,t);t.splice(f,0,h),h.record.name&&!py(h)&&n.set(h.record.name,h)}function c(h,f){let d,m={},y,T;if("name"in h&&h.name){if(d=n.get(h.name),!d)throw Ba(1,{location:h});T=d.record.name,m=Qt(fy(f.params,d.keys.filter(N=>!N.optional).concat(d.parent?d.parent.keys.filter(N=>N.optional):[]).map(N=>N.name)),h.params&&fy(h.params,d.keys.map(N=>N.name))),y=d.stringify(m)}else if(h.path!=null)y=h.path,d=t.find(N=>N.re.test(y)),d&&(m=d.parse(y),T=d.record.name);else{if(d=f.name?n.get(f.name):t.find(N=>N.re.test(f.path)),!d)throw Ba(1,{location:h,currentLocation:f});T=d.record.name,m=Qt({},f.params,h.params),y=d.stringify(m)}const b=[];let S=d;for(;S;)b.unshift(S.record),S=S.parent;return{name:T,path:y,params:m,matched:b,meta:g1(b)}}r.forEach(h=>s(h));function u(){t.length=0,n.clear()}return{addRoute:s,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:i}}function fy(r,e){const t={};for(const n of e)n in r&&(t[n]=r[n]);return t}function dy(r){const e={path:r.path,redirect:r.redirect,name:r.name,meta:r.meta||{},aliasOf:r.aliasOf,beforeEnter:r.beforeEnter,props:y1(r),children:r.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in r?r.components||null:r.component&&{default:r.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function y1(r){const e={},t=r.props||!1;if("component"in r)e.default=t;else for(const n in r.components)e[n]=typeof t=="object"?t[n]:t;return e}function py(r){for(;r;){if(r.record.aliasOf)return!0;r=r.parent}return!1}function g1(r){return r.reduce((e,t)=>Qt(e,t.meta),{})}function my(r,e){const t={};for(const n in r)t[n]=n in e?e[n]:r[n];return t}function b1(r,e){let t=0,n=e.length;for(;t!==n;){const s=t+n>>1;E0(r,e[s])<0?n=s:t=s+1}const i=E1(r);return i&&(n=e.lastIndexOf(i,n-1)),n}function E1(r){let e=r;for(;e=e.parent;)if(w0(e)&&E0(r,e)===0)return e}function w0({record:r}){return!!(r.name||r.components&&Object.keys(r.components).length||r.redirect)}function w1(r){const e={};if(r===""||r==="?")return e;const n=(r[0]==="?"?r.slice(1):r).split("&");for(let i=0;i<n.length;++i){const s=n[i].replace(h0," "),a=s.indexOf("="),o=al(a<0?s:s.slice(0,a)),l=a<0?null:al(s.slice(a+1));if(o in e){let c=e[o];Jr(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function yy(r){let e="";for(let t in r){const n=r[t];if(t=BA(t),n==null){n!==void 0&&(e+=(e.length?"&":"")+t);continue}(Jr(n)?n.map(s=>s&&Xf(s)):[n&&Xf(n)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function v1(r){const e={};for(const t in r){const n=r[t];n!==void 0&&(e[t]=Jr(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return e}const T1=Symbol(""),gy=Symbol(""),Iu=Symbol(""),up=Symbol(""),ed=Symbol("");function Eo(){let r=[];function e(n){return r.push(n),()=>{const i=r.indexOf(n);i>-1&&r.splice(i,1)}}function t(){r=[]}return{add:e,list:()=>r.slice(),reset:t}}function es(r,e,t,n,i,s=a=>a()){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((o,l)=>{const c=f=>{f===!1?l(Ba(4,{from:t,to:e})):f instanceof Error?l(f):a1(f)?l(Ba(2,{from:e,to:f})):(a&&n.enterCallbacks[i]===a&&typeof f=="function"&&a.push(f),o())},u=s(()=>r.call(n&&n.instances[i],e,t,c));let h=Promise.resolve(u);r.length<3&&(h=h.then(c)),h.catch(f=>l(f))})}function kh(r,e,t,n,i=s=>s()){const s=[];for(const a of r)for(const o in a.components){let l=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(c0(l)){const u=(l.__vccOpts||l)[e];u&&s.push(es(u,t,n,a,o,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const h=xA(u)?u.default:u;a.mods[o]=u,a.components[o]=h;const d=(h.__vccOpts||h)[e];return d&&es(d,t,n,a,o,i)()}))}}return s}function by(r){const e=on(Iu),t=on(up),n=Me(()=>{const l=pt(r.to);return e.resolve(l)}),i=Me(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],h=t.matched;if(!u||!h.length)return-1;const f=h.findIndex(ka.bind(null,u));if(f>-1)return f;const d=Ey(l[c-2]);return c>1&&Ey(u)===d&&h[h.length-1].path!==d?h.findIndex(ka.bind(null,l[c-2])):f}),s=Me(()=>i.value>-1&&A1(t.params,n.value.params)),a=Me(()=>i.value>-1&&i.value===t.matched.length-1&&m0(t.params,n.value.params));function o(l={}){if(N1(l)){const c=e[pt(r.replace)?"replace":"push"](pt(r.to)).catch(Uo);return r.viewTransition&&typeof document!="undefined"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:Me(()=>n.value.href),isActive:s,isExactActive:a,navigate:o}}function _1(r){return r.length===1?r[0]:r}const S1=Lt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:by,setup(r,{slots:e}){const t=nn(by(r)),{options:n}=on(Iu),i=Me(()=>({[wy(r.activeClass,n.linkActiveClass,"router-link-active")]:t.isActive,[wy(r.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&_1(e.default(t));return r.custom?s:xi("a",{"aria-current":t.isExactActive?r.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),C1=S1;function N1(r){if(!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)&&!r.defaultPrevented&&!(r.button!==void 0&&r.button!==0)){if(r.currentTarget&&r.currentTarget.getAttribute){const e=r.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return r.preventDefault&&r.preventDefault(),!0}}function A1(r,e){for(const t in e){const n=e[t],i=r[t];if(typeof n=="string"){if(n!==i)return!1}else if(!Jr(i)||i.length!==n.length||n.some((s,a)=>s!==i[a]))return!1}return!0}function Ey(r){return r?r.aliasOf?r.aliasOf.path:r.path:""}const wy=(r,e,t)=>r!=null?r:e!=null?e:t,x1=Lt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(r,{attrs:e,slots:t}){const n=on(ed),i=Me(()=>r.route||n.value),s=on(gy,0),a=Me(()=>{let c=pt(s);const{matched:u}=i.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),o=Me(()=>i.value.matched[a.value]);Qr(gy,Me(()=>a.value+1)),Qr(T1,o),Qr(ed,i);const l=ge();return Ge(()=>[l.value,o.value,r.name],([c,u,h],[f,d,m])=>{u&&(u.instances[h]=c,d&&d!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=d.leaveGuards),u.updateGuards.size||(u.updateGuards=d.updateGuards))),c&&u&&(!d||!ka(u,d)||!f)&&(u.enterCallbacks[h]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=i.value,u=r.name,h=o.value,f=h&&h.components[u];if(!f)return vy(t.default,{Component:f,route:c});const d=h.props[u],m=d?d===!0?c.params:typeof d=="function"?d(c):d:null,T=xi(f,Qt({},m,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return vy(t.default,{Component:T,route:c})||T}}});function vy(r,e){if(!r)return null;const t=r(e);return t.length===1?t[0]:t}const v0=x1;function R1(r){const e=m1(r.routes,r),t=r.parseQuery||w1,n=r.stringifyQuery||yy,i=r.history,s=Eo(),a=Eo(),o=Eo(),l=IC(zi);let c=zi;fa&&r.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Lh.bind(null,Ee=>""+Ee),h=Lh.bind(null,UA),f=Lh.bind(null,al);function d(Ee,$e){let z,Te;return g0(Ee)?(z=e.getRecordMatcher(Ee),Te=$e):Te=Ee,e.addRoute(Te,z)}function m(Ee){const $e=e.getRecordMatcher(Ee);$e&&e.removeRoute($e)}function y(){return e.getRoutes().map(Ee=>Ee.record)}function T(Ee){return!!e.getRecordMatcher(Ee)}function b(Ee,$e){if($e=Qt({},$e||l.value),typeof Ee=="string"){const q=qh(t,Ee,$e.path),se=e.resolve({path:q.path},$e),le=i.createHref(q.fullPath);return Qt(q,se,{params:f(se.params),hash:al(q.hash),redirectedFrom:void 0,href:le})}let z;if(Ee.path!=null)z=Qt({},Ee,{path:qh(t,Ee.path,$e.path).path});else{const q=Qt({},Ee.params);for(const se in q)q[se]==null&&delete q[se];z=Qt({},Ee,{params:h(q)}),$e.params=h($e.params)}const Te=e.resolve(z,$e),j=Ee.hash||"";Te.params=u(f(Te.params));const G=WA(n,Qt({},Ee,{hash:kA(j),path:Te.path})),M=i.createHref(G);return Qt({fullPath:G,hash:j,query:n===yy?v1(Ee.query):Ee.query||{}},Te,{redirectedFrom:void 0,href:M})}function S(Ee){return typeof Ee=="string"?qh(t,Ee,l.value.path):Qt({},Ee)}function N(Ee,$e){if(c!==Ee)return Ba(8,{from:$e,to:Ee})}function C(Ee){return Q(Ee)}function I(Ee){return C(Qt(S(Ee),{replace:!0}))}function H(Ee){const $e=Ee.matched[Ee.matched.length-1];if($e&&$e.redirect){const{redirect:z}=$e;let Te=typeof z=="function"?z(Ee):z;return typeof Te=="string"&&(Te=Te.includes("?")||Te.includes("#")?Te=S(Te):{path:Te},Te.params={}),Qt({query:Ee.query,hash:Ee.hash,params:Te.path!=null?{}:Ee.params},Te)}}function Q(Ee,$e){const z=c=b(Ee),Te=l.value,j=Ee.state,G=Ee.force,M=Ee.replace===!0,q=H(z);if(q)return Q(Qt(S(q),{state:typeof q=="object"?Qt({},j,q.state):j,force:G,replace:M}),$e||z);const se=z;se.redirectedFrom=$e;let le;return!G&&HA(n,Te,z)&&(le=Ba(16,{to:se,from:Te}),Ae(Te,Te,!0,!1)),(le?Promise.resolve(le):J(se,Te)).catch(be=>ii(be)?ii(be,2)?be:Se(be):ue(be,se,Te)).then(be=>{if(be){if(ii(be,2))return Q(Qt({replace:M},S(be.to),{state:typeof be.to=="object"?Qt({},j,be.to.state):j,force:G}),$e||se)}else be=A(se,Te,!0,M,j);return E(se,Te,be),be})}function te(Ee,$e){const z=N(Ee,$e);return z?Promise.reject(z):Promise.resolve()}function V(Ee){const $e=mt.values().next().value;return $e&&typeof $e.runWithContext=="function"?$e.runWithContext(Ee):Ee()}function J(Ee,$e){let z;const[Te,j,G]=M1(Ee,$e);z=kh(Te.reverse(),"beforeRouteLeave",Ee,$e);for(const q of Te)q.leaveGuards.forEach(se=>{z.push(es(se,Ee,$e))});const M=te.bind(null,Ee,$e);return z.push(M),ut(z).then(()=>{z=[];for(const q of s.list())z.push(es(q,Ee,$e));return z.push(M),ut(z)}).then(()=>{z=kh(j,"beforeRouteUpdate",Ee,$e);for(const q of j)q.updateGuards.forEach(se=>{z.push(es(se,Ee,$e))});return z.push(M),ut(z)}).then(()=>{z=[];for(const q of G)if(q.beforeEnter)if(Jr(q.beforeEnter))for(const se of q.beforeEnter)z.push(es(se,Ee,$e));else z.push(es(q.beforeEnter,Ee,$e));return z.push(M),ut(z)}).then(()=>(Ee.matched.forEach(q=>q.enterCallbacks={}),z=kh(G,"beforeRouteEnter",Ee,$e,V),z.push(M),ut(z))).then(()=>{z=[];for(const q of a.list())z.push(es(q,Ee,$e));return z.push(M),ut(z)}).catch(q=>ii(q,8)?q:Promise.reject(q))}function E(Ee,$e,z){o.list().forEach(Te=>V(()=>Te(Ee,$e,z)))}function A(Ee,$e,z,Te,j){const G=N(Ee,$e);if(G)return G;const M=$e===zi,q=fa?history.state:{};z&&(Te||M?i.replace(Ee.fullPath,Qt({scroll:M&&q&&q.scroll},j)):i.push(Ee.fullPath,j)),l.value=Ee,Ae(Ee,$e,z,M),Se()}let x;function $(){x||(x=i.listen((Ee,$e,z)=>{if(!et.listening)return;const Te=b(Ee),j=H(Te);if(j){Q(Qt(j,{replace:!0,force:!0}),Te).catch(Uo);return}c=Te;const G=l.value;fa&&ZA(oy(G.fullPath,z.delta),Pu()),J(Te,G).catch(M=>ii(M,12)?M:ii(M,2)?(Q(Qt(S(M.to),{force:!0}),Te).then(q=>{ii(q,20)&&!z.delta&&z.type===ol.pop&&i.go(-1,!1)}).catch(Uo),Promise.reject()):(z.delta&&i.go(-z.delta,!1),ue(M,Te,G))).then(M=>{M=M||A(Te,G,!1),M&&(z.delta&&!ii(M,8)?i.go(-z.delta,!1):z.type===ol.pop&&ii(M,20)&&i.go(-1,!1)),E(Te,G,M)}).catch(Uo)}))}let B=Eo(),K=Eo(),ae;function ue(Ee,$e,z){Se(Ee);const Te=K.list();return Te.length&&Te.forEach(j=>j(Ee,$e,z)),Promise.reject(Ee)}function L(){return ae&&l.value!==zi?Promise.resolve():new Promise((Ee,$e)=>{B.add([Ee,$e])})}function Se(Ee){return ae||(ae=!Ee,$(),B.list().forEach(([$e,z])=>Ee?z(Ee):$e()),B.reset()),Ee}function Ae(Ee,$e,z,Te){const{scrollBehavior:j}=r;if(!fa||!j)return Promise.resolve();const G=!z&&e1(oy(Ee.fullPath,0))||(Te||!z)&&history.state&&history.state.scroll||null;return bn().then(()=>j(Ee,$e,G)).then(M=>M&&XA(M)).catch(M=>ue(M,Ee,$e))}const ve=Ee=>i.go(Ee);let Ye;const mt=new Set,et={currentRoute:l,listening:!0,addRoute:d,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:T,getRoutes:y,resolve:b,options:r,push:C,replace:I,go:ve,back:()=>ve(-1),forward:()=>ve(1),beforeEach:s.add,beforeResolve:a.add,afterEach:o.add,onError:K.add,isReady:L,install(Ee){const $e=this;Ee.component("RouterLink",C1),Ee.component("RouterView",v0),Ee.config.globalProperties.$router=$e,Object.defineProperty(Ee.config.globalProperties,"$route",{enumerable:!0,get:()=>pt(l)}),fa&&!Ye&&l.value===zi&&(Ye=!0,C(i.location).catch(j=>{}));const z={};for(const j in zi)Object.defineProperty(z,j,{get:()=>l.value[j],enumerable:!0});Ee.provide(Iu,$e),Ee.provide(up,gw(z)),Ee.provide(ed,l);const Te=Ee.unmount;mt.add(Ee),Ee.unmount=function(){mt.delete(Ee),mt.size<1&&(c=zi,x&&x(),x=null,l.value=zi,Ye=!1,ae=!1),Te()}}};function ut(Ee){return Ee.reduce(($e,z)=>$e.then(()=>V(z)),Promise.resolve())}return et}function M1(r,e){const t=[],n=[],i=[],s=Math.max(e.matched.length,r.matched.length);for(let a=0;a<s;a++){const o=e.matched[a];o&&(r.matched.find(c=>ka(c,o))?n.push(o):t.push(o));const l=r.matched[a];l&&(e.matched.find(c=>ka(c,l))||i.push(l))}return[t,n,i]}function P1(){return on(Iu)}function hp(r){return on(up)}const I1=r=>r!==null&&typeof r=="object",O1=["{","}"];class $1{constructor(){this._caches=Object.create(null)}interpolate(e,t,n=O1){if(!t)return[e];let i=this._caches[e];return i||(i=q1(e,n),this._caches[e]=i),k1(i,t)}}const D1=/^(?:\d)+/,L1=/^(?:\w)+/;function q1(r,[e,t]){const n=[];let i=0,s="";for(;i<r.length;){let a=r[i++];if(a===e){s&&n.push({type:"text",value:s}),s="";let o="";for(a=r[i++];a!==void 0&&a!==t;)o+=a,a=r[i++];const l=a===t,c=D1.test(o)?"list":l&&L1.test(o)?"named":"unknown";n.push({value:o,type:c})}else s+=a}return s&&n.push({type:"text",value:s}),n}function k1(r,e){const t=[];let n=0;const i=Array.isArray(e)?"list":I1(e)?"named":"unknown";if(i==="unknown")return t;for(;n<r.length;){const s=r[n];switch(s.type){case"text":t.push(s.value);break;case"list":t.push(e[parseInt(s.value,10)]);break;case"named":i==="named"&&t.push(e[s.value]);break}n++}return t}const Ma="zh-Hans",ll="zh-Hant",Ri="en",Ou="fr",$u="es",B1=Object.prototype.hasOwnProperty,Ty=(r,e)=>B1.call(r,e),F1=new $1;function U1(r,e){return!!e.find(t=>r.indexOf(t)!==-1)}function V1(r,e){return e.find(t=>r.indexOf(t)===0)}function _y(r,e){if(!r)return;if(r=r.trim().replace(/_/g,"-"),e&&e[r])return r;if(r=r.toLowerCase(),r==="chinese")return Ma;if(r.indexOf("zh")===0)return r.indexOf("-hans")>-1?Ma:r.indexOf("-hant")>-1||U1(r,["-tw","-hk","-mo","-cht"])?ll:Ma;let t=[Ri,Ou,$u];e&&Object.keys(e).length>0&&(t=Object.keys(e));const n=V1(r,t);if(n)return n}class j1{constructor({locale:e,fallbackLocale:t,messages:n,watcher:i,formater:s}){this.locale=Ri,this.fallbackLocale=Ri,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=s||F1,this.messages=n||{},this.setLocale(e||Ri),i&&this.watchLocale(i)}setLocale(e){const t=this.locale;this.locale=_y(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach(n=>{n(this.locale,t)})}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,n=!0){const i=this.messages[e];i?n?Object.assign(i,t):Object.keys(t).forEach(s=>{Ty(i,s)||(i[s]=t[s])}):this.messages[e]=t}f(e,t,n){return this.formater.interpolate(e,t,n).join("")}t(e,t,n){let i=this.message;return typeof t=="string"?(t=_y(t,this.messages),t&&(i=this.messages[t])):n=t,Ty(i,e)?this.formater.interpolate(i[e],n).join(""):e}}function W1(r,e){r.$watchLocale?r.$watchLocale(t=>{e.setLocale(t)}):r.$watch(()=>r.$locale,t=>{e.setLocale(t)})}function H1(){return typeof uni!="undefined"&&Bs?Bs():typeof global!="undefined"&&global.getLocale?global.getLocale():Ri}function Q1(r,e={},t,n){if(typeof r!="string"){const a=[e,r];r=a[0],e=a[1]}typeof r!="string"&&(r=H1()),typeof t!="string"&&(t=typeof __uniConfig!="undefined"&&__uniConfig.fallbackLocale||Ri);const i=new j1({locale:r,fallbackLocale:t,messages:e,watcher:n});let s=(a,o)=>{if(typeof Sr!="function")s=function(l,c){return i.t(l,c)};else{let l=!1;s=function(c,u){const h=Sr().$vm;return h&&(h.$locale,l||(l=!0,W1(h,i))),i.t(c,u)}}return s(a,o)};return{i18n:i,f(a,o,l){return i.f(a,o,l)},t(a,o){return s(a,o)},add(a,o,l=!0){return i.add(a,o,l)},watch(a){return i.watchLocale(a)},getLocale(){return i.getLocale()},setLocale(a){return i.setLocale(a)}}}function T0(r,e){return r.indexOf(e[0])>-1}const _0=Ws(()=>typeof __uniConfig!="undefined"&&__uniConfig.locales&&!!Object.keys(__uniConfig.locales).length);let wo;function z1(){const r=Bs(),e=__uniConfig.locales;return e[r]||e[__uniConfig.fallbackLocale]||e.en||{}}function G1(r){return T0(r,Lf)?_n().f(r,z1(),Lf):r}function S0(r,e){if(e.length===1){if(r){const n=o=>xt(o)&&T0(o,Lf),i=e[0];let s=[];if(it(r)&&(s=r.filter(o=>n(o[i]))).length)return s;const a=r[e[0]];if(n(a))return r}return}const t=e.shift();return S0(r&&r[t],e)}function K1(r,e){return e.map(t=>C0(r,t))}function C0(r,e){const t=S0(r,e);if(!t)return!1;const n=e[e.length-1];if(it(t))t.forEach(i=>C0(i,[n]));else{let i=t[n];Object.defineProperty(t,n,{get(){return G1(i)},set(s){i=s}})}return!0}function _n(){if(!wo){let r;if(r=navigator.cookieEnabled&&window.localStorage&&localStorage[MS]||__uniConfig.locale||navigator.language,wo=Q1(r),_0()){const e=Object.keys(__uniConfig.locales||{});e.length&&e.forEach(t=>wo.add(t,__uniConfig.locales[t])),wo.setLocale(r)}}return wo}function Zn(r,e,t){return e.reduce((n,i,s)=>(n[r+i]=t[s],n),{})}const Y1=Ws(()=>{const r="uni.async.",e=["error"];_n().add(Ri,Zn(r,e,["The connection timed out, click the screen to try again."]),!1),_n().add($u,Zn(r,e,["Se agotó el tiempo de conexión, haga clic en la pantalla para volver a intentarlo."]),!1),_n().add(Ou,Zn(r,e,["La connexion a expiré, cliquez sur l'écran pour réessayer."]),!1),_n().add(Ma,Zn(r,e,["连接服务器超时，点击屏幕重试"]),!1),_n().add(ll,Zn(r,e,["連接服務器超時，點擊屏幕重試"]),!1)}),J1=Ws(()=>{const r="uni.showToast.",e=["unpaired"];_n().add(Ri,Zn(r,e,["Please note showToast must be paired with hideToast"]),!1),_n().add($u,Zn(r,e,["Tenga en cuenta que showToast debe estar emparejado con hideToast"]),!1),_n().add(Ou,Zn(r,e,["Veuillez noter que showToast doit être associé à hideToast"]),!1),_n().add(Ma,Zn(r,e,["请注意 showToast 与 hideToast 必须配对使用"]),!1),_n().add(ll,Zn(r,e,["請注意 showToast 與 hideToast 必須配對使用"]),!1)}),X1=Ws(()=>{const r="uni.showLoading.",e=["unpaired"];_n().add(Ri,Zn(r,e,["Please note showLoading must be paired with hideLoading"]),!1),_n().add($u,Zn(r,e,["Tenga en cuenta que showLoading debe estar emparejado con hideLoading"]),!1),_n().add(Ou,Zn(r,e,["Veuillez noter que showLoading doit être associé à hideLoading"]),!1),_n().add(Ma,Zn(r,e,["请注意 showLoading 与 hideLoading 必须配对使用"]),!1),_n().add(ll,Zn(r,e,["請注意 showLoading 與 hideLoading 必須配對使用"]),!1)});function Z1(r){if(_0())return K1(r,[["titleText"],["searchInput","placeholder"],["buttons","text"]])}function N0(r){const e=new rw;return{on(t,n){return e.on(t,n)},once(t,n){return e.once(t,n)},off(t,n){return e.off(t,n)},emit(t,...n){return e.emit(t,...n)},subscribe(t,n,i=!1){e[i?"once":"on"](`${r}.${t}`,n)},unsubscribe(t,n){e.off(`${r}.${t}`,n)},subscribeHandler(t,n,i){e.emit(`${r}.${t}`,n,i)}}}const Xa="invokeViewApi",Sy="invokeServiceApi";let ex=1;const tx=(r,e,t)=>{const{subscribe:n,publishHandler:i}=tr,s=t?ex++:0;t&&n(Sy+"."+s,t,!0),i(Sy,{id:s,name:r,args:e})},cl=Object.create(null);function Du(r,e){return r+"."+e}function nx(r,e){tr.subscribe(Du(r,Xa),sx)}function rx(r){tr.unsubscribe(Du(r,Xa)),Object.keys(cl).forEach(e=>{e.indexOf(r+".")===0&&delete cl[e]})}function ix(r,e,t){e=Du(r,e),cl[e]||(cl[e]=t)}function sx({id:r,name:e,args:t},n){e=Du(n,e);const i=a=>{r&&tr.publishHandler(Xa+"."+r,a)},s=cl[e];s?s(t,i):i({})}const ax=Ct(N0("service"),{invokeServiceMethod:tx}),ox=350,Cy=10,ic=el(!0);let jo;function ul(){jo&&(clearTimeout(jo),jo=null)}let A0=0,x0=0;function lx(r){if(ul(),r.touches.length!==1)return;const{pageX:e,pageY:t}=r.touches[0];A0=e,x0=t,jo=setTimeout(function(){const n=new CustomEvent("longpress",{bubbles:!0,cancelable:!0,target:r.target,currentTarget:r.currentTarget});n.touches=r.touches,n.changedTouches=r.changedTouches,r.target.dispatchEvent(n)},ox)}function cx(r){if(!jo)return;if(r.touches.length!==1)return ul();const{pageX:e,pageY:t}=r.touches[0];if(Math.abs(e-A0)>Cy||Math.abs(t-x0)>Cy)return ul()}function ux(){window.addEventListener("touchstart",lx,ic),window.addEventListener("touchmove",cx,ic),window.addEventListener("touchend",ul,ic),window.addEventListener("touchcancel",ul,ic)}function Ny(r,e){const t=Number(r);return isNaN(t)?e:t}function hx(){const r=/^Apple/.test(navigator.vendor)&&typeof window.orientation=="number",e=r&&Math.abs(window.orientation)===90;var t=r?Math[e?"max":"min"](screen.width,screen.height):screen.width,n=Math.min(window.innerWidth,document.documentElement.clientWidth,t)||t;return n}function fx(){const r=__uniConfig.globalStyle||{},e=Ny(r.rpxCalcMaxDeviceWidth,960),t=Ny(r.rpxCalcBaseDeviceWidth,375);function n(){let i=hx();i=i<=e?i:t,document.documentElement.style.fontSize=i/23.4375+"px"}n(),document.addEventListener("DOMContentLoaded",n),window.addEventListener("load",n),window.addEventListener("resize",n)}function dx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ay=["top","left","right","bottom"],fp,Kc={},_r;function dp(){return!("CSS"in window)||typeof CSS.supports!="function"?_r="":CSS.supports("top: env(safe-area-inset-top)")?_r="env":CSS.supports("top: constant(safe-area-inset-top)")?_r="constant":_r="",_r}function R0(){if(_r=typeof _r=="string"?_r:dp(),!_r){Ay.forEach(function(o){Kc[o]=0});return}function r(o,l){var c=o.style;Object.keys(l).forEach(function(u){var h=l[u];c[u]=h})}var e=[];function t(o){o?e.push(o):e.forEach(function(l){l()})}var n=!1;try{var i=Object.defineProperty({},"passive",{get:function(){n={passive:!0}}});window.addEventListener("test",null,i)}catch(o){}function s(o,l){var c=document.createElement("div"),u=document.createElement("div"),h=document.createElement("div"),f=document.createElement("div"),d=100,m=1e4,y={position:"absolute",width:d+"px",height:"200px",boxSizing:"border-box",overflow:"hidden",paddingBottom:_r+"(safe-area-inset-"+l+")"};r(c,y),r(u,y),r(h,{transition:"0s",animation:"none",width:"400px",height:"400px"}),r(f,{transition:"0s",animation:"none",width:"250%",height:"250%"}),c.appendChild(h),u.appendChild(f),o.appendChild(c),o.appendChild(u),t(function(){c.scrollTop=u.scrollTop=m;var b=c.scrollTop,S=u.scrollTop;function N(){this.scrollTop!==(this===c?b:S)&&(c.scrollTop=u.scrollTop=m,b=c.scrollTop,S=u.scrollTop,px(l))}c.addEventListener("scroll",N,n),u.addEventListener("scroll",N,n)});var T=getComputedStyle(c);Object.defineProperty(Kc,l,{configurable:!0,get:function(){return parseFloat(T.paddingBottom)}})}var a=document.createElement("div");r(a,{position:"absolute",left:"0",top:"0",width:"0",height:"0",zIndex:"-1",overflow:"hidden",visibility:"hidden"}),Ay.forEach(function(o){s(a,o)}),document.body.appendChild(a),t(),fp=!0}function sc(r){return fp||R0(),Kc[r]}var ac=[];function px(r){ac.length||setTimeout(function(){var e={};ac.forEach(function(t){e[t]=Kc[t]}),ac.length=0,Yc.forEach(function(t){t(e)})},0),ac.push(r)}var Yc=[];function mx(r){dp()&&(fp||R0(),typeof r=="function"&&Yc.push(r))}function yx(r){var e=Yc.indexOf(r);e>=0&&Yc.splice(e,1)}var gx={get support(){return(typeof _r=="string"?_r:dp()).length!=0},get top(){return sc("top")},get left(){return sc("left")},get right(){return sc("right")},get bottom(){return sc("bottom")},onChange:mx,offChange:yx},bx=gx;const Ln=dx(bx),Ex=Ja(()=>{},["prevent"]);function Oo(r,e){return parseInt((r.getPropertyValue(e).match(/\d+/)||["0"])[0])}function Lu(){const r=document.documentElement.style,e=Oo(r,"--window-top");return e?e+Ln.top:0}function wx(){const r=document.documentElement.style,e=Lu(),t=Oo(r,"--window-bottom"),n=Oo(r,"--window-left"),i=Oo(r,"--window-right"),s=Oo(r,"--top-window-height");return{top:e,bottom:t?t+Ln.bottom:0,left:n?n+Ln.left:0,right:i?i+Ln.right:0,topWindowHeight:s||0}}function Wo(r){const e=document.documentElement.style;Object.keys(r).forEach(t=>{e.setProperty(t,r[t])})}function vx(r){return Wo(r)}function pp(r){return Symbol(r)}function M0(r){return r.$page}function mp(r){return r.tagName.indexOf("UNI-")===0}const Tx="M1.952 18.080q-0.32-0.352-0.416-0.88t0.128-0.976l0.16-0.352q0.224-0.416 0.64-0.528t0.8 0.176l6.496 4.704q0.384 0.288 0.912 0.272t0.88-0.336l17.312-14.272q0.352-0.288 0.848-0.256t0.848 0.352l-0.416-0.416q0.32 0.352 0.32 0.816t-0.32 0.816l-18.656 18.912q-0.32 0.352-0.8 0.352t-0.8-0.32l-7.936-8.064z",_x="M15.808 0.16q-4.224 0-7.872 2.176-3.552 2.112-5.632 5.728-2.144 3.744-2.144 8.128 0 4.192 2.144 7.872 2.112 3.52 5.632 5.632 3.68 2.144 7.872 2.144 4.384 0 8.128-2.144 3.616-2.080 5.728-5.632 2.176-3.648 2.176-7.872 0-4.384-2.176-8.128-2.112-3.616-5.728-5.728-3.744-2.176-8.128-2.176zM15.136 8.672h1.728q0.128 0 0.224 0.096t0.096 0.256l-0.384 10.24q0 0.064-0.048 0.112t-0.112 0.048h-1.248q-0.096 0-0.144-0.048t-0.048-0.112l-0.384-10.24q0-0.16 0.096-0.256t0.224-0.096zM16 23.328q-0.48 0-0.832-0.352t-0.352-0.848 0.352-0.848 0.832-0.352 0.832 0.352 0.352 0.848-0.352 0.848-0.832 0.352z";function xy(r,e="#000",t=27){return X("svg",{width:t,height:t,viewBox:"0 0 32 32"},[X("path",{d:r,fill:e},null,8,["d","fill"])],8,["width","height"])}function P0(){{const{$pageInstance:r}=Cn();return r&&xx(r.proxy)}}function Gs(){const r=qi(),e=r.length;if(e)return r[e-1]}function yp(){var r;const e=(r=Gs())==null?void 0:r.$page;if(e)return e.meta}function I0(){const r=yp();return r?r.id:-1}function td(){const r=Gs();if(r)return r.$vm}const Sx=["navigationBar","pullToRefresh"];function Cx(){return JSON.parse(JSON.stringify(__uniConfig.globalStyle||{}))}function Nx(r,e){const t=Cx(),n=Ct({id:e},t,r);Sx.forEach(s=>{n[s]=Ct({},t[s],r[s])});const{navigationBar:i}=n;return i.titleText&&i.titleImage&&(i.titleText=""),n}function Ax(r,e,t,n,i,s){const{id:a,route:o}=n,l=Bf(n.navigationBar,__uniConfig.themeConfig,s).titleColor;return{id:a,path:Uc(o),route:o,fullPath:e,options:t,meta:n,openType:r,eventChannel:i,statusBarStyle:l==="#ffffff"?"light":"dark"}}function xx(r){var e,t;return((e=r.$page)==null?void 0:e.id)||((t=r.$basePage)==null?void 0:t.id)}function dr(r,e,t){if(xt(r))t=e,e=r,r=td();else if(typeof r=="number"){const i=qi().find(s=>M0(s).id===r);i?r=i.$vm:r=td()}if(!r)return;const n=r.$[e];return n&&US(n,t)}function Ry(r){r.preventDefault()}let My,Py=0;function Rx({onPageScroll:r,onReachBottom:e,onReachBottomDistance:t}){let n=!1,i=!1,s=!0;const a=()=>{const{scrollHeight:l}=document.documentElement,c=window.innerHeight,u=window.scrollY,h=u>0&&l>c&&u+c+t>=l,f=Math.abs(l-Py)>t;return h&&(!i||f)?(Py=l,i=!0,!0):(!h&&i&&(i=!1),!1)},o=()=>{r&&r(window.pageYOffset);function l(){if(a())return e&&e(),s=!1,setTimeout(function(){s=!0},350),!0}e&&s&&(l()||(My=setTimeout(l,300))),n=!1};return function(){clearTimeout(My),n||requestAnimationFrame(o),n=!0}}function Mx(r){if(r.indexOf("/")===0||r.indexOf("uni:")===0)return r;let e="";const t=qi();return t.length&&(e=M0(t[t.length-1]).route),gp(e,r)}function gp(r,e){if(e.indexOf("/")===0)return e;if(e.indexOf("./")===0)return gp(r,e.slice(2));const t=e.split("/"),n=t.length;let i=0;for(;i<n&&t[i]==="..";i++);t.splice(0,i),e=t.join("/");const s=r.length>0?r.split("/"):[];return s.splice(s.length-i-1,i+1),Uc(s.concat(t).join("/"))}function O0(r,e=!1){return e?__uniRoutes.find(t=>t.path===r||t.alias===r):__uniRoutes.find(t=>t.path===r)}function Px(){fx(),HS(mp),ux()}class Ix{constructor(e){this.$bindClass=!1,this.$bindStyle=!1,this.$vm=e,this.$el=WS(e.$),this.$el.getAttribute&&(this.$bindClass=!!this.$el.getAttribute("class"),this.$bindStyle=!!this.$el.getAttribute("style"))}selectComponent(e){if(!this.$el||!e)return;const t=Oy(this.$el.querySelector(e));if(t)return nd(t,!1)}selectAllComponents(e){if(!this.$el||!e)return[];const t=[],n=this.$el.querySelectorAll(e);for(let i=0;i<n.length;i++){const s=Oy(n[i]);s&&t.push(nd(s,!1))}return t}forceUpdate(e){e==="class"?this.$bindClass?(this.$el.__wxsClassChanged=!0,this.$vm.$forceUpdate()):this.updateWxsClass():e==="style"&&(this.$bindStyle?(this.$el.__wxsStyleChanged=!0,this.$vm.$forceUpdate()):this.updateWxsStyle())}updateWxsClass(){const{__wxsAddClass:e}=this.$el;e.length&&(this.$el.className=e.join(" "))}updateWxsStyle(){const{__wxsStyle:e}=this.$el;e&&this.$el.setAttribute("style",vS(e))}setStyle(e){return!this.$el||!e?this:(xt(e)&&(e=kc(e)),In(e)&&(this.$el.__wxsStyle=e,this.forceUpdate("style")),this)}addClass(e){if(!this.$el||!e)return this;const t=this.$el.__wxsAddClass||(this.$el.__wxsAddClass=[]);return t.indexOf(e)===-1&&(t.push(e),this.forceUpdate("class")),this}removeClass(e){if(!this.$el||!e)return this;const{__wxsAddClass:t}=this.$el;if(t){const i=t.indexOf(e);i>-1&&t.splice(i,1)}const n=this.$el.__wxsRemoveClass||(this.$el.__wxsRemoveClass=[]);return n.indexOf(e)===-1&&(n.push(e),this.forceUpdate("class")),this}hasClass(e){return this.$el&&this.$el.classList.contains(e)}getDataset(){return this.$el&&this.$el.dataset}callMethod(e,t={}){const n=this.$vm[e];at(n)?n(JSON.parse(JSON.stringify(t))):this.$vm.ownerId&&tr.publishHandler(kS,{nodeId:this.$el.__id,ownerId:this.$vm.ownerId,method:e,args:t})}requestAnimationFrame(e){return window.requestAnimationFrame(e)}getState(){return this.$el&&(this.$el.__wxsState||(this.$el.__wxsState={}))}triggerEvent(e,t={}){return this.$vm.$emit(e,t),this}getComputedStyle(e){if(this.$el){const t=window.getComputedStyle(this.$el);return e&&e.length?e.reduce((n,i)=>(n[i]=t[i],n),{}):t}return{}}setTimeout(e,t){return window.setTimeout(e,t)}clearTimeout(e){return window.clearTimeout(e)}getBoundingClientRect(){return this.$el.getBoundingClientRect()}}function nd(r,e=!0){if(e&&r&&(r=JE(r.$)),r&&r.$el)return r.$el.__wxsComponentDescriptor||(r.$el.__wxsComponentDescriptor=new Ix(r)),r.$el.__wxsComponentDescriptor}function rd(r,e){return nd(r,e)}function Ox(r,e,t=!0){if(!e||t&&r.length<2)return!1;const n=JE(e);if(!n)return!1;const i=n.$.type;return!i.$wxs&&!i.$renderjs?!1:n}function Iy(r,e,t,n=!0){if(e){r.__instance||(r.__instance=!0,Object.defineProperty(r,"instance",{get(){return rd(t.proxy,!1)}}));const i=Ox(e,t,n);if(i)return[r,rd(i,!1)]}}function Oy(r){if(r)return r.__vueParentComponent&&r.__vueParentComponent.proxy}const $x=r=>!r.type.indexOf("key")&&r instanceof KeyboardEvent,Dx=r=>r.type==="click",Lx=r=>r.type.indexOf("mouse")===0||["contextmenu"].includes(r.type),qx=r=>typeof TouchEvent!="undefined"&&r instanceof TouchEvent||r.type.indexOf("touch")===0||["longpress"].indexOf(r.type)>=0;function kx(r,e,t){const{currentTarget:n}=r;if(!(r instanceof Event)||!(n instanceof HTMLElement))return[r];const i=!mp(n);if(i)return Iy(r,e,t,!1)||[r];const s=$0(r,i);if(Dx(r))Ux(s,r);else if(Lx(r))Vx(s,r);else if(qx(r)){const a=Lu();s.touches=$y(r.touches,a),s.changedTouches=$y(r.changedTouches,a)}else $x(r)&&["key","code"].forEach(o=>{Object.defineProperty(s,o,{get(){return r[o]}})});return Iy(s,e,t)||[s]}function Bx(r){for(;!mp(r);)r=r.parentElement;return r}function $0(r,e=!1){const{type:t,timeStamp:n,target:i,currentTarget:s}=r;let a,o;a=qf(e?i:Bx(i)),o=qf(s);const l={type:t,timeStamp:n,target:a,detail:{},currentTarget:o};return r instanceof CustomEvent&&In(r.detail)&&(l.detail=r.detail),r._stopped&&(l._stopped=!0),r.type.startsWith("touch")&&(l.touches=r.touches,l.changedTouches=r.changedTouches),Fx(l,r),l}function Fx(r,e){Ct(r,{preventDefault(){return e.preventDefault()},stopPropagation(){return e.stopPropagation()}})}function Ux(r,e){const{x:t,y:n}=e,i=Lu();r.detail={x:t,y:n-i},r.touches=r.changedTouches=[D0(e,i)]}function Vx(r,e){const t=Lu();r.pageX=e.pageX,r.pageY=e.pageY-t,r.clientX=e.clientX,r.clientY=e.clientY-t,r.touches=r.changedTouches=[D0(e,t)]}function D0(r,e){return{force:1,identifier:0,clientX:r.clientX,clientY:r.clientY-e,pageX:r.pageX,pageY:r.pageY-e}}function $y(r,e){const t=[];for(let n=0;n<r.length;n++){const{identifier:i,pageX:s,pageY:a,clientX:o,clientY:l,force:c}=r[n];t.push({identifier:i,pageX:s,pageY:a-e,clientX:o,clientY:l-e,force:c||0})}return t}const jx=Object.defineProperty({__proto__:null,$nne:kx,createNativeEvent:$0},Symbol.toStringTag,{value:"Module"});function Wx(r){const e=r.globalProperties;Ct(e,jx),e.$gcd=rd}function Hx(r){Wx(r._context.config)}const Qx=(r,e)=>rr.emit("api."+r,e);let L0=1;function q0(r){return(r||I0())+"."+Xa}const zx=(r,e,t,n)=>{const{subscribe:i,publishHandler:s}=rr,a=n?L0++:0;n&&i(Xa+"."+a,n,!0),s(q0(t),{id:a,name:r,args:e},t)},Gx=(r,e,t,n)=>{const{subscribe:i,unsubscribe:s,publishHandler:a}=rr,o=L0++,l=Xa+"."+o;return i(l,t),a(q0(n),{id:o,name:r,args:e},n),()=>{s(l)}},Kx=Ct(N0("view"),{invokeOnCallback:Qx,invokeViewMethod:zx,invokeViewMethodKeepAlive:Gx});function Yx(){const{on:r}=rr;r(Eu,Jx),r(zE,Xx),r(GE,Zx)}function Jx(r){const e=Gs();dr(e,Eu,r),rr.invokeOnCallback("onWindowResize",r)}function Xx(r){const e=Gs();dr(Sr(),hs,r),dr(e,hs)}function Zx(){dr(Sr(),ks),dr(Gs(),ks)}const eR=[Zo,wu];function tR(){eR.forEach(r=>rr.subscribe(r,nR(r)))}function nR(r){return(e,t)=>{dr(parseInt(t),r,e)}}function rR(){Yx(),tR()}function iR(r){r.$vm=r,r.$mpType="app";const e=ge(_n().getLocale());Object.defineProperty(r,"$locale",{get(){return e.value},set(t){e.value=t}})}function sR(r,e){r.route=e.route,r.$vm=r,r.$page=e,r.$mpType="page",r.$fontFamilySet=new Set,e.meta.isTabBar&&(r.$.__isTabBar=!0,r.$.__isActive=!0)}function aR(){if(this.$route){const r=this.$route.meta;return r.eventChannel||(r.eventChannel=new ew(this.$page.id)),r.eventChannel}}function oR(r){const e=r.globalProperties;e.getOpenerEventChannel=aR}function lR(r){oR(r._context.config)}function k0(){return{path:"",query:{},scene:1001,referrerInfo:{appId:"",extraData:{}}}}function cR(r,e){const t=r.$options||{};t.globalData=Ct(t.globalData||{},e),Object.defineProperty(r,"globalData",{get(){return t.globalData},set(n){t.globalData=n}})}function Dy(r){return/^-?\d+[ur]px$/i.test(r)?r.replace(/(^-?\d+)[ur]px$/i,(e,t)=>`${tv(parseFloat(t))}px`):/^-?[\d\.]+$/.test(r)?`${r}px`:r||""}function uR(r){return r.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`).replace("webkit","-webkit")}function hR(r){const e=["matrix","matrix3d","scale","scale3d","rotate3d","skew","translate","translate3d"],t=["scaleX","scaleY","scaleZ","rotate","rotateX","rotateY","rotateZ","skewX","skewY","translateX","translateY","translateZ"],n=["opacity","background-color"],i=["width","height","left","right","top","bottom"],s=r.animates,a=r.option,o=a.transition,l={},c=[];return s.forEach(u=>{let h=u.type,f=[...u.args];if(e.concat(t).includes(h))h.startsWith("rotate")||h.startsWith("skew")?f=f.map(d=>parseFloat(d)+"deg"):h.startsWith("translate")&&(f=f.map(Dy)),t.indexOf(h)>=0&&(f.length=1),c.push(`${h}(${f.join(",")})`);else if(n.concat(i).includes(f[0])){h=f[0];const d=f[1];l[h]=i.includes(h)?Dy(d):d}}),l.transform=l.webkitTransform=c.join(" "),l.transition=l.webkitTransition=Object.keys(l).map(u=>`${uR(u)} ${o.duration}ms ${o.timingFunction} ${o.delay}ms`).join(","),l.transformOrigin=l.webkitTransformOrigin=a.transformOrigin,l}function Ly(r){const e=r.animation;if(!e||!e.actions||!e.actions.length)return;let t=0;const n=e.actions,i=e.actions.length;function s(){const a=n[t],o=a.option.transition,l=hR(a);Object.keys(l).forEach(c=>{r.$el.style[c]=l[c]}),t+=1,t<i&&setTimeout(s,o.duration+o.delay)}setTimeout(()=>{s()},0)}const fR={props:["animation"],watch:{animation:{deep:!0,handler(){Ly(this)}}},mounted(){Ly(this)}},pi=r=>{r.__reserved=!0;const{props:e,mixins:t}=r;return(!e||!e.animation)&&(t||(r.mixins=[])).push(fR),Za(r)},Za=r=>(r.__reserved=!0,r.compatConfig={MODE:3},Lt(r));function da(r){return r.__wwe=!0,r}function qu(r,e){return(t,n,i)=>{r.value&&e(t,dR(t,n,r.value,i||{}))}}function dR(r,e,t,n){let i;return i=qf(t),{type:e.__evName||n.type||r,timeStamp:e.timeStamp||0,target:i,currentTarget:i,detail:n}}const pR={hoverClass:{type:String,default:"none"},hoverStopPropagation:{type:Boolean,default:!1},hoverStartTime:{type:[Number,String],default:50},hoverStayTime:{type:[Number,String],default:400}};function B0(r){const e=ge(!1);let t=!1,n,i;function s(){requestAnimationFrame(()=>{clearTimeout(i),i=setTimeout(()=>{e.value=!1},parseInt(r.hoverStayTime))})}function a(m){m.touches.length>1||l(m)}function o(m){t||(l(m),window.addEventListener("mouseup",f))}function l(m){m._hoverPropagationStopped||!r.hoverClass||r.hoverClass==="none"||r.disabled||(r.hoverStopPropagation&&(m._hoverPropagationStopped=!0),t=!0,n=setTimeout(()=>{e.value=!0,t||s()},parseInt(r.hoverStartTime)))}function c(){h()}function u(){t&&f()}function h(){t=!1,e.value&&s()}function f(){h(),window.removeEventListener("mouseup",f)}function d(){t=!1,e.value=!1,clearTimeout(n)}return{hovering:e,binding:{onTouchstartPassive:da(a),onMousedown:da(o),onTouchend:da(c),onMouseup:da(u),onTouchcancel:da(d)}}}function Bh(r,e){return xt(e)&&(e=[e]),e.reduce((t,n)=>(r[n]&&(t[n]=!0),t),Object.create(null))}const F0=pp("uf"),mR=pp("ul");function yR(r,e){qy(r.id,e),Ge(()=>r.id,(t,n)=>{ky(n,e,!0),qy(t,e,!0)}),vl(()=>{ky(r.id,e)})}function qy(r,e,t){const n=P0();t&&!r||In(e)&&Object.keys(e).forEach(i=>{t?i.indexOf("@")!==0&&i.indexOf("uni-")!==0&&tr.on(`uni-${i}-${n}-${r}`,e[i]):i.indexOf("uni-")===0?tr.on(i,e[i]):r&&tr.on(`uni-${i}-${n}-${r}`,e[i])})}function ky(r,e,t){const n=P0();t&&!r||In(e)&&Object.keys(e).forEach(i=>{t?i.indexOf("@")!==0&&i.indexOf("uni-")!==0&&tr.off(`uni-${i}-${n}-${r}`,e[i]):i.indexOf("uni-")===0?tr.off(i,e[i]):r&&tr.off(`uni-${i}-${n}-${r}`,e[i])})}const gR={id:{type:String,default:""},hoverClass:{type:String,default:"button-hover"},hoverStartTime:{type:[Number,String],default:20},hoverStayTime:{type:[Number,String],default:70},hoverStopPropagation:{type:Boolean,default:!1},disabled:{type:[Boolean,String],default:!1},formType:{type:String,default:""},openType:{type:String,default:""},loading:{type:[Boolean,String],default:!1},plain:{type:[Boolean,String],default:!1}},U0=pi({name:"Button",props:gR,setup(r,{slots:e}){const t=ge(null),n=on(F0,!1),{hovering:i,binding:s}=B0(r),a=da((l,c)=>{if(r.disabled)return l.stopImmediatePropagation();c&&t.value.click();const u=r.formType;if(u){if(!n)return;u==="submit"?n.submit(l):u==="reset"&&n.reset(l);return}}),o=on(mR,!1);return o&&(o.addHandler(a),$r(()=>{o.removeHandler(a)})),yR(r,{"label-click":a}),()=>{const l=r.hoverClass,c=Bh(r,"disabled"),u=Bh(r,"loading"),h=Bh(r,"plain"),f=l&&l!=="none";return X("uni-button",di({ref:t,onClick:a,id:r.id,class:f&&i.value?l:""},f&&s,c,u,h),[e.default&&e.default()],16,["onClick","id"])}}}),V0=pp("upm");function j0(){return on(V0)}function bR(r){const e=ER(r);return Qr(V0,e),e}function ku(){return hp()}function ER(r){return nn(wR(JSON.parse(JSON.stringify(Nx(hp().meta,r)))))}function wR(r){{const{navigationBar:e}=r,{titleSize:t,titleColor:n,backgroundColor:i}=e;e.titleText=e.titleText||"",e.type=e.type||"default",e.titleSize=t||"16px",e.titleColor=n||"#000000",e.backgroundColor=i||"#F8F8F8",Z1(e)}if(history.state){const e=history.state.__type__;(e==="redirectTo"||e==="reLaunch")&&qi().length===0&&(r.isEntry=!0,r.isQuit=!0)}return r}function bp(){return history.state&&history.state.__id__||1}const Fh=["GET","OPTIONS","HEAD","POST","PUT","DELETE","TRACE","CONNECT","PATCH"];function W0(r,e){return!r||e.indexOf(r)===-1?e[0]:r}function vR(r){return function(){try{return r.apply(r,arguments)}catch(e){}}}let TR=1;const id={};function _R(r,e,t,n=!1){return id[r]={name:e,keepAlive:n,callback:t},r}function H0(r,e,t){if(typeof r=="number"){const n=id[r];if(n)return n.keepAlive||delete id[r],n.callback(e,t)}return e}const SR="success",CR="fail",NR="complete";function AR(r){const e={};for(const t in r){const n=r[t];at(n)&&(e[t]=vR(n),delete r[t])}return e}function xR(r,e){return!r||r.indexOf(":fail")===-1?e+":ok":e+r.substring(r.indexOf(":fail"))}function RR(r,e={},{beforeAll:t,beforeSuccess:n}={}){In(e)||(e={});const{success:i,fail:s,complete:a}=AR(e),o=at(i),l=at(s),c=at(a),u=TR++;return _R(u,r,h=>{h=h||{},h.errMsg=xR(h.errMsg,r),at(t)&&t(h),h.errMsg===r+":ok"?(at(n)&&n(h,e),o&&i(h)):l&&s(h),c&&a(h)}),u}const MR="success",PR="fail",IR="complete",hl={},Jc={};function OR(r,e){return function(t){return r(t,e)||t}}function Q0(r,e,t){let n=!1;for(let i=0;i<r.length;i++){const s=r[i];if(n)n=Promise.resolve(OR(s,t));else{const a=s(e,t);if(jd(a)&&(n=Promise.resolve(a)),a===!1)return{then(){},catch(){}}}}return n||{then(i){return i(e)},catch(){}}}function By(r,e={}){return[MR,PR,IR].forEach(t=>{const n=r[t];if(!it(n))return;const i=e[t];e[t]=function(a){Q0(n,a,e).then(o=>at(i)&&i(o)||o)}}),e}function Fy(r,e){const t=[];it(hl.returnValue)&&t.push(...hl.returnValue);const n=Jc[r];return n&&it(n.returnValue)&&t.push(...n.returnValue),t.forEach(i=>{e=i(e)||e}),e}function Uy(r){const e=Object.create(null);Object.keys(hl).forEach(n=>{n!=="returnValue"&&(e[n]=hl[n].slice())});const t=Jc[r];return t&&Object.keys(t).forEach(n=>{n!=="returnValue"&&(e[n]=(e[n]||[]).concat(t[n]))}),e}function Vy(r,e,t,n){const i=Uy(r);return i&&Object.keys(i).length?it(i.invoke)?Q0(i.invoke,t).then(a=>e(By(Uy(r),a),...n)):e(By(i,t),...n):e(t,...n)}function $R(r){return!!(In(r)&&[SR,CR,NR].find(e=>at(r[e])))}function z0(r,e){return(t={},...n)=>$R(t)?Fy(r,Vy(r,e,Ct({},t),n)):Fy(r,new Promise((i,s)=>{Vy(r,e,Ct({},t,{success:i,fail:s}),n)}))}function DR(r,e){const t=r[0];if(!e||!e.formatArgs||!In(e.formatArgs)&&In(t))return;const n=e.formatArgs,i=Object.keys(n);for(let s=0;s<i.length;s++){const a=i[s],o=n[a];if(at(o)){const l=o(r[0][a],t);if(xt(l))return l}else It(t,a)||(t[a]=o)}}function LR(r,e,t){const n={errMsg:e+":ok"};return H0(r,Ct(t||{},n))}function jy(r,e,t,n={}){const i=e+":fail";let s="";t?t.indexOf(i)===0?s=t:s=i+" "+t:s=i,delete n.errCode;let a=Ct({errMsg:s},n);return H0(r,a)}function G0(r,e,t,n){if(n&&n.beforeInvoke){const s=n.beforeInvoke(e);if(xt(s))return s}const i=DR(e,n);if(i)return i}function qR(r){return!r||xt(r)?r:r.stack?(typeof globalThis=="undefined"||globalThis.harmonyChannel,r.message):r}function K0(r,e,t,n){return i=>{const s=RR(r,i,n),a=G0(r,[i],t,n);return a?jy(s,r,a):e(i,{resolve:o=>LR(s,r,o),reject:(o,l)=>jy(s,r,qR(o),l)})}}function kR(r,e,t,n){return(...i)=>{const s=G0(r,i,t,n);if(s)throw new Error(s);return e.apply(null,i)}}function BR(r,e,t,n){return K0(r,e,t,n)}function FR(r,e,t,n){return z0(r,K0(r,e,void 0,n))}function mi(r,e,t,n){return kR(r,e,void 0,n)}function yi(r,e,t,n){return z0(r,BR(r,e,void 0,n))}function UR(r){return`method 'uni.${r}' not supported`}function VR(r){return(e,{reject:t})=>t(UR(r))}const jR="upx2px",WR=1e-4,HR=750;let Y0=!1,sd=0,J0=0,X0=960,Z0=375,ev=750;function QR(){let r,e,t;{const{windowWidth:n,pixelRatio:i,platform:s}=aP();r=n,e=i,t=s}sd=r,J0=e,Y0=t==="ios"}function Uh(r,e){const t=Number(r);return isNaN(t)?e:t}function zR(){const r=__uniConfig.globalStyle||{};X0=Uh(r.rpxCalcMaxDeviceWidth,960),Z0=Uh(r.rpxCalcBaseDeviceWidth,375),ev=Uh(r.rpxCalcBaseDeviceWidth,750)}const tv=mi(jR,(r,e)=>{if(sd===0&&(QR(),zR()),r=Number(r),r===0)return 0;let t=e||sd;t=r===ev||t<=X0?t:Z0;let n=r/HR*t;return n<0&&(n=-n),n=Math.floor(n+WR),n===0&&(J0===1||!Y0?n=1:n=.5),r<0?-n:n}),GR="addInterceptor";function Wy(r,e){Object.keys(e).forEach(t=>{at(e[t])&&(r[t]=KR(r[t],e[t]))})}function KR(r,e){const t=e?r?r.concat(e):it(e)?e:[e]:r;return t&&YR(t)}function YR(r){const e=[];for(let t=0;t<r.length;t++)e.indexOf(r[t])===-1&&e.push(r[t]);return e}const ba=mi(GR,(r,e)=>{xt(r)&&In(e)?Wy(Jc[r]||(Jc[r]={}),e):In(r)&&Wy(hl,r)}),JR="getLocale",Bs=mi(JR,()=>{const r=Sr();return r&&r.$vm?r.$vm.$locale:_n().getLocale()}),Hy={[OE]:[],[IE]:[],[Bc]:[],[hs]:[],[ks]:[]};function XR(r){Object.keys(Hy).forEach(e=>{Hy[e].forEach(t=>{zs(e,t,r)})})}const ZR="getStorageSync",eM="setStorageSync",tM="removeStorage",nM="request",rM={JSON:"json"},iM=["text","arraybuffer"],sM="text",Qy=encodeURIComponent;function aM(r,e){let t=r.split("#");const n=t[1]||"";t=t[0].split("?");let i=t[1]||"";r=t[0];const s=i.split("&").filter(o=>o),a={};s.forEach(o=>{const l=o.split("=");a[l[0]]=l[1]});for(const o in e)if(It(e,o)){let l=e[o];typeof l=="undefined"||l===null?l="":In(l)&&(l=JSON.stringify(l)),a[Qy(o)]=Qy(l)}return i=Object.keys(a).map(o=>`${o}=${a[o]}`).join("&"),r+(i?"?"+i:"")+(n?"#"+n:"")}const oM={},lM={formatArgs:{method(r,e){e.method=W0((r||"").toUpperCase(),Fh)},data(r,e){e.data=r||""},url(r,e){e.method===Fh[0]&&In(e.data)&&Object.keys(e.data).length&&(e.url=aM(r,e.data))},header(r,e){const t=e.header=r||{};e.method!==Fh[0]&&(Object.keys(t).find(n=>n.toLowerCase()==="content-type")||(t["Content-Type"]="application/json"))},dataType(r,e){e.dataType=(r||rM.JSON).toLowerCase()},responseType(r,e){e.responseType=(r||"").toLowerCase(),iM.indexOf(e.responseType)===-1&&(e.responseType=sM)}}};function cM(r){if(!xt(r))return r;const e=r.indexOf("?");if(e===-1)return r;const t=r.slice(e+1).trim().replace(/^(\?|#|&)/,"");if(!t)return r;r=r.slice(0,e);const n=[];return t.split("&").forEach(i=>{const s=i.replace(/\+/g," ").split("="),a=s.shift(),o=s.length>0?s.join("="):"";n.push(a+"="+encodeURIComponent(o))}),n.length?r+"?"+n.join("&"):r}const uM=["slide-in-right","slide-in-left","slide-in-top","slide-in-bottom","fade-in","zoom-out","zoom-fade-out","pop-in","none"],hM=["slide-out-right","slide-out-left","slide-out-top","slide-out-bottom","fade-out","zoom-in","zoom-fade-in","pop-out","none"],Bu={url:{type:String,required:!0}},Ho="navigateTo",Qo="redirectTo",Ec="reLaunch",Pa="switchTab",fM="navigateBack",zy="preloadPage",dM="unPreloadPage",pM=Ct({},Bu,nv(uM)),mM=Ct({delta:{type:Number}},nv(hM)),yM=Bu,gM=Bu,bM=Bu,EM=Fu(Ho),wM=Fu(Qo),vM=Fu(Ec),TM=Fu(Pa),_M={formatArgs:{delta(r,e){r=parseInt(r+"")||1,e.delta=Math.min(qi().length-1,r)}}};function nv(r){return{animationType:{type:String,validator(e){if(e&&r.indexOf(e)===-1)return"`"+e+"` is not supported for `animationType` (supported values are: `"+r.join("`|`")+"`)"}},animationDuration:{type:Number}}}let wc;function SM(){wc=""}function Fu(r){return{formatArgs:{url:CM(r)},beforeAll:SM}}function CM(r){return function(t,n){if(!t)return'Missing required args: "url"';t=Mx(t);const i=t.split("?")[0],s=O0(i,!0);if(!s)return"page `"+t+"` is not found";if(r===Ho||r===Qo){if(s.meta.isTabBar)return`can not ${r} a tabbar page`}else if(r===Pa&&!s.meta.isTabBar)return"can not switch to no-tabBar page";if((r===Pa||r===zy)&&s.meta.isTabBar&&n.openType!=="appLaunch"&&(t=i),s.meta.isEntry&&(t=t.replace(s.alias,"/")),n.url=cM(t),r!==dM){if(r===zy){if(s.meta.isTabBar){const a=qi(),o=s.path.slice(1);if(a.find(l=>l.route===o))return"tabBar page `"+o+"` already exists"}return}if(wc===t&&n.openType!=="appLaunch")return`${wc} locked`;__uniConfig.ready&&(wc=t)}}}const NM="hideLoading",AM="setNavigationBarColor",ad="setNavigationBarTitle",xM="showNavigationBarLoading",RM="hideNavigationBarLoading",MM="showLoading",PM={},IM={formatArgs:{title:"",mask:!1}},OM="showToast",rv=["success","loading","none","error"],$M={},DM={formatArgs:{title:"",icon(r,e){e.icon=W0(r,rv)},image(r,e){r?e.image=mv(r):e.image=""},duration:1500,mask:!1}},fl={beforeInvoke(){const r=yp();if(r&&!r.isTabBar)return"not TabBar page"},formatArgs:{index(r){if(!__uniConfig.tabBar.list[r])return"tabbar item not found"}}};fl.beforeInvoke,fl.formatArgs;fl.beforeInvoke;fl.beforeInvoke,fl.formatArgs;function iv(){const r=td();if(!r)return;const e=Ep(),t=e.keys();for(const n of t){const i=e.get(n);i.$.__isTabBar?i.$.__isActive=!1:Uu(n)}r.$.__isTabBar&&(r.$.__isVisible=!1,dr(r,ks))}function LM(r,e){return r===e.fullPath||r==="/"&&e.meta.isEntry}function sv(r){const e=Ep().values();for(const t of e){const n=Ks(t);if(LM(r,n))return t.$.__isActive=!0,n.id}}const av=yi(Pa,({url:r,tabBarText:e,isAutomatedTesting:t},{resolve:n,reject:i})=>{if(!Fa.handledBeforeEntryPageRoutes){cd.push({args:{type:Pa,url:r,tabBarText:e,isAutomatedTesting:t},resolve:n,reject:i});return}return iv(),ss({type:Pa,url:r,tabBarText:e,isAutomatedTesting:t},sv(r)).then(n).catch(i)},bM,TM);function ov(){const r=Gs();if(!r)return;const e=Ks(r);Uu(Vu(e.path,e.id))}const lv=yi(Qo,({url:r,isAutomatedTesting:e},{resolve:t,reject:n})=>{if(!Fa.handledBeforeEntryPageRoutes){ud.push({args:{type:Qo,url:r,isAutomatedTesting:e},resolve:t,reject:n});return}return ov(),ss({type:Qo,url:r,isAutomatedTesting:e}).then(t).catch(n)},yM,wM);function cv(){const r=Ep().keys();for(const e of r)Uu(e)}const qM=yi(Ec,({url:r,isAutomatedTesting:e},{resolve:t,reject:n})=>{if(!Fa.handledBeforeEntryPageRoutes){hd.push({args:{type:Ec,url:r,isAutomatedTesting:e},resolve:t,reject:n});return}return cv(),ss({type:Ec,url:r,isAutomatedTesting:e}).then(t).catch(n)},gM,vM);function ss({type:r,url:e,tabBarText:t,events:n,isAutomatedTesting:i},s){const a=Sr().$router,{path:o,query:l}=ZS(e);return new Promise((c,u)=>{const h=HM(r,s);a[r==="navigateTo"?"push":"replace"]({path:o,query:l,state:h,force:!0}).then(f=>{if(ii(f))return u(f.message);if(r==="switchTab"&&(a.currentRoute.value.meta.tabBarText=t),r==="navigateTo"){const d=a.currentRoute.value.meta;return d.eventChannel?n&&(Object.keys(n).forEach(m=>{d.eventChannel._addListener(m,"on",n[m])}),d.eventChannel._clearCache()):d.eventChannel=new ew(h.__id__,n),c(i?{__id__:h.__id__}:{eventChannel:d.eventChannel})}return i?c({__id__:h.__id__}):c()})})}function uv(){if(Fa.handledBeforeEntryPageRoutes)return;Fa.handledBeforeEntryPageRoutes=!0;const r=[...ld];ld.length=0,r.forEach(({args:i,resolve:s,reject:a})=>ss(i).then(s).catch(a));const e=[...cd];cd.length=0,e.forEach(({args:i,resolve:s,reject:a})=>(iv(),ss(i,sv(i.url)).then(s).catch(a)));const t=[...ud];ud.length=0,t.forEach(({args:i,resolve:s,reject:a})=>(ov(),ss(i).then(s).catch(a)));const n=[...hd];hd.length=0,n.forEach(({args:i,resolve:s,reject:a})=>(cv(),ss(i).then(s).catch(a)))}function hv(r){const e=window.CSS&&window.CSS.supports;return e&&(e(r)||e.apply(window.CSS,r.split(":")))}const kM=hv("top:env(a)"),BM=hv("top:constant(a)"),Xc=kM?"env":BM?"constant":"";function fv(r){vx({"--window-top":FM(0),"--window-bottom":UM(0)})}function FM(r){return Xc?`calc(${r}px + ${Xc}(safe-area-inset-top))`:`${r}px`}function UM(r){return Xc?`calc(${r}px + ${Xc}(safe-area-inset-bottom))`:`${r}px`}const od="$$",fs=new Map;function Ks(r){return r.$page}const Fa={handledBeforeEntryPageRoutes:!1},ld=[],cd=[],ud=[],hd=[];function VM(){fs.forEach((r,e)=>{r.$.isUnmounted&&fs.delete(e)})}function Ep(){return fs}function qi(){return _l()}function _l(){const r=[],e=fs.values();for(const t of e)t.$.__isTabBar?t.$.__isActive&&r.push(t):r.push(t);return r}function jM(r){const e=xs.get(r);e&&(xs.delete(r),zo.pruneCacheEntry(e))}function Uu(r,e=!0){const t=fs.get(r);t.$.__isUnload=!0,dr(t,Qd),fs.delete(r),e&&jM(r)}let WM=bp();function HM(r,e){return{__id__:e||++WM,__type__:r}}function QM(r){const e=j0();let t=r.fullPath;return r.meta.isEntry&&t.indexOf(r.meta.route)===-1&&(t="/"+r.meta.route+t.replace("/","")),Ax("navigateTo",t,{},e)}function zM(r){const e=r.$route,t=QM(e);sR(r,t),fs.set(Vu(t.path,t.id),r),fs.size===1&&setTimeout(()=>{uv()},0)}function Vu(r,e){return r+od+e}function GM(){const r=hp(),e=Me(()=>Vu("/"+r.meta.route,bp())),t=Me(()=>r.meta.isTabBar);return{routeKey:e,isTabBar:t,routeCache:zo}}const xs=new Map,zo={get(r){return xs.get(r)},set(r,e){KM(r),xs.set(r,e)},delete(r){xs.get(r)&&xs.delete(r)},forEach(r){xs.forEach(r)}};function KM(r){const e=parseInt(r.split(od)[1]);e&&zo.forEach((t,n)=>{const i=parseInt(n.split(od)[1]);i&&i>e&&(zo.delete(n),zo.pruneCacheEntry(t),bn(()=>VM()))})}function YM(r){{const e="nvue-dir-"+__uniConfig.nvue["flex-direction"];r.isNVue?(document.body.setAttribute("nvue",""),document.body.setAttribute(e,"")):(document.body.removeAttribute("nvue"),document.body.removeAttribute(e))}}function Gy(r,e){ZM(r),fv(),YM(e),pv(r,e)}function JM(r){const e=dv(r);e&&XM(e)}function XM(r){const e=document.querySelector("uni-page-body");e&&e.setAttribute(r,"")}function dv(r){return r.type.__scopeId}let Vh;function ZM(r){const e=dv(r),{body:t}=document;Vh&&t.removeAttribute(Vh),e&&t.setAttribute(e,""),Vh=e}const eP=(()=>{let r=!1;try{const e={};Object.defineProperty(e,"passive",{get(){r=!0}}),window.addEventListener("test-passive",()=>{},e)}catch(e){}return r})(),tP=eP?{passive:!1}:!1;let oc;function pv(r,e){if(document.removeEventListener("touchmove",Ry),oc&&document.removeEventListener("scroll",oc),e.disableScroll)return document.addEventListener("touchmove",Ry,tP);const{onPageScroll:t,onReachBottom:n}=r,i=e.navigationBar.type==="transparent";if(!(t!=null&&t.length)&&!(n!=null&&n.length)&&!i)return;const s={},a=Ks(r.proxy).id;(t||i)&&(s.onPageScroll=nP(a,t,i)),n!=null&&n.length&&(s.onReachBottomDistance=e.onReachBottomDistance||RS,s.onReachBottom=()=>tr.publishHandler(wu,{},a)),oc=Rx(s),requestAnimationFrame(()=>document.addEventListener("scroll",oc))}function nP(r,e,t){return n=>{e&&tr.publishHandler(Zo,{scrollTop:n},r),t&&tr.emit(r+"."+Zo,{scrollTop:n})}}function Ky(r){const{base:e}=__uniConfig.router;return Uc(r).indexOf(e)===0?Uc(r):e+r}function mv(r){const{base:e,assets:t}=__uniConfig.router;if(e==="./"&&r.indexOf("./")===0&&(r.includes("/static/")||r.indexOf("./"+(t||"assets")+"/")===0)&&(r=r.slice(1)),r.indexOf("/")===0)if(r.indexOf("//")===0)r="https:"+r;else return Ky(r.slice(1));if(PS.test(r)||IS.test(r)||r.indexOf("blob:")===0)return r;const n=_l();return n.length?Ky(gp(Ks(n[n.length-1]).route,r).slice(1)):r}const Xn=navigator.userAgent,rP=/android/i.test(Xn),yv=/iphone|ipad|ipod/i.test(Xn),jh=Xn.match(/Windows NT ([\d|\d.\d]*)/i),fd=/Macintosh|Mac/i.test(Xn),Yy=/Linux|X11/i.test(Xn),iP=fd&&navigator.maxTouchPoints>0;function gv(){return/^Apple/.test(navigator.vendor)&&typeof window.orientation=="number"}function bv(r){return r&&Math.abs(window.orientation)===90}function Ev(r,e){return r?Math[e?"max":"min"](screen.width,screen.height):screen.width}function sP(r,e){return r?Math[e?"min":"max"](screen.height,screen.width):screen.height}function wv(r){return Math.min(window.innerWidth,document.documentElement.clientWidth,r)||r}function aP(){const r=gv(),e=wv(Ev(r,bv(r)));return{platform:yv?"ios":"other",pixelRatio:window.devicePixelRatio,windowWidth:e}}const Wh=k0(),vv=k0();function oP(){return Ct({},vv)}function lP({path:r,query:e}){return Ct(Wh,{path:r,query:e}),Ct(vv,Wh),Ct({},Wh)}const wp=pi({name:"ResizeSensor",props:{initial:{type:Boolean,default:!1}},emits:["resize"],setup(r,{emit:e}){const t=ge(null),n=uP(t),i=cP(t,e,n);return hP(t,r,i,n),()=>X("uni-resize-sensor",{ref:t,onAnimationstartOnce:i},[X("div",{onScroll:i},[X("div",null,null)],40,["onScroll"]),X("div",{onScroll:i},[X("div",null,null)],40,["onScroll"])],40,["onAnimationstartOnce"])}});function cP(r,e,t){const n=nn({width:-1,height:-1});return Ge(()=>Ct({},n),i=>e("resize",i)),()=>{const i=r.value;i&&(n.width=i.offsetWidth,n.height=i.offsetHeight,t())}}function uP(r){return()=>{const{firstElementChild:e,lastElementChild:t}=r.value;e.scrollLeft=1e5,e.scrollTop=1e5,t.scrollLeft=1e5,t.scrollTop=1e5}}function hP(r,e,t,n){Cu(n),gn(()=>{e.initial&&bn(t);const i=r.value;i.offsetParent!==i.parentElement&&(i.parentElement.style.position="relative"),"AnimationEvent"in window||n()})}let fP;function Jy(){}const dP={cursorSpacing:{type:[Number,String],default:0},showConfirmBar:{type:[Boolean,String],default:"auto"},adjustPosition:{type:[Boolean,String],default:!0},autoBlur:{type:[Boolean,String],default:!1}},pP=["keyboardheightchange"];function mP(r,e,t){function n(i){const s=Me(()=>String(navigator.vendor).indexOf("Apple")===0);i.addEventListener("focus",()=>{clearTimeout(fP),document.addEventListener("click",Jy,!1)});const a=()=>{document.removeEventListener("click",Jy,!1),s.value&&document.documentElement.scrollTo(document.documentElement.scrollLeft,document.documentElement.scrollTop)};i.addEventListener("blur",()=>{s.value&&i.blur(),a()})}Ge(()=>e.value,i=>i&&n(i))}const yP={src:{type:String,default:""},mode:{type:String,default:"scaleToFill"},lazyLoad:{type:[Boolean,String],default:!1},draggable:{type:Boolean,default:!1}},vc={widthFix:["offsetWidth","height",(r,e)=>r/e],heightFix:["offsetHeight","width",(r,e)=>r*e]},gP={aspectFit:["center center","contain"],aspectFill:["center center","cover"],widthFix:[,"100% 100%"],heightFix:[,"100% 100%"],top:["center top"],bottom:["center bottom"],center:["center center"],left:["left center"],right:["right center"],"top left":["left top"],"top right":["right top"],"bottom left":["left bottom"],"bottom right":["right bottom"]},vp=pi({name:"Image",props:yP,setup(r,{emit:e}){const t=ge(null),n=bP(t,r),i=qu(t,e),{fixSize:s}=TP(t,r,n);return EP(n,r,t,s,i),()=>X("uni-image",{ref:t},[X("div",{style:n.modeStyle},null,4),vc[r.mode]?X(wp,{onResize:s},null,8,["onResize"]):X("span",null,null)],512)}});function bP(r,e){const t=ge(""),n=Me(()=>{let s="auto",a="";const o=gP[e.mode];return o?(o[0]&&(a=o[0]),o[1]&&(s=o[1])):(a="0% 0%",s="100% 100%"),`background-image:${t.value?'url("'+t.value+'")':"none"};background-position:${a};background-size:${s};`}),i=nn({rootEl:r,src:Me(()=>e.src?mv(e.src):""),origWidth:0,origHeight:0,origStyle:{width:"",height:""},modeStyle:n,imgSrc:t});return gn(()=>{const s=r.value;i.origWidth=s.clientWidth||0,i.origHeight=s.clientHeight||0}),i}function EP(r,e,t,n,i){let s,a;const o=(u=0,h=0,f="")=>{r.origWidth=u,r.origHeight=h,r.imgSrc=f},l=u=>{if(!u){c(),o();return}s=s||new Image,s.onload=h=>{const{width:f,height:d}=s;o(f,d,u),bn(()=>{n()}),s.draggable=e.draggable,a&&a.remove(),a=s,t.value.appendChild(s),c(),i("load",h,{width:f,height:d})},s.onerror=h=>{o(),c(),i("error",h,{errMsg:`GET ${r.src} 404 (Not Found)`})},s.src=u},c=()=>{s&&(s.onload=null,s.onerror=null,s=null)};Ge(()=>r.src,u=>l(u)),Ge(()=>r.imgSrc,u=>{!u&&a&&(a.remove(),a=null)}),gn(()=>l(r.src)),$r(()=>c())}const wP=navigator.vendor==="Google Inc.";function vP(r){return wP&&r>10&&(r=Math.round(r/2)*2),r}function TP(r,e,t){const n=()=>{const{mode:s}=e,a=vc[s];if(!a)return;const{origWidth:o,origHeight:l}=t,c=o&&l?o/l:0;if(!c)return;const u=r.value,h=u[a[0]];h&&(u.style[a[1]]=vP(a[2](h,c))+"px")},i=()=>{const{style:s}=r.value,{origStyle:{width:a,height:o}}=t;s.width=a,s.height=o};return Ge(()=>e.mode,(s,a)=>{vc[a]&&i(),vc[s]&&n()}),{fixSize:n,resetSize:i}}function _P(r,e){let t=0,n,i;const s=function(...a){const o=Date.now();if(clearTimeout(n),i=()=>{i=null,t=o,r.apply(this,a)},o-t<e){n=setTimeout(i,e-(o-t));return}i()};return s.cancel=function(){clearTimeout(n),i=null},s.flush=function(){clearTimeout(n),i&&i()},s}const SP=el(!0),Zc=[];let Hh=0,Xy=!1;const Zy=r=>Zc.forEach(e=>e.userAction=r);function CP(r={userAction:!1}){Xy||(["touchstart","touchmove","touchend","mousedown","mouseup"].forEach(t=>{document.addEventListener(t,function(){!Hh&&Zy(!0),Hh++,setTimeout(()=>{!--Hh&&Zy(!1)},0)},SP)}),Xy=!0),Zc.push(r)}function NP(r){const e=Zc.indexOf(r);e>=0&&Zc.splice(e,1)}function AP(){const r=nn({userAction:!1});return gn(()=>{CP(r)}),$r(()=>{NP(r)}),{state:r}}function Tv(){const r=nn({attrs:{}});return gn(()=>{let e=Cn();for(;e;){const t=e.type.__scopeId;t&&(r.attrs[t]=""),e=e.proxy&&e.proxy.$mpType==="page"?null:e.parent}}),{state:r}}function xP(r,e){const t=on(F0,!1);if(!t)return;const n=Cn(),i={submit(){const s=n.proxy;return[s[r],xt(e)?s[e]:e.value]},reset(){xt(e)?n.proxy[e]="":e.value=""}};t.addField(i),$r(()=>{t.removeField(i)})}function RP(r,e){const t=document.activeElement;if(!t)return e({});const n={};["input","textarea"].includes(t.tagName.toLowerCase())&&(n.start=t.selectionStart,n.end=t.selectionEnd),e(n)}const MP=function(){ix(I0(),"getSelectedTextRange",RP)};function dd(r,e,t){return e==="number"&&isNaN(Number(r))&&(r=""),r==null?"":String(r)}const PP=["none","text","decimal","numeric","tel","search","email","url"],IP=Ct({},{name:{type:String,default:""},modelValue:{type:[String,Number]},value:{type:[String,Number]},disabled:{type:[Boolean,String],default:!1},autoFocus:{type:[Boolean,String],default:!1},focus:{type:[Boolean,String],default:!1},cursor:{type:[Number,String],default:-1},selectionStart:{type:[Number,String],default:-1},selectionEnd:{type:[Number,String],default:-1},type:{type:String,default:"text"},password:{type:[Boolean,String],default:!1},placeholder:{type:String,default:""},placeholderStyle:{type:String,default:""},placeholderClass:{type:String,default:""},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},confirmHold:{type:Boolean,default:!1},ignoreCompositionEvent:{type:Boolean,default:!0},step:{type:String,default:"0.000000000000000001"},inputmode:{type:String,default:void 0,validator:r=>!!~PP.indexOf(r)},cursorColor:{type:String,default:""}},dP),OP=["input","focus","blur","update:value","update:modelValue","update:focus","compositionstart","compositionupdate","compositionend",...pP];function $P(r,e,t){const n=ge(null),i=qu(e,t),s=Me(()=>{const h=Number(r.selectionStart);return isNaN(h)?-1:h}),a=Me(()=>{const h=Number(r.selectionEnd);return isNaN(h)?-1:h}),o=Me(()=>{const h=Number(r.cursor);return isNaN(h)?-1:h}),l=Me(()=>{var h=Number(r.maxlength);return isNaN(h)?140:h});let c="";c=dd(r.modelValue,r.type)||dd(r.value,r.type);const u=nn({value:c,valueOrigin:c,maxlength:l,focus:r.focus,composing:!1,selectionStart:s,selectionEnd:a,cursor:o});return Ge(()=>u.focus,h=>t("update:focus",h)),Ge(()=>u.maxlength,h=>u.value=u.value.slice(0,h),{immediate:!1}),{fieldRef:n,state:u,trigger:i}}function DP(r,e,t,n){let i=null;i=ZE(o=>{e.value=dd(o,r.type)},100,{setTimeout,clearTimeout}),Ge(()=>r.modelValue,i),Ge(()=>r.value,i);const s=_P((o,l)=>{i.cancel(),t("update:modelValue",l.value),t("update:value",l.value),n("input",o,l)},100),a=(o,l,c)=>{i.cancel(),s(o,l),c&&s.flush()};return Xr(()=>{i.cancel(),s.cancel()}),{trigger:n,triggerInput:a}}function LP(r,e){AP();const t=Me(()=>r.autoFocus||r.focus);function n(){if(!t.value)return;const s=e.value;if(!s){setTimeout(n,100);return}s.focus()}function i(){const s=e.value;s&&s.blur()}Ge(()=>r.focus,s=>{s?n():i()}),gn(()=>{t.value&&bn(n)})}function qP(r,e,t,n,i,s){function a(){const u=r.value;u&&e.focus&&e.selectionStart>-1&&e.selectionEnd>-1&&u.type!=="number"&&(u.selectionStart=e.selectionStart,u.selectionEnd=e.selectionEnd)}function o(){const u=r.value;u&&e.focus&&e.selectionStart<0&&e.selectionEnd<0&&e.cursor>-1&&u.type!=="number"&&(u.selectionEnd=u.selectionStart=e.cursor)}function l(u){return u.type==="number"?null:u.selectionEnd}function c(){const u=r.value;if(!u)return;const h=function(y){e.focus=!0,n("focus",y,{value:e.value}),a(),o()},f=function(y,T){y.stopPropagation(),!(at(s)&&s(y,e)===!1)&&(e.value=u.value,(!e.composing||!t.ignoreCompositionEvent)&&i(y,{value:u.value,cursor:l(u)},T))},d=function(y){e.composing&&(e.composing=!1,f(y,!0)),e.focus=!1,n("blur",y,{value:e.value,cursor:l(y.target)})};u.addEventListener("change",y=>y.stopPropagation()),u.addEventListener("focus",h),u.addEventListener("blur",d),u.addEventListener("input",f),u.addEventListener("compositionstart",y=>{y.stopPropagation(),e.composing=!0,m(y)}),u.addEventListener("compositionend",y=>{y.stopPropagation(),e.composing&&(e.composing=!1,f(y)),m(y)}),u.addEventListener("compositionupdate",m);function m(y){t.ignoreCompositionEvent||n(y.type,y,{value:y.data})}}Ge([()=>e.selectionStart,()=>e.selectionEnd],a),Ge(()=>e.cursor,o),Ge(()=>r.value,c)}function kP(r,e,t,n){MP();const{fieldRef:i,state:s,trigger:a}=$P(r,e,t),{triggerInput:o}=DP(r,s,t,a);LP(r,i),mP(r,i);const{state:l}=Tv();xP("name",s),qP(i,s,r,a,o,n);const c=String(navigator.vendor).indexOf("Apple")===0&&CSS.supports("image-orientation:from-image");return{fieldRef:i,state:s,scopedAttrsState:l,fixDisabledColor:c,trigger:a}}const BP=Ct({},IP,{placeholderClass:{type:String,default:"input-placeholder"},textContentType:{type:String,default:""}}),FP=Ws(()=>{{const r=navigator.userAgent;let e="";const t=r.match(/OS\s([\w_]+)\slike/);if(t)e=t[1].replace(/_/g,".");else if(/Macintosh|Mac/i.test(r)&&navigator.maxTouchPoints>0){const n=r.match(/Version\/(\S*)\b/);n&&(e=n[1])}return!!e&&parseInt(e)>=16&&parseFloat(e)<17.2}});function eg(r,e,t,n,i){if(e.value){if(r.data==="."){if(e.value.slice(-1)===".")return t.value=n.value=e.value=e.value.slice(0,-1),!1;if(e.value&&!e.value.includes("."))return e.value+=".",i&&(i.fn=()=>{t.value=n.value=e.value=e.value.slice(0,-1),n.removeEventListener("blur",i.fn)},n.addEventListener("blur",i.fn)),!1}else if(r.inputType==="deleteContentBackward"&&FP()&&e.value.slice(-2,-1)===".")return e.value=t.value=n.value=e.value.slice(0,-2),!0}}function UP(r,e){if(e.value==="number"){const t=typeof r.modelValue=="undefined"?r.value:r.modelValue,n=ge(typeof t!="undefined"&&t!==null?t.toLocaleString():"");return Ge(()=>r.modelValue,i=>{n.value=typeof i!="undefined"&&i!==null?i.toLocaleString():""}),Ge(()=>r.value,i=>{n.value=typeof i!="undefined"&&i!==null?i.toLocaleString():""}),n}else return ge("")}const VP=pi({name:"Input",props:BP,emits:["confirm",...OP],setup(r,{emit:e,expose:t}){const n=["text","number","idcard","digit","password","tel"],i=["off","one-time-code"],s=Me(()=>{let S="";switch(r.type){case"text":S="text",r.confirmType==="search"&&(S="search");break;case"idcard":S="text";break;case"digit":S="number";break;default:S=n.includes(r.type)?r.type:"text";break}return r.password?"password":S}),a=Me(()=>{const S=i.indexOf(r.textContentType),N=i.indexOf(Di(r.textContentType));return i[S!==-1?S:N!==-1?N:0]});let o=UP(r,s),l={fn:null};const c=ge(null),{fieldRef:u,state:h,scopedAttrsState:f,fixDisabledColor:d,trigger:m}=kP(r,c,e,(S,N)=>{const C=S.target;if(s.value==="number"){if(l.fn&&(C.removeEventListener("blur",l.fn),l.fn=null),C.validity&&!C.validity.valid){if((!o.value||!C.value)&&S.data==="-"||o.value[0]==="-"&&S.inputType==="deleteContentBackward")return o.value="-",N.value="",l.fn=()=>{o.value=C.value=""},C.addEventListener("blur",l.fn),!1;const H=eg(S,o,N,C,l);return typeof H=="boolean"?H:(o.value=N.value=C.value=o.value==="-"?"":o.value,!1)}else{const H=eg(S,o,N,C,l);if(typeof H=="boolean")return H;o.value=C.value}const I=N.maxlength;if(I>0&&C.value.length>I)return C.value=C.value.slice(0,I),N.value=C.value,(r.modelValue!==void 0&&r.modelValue!==null?r.modelValue.toString():"")!==C.value}});Ge(()=>h.value,S=>{r.type==="number"&&!(o.value==="-"&&S==="")&&(o.value=S.toString())});const y=["number","digit"],T=Me(()=>y.includes(r.type)?r.step:"");function b(S){if(S.key!=="Enter")return;const N=S.target;S.stopPropagation(),m("confirm",S,{value:N.value}),!r.confirmHold&&N.blur()}return t({$triggerInput:S=>{e("update:modelValue",S.value),e("update:value",S.value),h.value=S.value}}),()=>{let S=r.disabled&&d?X("input",{key:"disabled-input",ref:u,value:h.value,tabindex:"-1",readonly:!!r.disabled,type:s.value,maxlength:h.maxlength,step:T.value,class:"uni-input-input",style:r.cursorColor?{caretColor:r.cursorColor}:{},onFocus:N=>N.target.blur()},null,44,["value","readonly","type","maxlength","step","onFocus"]):X("input",{key:"input",ref:u,value:h.value,onInput:N=>{h.value=N.target.value.toString()},disabled:!!r.disabled,type:s.value,maxlength:h.maxlength,step:T.value,enterkeyhint:r.confirmType,pattern:r.type==="number"?"[0-9]*":void 0,class:"uni-input-input",style:r.cursorColor?{caretColor:r.cursorColor}:{},autocomplete:a.value,onKeyup:b,inputmode:r.inputmode},null,44,["value","onInput","disabled","type","maxlength","step","enterkeyhint","pattern","autocomplete","onKeyup","inputmode"]);return X("uni-input",{ref:c},[X("div",{class:"uni-input-wrapper"},[Su(X("div",di(f.attrs,{style:r.placeholderStyle,class:["uni-input-placeholder",r.placeholderClass]}),[r.placeholder],16),[[Mu,!(h.value.length||o.value==="-"||o.value.includes("."))]]),r.confirmType==="search"?X("form",{action:"",onSubmit:N=>N.preventDefault(),class:"uni-input-form"},[S],40,["onSubmit"]):S])],512)}}});function eu(r){const e=[];return it(r)&&r.forEach(t=>{qa(t)?t.type===Ht?e.push(...eu(t.children)):e.push(t):it(t)&&e.push(...eu(t))}),e}const vo=function(r,e,t,n){r.addEventListener(e,i=>{at(t)&&t(i)===!1&&((typeof i.cancelable=="undefined"||i.cancelable)&&i.preventDefault(),i.stopPropagation())},{passive:!1})};let tg,ng;function jP(r,e,t){$r(()=>{document.removeEventListener("mousemove",tg),document.removeEventListener("mouseup",ng)});let n=0,i=0,s=0,a=0;const o=function(d,m,y,T){if(e({cancelable:d.cancelable,target:d.target,currentTarget:d.currentTarget,preventDefault:d.preventDefault.bind(d),stopPropagation:d.stopPropagation.bind(d),touches:d.touches,changedTouches:d.changedTouches,detail:{state:m,x:y,y:T,dx:y-n,dy:T-i,ddx:y-s,ddy:T-a,timeStamp:d.timeStamp}})===!1)return!1};let l=null,c,u;vo(r,"touchstart",function(d){if(c=!0,d.touches.length===1&&!l)return l=d,n=s=d.touches[0].pageX,i=a=d.touches[0].pageY,o(d,"start",n,i)}),vo(r,"mousedown",function(d){if(u=!0,!c&&!l)return l=d,n=s=d.pageX,i=a=d.pageY,o(d,"start",n,i)}),vo(r,"touchmove",function(d){if(d.touches.length===1&&l){const m=o(d,"move",d.touches[0].pageX,d.touches[0].pageY);return s=d.touches[0].pageX,a=d.touches[0].pageY,m}});const h=tg=function(d){if(!c&&u&&l){const m=o(d,"move",d.pageX,d.pageY);return s=d.pageX,a=d.pageY,m}};document.addEventListener("mousemove",h),vo(r,"touchend",function(d){if(d.touches.length===0&&l)return c=!1,l=null,o(d,"end",d.changedTouches[0].pageX,d.changedTouches[0].pageY)});const f=ng=function(d){if(u=!1,!c&&l)return l=null,o(d,"end",d.pageX,d.pageY)};document.addEventListener("mouseup",f),vo(r,"touchcancel",function(d){if(l){c=!1;const m=l;return l=null,o(d,"cancel",m.touches[0].pageX,m.touches[0].pageY)}})}const WP={value:{type:Array,default(){return[]},validator:function(r){return it(r)&&r.filter(e=>typeof e=="number").length===r.length}},indicatorStyle:{type:String,default:""},indicatorClass:{type:String,default:""},maskStyle:{type:String,default:""},maskClass:{type:String,default:""}};function HP(r){const e=nn([...r.value]),t=nn({value:e,height:34});return Ge(()=>r.value,(n,i)=>{t.value.length=n.length,n.forEach((s,a)=>{s!==t.value[a]&&t.value.splice(a,1,s)})}),t}const QP=pi({name:"PickerView",props:WP,emits:["change","pickstart","pickend","update:value"],setup(r,{slots:e,emit:t}){const n=ge(null),i=ge(null),s=qu(n,t),a=HP(r),o=ge(null);gn(()=>{const d=o.value;d&&(a.height=d.$el.offsetHeight)});let c=ge([]),u=ge([]);function h(d){let m=u.value;m=m.filter(T=>T.type!==lr);let y=m.indexOf(d);return y!==-1?y:c.value.indexOf(d)}return Qr("getPickerViewColumn",function(d){return Me({get(){const y=h(d.vnode);return a.value[y]||0},set(y){const T=h(d.vnode);if(T<0)return;if(a.value[T]!==y){a.value[T]=y;const S=a.value.map(N=>N);t("update:value",S),s("change",{},{value:S})}}})}),Qr("pickerViewProps",r),Qr("pickerViewState",a),()=>{const d=e.default&&e.default();{const m=eu(d);c.value=m,bn(()=>{u.value=m})}return X("uni-picker-view",{ref:n},[X(wp,{ref:o,onResize:({height:m})=>a.height=m},null,8,["onResize"]),X("div",{ref:i,class:"uni-picker-view-wrapper"},[d],512)],512)}}});class _v{constructor(e){this._drag=e,this._dragLog=Math.log(e),this._x=0,this._v=0,this._startTime=0}set(e,t){this._x=e,this._v=t,this._startTime=new Date().getTime()}setVelocityByEnd(e){this._v=(e-this._x)*this._dragLog/(Math.pow(this._drag,100)-1)}x(e){e===void 0&&(e=(new Date().getTime()-this._startTime)/1e3);const t=e===this._dt&&this._powDragDt?this._powDragDt:this._powDragDt=Math.pow(this._drag,e);return this._dt=e,this._x+this._v*t/this._dragLog-this._v/this._dragLog}dx(e){e===void 0&&(e=(new Date().getTime()-this._startTime)/1e3);const t=e===this._dt&&this._powDragDt?this._powDragDt:this._powDragDt=Math.pow(this._drag,e);return this._dt=e,this._v*t}done(){return Math.abs(this.dx())<3}reconfigure(e){const t=this.x(),n=this.dx();this._drag=e,this._dragLog=Math.log(e),this.set(t,n)}configuration(){const e=this;return[{label:"Friction",read:function(){return e._drag},write:function(t){e.reconfigure(t)},min:.001,max:.1,step:.001}]}}function Sv(r,e,t){return r>e-t&&r<e+t}function Ns(r,e){return Sv(r,0,e)}class Cv{constructor(e,t,n){this._m=e,this._k=t,this._c=n,this._solution=null,this._endPosition=0,this._startTime=0}_solve(e,t){const n=this._c,i=this._m,s=this._k,a=n*n-4*i*s;if(a===0){const h=-n/(2*i),f=e,d=t/(h*e);return{x:function(m){return(f+d*m)*Math.pow(Math.E,h*m)},dx:function(m){const y=Math.pow(Math.E,h*m);return h*(f+d*m)*y+d*y}}}if(a>0){const h=(-n-Math.sqrt(a))/(2*i),f=(-n+Math.sqrt(a))/(2*i),d=(t-h*e)/(f-h),m=e-d;return{x:function(y){let T,b;return y===this._t&&(T=this._powER1T,b=this._powER2T),this._t=y,T||(T=this._powER1T=Math.pow(Math.E,h*y)),b||(b=this._powER2T=Math.pow(Math.E,f*y)),m*T+d*b},dx:function(y){let T,b;return y===this._t&&(T=this._powER1T,b=this._powER2T),this._t=y,T||(T=this._powER1T=Math.pow(Math.E,h*y)),b||(b=this._powER2T=Math.pow(Math.E,f*y)),m*h*T+d*f*b}}}const o=Math.sqrt(4*i*s-n*n)/(2*i),l=-n/2*i,c=e,u=(t-l*e)/o;return{x:function(h){return Math.pow(Math.E,l*h)*(c*Math.cos(o*h)+u*Math.sin(o*h))},dx:function(h){const f=Math.pow(Math.E,l*h),d=Math.cos(o*h),m=Math.sin(o*h);return f*(u*o*d-c*o*m)+l*f*(u*m+c*d)}}}x(e){return e===void 0&&(e=(new Date().getTime()-this._startTime)/1e3),this._solution?this._endPosition+this._solution.x(e):0}dx(e){return e===void 0&&(e=(new Date().getTime()-this._startTime)/1e3),this._solution?this._solution.dx(e):0}setEnd(e,t,n){if(n||(n=new Date().getTime()),e!==this._endPosition||!Ns(t,.4)){t=t||0;let i=this._endPosition;this._solution&&(Ns(t,.4)&&(t=this._solution.dx((n-this._startTime)/1e3)),i=this._solution.x((n-this._startTime)/1e3),Ns(t,.4)&&(t=0),Ns(i,.4)&&(i=0),i+=this._endPosition),this._solution&&Ns(i-e,.4)&&Ns(t,.4)||(this._endPosition=e,this._solution=this._solve(i-this._endPosition,t),this._startTime=n)}}snap(e){this._startTime=new Date().getTime(),this._endPosition=e,this._solution={x:function(){return 0},dx:function(){return 0}}}done(e){return e||(e=new Date().getTime()),Sv(this.x(),this._endPosition,.4)&&Ns(this.dx(),.4)}reconfigure(e,t,n){this._m=e,this._k=t,this._c=n,this.done()||(this._solution=this._solve(this.x()-this._endPosition,this.dx()),this._startTime=new Date().getTime())}springConstant(){return this._k}damping(){return this._c}configuration(){function e(n,i){n.reconfigure(1,i,n.damping())}function t(n,i){n.reconfigure(1,n.springConstant(),i)}return[{label:"Spring Constant",read:this.springConstant.bind(this),write:e.bind(this,this),min:100,max:1e3},{label:"Damping",read:this.damping.bind(this),write:t.bind(this,this),min:1,max:500}]}}class zP{constructor(e,t,n){this._extent=e,this._friction=t||new _v(.01),this._spring=n||new Cv(1,90,20),this._startTime=0,this._springing=!1,this._springOffset=0}snap(e,t){this._springOffset=0,this._springing=!0,this._spring.snap(e),this._spring.setEnd(t)}set(e,t){this._friction.set(e,t),e>0&&t>=0?(this._springOffset=0,this._springing=!0,this._spring.snap(e),this._spring.setEnd(0)):e<-this._extent&&t<=0?(this._springOffset=0,this._springing=!0,this._spring.snap(e),this._spring.setEnd(-this._extent)):this._springing=!1,this._startTime=new Date().getTime()}x(e){if(!this._startTime)return 0;if(e||(e=(new Date().getTime()-this._startTime)/1e3),this._springing)return this._spring.x()+this._springOffset;let t=this._friction.x(e),n=this.dx(e);return(t>0&&n>=0||t<-this._extent&&n<=0)&&(this._springing=!0,this._spring.setEnd(0,n),t<-this._extent?this._springOffset=-this._extent:this._springOffset=0,t=this._spring.x()+this._springOffset),t}dx(e){let t;return this._lastTime===e?t=this._lastDx:t=this._springing?this._spring.dx(e):this._friction.dx(e),this._lastTime=e,this._lastDx=t,t}done(){return this._springing?this._spring.done():this._friction.done()}setVelocityByEnd(e){this._friction.setVelocityByEnd(e)}configuration(){const e=this._friction.configuration();return e.push.apply(e,this._spring.configuration()),e}}function GP(r,e,t){const n={id:0,cancelled:!1};function i(a,o,l,c){if(!a||!a.cancelled){l(o);const u=o.done();u||a.cancelled||(a.id=requestAnimationFrame(i.bind(null,a,o,l,c))),u&&c&&c(o)}}function s(a){a&&a.id&&cancelAnimationFrame(a.id),a&&(a.cancelled=!0)}return i(n,r,e,t),{cancel:s.bind(null,n),model:r}}class KP{constructor(e,t){t=t||{},this._element=e,this._options=t,this._enableSnap=t.enableSnap||!1,this._itemSize=t.itemSize||0,this._enableX=t.enableX||!1,this._enableY=t.enableY||!1,this._shouldDispatchScrollEvent=!!t.onScroll,this._enableX?(this._extent=(t.scrollWidth||this._element.offsetWidth)-this._element.parentElement.offsetWidth,this._scrollWidth=t.scrollWidth):(this._extent=(t.scrollHeight||this._element.offsetHeight)-this._element.parentElement.offsetHeight,this._scrollHeight=t.scrollHeight),this._position=0,this._scroll=new zP(this._extent,t.friction,t.spring),this._onTransitionEnd=this.onTransitionEnd.bind(this),this.updatePosition()}onTouchStart(){this._startPosition=this._position,this._lastChangePos=this._startPosition,this._startPosition>0?this._startPosition/=.5:this._startPosition<-this._extent&&(this._startPosition=(this._startPosition+this._extent)/.5-this._extent),this._animation&&(this._animation.cancel(),this._scrolling=!1),this.updatePosition()}onTouchMove(e,t){let n=this._startPosition;this._enableX?n+=e:this._enableY&&(n+=t),n>0?n*=.5:n<-this._extent&&(n=.5*(n+this._extent)-this._extent),this._position=n,this.updatePosition(),this.dispatchScroll()}onTouchEnd(e,t,n){if(this._enableSnap&&this._position>-this._extent&&this._position<0){if(this._enableY&&(Math.abs(t)<this._itemSize&&Math.abs(n.y)<300||Math.abs(n.y)<150)){this.snap();return}if(this._enableX&&(Math.abs(e)<this._itemSize&&Math.abs(n.x)<300||Math.abs(n.x)<150)){this.snap();return}}this._enableX?this._scroll.set(this._position,n.x):this._enableY&&this._scroll.set(this._position,n.y);let i;if(this._enableSnap){const s=this._scroll._friction.x(100),a=s%this._itemSize;i=Math.abs(a)>this._itemSize/2?s-(this._itemSize-Math.abs(a)):s-a,i<=0&&i>=-this._extent&&this._scroll.setVelocityByEnd(i)}this._lastTime=Date.now(),this._lastDelay=0,this._scrolling=!0,this._lastChangePos=this._position,this._lastIdx=Math.floor(Math.abs(this._position/this._itemSize)),this._animation=GP(this._scroll,()=>{const s=Date.now(),a=(s-this._scroll._startTime)/1e3,o=this._scroll.x(a);this._position=o,this.updatePosition();const l=this._scroll.dx(a);this._shouldDispatchScrollEvent&&s-this._lastTime>this._lastDelay&&(this.dispatchScroll(),this._lastDelay=Math.abs(2e3/l),this._lastTime=s)},()=>{this._enableSnap&&(i<=0&&i>=-this._extent&&(this._position=i,this.updatePosition()),at(this._options.onSnap)&&this._options.onSnap(Math.floor(Math.abs(this._position)/this._itemSize))),this._shouldDispatchScrollEvent&&this.dispatchScroll(),this._scrolling=!1})}onTransitionEnd(){this._element.style.webkitTransition="",this._element.style.transition="",this._element.removeEventListener("transitionend",this._onTransitionEnd),this._snapping&&(this._snapping=!1),this.dispatchScroll()}snap(){const e=this._itemSize,t=this._position%e,n=Math.abs(t)>this._itemSize/2?this._position-(e-Math.abs(t)):this._position-t;this._position!==n&&(this._snapping=!0,this.scrollTo(-n),at(this._options.onSnap)&&this._options.onSnap(Math.floor(Math.abs(this._position)/this._itemSize)))}scrollTo(e,t){this._animation&&(this._animation.cancel(),this._scrolling=!1),typeof e=="number"&&(this._position=-e),this._position<-this._extent?this._position=-this._extent:this._position>0&&(this._position=0);const n="transform "+(t||.2)+"s ease-out";this._element.style.webkitTransition="-webkit-"+n,this._element.style.transition=n,this.updatePosition(),this._element.addEventListener("transitionend",this._onTransitionEnd)}dispatchScroll(){if(at(this._options.onScroll)&&Math.round(Number(this._lastPos))!==Math.round(this._position)){this._lastPos=this._position;const e={target:{scrollLeft:this._enableX?-this._position:0,scrollTop:this._enableY?-this._position:0,scrollHeight:this._scrollHeight||this._element.offsetHeight,scrollWidth:this._scrollWidth||this._element.offsetWidth,offsetHeight:this._element.parentElement.offsetHeight,offsetWidth:this._element.parentElement.offsetWidth}};this._options.onScroll(e)}}update(e,t,n){let i=0;const s=this._position;this._enableX?(i=this._element.childNodes.length?(t||this._element.offsetWidth)-this._element.parentElement.offsetWidth:0,this._scrollWidth=t):(i=this._element.childNodes.length?(t||this._element.offsetHeight)-this._element.parentElement.offsetHeight:0,this._scrollHeight=t),typeof e=="number"&&(this._position=-e),this._position<-i?this._position=-i:this._position>0&&(this._position=0),this._itemSize=n||this._itemSize,this.updatePosition(),s!==this._position&&(this.dispatchScroll(),at(this._options.onSnap)&&this._options.onSnap(Math.floor(Math.abs(this._position)/this._itemSize))),this._extent=i,this._scroll._extent=i}updatePosition(){let e="";this._enableX?e="translateX("+this._position+"px) translateZ(0)":this._enableY&&(e="translateY("+this._position+"px) translateZ(0)"),this._element.style.webkitTransform=e,this._element.style.transform=e}isScrolling(){return this._scrolling||this._snapping}}function YP(r,e){const t={trackingID:-1,maxDy:0,maxDx:0},n=new KP(r,e);function i(l){const c=l,u=l;return c.detail.state==="move"||c.detail.state==="end"?{x:c.detail.dx,y:c.detail.dy}:{x:u.screenX-t.x,y:u.screenY-t.y}}function s(l){const c=l,u=l;c.detail.state==="start"?(t.trackingID="touch",t.x=c.detail.x,t.y=c.detail.y):(t.trackingID="mouse",t.x=u.screenX,t.y=u.screenY),t.maxDx=0,t.maxDy=0,t.historyX=[0],t.historyY=[0],t.historyTime=[c.detail.timeStamp||u.timeStamp],t.listener=n,n.onTouchStart&&n.onTouchStart(),(typeof l.cancelable!="boolean"||l.cancelable)&&l.preventDefault()}function a(l){const c=l,u=l;if(t.trackingID!==-1){(typeof l.cancelable!="boolean"||l.cancelable)&&l.preventDefault();const h=i(l);if(h){for(t.maxDy=Math.max(t.maxDy,Math.abs(h.y)),t.maxDx=Math.max(t.maxDx,Math.abs(h.x)),t.historyX.push(h.x),t.historyY.push(h.y),t.historyTime.push(c.detail.timeStamp||u.timeStamp);t.historyTime.length>10;)t.historyTime.shift(),t.historyX.shift(),t.historyY.shift();t.listener&&t.listener.onTouchMove&&t.listener.onTouchMove(h.x,h.y)}}}function o(l){if(t.trackingID!==-1){l.preventDefault();const c=i(l);if(c){const u=t.listener;t.trackingID=-1,t.listener=null;const h=t.historyTime.length,f={x:0,y:0};if(h>2)for(let d=t.historyTime.length-1,m=t.historyTime[d],y=t.historyX[d],T=t.historyY[d];d>0;){d--;const b=t.historyTime[d],S=m-b;if(S>30&&S<50){f.x=(y-t.historyX[d])/(S/1e3),f.y=(T-t.historyY[d])/(S/1e3);break}}t.historyTime=[],t.historyX=[],t.historyY=[],u&&u.onTouchEnd&&u.onTouchEnd(c.x,c.y,f)}}}return{scroller:n,handleTouchStart:s,handleTouchMove:a,handleTouchEnd:o}}function JP(r){let t=0,n=0;r.addEventListener("touchstart",i=>{const s=i.changedTouches[0];t=s.clientX,n=s.clientY}),r.addEventListener("touchend",i=>{const s=i.changedTouches[0];if(Math.abs(s.clientX-t)<20&&Math.abs(s.clientY-n)<20){const a={bubbles:!0,cancelable:!0,target:i.target,currentTarget:i.currentTarget},o=new CustomEvent("click",a);["screenX","screenY","clientX","clientY","pageX","pageY"].forEach(c=>{o[c]=s[c]}),i.target.dispatchEvent(o)}})}const XP=pi({name:"PickerViewColumn",setup(r,{slots:e,emit:t}){const n=ge(null),i=ge(null),s=on("getPickerViewColumn"),a=Cn(),o=s?s(a):ge(0),l=on("pickerViewProps"),c=on("pickerViewState"),u=ge(34),h=ge(null);gn(()=>{const Q=h.value;u.value=Q.$el.offsetHeight});const d=Me(()=>(c.height-u.value)/2),{state:m}=Tv();let y;const T=nn({current:o.value,length:0});let b;function S(){y&&!b&&(b=!0,bn(()=>{b=!1;let Q=Math.min(T.current,T.length-1);Q=Math.max(Q,0),y.update(Q*u.value,void 0,u.value)}))}Ge(()=>o.value,Q=>{Q!==T.current&&(T.current=Q,S())}),Ge(()=>T.current,Q=>o.value=Q),Ge([()=>u.value,()=>T.length,()=>c.height],S);let N=0;function C(Q){const te=N+Q.deltaY;if(Math.abs(te)>10){N=0;let V=Math.min(T.current+(te<0?-1:1),T.length-1);T.current=V=Math.max(V,0),y.scrollTo(V*u.value)}else N=te;Q.preventDefault()}function I({clientY:Q}){const te=n.value;if(!y.isScrolling()){const V=te.getBoundingClientRect(),J=Q-V.top-c.height/2,E=u.value/2;if(!(Math.abs(J)<=E)){const A=Math.ceil((Math.abs(J)-E)/u.value),x=J<0?-A:A;let $=Math.min(T.current+x,T.length-1);T.current=$=Math.max($,0),y.scrollTo($*u.value)}}}return gn(()=>{const Q=n.value,te=i.value,{scroller:V,handleTouchStart:J,handleTouchMove:E,handleTouchEnd:A}=YP(te,{enableY:!0,enableX:!1,enableSnap:!0,itemSize:u.value,friction:new _v(1e-4),spring:new Cv(2,90,20),onSnap:x=>{!isNaN(x)&&x!==T.current&&(T.current=x)}});y=V,jP(Q,x=>{switch(x.detail.state){case"start":J(x);break;case"move":E(x),x.stopPropagation();break;case"end":case"cancel":A(x)}}),JP(Q),S()}),()=>{const Q=e.default&&e.default();T.length=eu(Q).length;const te=`${d.value}px 0`;return X("uni-picker-view-column",{ref:n},[X("div",{onWheel:C,onClick:I,class:"uni-picker-view-group"},[X("div",di(m.attrs,{class:["uni-picker-view-mask",l.maskClass],style:`background-size: 100% ${d.value}px;${l.maskStyle}`}),null,16),X("div",di(m.attrs,{class:["uni-picker-view-indicator",l.indicatorClass],style:l.indicatorStyle}),[X(wp,{ref:h,onResize:({height:V})=>u.value=V},null,8,["onResize"])],16),X("div",{ref:i,class:["uni-picker-view-content"],style:{padding:te,"--picker-view-column-indicator-height":`${u.value}px`}},[Q],4)],40,["onWheel","onClick"])],512)}}}),ZP=pi({name:"Refresher",props:{refreshState:{type:String,default:""},refresherHeight:{type:Number,default:0},refresherThreshold:{type:Number,default:45},refresherDefaultStyle:{type:String,default:"black"},refresherBackground:{type:String,default:"#fff"}},setup(r,{slots:e}){const t=ge(null),n=Me(()=>{const s={backgroundColor:r.refresherBackground};switch(r.refreshState){case"pulling":s.height=r.refresherHeight+"px";break;case"refreshing":s.height=r.refresherThreshold+"px",s.transition="height 0.3s";break;case"":case"refresherabort":case"restore":s.height="0px",s.transition="height 0.3s";break}return s}),i=Me(()=>{const s=r.refresherHeight/r.refresherThreshold;return(s>1?1:s)*360});return()=>{const{refreshState:s,refresherDefaultStyle:a,refresherThreshold:o}=r;return X("div",{ref:t,style:n.value,class:"uni-scroll-view-refresher"},[a!=="none"?X("div",{class:"uni-scroll-view-refresh"},[X("div",{class:"uni-scroll-view-refresh-inner"},[s=="pulling"?X("svg",{key:"refresh__icon",style:{transform:"rotate("+i.value+"deg)"},fill:"#2BD009",class:"uni-scroll-view-refresh__icon",width:"24",height:"24",viewBox:"0 0 24 24"},[X("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},null),X("path",{d:"M0 0h24v24H0z",fill:"none"},null)],4):null,s=="refreshing"?X("svg",{key:"refresh__spinner",class:"uni-scroll-view-refresh__spinner",width:"24",height:"24",viewBox:"25 25 50 50"},[X("circle",{cx:"50",cy:"50",r:"20",fill:"none",style:"color: #2bd009","stroke-width":"3"},null)]):null])]):null,a==="none"?X("div",{class:"uni-scroll-view-refresher-container",style:{height:`${o}px`}},[e.default&&e.default()]):null],4)}}}),rg=el(!0),eI={direction:{type:[String],default:"vertical"},scrollX:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},showScrollbar:{type:[Boolean,String],default:!0},upperThreshold:{type:[Number,String],default:50},lowerThreshold:{type:[Number,String],default:50},scrollTop:{type:[Number,String],default:0},scrollLeft:{type:[Number,String],default:0},scrollIntoView:{type:String,default:""},scrollWithAnimation:{type:[Boolean,String],default:!1},enableBackToTop:{type:[Boolean,String],default:!1},refresherEnabled:{type:[Boolean,String],default:!1},refresherThreshold:{type:Number,default:45},refresherDefaultStyle:{type:String,default:"black"},refresherBackground:{type:String,default:"#fff"},refresherTriggered:{type:[Boolean,String],default:!1}},Tp=pi({name:"ScrollView",compatConfig:{MODE:3},props:eI,emits:["scroll","scrolltoupper","scrolltolower","refresherrefresh","refresherrestore","refresherpulling","refresherabort","update:refresherTriggered"],setup(r,{emit:e,slots:t,expose:n}){const i=ge(null),s=ge(null),a=ge(null),o=ge(null),l=qu(i,e),{state:c,scrollTopNumber:u,scrollLeftNumber:h}=tI(r),{realScrollX:f,realScrollY:d}=nI(r,c,u,h,l,i,s,o,e),m=Me(()=>{let T="";return f.value?T+="overflow-x:auto;":T+="overflow-x:hidden;",d.value?T+="overflow-y:auto;":T+="overflow-y:hidden;",T}),y=Me(()=>{let T="uni-scroll-view";return r.showScrollbar===!1&&(T+=" uni-scroll-view-scrollbar-hidden"),T});return n({$getMain(){return s.value}}),()=>{const{refresherEnabled:T,refresherBackground:b,refresherDefaultStyle:S,refresherThreshold:N}=r,{refresherHeight:C,refreshState:I}=c;return X("uni-scroll-view",{ref:i},[X("div",{ref:a,class:"uni-scroll-view"},[X("div",{ref:s,style:m.value,class:y.value},[T?X(ZP,{refreshState:I,refresherHeight:C,refresherThreshold:N,refresherDefaultStyle:S,refresherBackground:b},{default:()=>[S=="none"?t.refresher&&t.refresher():null]},8,["refreshState","refresherHeight","refresherThreshold","refresherDefaultStyle","refresherBackground"]):null,X("div",{ref:o,class:"uni-scroll-view-content"},[t.default&&t.default()],512)],6)],512)],512)}}});function tI(r){const e=Me(()=>Number(r.scrollTop)||0),t=Me(()=>Number(r.scrollLeft)||0);return{state:nn({lastScrollTop:e.value,lastScrollLeft:t.value,lastScrollToUpperTime:0,lastScrollToLowerTime:0,refresherHeight:0,refreshState:""}),scrollTopNumber:e,scrollLeftNumber:t}}function nI(r,e,t,n,i,s,a,o,l){let c=!1,u=0,h=!1,f=()=>{};const d=Me(()=>r.scrollX),m=Me(()=>r.scrollY),y=Me(()=>{let J=Number(r.upperThreshold);return isNaN(J)?50:J}),T=Me(()=>{let J=Number(r.lowerThreshold);return isNaN(J)?50:J});function b(J,E){const A=a.value;let x=0,$="";if(J<0?J=0:E==="x"&&J>A.scrollWidth-A.offsetWidth?J=A.scrollWidth-A.offsetWidth:E==="y"&&J>A.scrollHeight-A.offsetHeight&&(J=A.scrollHeight-A.offsetHeight),E==="x"?x=A.scrollLeft-J:E==="y"&&(x=A.scrollTop-J),x===0)return;let B=o.value;B.style.transition="transform .3s ease-out",B.style.webkitTransition="-webkit-transform .3s ease-out",E==="x"?$="translateX("+x+"px) translateZ(0)":E==="y"&&($="translateY("+x+"px) translateZ(0)"),B.removeEventListener("transitionend",f),B.removeEventListener("webkitTransitionEnd",f),f=()=>H(J,E),B.addEventListener("transitionend",f),B.addEventListener("webkitTransitionEnd",f),E==="x"?A.style.overflowX="hidden":E==="y"&&(A.style.overflowY="hidden"),B.style.transform=$,B.style.webkitTransform=$}function S(J){const E=J.target;i("scroll",J,{scrollLeft:E.scrollLeft,scrollTop:E.scrollTop,scrollHeight:E.scrollHeight,scrollWidth:E.scrollWidth,deltaX:e.lastScrollLeft-E.scrollLeft,deltaY:e.lastScrollTop-E.scrollTop}),m.value&&(E.scrollTop<=y.value&&e.lastScrollTop-E.scrollTop>0&&J.timeStamp-e.lastScrollToUpperTime>200&&(i("scrolltoupper",J,{direction:"top"}),e.lastScrollToUpperTime=J.timeStamp),E.scrollTop+E.offsetHeight+T.value>=E.scrollHeight&&e.lastScrollTop-E.scrollTop<0&&J.timeStamp-e.lastScrollToLowerTime>200&&(i("scrolltolower",J,{direction:"bottom"}),e.lastScrollToLowerTime=J.timeStamp)),d.value&&(E.scrollLeft<=y.value&&e.lastScrollLeft-E.scrollLeft>0&&J.timeStamp-e.lastScrollToUpperTime>200&&(i("scrolltoupper",J,{direction:"left"}),e.lastScrollToUpperTime=J.timeStamp),E.scrollLeft+E.offsetWidth+T.value>=E.scrollWidth&&e.lastScrollLeft-E.scrollLeft<0&&J.timeStamp-e.lastScrollToLowerTime>200&&(i("scrolltolower",J,{direction:"right"}),e.lastScrollToLowerTime=J.timeStamp)),e.lastScrollTop=E.scrollTop,e.lastScrollLeft=E.scrollLeft}function N(J){m.value&&(r.scrollWithAnimation?b(J,"y"):a.value.scrollTop=J)}function C(J){d.value&&(r.scrollWithAnimation?b(J,"x"):a.value.scrollLeft=J)}function I(J){if(J){if(!/^[_a-zA-Z][-_a-zA-Z0-9:]*$/.test(J))return;let E=s.value.querySelector("#"+J);if(E){let A=a.value.getBoundingClientRect(),x=E.getBoundingClientRect();if(d.value){let $=x.left-A.left,K=a.value.scrollLeft+$;r.scrollWithAnimation?b(K,"x"):a.value.scrollLeft=K}if(m.value){let $=x.top-A.top,K=a.value.scrollTop+$;r.scrollWithAnimation?b(K,"y"):a.value.scrollTop=K}}}}function H(J,E){o.value.style.transition="",o.value.style.webkitTransition="",o.value.style.transform="",o.value.style.webkitTransform="";let A=a.value;E==="x"?(A.style.overflowX=d.value?"auto":"hidden",A.scrollLeft=J):E==="y"&&(A.style.overflowY=m.value?"auto":"hidden",A.scrollTop=J),o.value.removeEventListener("transitionend",f),o.value.removeEventListener("webkitTransitionEnd",f)}function Q(J){if(r.refresherEnabled){switch(J){case"refreshing":e.refresherHeight=r.refresherThreshold,c||(c=!0,i("refresherpulling",{},{deltaY:e.refresherHeight,dy:e.refresherHeight}),i("refresherrefresh",{},{dy:V.y-te.y}),l("update:refresherTriggered",!0));break;case"restore":case"refresherabort":c=!1,e.refresherHeight=u=0,J==="restore"&&(h=!1,i("refresherrestore",{},{dy:V.y-te.y})),J==="refresherabort"&&h&&(h=!1,i("refresherabort",{},{dy:V.y-te.y}));break}e.refreshState=J}}let te={x:0,y:0},V={y:r.refresherThreshold};return gn(()=>{bn(()=>{N(t.value),C(n.value)}),I(r.scrollIntoView);let J=function(B){B.preventDefault(),B.stopPropagation(),S(B)},E=null,A=function(B){if(te===null)return;let K=B.touches[0].pageX,ae=B.touches[0].pageY,ue=a.value;if(Math.abs(K-te.x)>Math.abs(ae-te.y))if(d.value){if(ue.scrollLeft===0&&K>te.x){E=!1;return}else if(ue.scrollWidth===ue.offsetWidth+ue.scrollLeft&&K<te.x){E=!1;return}E=!0}else E=!1;else if(m.value)if(ue.scrollTop===0&&ae>te.y)E=!1,r.refresherEnabled&&B.cancelable!==!1&&B.preventDefault();else if(ue.scrollHeight===ue.offsetHeight+ue.scrollTop&&ae<te.y){E=!1;return}else E=!0;else E=!1;if(E&&B.stopPropagation(),ue.scrollTop===0&&B.touches.length===1&&Q("pulling"),r.refresherEnabled&&e.refreshState==="pulling"){const L=ae-te.y;u===0&&(u=ae),c?(e.refresherHeight=L+r.refresherThreshold,h=!1):(e.refresherHeight=ae-u,e.refresherHeight>0&&(h=!0,i("refresherpulling",B,{deltaY:L,dy:L})))}},x=function(B){B.touches.length===1&&(te={x:B.touches[0].pageX,y:B.touches[0].pageY})},$=function(B){V={x:B.changedTouches[0].pageX,y:B.changedTouches[0].pageY},e.refresherHeight>=r.refresherThreshold?Q("refreshing"):Q("refresherabort"),te={x:0,y:0},V={x:0,y:r.refresherThreshold}};a.value.addEventListener("touchstart",x,rg),a.value.addEventListener("touchmove",A,el(!1)),a.value.addEventListener("scroll",J,el(!1)),a.value.addEventListener("touchend",$,rg),$r(()=>{a.value.removeEventListener("touchstart",x),a.value.removeEventListener("touchmove",A),a.value.removeEventListener("scroll",J),a.value.removeEventListener("touchend",$)})}),Cu(()=>{m.value&&(a.value.scrollTop=e.lastScrollTop),d.value&&(a.value.scrollLeft=e.lastScrollLeft)}),Ge(t,J=>{N(J)}),Ge(n,J=>{C(J)}),Ge(()=>r.scrollIntoView,J=>{I(J)}),Ge(()=>r.refresherTriggered,J=>{J===!0?Q("refreshing"):J===!1&&Q("restore")}),{realScrollX:d,realScrollY:m,_scrollTopChanged:N,_scrollLeftChanged:C}}const To={ensp:" ",emsp:" ",nbsp:" "};function rI(r,{space:e,decode:t}){let n="",i=!1;for(let s of r)e&&To[e]&&s===" "&&(s=To[e]),i?(s==="n"?n+=Hd:s==="\\"?n+="\\":n+="\\"+s,i=!1):s==="\\"?i=!0:n+=s;return t?n.replace(/&nbsp;/g,To.nbsp).replace(/&ensp;/g,To.ensp).replace(/&emsp;/g,To.emsp).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'"):n}function iI(r,e){return rI(r,e).split(Hd)}const ju=pi({name:"Text",props:{selectable:{type:[Boolean,String],default:!1},space:{type:String,default:""},decode:{type:[Boolean,String],default:!1}},setup(r,{slots:e}){const t=ge(null);return()=>{const n=[];return e.default&&e.default().forEach(i=>{if(i.shapeFlag&8&&i.type!==lr){const s=iI(i.children,{space:r.space,decode:r.decode}),a=s.length-1;s.forEach((o,l)=>{l===0&&!o||n.push(Ze(o)),l!==a&&n.push(X("br"))})}else n.push(i)}),X("uni-text",{ref:t,selectable:r.selectable?!0:null},[X("span",null,n)],8,["selectable"])}}}),Yt=pi({name:"View",props:Ct({},pR),setup(r,{slots:e}){const t=ge(null),{hovering:n,binding:i}=B0(r);return()=>{const s=r.hoverClass;return s&&s!=="none"?X("uni-view",di({class:n.value?s:"",ref:t},i),[Bt(e,"default")],16):X("uni-view",{ref:t},[Bt(e,"default")],512)}}});function ig(r,e,t,n){at(e)&&zs(r,e.bind(t),n)}function sI(r,e,t){const n=r.mpType||t.$mpType;if(!(!n||n==="component"||n==="page"&&e.renderer==="component")&&(Object.keys(r).forEach(i=>{if(rC(i,r[i],!1)){const s=r[i];it(s)?s.forEach(a=>ig(i,a,t,e)):ig(i,s,t,e)}}),n==="page")){e.__isVisible=!0;try{let i=e.attrs.__pageQuery;dr(t,Ka,i),delete e.attrs.__pageQuery;const s=t.$page;(s==null?void 0:s.openType)!=="preloadPage"&&dr(t,hs)}catch(i){}}}function aI(r,e,t){sI(r,e,t)}function oI(r,e,t){return r[e]=t}function lI(r,...e){const t=this[r];return t?t(...e):null}function cI(r){const e=r.config.errorHandler;return function(n,i,s){e&&e(n,i,s);const a=r._instance;if(!a||!a.proxy)throw n;a[Bc]?dr(a.proxy,Bc,n):(i&&i.$.vnode,void 0)}}function uI(r,e){return r?[...new Set([].concat(r,e))]:e}function hI(r){tw.forEach(e=>{r[e]=uI})}function fI(r){const e=r.config;e.errorHandler=aC(r,cI),hI(e.optionMergeStrategies);const t=e.globalProperties;t.$set=oI,t.$applyOptions=aI,t.$callMethod=lI,sC(r)}function dI(r){const e=R1(gI());e.beforeEach((t,n)=>{t&&n&&t.meta.isTabBar&&n.meta.isTabBar&&mI(n.meta.tabBarIndex)}),r.router=e,r.use(e)}let Nv=Object.create(null);function pI(r){return Nv[r]}function mI(r){typeof window!="undefined"&&(Nv[r]={left:window.pageXOffset,top:window.pageYOffset})}const yI=(r,e,t)=>{if(t)return t;if(r&&e&&r.meta.isTabBar&&e.meta.isTabBar){const n=pI(r.meta.tabBarIndex);if(n)return n}return{left:0,top:0}};function gI(){return{history:EI(),strict:!!__uniConfig.router.strict,routes:__uniRoutes,scrollBehavior:yI}}function bI(r=1){const e=_l(),t=e.length-1,n=t-r;for(let i=t;i>n;i--){const s=Ks(e[i]);Uu(Vu(s.path,s.id),!1)}}function EI(){let{routerBase:r}=__uniConfig.router;r==="/"&&(r="");const e=s1(r);return e.listen((t,n,i)=>{i.direction==="back"&&bI(Math.abs(i.delta))}),e}const wI={install(r){fI(r),Hx(r),lR(r),r.config.warnHandler||(r.config.warnHandler=vI),dI(r)}};function vI(r,e,t){if(e){if(e.$.type.name==="PageMetaHead")return;const s=e.$.parent;if(s&&s.type.name==="PageMeta")return}const n=[`[Vue warn]: ${r}`];t.length&&n.push(`
`,t)}const TI={class:"uni-async-loading"},_I=X("i",{class:"uni-loading"},null,-1),Qh=Za({name:"AsyncLoading",render(){return _e(),Ne("div",TI,[_I])}});function SI(){window.location.reload()}const zh=Za({name:"AsyncError",props:["error"],setup(){Y1();const{t:r}=_n();return()=>X("div",{class:"uni-async-error",onClick:SI},[r("uni.async.error")],8,["onClick"])}});let pa;function Sr(){return pa}function CI(r){pa=r,Object.defineProperty(pa.$.ctx,"$children",{get(){return _l().map(t=>t.$vm)}});const e=pa.$.appContext.app;e.component(Qh.name)||e.component(Qh.name,Qh),e.component(zh.name)||e.component(zh.name,zh),iR(pa),cR(pa),rR(),Px()}function sg(r,{clone:e,init:t,setup:n,before:i}){e&&(r=Ct({},r)),i&&i(r);const s=r.setup;return r.setup=(a,o)=>{const l=Cn();if(t(l.proxy),n(l),s)return s(a,o)},r}function Av(r,e){return r&&(r.__esModule||r[Symbol.toStringTag]==="Module")?sg(r.default,e):sg(r,e)}function Sl(r){return Av(r,{clone:!0,init:zM,setup(e){e.$pageInstance=e;const t=ku(),n=XE(t.query);e.attrs.__pageQuery=n,Ks(e.proxy).options=n,e.proxy.options=n;const i=j0();return fv(),e.onReachBottom=nn([]),e.onPageScroll=nn([]),Ge([e.onReachBottom,e.onPageScroll],()=>{const s=Gs();e.proxy===s&&pv(e,i)},{once:!0}),Xr(()=>{Gy(e,i)}),gn(()=>{JM(e);const{onReady:s}=e;s&&fr(s),ag(t)}),rN(()=>{if(!e.__isVisible){Gy(e,i),e.__isVisible=!0;const{onShow:s}=e;s&&fr(s),bn(()=>{ag(t)})}}),iN(()=>{if(e.__isVisible&&!e.__isUnload){e.__isVisible=!1;{const{onHide:s}=e;s&&fr(s)}}}),nx(i.id),$r(()=>{rx(i.id)}),n}})}function NI(r){return Av(r,{init:CI,setup(e){const t=ku(),n=()=>{XR(e);const{onLaunch:i,onShow:s,onPageNotFound:a}=e,o=t.path.slice(1),l=lP({path:o||__uniRoutes[0].meta.route,query:XE(t.query)});if(i&&fr(i,l),s&&fr(s,l),!t.matched.length){const c={notFound:!0,openType:"appLaunch",path:t.path,query:{},scene:1001};uv(),a&&fr(a,c)}};return P1().isReady().then(n),gn(()=>{window.addEventListener("resize",ZE(AI,50,{setTimeout,clearTimeout})),window.addEventListener("message",xI),document.addEventListener("visibilitychange",RI),MI()}),t.query},before(e){e.mpType="app";const{setup:t}=e,n=()=>(_e(),Ne(lO));e.setup=(i,s)=>{const a=t&&t(i,s);return at(a)?n:a},e.render=n}})}function AI(){const{windowWidth:r,windowHeight:e,screenWidth:t,screenHeight:n}=Hu(),s=Math.abs(Number(window.orientation))===90?"landscape":"portrait";rr.emit(Eu,{deviceOrientation:s,size:{windowWidth:r,windowHeight:e,screenWidth:t,screenHeight:n}})}function xI(r){In(r.data)&&r.data.type===OS&&rr.emit(qS,r.data.data,r.data.pageId)}function RI(){const{emit:r}=rr;document.visibilityState==="visible"?r(zE,oP()):r(GE)}function MI(){let r=null;try{r=window.matchMedia("(prefers-color-scheme: dark)")}catch(e){}if(r){let e=t=>{rr.emit(bu,{theme:t.matches?"dark":"light"})};r.addEventListener?r.addEventListener("change",e):r.addListener(e)}}function ag(r){const{tabBarText:e,tabBarIndex:t,route:n}=r.meta;e&&dr("onTabItemTap",{index:t,text:e,pagePath:n})}const og="__DC_STAT_UUID",lg=navigator.cookieEnabled&&(window.localStorage||window.sessionStorage)||{};let sa;function PI(){if(sa=sa||lg[og],!sa){sa=Date.now()+""+Math.floor(Math.random()*1e7);try{lg[og]=sa}catch(r){}}return sa}function II(){const r=navigator.userAgent,e=r.indexOf("compatible")>-1&&r.indexOf("MSIE")>-1,t=r.indexOf("Edge")>-1&&!e,n=r.indexOf("Trident")>-1&&r.indexOf("rv:11.0")>-1;if(e){new RegExp("MSIE (\\d+\\.\\d+);").test(r);const s=parseFloat(RegExp.$1);return s>6?s:6}else return t?-1:n?11:-1}function xv(){if(__uniConfig.darkmode!==!0)return xt(__uniConfig.darkmode)?__uniConfig.darkmode:"light";try{return window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}catch(r){return"light"}}function OI(){let r,e="0",t="",n="phone";const i=navigator.language;if(yv){r="iOS";const h=Xn.match(/OS\s([\w_]+)\slike/);h&&(e=h[1].replace(/_/g,"."));const f=Xn.match(/\(([a-zA-Z]+);/);f&&(t=f[1])}else if(rP){r="Android";const h=Xn.match(/Android[\s/]([\w\.]+)[;\s]/);h&&(e=h[1]);const f=Xn.match(/\((.+?)\)/),d=f?f[1].split(";"):Xn.split(" "),m=[/\bAndroid\b/i,/\bLinux\b/i,/\bU\b/i,/^\s?[a-z][a-z]$/i,/^\s?[a-z][a-z]-[a-z][a-z]$/i,/\bwv\b/i,/\/[\d\.,]+$/,/^\s?[\d\.,]+$/,/\bBrowser\b/i,/\bMobile\b/i];for(let y=0;y<d.length;y++){const T=d[y];if(T.indexOf("Build")>0){t=T.split("Build")[0].trim();break}let b;for(let S=0;S<m.length;S++)if(m[S].test(T)){b=!0;break}if(!b){t=T.trim();break}}}else if(iP){if(t="iPad",r="iOS",n="pad",e=at(window.BigInt)?"14.0":"13.0",parseInt(e)===14){const h=Xn.match(/Version\/(\S*)\b/);h&&(e=h[1])}}else if(jh||fd||Yy){t="PC",r="PC",n="pc",e="0";let h=Xn.match(/\((.+?)\)/)[1];if(jh){switch(r="Windows",jh[1]){case"5.1":e="XP";break;case"6.0":e="Vista";break;case"6.1":e="7";break;case"6.2":e="8";break;case"6.3":e="8.1";break;case"10.0":e="10";break}const f=h&&h.match(/[Win|WOW]([\d]+)/);f&&(e+=` x${f[1]}`)}else if(fd){r="macOS";const f=h&&h.match(/Mac OS X (.+)/)||"";e&&(e=f[1].replace(/_/g,"."),e.indexOf(";")!==-1&&(e=e.split(";")[0]))}else if(Yy){r="Linux";const f=h&&h.match(/Linux (.*)/)||"";f&&(e=f[1],e.indexOf(";")!==-1&&(e=e.split(";")[0]))}}else r="Other",e="0",n="unknown";const s=`${r} ${e}`,a=r.toLowerCase();let o="",l=String(II());if(l!=="-1")o="IE";else{const h=["Version","Firefox","Chrome","Edge{0,1}"],f=["Safari","Firefox","Chrome","Edge"];for(let d=0;d<h.length;d++){const m=h[d],y=new RegExp(`(${m})/(\\S*)\\b`);y.test(Xn)&&(o=f[d],l=Xn.match(y)[2])}}let c="portrait";const u=typeof window.screen.orientation=="undefined"?window.orientation:window.screen.orientation.angle;return c=Math.abs(u)===90?"landscape":"portrait",{deviceBrand:void 0,brand:void 0,deviceModel:t,deviceOrientation:c,model:t,system:s,platform:a,browserName:o.toLowerCase(),browserVersion:l,language:i,deviceType:n,ua:Xn,osname:r,osversion:e,theme:xv()}}const $I=mi("getWindowInfo",()=>{const r=window.devicePixelRatio,e=gv(),t=bv(e),n=Ev(e,t),i=sP(e,t),s=wv(n);let a=window.innerHeight;const o=Ln.top,l={left:Ln.left,right:s-Ln.right,top:Ln.top,bottom:a-Ln.bottom,width:s-Ln.left-Ln.right,height:a-Ln.top-Ln.bottom},{top:c,bottom:u}=wx();return a-=c,a-=u,{windowTop:c,windowBottom:u,windowWidth:s,windowHeight:a,pixelRatio:r,screenWidth:n,screenHeight:i,statusBarHeight:o,safeArea:l,safeAreaInsets:{top:Ln.top,right:Ln.right,bottom:Ln.bottom,left:Ln.left},screenTop:i-a}});let Wu,Tc=!0;function _p(){Tc&&(Wu=OI())}const DI=mi("getDeviceInfo",()=>{_p();const{deviceBrand:r,deviceModel:e,brand:t,model:n,platform:i,system:s,deviceOrientation:a,deviceType:o,osname:l,osversion:c}=Wu;return Ct({brand:t,deviceBrand:r,deviceModel:e,devicePixelRatio:window.devicePixelRatio,deviceId:PI(),deviceOrientation:a,deviceType:o,model:n,platform:i,system:s,osName:l?l.toLowerCase():void 0,osVersion:c})}),LI=mi("getAppBaseInfo",()=>{_p();const{theme:r,language:e,browserName:t,browserVersion:n}=Wu;return Ct({appId:__uniConfig.appId,appName:__uniConfig.appName,appVersion:__uniConfig.appVersion,appVersionCode:__uniConfig.appVersionCode,appLanguage:Bs?Bs():e,enableDebug:!1,hostSDKVersion:void 0,hostPackageName:void 0,hostFontSizeSetting:void 0,hostName:t,hostVersion:n,hostTheme:r,hostLanguage:e,language:e,SDKVersion:"",theme:r,version:"",uniPlatform:"web",isUniAppX:!1,uniCompileVersion:__uniConfig.compilerVersion,uniCompilerVersion:__uniConfig.compilerVersion,uniRuntimeVersion:__uniConfig.compilerVersion},{})}),Hu=mi("getSystemInfoSync",()=>{Tc=!0,_p(),Tc=!1;const r=$I(),e=DI(),t=LI();Tc=!0;const{ua:n,browserName:i,browserVersion:s,osname:a,osversion:o}=Wu,l=Ct(r,e,t,{ua:n,browserName:i,browserVersion:s,uniPlatform:"web",uniCompileVersion:__uniConfig.compilerVersion,uniRuntimeVersion:__uniConfig.compilerVersion,fontSizeSetting:void 0,osName:a.toLowerCase(),osVersion:o,osLanguage:void 0,osTheme:void 0});return delete l.screenTop,delete l.enableDebug,__uniConfig.darkmode||delete l.theme,VS(l)});function qI(r){const e=["object","string","number","boolean","undefined"];try{const t=xt(r)?JSON.parse(r):r,n=t.type;if(e.indexOf(n)>=0){const i=Object.keys(t);if(i.length===2&&"data"in t){if(typeof t.data===n)return t.data;if(n==="object"&&/^\d{4}-\d{2}-\d{2}T\d{2}\:\d{2}\:\d{2}\.\d{3}Z$/.test(t.data))return new Date(t.data)}else if(i.length===1)return""}}catch(t){}}const Go=mi(eM,(r,e)=>{const t=typeof e,n=t==="string"?e:JSON.stringify({type:t,data:e});localStorage.setItem(r,n)});function kI(r){const e=localStorage&&localStorage.getItem(r);if(!xt(e))throw new Error("data not found");let t=e;try{const n=JSON.parse(e),i=qI(n);i!==void 0&&(t=i)}catch(n){}return t}const Ko=mi(ZR,r=>{try{return kI(r)}catch(e){return""}}),_c=mi(tM,r=>{localStorage&&localStorage.removeItem(r)}),Rv={esc:["Esc","Escape"],enter:["Enter"]},BI=Object.keys(Rv);function FI(){const r=ge(""),e=ge(!1),t=n=>{if(e.value)return;const i=BI.find(s=>Rv[s].indexOf(n.key)!==-1);i&&(r.value=i),bn(()=>r.value="")};return gn(()=>{document.addEventListener("keyup",t)}),$r(()=>{document.removeEventListener("keyup",t)}),{key:r,disable:e}}function UI(r,e,t){return e.onClose=(...n)=>(e.visible=!1,t.apply(null,n)),l0(Lt({setup(){return()=>(_e(),Ne(r,e,null,16))}}))}function VI(r){let e=document.getElementById(r);return e||(e=document.createElement("div"),e.id=r,document.body.append(e)),e}function jI(r,{onEsc:e,onEnter:t}){const n=ge(r.visible),{key:i,disable:s}=FI();return Ge(()=>r.visible,a=>n.value=a),Ge(()=>n.value,a=>s.value=!a),rp(()=>{const{value:a}=i;a==="esc"?e&&e():a==="enter"&&t&&t()}),n}const WI=FR(nM,({url:r,data:e,header:t={},method:n,dataType:i,responseType:s,enableChunked:a,withCredentials:o,timeout:l=__uniConfig.networkTimeout.request},{resolve:c,reject:u})=>{let h=null;const f=zI(t);if(n!=="GET")if(xt(e)||e instanceof ArrayBuffer)h=e;else if(f==="json")try{h=JSON.stringify(e)}catch(m){h=e.toString()}else if(f==="urlencoded"){const m=[];for(const y in e)It(e,y)&&m.push(encodeURIComponent(y)+"="+encodeURIComponent(e[y]));h=m.join("&")}else h=e.toString();let d;if(a){if(typeof window.fetch===void 0||typeof window.AbortController===void 0)throw new Error("fetch or AbortController is not supported in this environment");const m=new AbortController,y=m.signal;d=new cg(m);const T={method:n,headers:t,body:h,signal:y,credentials:o?"include":"same-origin"},b=setTimeout(function(){d.abort(),u("timeout",{errCode:5})},l);T.signal.addEventListener("abort",function(){clearTimeout(b),u("abort",{errCode:600003})}),window.fetch(r,T).then(S=>{const N=S.status,C=S.headers,I=S.body,H={};C.forEach((E,A)=>{H[A]=E});const Q=HI(H);if(d._emitter.emit("headersReceived",{header:H,statusCode:N,cookies:Q}),!I){c({data:"",statusCode:N,header:H,cookies:Q});return}const te=I.getReader(),V=[],J=()=>{te.read().then(({done:E,value:A})=>{if(E){const $=QI(V);let B=s==="text"?new TextDecoder().decode($):$;s==="text"&&(B=ug(B,s,i)),c({data:B,statusCode:N,header:H,cookies:Q});return}const x=A;V.push(x),d._emitter.emit("chunkReceived",{data:x}),J()})};J()},S=>{u(S,{errCode:5})})}else{const m=new XMLHttpRequest;d=new cg(m),m.open(n,r);for(const T in t)It(t,T)&&m.setRequestHeader(T,t[T]);const y=setTimeout(function(){m.onload=m.onabort=m.onerror=null,d.abort(),u("timeout",{errCode:5})},l);m.responseType=s,m.onload=function(){clearTimeout(y);const T=m.status;let b=s==="text"?m.responseText:m.response;s==="text"&&(b=ug(b,s,i)),c({data:b,statusCode:T,header:GI(m.getAllResponseHeaders()),cookies:[]})},m.onabort=function(){clearTimeout(y),u("abort",{errCode:600003})},m.onerror=function(){clearTimeout(y),u(void 0,{errCode:5})},m.withCredentials=o,m.send(h)}return d},oM,lM),HI=r=>{let e=r["Set-Cookie"]||r["set-cookie"],t=[];if(!e)return[];e[0]==="["&&e[e.length-1]==="]"&&(e=e.slice(1,-1));const n=e.split(";");for(let i=0;i<n.length;i++)n[i].indexOf("Expires=")!==-1||n[i].indexOf("expires=")!==-1?t.push(n[i].replace(",","")):t.push(n[i]);return t=t.join(";").split(","),t};function QI(r){const e=r.reduce((i,s)=>i+s.byteLength,0),t=new Uint8Array(e);let n=0;for(const i of r)t.set(new Uint8Array(i),n),n+=i.byteLength;return t.buffer}function zI(r){const e=Object.keys(r).find(n=>n.toLowerCase()==="content-type");if(!e)return;const t=r[e];return t.indexOf("application/json")===0?"json":t.indexOf("application/x-www-form-urlencoded")===0?"urlencoded":"string"}class cg{constructor(e){this._requestOnChunkReceiveCallbackId=0,this._requestOnChunkReceiveCallbacks=new Map,this._requestOnHeadersReceiveCallbackId=0,this._requestOnHeadersReceiveCallbacks=new Map,this._emitter=new rw,this._controller=e}abort(){this._controller&&(this._controller.abort(),delete this._controller)}onHeadersReceived(e){return this._emitter.on("headersReceived",e),this._requestOnHeadersReceiveCallbackId++,this._requestOnHeadersReceiveCallbacks.set(this._requestOnHeadersReceiveCallbackId,e),this._requestOnHeadersReceiveCallbackId}offHeadersReceived(e){if(e==null){this._emitter.off("headersReceived");return}if(typeof e=="function"){this._requestOnHeadersReceiveCallbacks.forEach((n,i)=>{n===e&&(this._requestOnHeadersReceiveCallbacks.delete(i),this._emitter.off("headersReceived",e))});return}const t=this._requestOnHeadersReceiveCallbacks.get(e);t&&(this._requestOnHeadersReceiveCallbacks.delete(e),this._emitter.off("headersReceived",t))}onChunkReceived(e){return this._emitter.on("chunkReceived",e),this._requestOnChunkReceiveCallbackId++,this._requestOnChunkReceiveCallbacks.set(this._requestOnChunkReceiveCallbackId,e),this._requestOnChunkReceiveCallbackId}offChunkReceived(e){if(e==null){this._emitter.off("chunkReceived");return}if(typeof e=="function"){this._requestOnChunkReceiveCallbacks.forEach((n,i)=>{n===e&&(this._requestOnChunkReceiveCallbacks.delete(i),this._emitter.off("chunkReceived",e))});return}const t=this._requestOnChunkReceiveCallbacks.get(e);t&&(this._requestOnChunkReceiveCallbacks.delete(e),this._emitter.off("chunkReceived",t))}}function GI(r){const e={};return r.split(Hd).forEach(t=>{const n=t.match(/(\S+\s*):\s*(.*)/);!n||n.length!==3||(e[n[1]]=n[2])}),e}function ug(r,e,t){let n=r;if(e==="text"&&t==="json")try{n=JSON.parse(n)}catch(i){}return n}const pd=yi(fM,(r,{resolve:e,reject:t})=>{let n=!0;return dr(Fc,{from:r.from||"navigateBack"})===!0&&(n=!1),n?(Sr().$router.go(-r.delta),e()):t(Fc)},mM,_M),Mi=yi(Ho,({url:r,events:e,isAutomatedTesting:t},{resolve:n,reject:i})=>{if(!Fa.handledBeforeEntryPageRoutes){ld.push({args:{type:Ho,url:r,events:e,isAutomatedTesting:t},resolve:n,reject:i});return}return ss({type:Ho,url:r,events:e,isAutomatedTesting:t}).then(n).catch(i)},pM,EM);function KI(r){__uniConfig.darkmode&&rr.on(bu,r)}function YI(r){rr.off(bu,r)}const JI={title:{type:String,default:""},icon:{default:"success",validator(r){return rv.indexOf(r)!==-1}},image:{type:String,default:""},duration:{type:Number,default:1500},mask:{type:Boolean,default:!1},visible:{type:Boolean}},Sc="uni-toast__icon",XI={light:"#fff",dark:"rgba(255,255,255,0.9)"},hg=r=>XI[r],ZI=Lt({name:"Toast",props:JI,setup(r){J1(),X1();const{Icon:e}=eO(r),t=jI(r,{});return()=>{const{mask:n,duration:i,title:s,image:a}=r;return X(lp,{name:"uni-fade"},{default:()=>[Su(X("uni-toast",{"data-duration":i},[n?X("div",{class:"uni-mask",style:"background: transparent;",onTouchmove:Ex},null,40,["onTouchmove"]):"",!a&&!e.value?X("div",{class:"uni-sample-toast"},[X("p",{class:"uni-simple-toast__text"},[s])]):X("div",{class:"uni-toast"},[a?X("img",{src:a,class:Sc},null,10,["src"]):e.value,X("p",{class:"uni-toast__content"},[s])])],8,["data-duration"]),[[Mu,t.value]])]})}}});function eO(r){const e=ge(hg(xv())),t=({theme:i})=>e.value=hg(i);return rp(()=>{r.visible?KI(t):YI(t)}),{Icon:Me(()=>{switch(r.icon){case"success":return X(xy(Tx,e.value,38),{class:Sc});case"error":return X(xy(_x,e.value,38),{class:Sc});case"loading":return X("i",{class:[Sc,"uni-loading"]},null,2);default:return null}})}}let is,Ms="",_o;const tO=Gd();function nO(){tO.run(()=>{Ge([()=>is.visible,()=>is.duration],([r,e])=>{if(r){if(_o&&clearTimeout(_o),Ms==="onShowLoading")return;_o=setTimeout(()=>{Sp("onHideToast")},e)}else _o&&clearTimeout(_o)})})}function Mv(r){is?Ct(is,r):(is=nn(Ct(r,{visible:!1})),bn(()=>{nO(),rr.on("onHidePopup",()=>Sp("onHidePopup")),UI(ZI,is,()=>{}).mount(VI("u-a-t"))})),setTimeout(()=>{is.visible=!0},10)}const Ps=yi(OM,(r,{resolve:e,reject:t})=>{Mv(r),Ms="onShowToast",e()},$M,DM),rO={icon:"loading",duration:1e8,image:""},Pv=yi(MM,(r,{resolve:e,reject:t})=>{Ct(r,rO),Mv(r),Ms="onShowLoading",e()},PM,IM),tu=yi(NM,(r,{resolve:e,reject:t})=>{Sp("onHideLoading"),e()});function Sp(r){const{t:e}=_n();if(!Ms)return;let t="";r==="onHideToast"&&Ms!=="onShowToast"?t=e("uni.showToast.unpaired"):r==="onHideLoading"&&Ms!=="onShowLoading"&&(t=e("uni.showLoading.unpaired")),!t&&(Ms="",setTimeout(()=>{is.visible=!1},10))}function iO(r){document.title=r,rr.emit(LS,{titleText:r})}function sO(r){function e(){iO(r.navigationBar.titleText)}rp(e),Cu(e)}function aO(r,e,t,n,i){if(!r)return i("page not found");const{navigationBar:s}=r;switch(e){case AM:const{frontColor:a,backgroundColor:o,animation:l}=t,{duration:c,timingFunc:u}=l;a&&(s.titleColor=a==="#000000"?"#000000":"#ffffff"),o&&(s.backgroundColor=o),s.duration=c+"ms",s.timingFunc=u;break;case xM:s.loading=!0;break;case RM:s.loading=!1;break;case ad:const{title:h}=t;s.titleText=h;break}n()}const oO=yi(ad,(r,{resolve:e,reject:t})=>{aO(yp(),ad,r,e,t)}),aa="0px",lO=Za({name:"Layout",setup(r,{emit:e}){const t=ge(null);uO();const n=GM(),{layoutState:i,windowState:s}=fO();hO(i,t);const o=cO(!1);return()=>{const l=dO(n);return X("uni-app",{ref:t,class:o.value},[l,!1],2)}}});function cO(r){const e=ge(!1);return Me(()=>({"uni-app--showtabbar":r,"uni-app--maxwidth":e.value}))}function uO(){Wo({"--status-bar-height":aa,"--top-window-height":aa,"--window-left":aa,"--window-right":aa,"--window-margin":aa,"--tab-bar-height":aa})}function hO(r,e){const t=ku();function n(){const i=document.body.clientWidth,s=_l();let a={};if(s.length>0){const c=s[s.length-1];a=Ks(c).meta}else{const c=O0(t.path,!0);c&&(a=c.meta)}const o=parseInt(String((It(a,"maxWidth")?a.maxWidth:__uniConfig.globalStyle.maxWidth)||Number.MAX_SAFE_INTEGER));let l=!1;i>o?l=!0:l=!1,l&&o?(r.marginWidth=(i-o)/2,bn(()=>{const c=e.value;c&&c.setAttribute("style","max-width:"+o+"px;margin:0 auto;")})):(r.marginWidth=0,bn(()=>{const c=e.value;c&&c.removeAttribute("style")}))}Ge([()=>t.path],n),gn(()=>{n(),window.addEventListener("resize",n)})}function fO(){ku();{const r=nn({marginWidth:0,leftWindowWidth:0,rightWindowWidth:0});return Ge(()=>r.marginWidth,e=>Wo({"--window-margin":e+"px"})),Ge(()=>r.leftWindowWidth+r.marginWidth,e=>{Wo({"--window-left":e+"px"})}),Ge(()=>r.rightWindowWidth+r.marginWidth,e=>{Wo({"--window-right":e+"px"})}),{layoutState:r,windowState:Me(()=>({}))}}}function dO(r,e,t,n,i,s){return pO(r)}function pO({routeKey:r,isTabBar:e,routeCache:t}){return X(v0,null,{default:re(({Component:n})=>[(_e(),Ne(nN,{matchBy:"key",cache:t},[(_e(),Ne(kn(n),{type:e.value?"tabBar":"",key:r.value}))],1032,["cache"]))]),_:1})}const fg="login",mO=yi(fg,VR(fg)),tr=Ct(ax,{publishHandler(r,e,t){rr.subscribeHandler(r,e,t)}}),rr=Ct(Kx,{publishHandler(r,e,t){tr.subscribeHandler(r,e,t)}}),yO=Za({name:"PageBody",setup(r,e){const n=ge(null),i=null,s=ge(null);return Ge(()=>(!1).enablePullDownRefresh,()=>{s.value=(!1).enablePullDownRefresh?i:null},{immediate:!0}),()=>X(Ht,null,[!1,X("uni-page-wrapper",di({ref:n},s.value),[X("uni-page-body",null,[Bt(e.slots,"default")]),null],16)])}}),gO=Za({name:"Page",setup(r,e){let t=bR(bp());t.navigationBar;const n={};return sO(t),()=>X("uni-page",{"data-page":t.route,style:n},[bO(e),null])}});function bO(r){return _e(),Ne(yO,{key:0},{default:re(()=>[Bt(r.slots,"page")]),_:3})}const EO="",wO="poop-rect",vO="1.0.0",TO="100",_O=!1,SO={"flex-direction":"column"},CO={request:6e4,connectSocket:6e4,uploadFile:6e4,downloadFile:6e4},NO={mode:"hash",base:"/",assets:"",routerBase:"/"},cs={loading:"AsyncLoading",error:"AsyncError",delay:200,timeout:6e4,suspensible:!0},AO=void 0,xO=void 0,RO=void 0,MO=void 0,PO=void 0,IO=void 0,OO={},$O="",DO="en",LO=!1,qO={};window.uni={};window.wx={};window.rpx2px=tv;const dg=Object.assign({"./locale/en.json":lS,"./locale/zh-Hans.json":cS}),ds=Object.assign;window.__uniConfig=ds({globalStyle:{backgroundColor:"#FFFFFF",navigationBar:{backgroundColor:"#f8f8f8",titleText:"poop-rect",style:"custom",type:"default",titleColor:"#000000"},isNVue:!1},easycom:{autoscan:!0,custom:{"^fg-(.*)":"@/components/fg-$1/fg-$1.vue","^wd-(.*)":"wot-design-uni/components/wd-$1/wd-$1.vue","^(?!z-paging-refresh|z-paging-load-more)z-paging(.*)":"z-paging/components/z-paging$1/z-paging$1.vue"}},tabBar:{position:"bottom",color:"#999",selectedColor:"#007aff",borderStyle:"black",blurEffect:"none",fontSize:"10px",iconWidth:"24px",spacing:"3px",height:"50px",list:[],selectedIndex:0,shown:!0},compilerVersion:"4.76"},{appId:EO,appName:wO,appVersion:vO,appVersionCode:TO,async:cs,debug:_O,networkTimeout:CO,sdkConfigs:OO,qqMapKey:AO,bMapKey:xO,googleMapKey:RO,aMapKey:MO,aMapSecurityJsCode:PO,aMapServiceHost:IO,nvue:SO,locale:$O,fallbackLocale:DO,locales:Object.keys(dg).reduce((r,e)=>{const t=e.replace(/\.\/locale\/(uni-app.)?(.*).json/,"$2");return ds(r[t]||(r[t]={}),dg[e].default),r},{}),router:NO,darkmode:LO,themeConfig:qO});window.__uniLayout=window.__uniLayout||{};const Ys={delay:cs.delay,timeout:cs.timeout,suspensible:cs.suspensible};cs.loading&&(Ys.loadingComponent={name:"SystemAsyncLoading",render(){return X(Pr(cs.loading))}});cs.error&&(Ys.errorComponent={name:"SystemAsyncError",props:["error"],render(){return X(Pr(cs.error),{error:this.error})}});const Iv=()=>yl(()=>Promise.resolve().then(()=>yU),void 0,import.meta.url).then(r=>Sl(r.default||r)),kO=El(ds({loader:Iv},Ys)),Ov=()=>yl(()=>Promise.resolve().then(()=>XU),void 0,import.meta.url).then(r=>Sl(r.default||r)),BO=El(ds({loader:Ov},Ys)),$v=()=>yl(()=>Promise.resolve().then(()=>y4),void 0,import.meta.url).then(r=>Sl(r.default||r)),FO=El(ds({loader:$v},Ys)),Dv=()=>yl(()=>Promise.resolve().then(()=>v4),void 0,import.meta.url).then(r=>Sl(r.default||r)),UO=El(ds({loader:Dv},Ys)),Lv=()=>yl(()=>Promise.resolve().then(()=>A4),void 0,import.meta.url).then(r=>Sl(r.default||r)),VO=El(ds({loader:Lv},Ys));function So(r,e){return _e(),Ne(gO,null,{page:re(()=>[X(r,ds({},e,{ref:"page"}),null,512)]),_:1})}window.__uniRoutes=[{path:"/",alias:"/pages/poop",component:{setup(){const r=Sr(),e=r&&r.$route&&r.$route.query||{};return()=>So(kO,e)}},loader:Iv,meta:{isQuit:!0,isEntry:!0,navigationBar:{},isNVue:!1}},{path:"/pages/calendar",component:{setup(){const r=Sr(),e=r&&r.$route&&r.$route.query||{};return()=>So(BO,e)}},loader:Ov,meta:{navigationBar:{},isNVue:!1}},{path:"/pages/record",component:{setup(){const r=Sr(),e=r&&r.$route&&r.$route.query||{};return()=>So(FO,e)}},loader:$v,meta:{navigationBar:{},isNVue:!1}},{path:"/pages/setting",component:{setup(){const r=Sr(),e=r&&r.$route&&r.$route.query||{};return()=>So(UO,e)}},loader:Dv,meta:{navigationBar:{},isNVue:!1}},{path:"/pages-sub/demo/index",component:{setup(){const r=Sr(),e=r&&r.$route&&r.$route.query||{};return()=>So(VO,e)}},loader:Lv,meta:{navigationBar:{titleText:"分包页面",type:"default"},isNVue:!1}}].map(r=>(r.meta.route=(r.alias||r.path).slice(1),r));class md{constructor(e){this._reject=null,this.promise=new Promise((t,n)=>{e(t,n),this._reject=n})}abort(e){this._reject&&this._reject(e)}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}}function ui(r){return Number.isNaN(Number(r))?`${r}`:`${r}px`}function Fs(r){return Object.prototype.toString.call(r)==="[object Object]"||typeof r=="object"}function Us(r){const t=Object.prototype.toString.call(r).match(/\[object (\w+)\]/);return t&&t.length?t[1].toLowerCase():""}const jO=function(r,e){const t=(e==null?void 0:e.labelKey)||"value";return Array.isArray(r)?r.map(n=>n[t]).join(", "):r[t]},Mt=r=>r!=null;function WO(r,e,t){const n=(r<<16|e<<8|t).toString(16);return"#"+"0".repeat(Math.max(0,6-n.length))+n}function pg(r){const e=[];for(let t=1;t<7;t+=2)e.push(parseInt("0x"+r.slice(t,t+2),16));return e}const HO=(r,e,t=2)=>{const n=pg(r),i=pg(e),s=(i[0]-n[0])/t,a=(i[1]-n[1])/t,o=(i[2]-n[2])/t,l=[];for(let c=0;c<t;c++)l.push(WO(parseInt(String(s*c+n[0])),parseInt(String(a*c+n[1])),parseInt(String(o*c+n[2]))));return l},Yo=(r,e,t)=>Math.min(Math.max(r,e),t),Ua=(r,e)=>{if(r===e)return!0;if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0},Mn=(r,e=2)=>{let t=r.toString();for(;t.length<e;)t="0"+t;return t},Gh={id:1e3};function QO(r){return r.replace(/[A-Z]/g,function(t){return"-"+t}).toLowerCase()}function zO(r){return r.replace(/-(\w)/g,(e,t)=>t.toUpperCase())}function At(r){return typeof Array.isArray=="function"?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}function fn(r){return Us(r)==="function"||Us(r)==="asyncfunction"}function Cp(r){return Us(r)==="string"}function Cc(r){return Us(r)==="number"}function Nc(r){return Fs(r)&&Mt(r)?fn(r.then)&&fn(r.catch):!1}function mg(r){return typeof r=="undefined"}function Oi(r){if(At(r)){const e=r.filter(function(t){return t!=null&&t!==""}).map(function(t){return Oi(t)}).join(";");return e?e.endsWith(";")?e:e+";":""}if(Cp(r))return r?r.endsWith(";")?r:r+";":"";if(Fs(r)){const e=Object.keys(r).filter(function(t){return r[t]!=null&&r[t]!==""}).map(function(t){return[QO(t),r[t]].join(":")}).join(";");return e?e.endsWith(";")?e:e+";":""}return""}const jr=(r=1e3/30)=>new md(e=>{const t=setTimeout(()=>{clearTimeout(t),e(!0)},r)});function $t(r,e=new Map){if(r===null||typeof r!="object")return r;if(GO(r))return new Date(r.getTime());if(r instanceof RegExp)return new RegExp(r.source,r.flags);if(r instanceof Error){const n=new Error(r.message);return n.stack=r.stack,n}if(e.has(r))return e.get(r);const t=Array.isArray(r)?[]:{};e.set(r,t);for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=$t(r[n],e));return t}function Ia(r,e){if(r=$t(r),typeof r!="object"||typeof e!="object")throw new Error("Both target and source must be objects.");for(const t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}function nu(r,e){return Object.keys(e).forEach(t=>{const n=r[t],i=e[t];Fs(n)&&Fs(i)?nu(n,i):r[t]=i}),r}function Np(r,e,t={}){let n=null,i,s,a;const o=Mt(t.leading)?t.leading:!1,l=Mt(t.trailing)?t.trailing:!0;function c(){i!==void 0&&(a=r.apply(s,i),i=void 0)}function u(){n=setTimeout(()=>{n=null,l&&c()},e)}function h(){n!==null&&(clearTimeout(n),n=null)}function f(...d){return i=d,s=this,n===null?(o&&c(),u()):l&&(h(),u()),a}return f}const qv=(r,e)=>{const t=e.split(".");try{return t.reduce((n,i)=>n!=null?n[i]:void 0,r)}catch(n){return}},GO=r=>Object.prototype.toString.call(r)==="[object Date]"&&!Number.isNaN(r.getTime());function yg(r,e){const t=$t(r);return Object.keys(t).forEach(n=>e(t[n],n)&&delete t[n]),t}function gg(r,e){return r.reduce((t,n)=>Math.abs(n-e)<Math.abs(t-e)?n:t)}const kv=[Number,String],bg={type:Boolean,default:!0},en=r=>({type:r,required:!0}),eo=()=>({type:Array,default:()=>[]}),qe=r=>({type:Boolean,default:r}),jt=r=>({type:Number,default:r}),Qu=r=>({type:kv,default:r}),lt=r=>({type:String,default:r}),xn={customStyle:lt(""),customClass:lt("")},KO=Tt(Xe({},xn),{name:en(String),color:String,size:kv,classPrefix:lt("wd-icon")}),YO={name:"wd-icon",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},JO=Lt(Tt(Xe({},YO),{props:KO,emits:["click","touch"],setup(r,{emit:e}){const t=r,n=e,i=Me(()=>Mt(t.name)&&t.name.includes("/")),s=Me(()=>{const l=t.classPrefix;return`${l} ${t.customClass} ${i.value?"wd-icon--image":l+"-"+t.name}`}),a=Me(()=>{const l={};return t.color&&(l.color=t.color),t.size&&(l["font-size"]=ui(t.size)),`${Oi(l)} ${t.customStyle}`});function o(l){n("click",l)}return(l,c)=>{const u=vp,h=Yt;return _e(),Ne(h,{onClick:o,class:Nt(s.value),style:zt(a.value)},{default:re(()=>[i.value?(_e(),Ne(u,{key:0,class:"wd-icon__image",src:l.name},null,8,["src"])):gt("",!0)]),_:1},8,["class","style"])}}})),cn=(r,e)=>{const t=r.__vccOpts||r;for(const[n,i]of e)t[n]=i;return t},er=cn(JO,[["__scopeId","data-v-bef80b7c"]]),lc=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],Bv=r=>r.replace(/[+/]/g,e=>e==="+"?"-":"_").replace(/=+\$/m,""),XO=(r,e=!1)=>{let t="";for(let n=0,i=r.length;n<i;n+=3){const[s,a,o]=[r[n],r[n+1],r[n+2]],l=s<<16|a<<8|o;t+=lc[l>>>18],t+=lc[l>>>12&63],t+=typeof a!="undefined"?lc[l>>>6&63]:"=",t+=typeof o!="undefined"?lc[l&63]:"="}return e?Bv(t):t},ZO=typeof btoa=="function"?r=>btoa(r):r=>{if(r.charCodeAt(0)>255)throw new RangeError("The string contains invalid characters.");return XO(Uint8Array.from(r,e=>e.charCodeAt(0)))},e$=r=>unescape(encodeURIComponent(r));function Ap(r,e=!1){const t=ZO(e$(r));return e?Bv(t):t}const t$=Tt(Xe({},xn),{type:lt("ring"),color:lt("#4D80F0"),size:Qu("")}),n$={name:"wd-loading",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},r$=Lt(Tt(Xe({},n$),{props:t$,setup(r){const e=Gh.id++,t=Gh.id++,n=Gh.id++,i={outline(h="#4D80F0"){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><defs><linearGradient x1="100%" y1="0%" x2="0%" y2="0%" id="${e}"><stop stop-color="#FFF" offset="0%" stop-opacity="0"/><stop stop-color="#FFF" offset="100%"/></linearGradient></defs><g fill="none" fill-rule="evenodd"><path d="M21 1c11.046 0 20 8.954 20 20s-8.954 20-20 20S1 32.046 1 21 9.954 1 21 1zm0 7C13.82 8 8 13.82 8 21s5.82 13 13 13 13-5.82 13-13S28.18 8 21 8z" fill="${h}"/><path d="M4.599 21c0 9.044 7.332 16.376 16.376 16.376 9.045 0 16.376-7.332 16.376-16.376" stroke="url(#${e}) " stroke-width="3.5" stroke-linecap="round"/></g></svg>`},ring(h="#4D80F0",f="#a6bff7"){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><linearGradient id="${t}" gradientUnits="userSpaceOnUse" x1="50" x2="50" y2="180"><stop offset="0" stop-color="${h}"></stop> <stop offset="1" stop-color="${f}"></stop></linearGradient> <path fill="url(#${t})" d="M20 100c0-44.1 35.9-80 80-80V0C44.8 0 0 44.8 0 100s44.8 100 100 100v-20c-44.1 0-80-35.9-80-80z"></path> <linearGradient id="${n}" gradientUnits="userSpaceOnUse" x1="150" y1="20" x2="150" y2="180"><stop offset="0" stop-color="#fff" stop-opacity="0"></stop> <stop offset="1" stop-color="${f}"></stop></linearGradient> <path fill="url(#${n})" d="M100 0v20c44.1 0 80 35.9 80 80s-35.9 80-80 80v20c55.2 0 100-44.8 100-100S155.2 0 100 0z"></path> <circle cx="100" cy="10" r="10" fill="${h}"></circle></svg>`}},s=r,a=ge(""),o=ge(""),l=ge(null);Ge(()=>s.size,h=>{l.value=ui(h)},{deep:!0,immediate:!0}),Ge(()=>s.type,()=>{u()},{deep:!0,immediate:!0});const c=Me(()=>{const h={};return Mt(l.value)&&(h.height=ui(l.value),h.width=ui(l.value)),`${Oi(h)} ${s.customStyle}`});Xr(()=>{o.value=HO(s.color,"#ffffff",2)[1],u()});function u(){const{type:h,color:f}=s;let d=Mt(h)?h:"ring";const m=`"data:image/svg+xml;base64,${Ap(d==="ring"?i[d](f,o.value):i[d](f))}"`;a.value=m}return(h,f)=>{const d=Yt;return _e(),Ne(d,{class:Nt(`wd-loading ${s.customClass}`),style:zt(c.value)},{default:re(()=>[X(d,{class:"wd-loading__body"},{default:re(()=>[X(d,{class:"wd-loading__svg",style:zt(`background-image: url(${a.value});`)},null,8,["style"])]),_:1})]),_:1},8,["class","style"])}}})),xp=cn(r$,[["__scopeId","data-v-4224d8d3"]]),i$=Tt(Xe({},xn),{show:qe(!1),duration:{type:[Object,Number,Boolean],default:300},lazyRender:qe(!1),name:[String,Array],destroy:qe(!0),enterClass:lt(""),enterActiveClass:lt(""),enterToClass:lt(""),leaveClass:lt(""),leaveActiveClass:lt(""),leaveToClass:lt(""),disableTouchMove:qe(!1)}),s$={name:"wd-transition",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},a$=Lt(Tt(Xe({},s$),{props:i$,emits:["click","before-enter","enter","before-leave","leave","after-leave","after-enter"],setup(r,{emit:e}){const t=V=>{let J=`${n.enterClass} ${n.enterActiveClass}`,E=`${n.enterToClass} ${n.enterActiveClass}`,A=`${n.leaveClass} ${n.leaveActiveClass}`,x=`${n.leaveToClass} ${n.leaveActiveClass}`;if(Array.isArray(V))for(let $=0;$<V.length;$++)J=`wd-${V[$]}-enter wd-${V[$]}-enter-active ${J}`,E=`wd-${V[$]}-enter-to wd-${V[$]}-enter-active ${E}`,A=`wd-${V[$]}-leave wd-${V[$]}-leave-active ${A}`,x=`wd-${V[$]}-leave-to wd-${V[$]}-leave-active ${x}`;else V&&(J=`wd-${V}-enter wd-${V}-enter-active ${J}`,E=`wd-${V}-enter-to wd-${V}-enter-active ${E}`,A=`wd-${V}-leave wd-${V}-leave-active ${A}`,x=`wd-${V}-leave-to wd-${V}-leave-active ${x}`);return{enter:J,"enter-to":E,leave:A,"leave-to":x}},n=r,i=e,s=ge(!1),a=ge(!1),o=ge(""),l=ge(!1),c=ge(300),u=ge(""),h=ge(null),f=ge(null),d=ge(null),m=Me(()=>`-webkit-transition-duration:${c.value}ms;transition-duration:${c.value}ms;${a.value||!n.destroy?"":"display: none;"}${n.customStyle}`),y=Me(()=>`wd-transition ${n.customClass}  ${u.value}`),T=Me(()=>!n.lazyRender||s.value);Xr(()=>{n.show&&C()}),Ge(()=>n.show,V=>{S(V)},{deep:!0});function b(){i("click")}function S(V){V?(N(),C()):I()}function N(){Nc(h.value)&&h.value.abort(),Nc(f.value)&&f.value.abort(),Nc(d.value)&&d.value.abort(),h.value=null,f.value=null,d.value=null}function C(){h.value=new md(V=>v(this,null,function*(){try{const J=t(n.name),E=Fs(n.duration)?n.duration.enter:n.duration;o.value="enter",i("before-enter"),f.value=jr(),yield f.value,i("enter"),u.value=J.enter,c.value=E,f.value=jr(),yield f.value,s.value=!0,a.value=!0,f.value=jr(),yield f.value,f.value=null,l.value=!1,u.value=J["enter-to"],V()}catch(J){}}))}function I(){return v(this,null,function*(){if(!h.value)return l.value=!1,Q();try{if(yield h.value,!a.value)return;const V=t(n.name),J=Fs(n.duration)?n.duration.leave:n.duration;o.value="leave",i("before-leave"),c.value=J,d.value=jr(),yield d.value,i("leave"),u.value=V.leave,d.value=jr(),yield d.value,l.value=!1,u.value=V["leave-to"],d.value=H(c.value),yield d.value,d.value=null,Q(),h.value=null}catch(V){}})}function H(V){return new md(J=>{const E=setTimeout(()=>{clearTimeout(E),J()},V)})}function Q(){l.value||(l.value=!0,o.value==="leave"?i("after-leave"):o.value==="enter"&&i("after-enter"),!n.show&&a.value&&(a.value=!1))}function te(){}return(V,J)=>{const E=Yt;return T.value&&V.disableTouchMove?(_e(),Ne(E,{key:0,class:Nt(y.value),style:zt(m.value),onTransitionend:Q,onClick:b,onTouchmove:Ja(te,["stop","prevent"])},{default:re(()=>[Bt(V.$slots,"default",{},void 0,!0)]),_:3},8,["class","style"])):T.value&&!V.disableTouchMove?(_e(),Ne(E,{key:1,class:Nt(y.value),style:zt(m.value),onTransitionend:Q,onClick:b},{default:re(()=>[Bt(V.$slots,"default",{},void 0,!0)]),_:3},8,["class","style"])):gt("",!0)}}})),ru=cn(a$,[["__scopeId","data-v-60fd6c07"]]),o$=Tt(Xe({},xn),{show:qe(!1),duration:{type:[Object,Number,Boolean],default:300},lockScroll:qe(!0),zIndex:jt(10)});function l$(r){const e=ge(0),t=()=>{e.value===0&&(document.getElementsByTagName("body")[0].style.overflow="hidden"),e.value++},n=()=>{e.value>0&&(e.value--,e.value===0&&(document.getElementsByTagName("body")[0].style.overflow=""))},i=()=>{r()&&n()};return Ge(r,s=>{s?t():n()}),qw(i),$r(i),{lock:t,unlock:n}}const c$={name:"wd-overlay",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},u$=Lt(Tt(Xe({},c$),{props:o$,emits:["click"],setup(r,{emit:e}){const t=r,n=e;function i(){n("click")}return l$(()=>t.show&&t.lockScroll),(s,a)=>(_e(),Ne(ru,{show:s.show,name:"fade","custom-class":"wd-overlay",duration:s.duration,"custom-style":`z-index: ${s.zIndex}; ${s.customStyle}`,"disable-touch-move":s.lockScroll,onClick:i},{default:re(()=>[Bt(s.$slots,"default",{},void 0,!0)]),_:3},8,["show","duration","custom-style","disable-touch-move"]))}})),yd=cn(u$,[["__scopeId","data-v-43633df7"]]),Eg="__TOAST_OPTION__",gd={duration:2e3,show:!1},wg=Symbol("None");function to(r=""){const e=Fv(r),t=on(e,ge(wg));t.value===wg&&(t.value=gd,Qr(e,t));let n=null;const i=f=>d=>s(Ia(f,typeof d=="string"?{msg:d}:d)),s=f=>{const d=Ia(gd,typeof f=="string"?{msg:f}:f);t.value=Ia(d,{show:!0}),n&&clearTimeout(n),t.value.duration&&t.value.duration>0&&(n=setTimeout(()=>{n&&clearTimeout(n),h()},d.duration))},a=i({iconName:"loading",duration:0,cover:!0}),o=i({iconName:"success",duration:1500}),l=i({iconName:"error"}),c=i({iconName:"warning"}),u=i({iconName:"info"}),h=()=>{t.value={show:!1}};return{show:s,loading:a,success:o,error:l,warning:c,info:u,close:h}}const Fv=r=>r?`${Eg}${r}`:Eg,h$={success(){return'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>成功</title><desc>Created with Sketch.</desc><defs><filter x="-63.2%" y="-80.0%" width="226.3%" height="260.0%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.122733141   0 0 0 0 0.710852582   0 0 0 0 0.514812768  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter><rect id="path-2" x="3.4176226" y="5.81442199" width="3" height="8.5" rx="1.5"></rect><linearGradient x1="50%" y1="0.126649064%" x2="50%" y2="100%" id="linearGradient-4"><stop stop-color="#ACFFBD" stop-opacity="0.208123907" offset="0%"></stop><stop stop-color="#10B87C" offset="100%"></stop></linearGradient></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-388.000000, -538.000000)"><g id="成功" transform="translate(388.000000, 538.000000)"><circle id="Oval" fill="#34D19D" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#34D19D" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(11.500000, 14.000000)"><mask id="mask-3" fill="white"><use xlink:href="#path-2"></use></mask><use id="Rectangle-Copy-24" fill="#C4FFEB" transform="translate(4.917623, 10.064422) rotate(-45.000000) translate(-4.917623, -10.064422) " xlink:href="#path-2"></use><rect id="Rectangle" fill="url(#linearGradient-4)" mask="url(#mask-3)" transform="translate(6.215869, 11.372277) rotate(-45.000000) translate(-6.215869, -11.372277) " x="4.71586891" y="9.52269089" width="3" height="3.69917136"></rect><rect id="Rectangle" fill="#FFFFFF" transform="translate(11.636236, 7.232744) scale(1, -1) rotate(-45.000000) translate(-11.636236, -7.232744) " x="10.1362361" y="-1.02185365" width="3" height="16.5091951" rx="1.5"></rect></g></g></g></g></svg>'},warning(){return'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>警告</title><desc>Created with Sketch.</desc> <defs> <filter x="-240.0%" y="-60.0%" width="580.0%" height="220.0%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.824756567   0 0 0 0 0.450356612   0 0 0 0 0.168550194  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode> <feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-580.000000, -538.000000)"> <g id="警告" transform="translate(580.000000, 538.000000)"><circle id="Oval" fill="#F0883A" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#F0883A" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(18.500000, 10.800000)"><rect id="Rectangle" fill="#FFFFFF" transform="translate(2.492935, 7.171583) scale(1, -1) rotate(-360.000000) translate(-2.492935, -7.171583) " x="0.992934699" y="0.955464537" width="3" height="12.4322365" rx="1.5"></rect><rect id="Rectangle-Copy-25" fill="#FFDEC5" transform="translate(2.508751, 17.202636) scale(1, -1) rotate(-360.000000) translate(-2.508751, -17.202636) " x="1.00875134" y="15.200563" width="3" height="4.00414639" rx="1.5"></rect></g></g></g></g></svg>'},info(){return'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>常规</title><desc>Created with Sketch.</desc><defs><filter x="-300.0%" y="-57.1%" width="700.0%" height="214.3%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.362700096   0 0 0 0 0.409035039   0 0 0 0 0.520238904  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-772.000000, -538.000000)"><g id="常规" transform="translate(772.000000, 538.000000)"><circle id="Oval" fill="#909CB7" opacity="0.4" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#909CB7" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(18.500000, 9.800000)"><g id="编组-2" transform="translate(2.492935, 10.204709) rotate(-180.000000) translate(-2.492935, -10.204709) translate(0.992935, 0.204709)"><rect id="Rectangle" fill="#FFFFFF" transform="translate(1.500000, 7.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -7.000000) " x="0" y="0" width="3" height="14" rx="1.5"></rect><rect id="Rectangle-Copy-25" fill="#EEEEEE" transform="translate(1.500000, 18.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -18.000000) " x="0" y="16" width="3" height="4" rx="1.5"></rect></g></g></g></g></g></svg>'},error(){return'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>toast</title><desc>Created with Sketch.</desc><defs><linearGradient x1="99.6229896%" y1="50.3770104%" x2="0.377010363%" y2="50.3770104%" id="linearGradient-1"><stop stop-color="#FFDFDF" offset="0%"></stop><stop stop-color="#F9BEBE" offset="100%"></stop></linearGradient><linearGradient x1="0.377010363%" y1="50.3770104%" x2="99.6229896%" y2="50.3770104%" id="linearGradient-2"><stop stop-color="#FFDFDF" offset="0%"></stop><stop stop-color="#F9BEBE" offset="100%"></stop></linearGradient></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-196.000000, -538.000000)"> <g id="toast" transform="translate(196.000000, 538.000000)"><circle id="Oval" fill="#FA4350" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#FA4350" opacity="0.900000036" cx="21" cy="21" r="16"></circle><rect id="矩形" fill="#FFDFDF" transform="translate(21.071068, 21.071068) rotate(-225.000000) translate(-21.071068, -21.071068) " x="12.5710678" y="19.5710678" width="17" height="3" rx="1.5"></rect><rect id="矩形" fill="url(#linearGradient-1)" transform="translate(19.303301, 22.838835) rotate(-225.000000) translate(-19.303301, -22.838835) " x="17.3033009" y="21.3388348" width="4" height="3"></rect><rect id="矩形" fill="url(#linearGradient-2)" transform="translate(22.838835, 19.303301) rotate(-225.000000) translate(-22.838835, -19.303301) " x="20.8388348" y="17.8033009" width="4" height="3"></rect><rect id="矩形" fill="#FFFFFF" transform="translate(21.071068, 21.071068) rotate(-315.000000) translate(-21.071068, -21.071068) " x="12.5710678" y="19.5710678" width="17" height="3" rx="1.5"></rect></g></g></g></svg>'}},f$=Tt(Xe({},xn),{selector:lt(""),msg:{type:String,default:""},direction:lt("horizontal"),iconName:{type:String,default:""},iconSize:Number,loadingType:lt("outline"),loadingColor:{type:String,default:"#4D80F0"},loadingSize:Number,iconColor:String,position:lt("middle-top"),zIndex:{type:Number,default:100},cover:{type:Boolean,default:!1},iconClass:{type:String,default:""},classPrefix:{type:String,default:"wd-icon"},opened:Function,closed:Function}),d$={name:"wd-toast",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},p$=Lt(Tt(Xe({},d$),{props:f$,setup(r){const e=r,t=ge(""),n=ge(""),i=ge("middle"),s=ge(!1),a=ge(100),o=ge("outline"),l=ge("#4D80F0"),c=ge(),u=ge(),h=ge(""),f=ge(!1),d=ge("wd-icon"),m=ge(""),y=ge("horizontal");let T=null,b=null;const S=Fv(e.selector),N=on(S,ge(gd));Ge(()=>N.value,A=>{J(A)},{deep:!0,immediate:!0}),Ge(()=>t.value,()=>{V()},{deep:!0,immediate:!0});const C=Me(()=>{const A={"z-index":a.value,position:"fixed",top:"50%",left:0,width:"100%",transform:"translate(0, -50%)","text-align":"center","pointer-events":"none"};return Oi(A)}),I=Me(()=>`wd-toast ${e.customClass} wd-toast--${i.value} ${(t.value!=="loading"||n.value)&&(t.value||m.value)?"wd-toast--with-icon":""} ${t.value==="loading"&&!n.value?"wd-toast--loading":""} ${y.value==="vertical"?"is-vertical":""}`),H=Me(()=>{const A={backgroundImage:`url(${h.value})`};return Mt(c.value)&&(A.width=c.value,A.height=c.value),Oi(A)});Xr(()=>{V()});function Q(){fn(T)&&T()}function te(){fn(b)&&b()}function V(){if(t.value!=="success"&&t.value!=="warning"&&t.value!=="info"&&t.value!=="error")return;const A=h$[t.value](),x=`"data:image/svg+xml;base64,${Ap(A)}"`;h.value=x}function J(A){s.value=Mt(A.show)?A.show:!1,s.value&&E(A,e)}function E(A,x){t.value=Mt(A.iconName)?A.iconName:x.iconName,m.value=Mt(A.iconClass)?A.iconClass:x.iconClass,n.value=Mt(A.msg)?A.msg:x.msg,i.value=Mt(A.position)?A.position:x.position,a.value=Mt(A.zIndex)?A.zIndex:x.zIndex,o.value=Mt(A.loadingType)?A.loadingType:x.loadingType,l.value=Mt(A.loadingColor)?A.loadingColor:x.loadingColor,c.value=Mt(A.iconSize)?ui(A.iconSize):Mt(x.iconSize)?ui(x.iconSize):void 0,u.value=Mt(A.loadingSize)?ui(A.loadingSize):Mt(x.loadingSize)?ui(x.loadingSize):void 0,f.value=Mt(A.cover)?A.cover:x.cover,d.value=Mt(A.classPrefix)?A.classPrefix:x.classPrefix,y.value=Mt(A.direction)?A.direction:x.direction,b=fn(A.closed)?A.closed:fn(x.closed)?x.closed:null,T=fn(A.opened)?A.opened:fn(x.opened)?x.opened:null}return(A,x)=>{const $=Yt;return _e(),Gn(Ht,null,[f.value?(_e(),Ne(yd,{key:0,"z-index":a.value,"lock-scroll":"",show:s.value,"custom-style":"background-color: transparent;pointer-events: auto;"},null,8,["z-index","show"])):gt("",!0),X(ru,{name:"fade",show:s.value,"custom-style":C.value,onAfterEnter:Q,onAfterLeave:te},{default:re(()=>[X($,{class:Nt(I.value)},{default:re(()=>[t.value==="loading"?(_e(),Ne(xp,{key:0,type:o.value,color:l.value,size:u.value,"custom-class":`wd-toast__icon ${y.value==="vertical"?"is-vertical":""}`},null,8,["type","color","size","custom-class"])):t.value==="success"||t.value==="warning"||t.value==="info"||t.value==="error"?(_e(),Ne($,{key:1,class:Nt(`wd-toast__iconWrap wd-toast__icon ${y.value==="vertical"?"is-vertical":""}`)},{default:re(()=>[X($,{class:"wd-toast__iconBox"},{default:re(()=>[X($,{class:"wd-toast__iconSvg",style:zt(H.value)},null,8,["style"])]),_:1})]),_:1},8,["class"])):m.value?(_e(),Ne(er,{key:2,"custom-class":`wd-toast__icon ${y.value==="vertical"?"is-vertical":""}`,size:c.value,"class-prefix":d.value,name:m.value},null,8,["custom-class","size","class-prefix","name"])):gt("",!0),n.value?(_e(),Ne($,{key:3,class:"wd-toast__msg"},{default:re(()=>[Ze(vt(n.value),1)]),_:1})):gt("",!0)]),_:1},8,["class"])]),_:1},8,["show","custom-style"])],64)}}})),zu=cn(p$,[["__scopeId","data-v-d24ac773"]]);function Wn(r,e){return typeof r=="string"?e:r}const Gu=(r,e=0)=>(t,n=Cn())=>{!Ya&&zs(r,t,n)},Ku=Gu(hs,3),m$=Gu(ks,3),y$=Gu(PE,1),Uv=Gu(Ka,2),g$={name:"wd-root-portal",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}};function b$(r,e,t,n,i,s){return _e(),Ne($N,{to:"body"},[Bt(r.$slots,"default")])}const E$=cn(g$,[["render",b$]]),w$=Tt(Xe({},xn),{transition:String,closable:qe(!1),position:lt("center"),closeOnClickModal:qe(!0),duration:{type:[Number,Boolean],default:300},modal:qe(!0),zIndex:jt(10),hideWhenClose:qe(!0),modalStyle:lt(""),safeAreaInsetBottom:qe(!1),modelValue:qe(!1),lazyRender:qe(!0),lockScroll:qe(!0),rootPortal:qe(!1)}),v$={name:"wd-popup",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},T$=Lt(Tt(Xe({},v$),{props:w$,emits:["update:modelValue","before-enter","enter","before-leave","leave","after-leave","after-enter","click-modal","close"],setup(r,{emit:e}){const t=r,n=e,i=Me(()=>t.transition?t.transition:t.position==="center"?["zoom-in","fade"]:t.position==="left"?"slide-left":t.position==="right"?"slide-right":t.position==="bottom"?"slide-up":t.position==="top"?"slide-down":"slide-up"),s=ge(0),a=Me(()=>`z-index:${t.zIndex}; padding-bottom: ${s.value}px;${t.customStyle}`),o=Me(()=>`wd-popup wd-popup--${t.position} ${!t.transition&&t.position==="center"?"is-deep":""} ${t.customClass||""}`);Xr(()=>{if(t.safeAreaInsetBottom){const{safeArea:h,screenHeight:f,safeAreaInsets:d}=Hu();h?s.value=d?d.bottom:0:s.value=0}});function l(){n("click-modal"),t.closeOnClickModal&&c()}function c(){n("close"),n("update:modelValue",!1)}function u(){}return(h,f)=>{const d=Yt;return h.rootPortal?(_e(),Ne(E$,{key:0},{default:re(()=>[X(d,{class:"wd-popup-wrapper"},{default:re(()=>[h.modal?(_e(),Ne(yd,{key:0,show:h.modelValue,"z-index":h.zIndex,"lock-scroll":h.lockScroll,duration:h.duration,"custom-style":h.modalStyle,onClick:l,onTouchmove:u},null,8,["show","z-index","lock-scroll","duration","custom-style"])):gt("",!0),X(ru,{"lazy-render":h.lazyRender,"custom-class":o.value,"custom-style":a.value,duration:h.duration,show:h.modelValue,name:i.value,destroy:h.hideWhenClose,onBeforeEnter:f[0]||(f[0]=m=>n("before-enter")),onEnter:f[1]||(f[1]=m=>n("enter")),onAfterEnter:f[2]||(f[2]=m=>n("after-enter")),onBeforeLeave:f[3]||(f[3]=m=>n("before-leave")),onLeave:f[4]||(f[4]=m=>n("leave")),onAfterLeave:f[5]||(f[5]=m=>n("after-leave"))},{default:re(()=>[Bt(h.$slots,"default",{},void 0,!0),h.closable?(_e(),Ne(er,{key:0,"custom-class":"wd-popup__close",name:"add",onClick:c})):gt("",!0)]),_:3},8,["lazy-render","custom-class","custom-style","duration","show","name","destroy"])]),_:3})]),_:3})):(_e(),Ne(d,{key:1,class:"wd-popup-wrapper"},{default:re(()=>[h.modal?(_e(),Ne(yd,{key:0,show:h.modelValue,"z-index":h.zIndex,"lock-scroll":h.lockScroll,duration:h.duration,"custom-style":h.modalStyle,onClick:l,onTouchmove:u},null,8,["show","z-index","lock-scroll","duration","custom-style"])):gt("",!0),X(ru,{"lazy-render":h.lazyRender,"custom-class":o.value,"custom-style":a.value,duration:h.duration,show:h.modelValue,name:i.value,destroy:h.hideWhenClose,onBeforeEnter:f[6]||(f[6]=m=>n("before-enter")),onEnter:f[7]||(f[7]=m=>n("enter")),onAfterEnter:f[8]||(f[8]=m=>n("after-enter")),onBeforeLeave:f[9]||(f[9]=m=>n("before-leave")),onLeave:f[10]||(f[10]=m=>n("leave")),onAfterLeave:f[11]||(f[11]=m=>n("after-leave"))},{default:re(()=>[Bt(h.$slots,"default",{},void 0,!0),h.closable?(_e(),Ne(er,{key:0,"custom-class":"wd-popup__close",name:"add",onClick:c})):gt("",!0)]),_:3},8,["lazy-render","custom-class","custom-style","duration","show","name","destroy"])]),_:3}))}}})),Rp=cn(T$,[["__scopeId","data-v-950f6ca5"]]),_$=Tt(Xe({},xn),{plain:qe(!1),round:qe(!0),disabled:qe(!1),hairline:qe(!1),block:qe(!1),type:lt("primary"),size:lt("medium"),icon:String,classPrefix:lt("wd-icon"),loading:qe(!1),loadingColor:String,openType:String,hoverStopPropagation:Boolean,lang:String,sessionFrom:String,sendMessageTitle:String,sendMessagePath:String,sendMessageImg:String,appParameter:String,showMessageCard:Boolean,buttonId:String,scope:String}),S$={name:"wd-button",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},C$=Lt(Tt(Xe({},S$),{props:_$,emits:["click","getuserinfo","contact","getphonenumber","error","launchapp","opensetting","chooseavatar","agreeprivacyauthorization"],setup(r,{emit:e}){const t=(C="#4D80F0",I=!0)=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><defs><linearGradient x1="100%" y1="0%" x2="0%" y2="0%" id="a"><stop stop-color="${I?C:"#fff"}" offset="0%" stop-opacity="0"/><stop stop-color="${I?C:"#fff"}" offset="100%"/></linearGradient></defs><g fill="none" fill-rule="evenodd"><path d="M21 1c11.046 0 20 8.954 20 20s-8.954 20-20 20S1 32.046 1 21 9.954 1 21 1zm0 7C13.82 8 8 13.82 8 21s5.82 13 13 13 13-5.82 13-13S28.18 8 21 8z" fill="${I?"#fff":C}"/><path d="M4.599 21c0 9.044 7.332 16.376 16.376 16.376 9.045 0 16.376-7.332 16.376-16.376" stroke="url(#a)" stroke-width="3.5" stroke-linecap="round"/></g></svg>`,n=r,i=e,s=ge(20),a=ge(70),o=ge(""),l=Me(()=>`background-image: url(${o.value});`);Ge(()=>n.loading,()=>{N()},{deep:!0,immediate:!0});function c(C){!n.disabled&&!n.loading&&i("click",C)}function u(C){n.scope==="phoneNumber"?d(C):n.scope==="userInfo"&&h(C)}function h(C){i("getuserinfo",C.detail)}function f(C){i("contact",C.detail)}function d(C){i("getphonenumber",C.detail)}function m(C){i("error",C.detail)}function y(C){i("launchapp",C.detail)}function T(C){i("opensetting",C.detail)}function b(C){i("chooseavatar",C.detail)}function S(C){i("agreeprivacyauthorization",C.detail)}function N(){const{loadingColor:C,type:I,plain:H}=n;let Q=C;if(!Q)switch(I){case"primary":Q="#4D80F0";break;case"success":Q="#34d19d";break;case"info":Q="#333";break;case"warning":Q="#f0883a";break;case"error":Q="#fa4350";break;case"default":Q="#333";break}const te=t(Q,!H);o.value=`"data:image/svg+xml;base64,${Ap(te)}"`}return(C,I)=>{const H=Yt,Q=U0;return _e(),Ne(Q,{id:C.buttonId,"hover-class":`${C.disabled||C.loading?"":"wd-button--active"}`,style:zt(C.customStyle),class:Nt(["wd-button","is-"+C.type,"is-"+C.size,C.round?"is-round":"",C.hairline?"is-hairline":"",C.plain?"is-plain":"",C.disabled?"is-disabled":"",C.block?"is-block":"",C.loading?"is-loading":"",C.customClass]),"hover-start-time":s.value,"hover-stay-time":a.value,"open-type":C.disabled||C.loading?void 0:C.openType,"send-message-title":C.sendMessageTitle,"send-message-path":C.sendMessagePath,"send-message-img":C.sendMessageImg,"app-parameter":C.appParameter,"show-message-card":C.showMessageCard,"session-from":C.sessionFrom,lang:C.lang,"hover-stop-propagation":C.hoverStopPropagation,scope:C.scope,onClick:c,onGetAuthorize:u,onGetuserinfo:h,onContact:f,onGetphonenumber:d,onError:m,onLaunchapp:y,onOpensetting:T,onChooseavatar:b,onAgreeprivacyauthorization:S},{default:re(()=>[X(H,{class:"wd-button__content"},{default:re(()=>[C.loading?(_e(),Ne(H,{key:0,class:"wd-button__loading"},{default:re(()=>[X(H,{class:"wd-button__loading-svg",style:zt(l.value)},null,8,["style"])]),_:1})):C.icon?(_e(),Ne(er,{key:1,"custom-class":"wd-button__icon",name:C.icon,classPrefix:C.classPrefix},null,8,["name","classPrefix"])):gt("",!0),X(H,{class:"wd-button__text"},{default:re(()=>[Bt(C.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3},8,["id","hover-class","style","class","hover-start-time","hover-stay-time","open-type","send-message-title","send-message-path","send-message-img","app-parameter","show-message-card","session-from","lang","hover-stop-propagation","scope"])}}})),Va=cn(C$,[["__scopeId","data-v-7f9ef195"]]);function Mp(r){const e=on(r,null);if(e){const t=Cn(),{link:n,unlink:i,internalChildren:s}=e;n(t),vl(()=>i(t));const a=Me(()=>s.indexOf(t));return{parent:e,index:a}}return{parent:null,index:ge(-1)}}const Vv=Symbol("wd-cell-group"),N$=Tt(Xe({},xn),{title:String,value:String,useSlot:qe(!1),border:qe(!1)});function jv(){const{parent:r,index:e}=Mp(Vv);return{border:Me(()=>r&&r.props.border&&e.value)}}const Pp=Symbol("wd-form"),A$=Tt(Xe({},xn),{model:en(Object),rules:{type:Object,default:()=>({})},resetOnChange:qe(!0),errorType:{type:String,default:"message"}}),x$={calendar:{placeholder:"请选择",title:"选择日期",day:"日",week:"周",month:"月",confirm:"确定",startTime:"开始时间",endTime:"结束时间",to:"至",timeFormat:"YY年MM月DD日 HH:mm:ss",dateFormat:"YYYY年MM月DD日",weekFormat:(r,e)=>`${r} 第 ${e} 周`,startWeek:"开始周",endWeek:"结束周",startMonth:"开始月",endMonth:"结束月",monthFormat:"YYYY年MM月"},calendarView:{startTime:"开始",endTime:"结束",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},rangePrompt:r=>`选择天数不能超过${r}天`,rangePromptWeek:r=>`选择周数不能超过${r}周`,rangePromptMonth:r=>`选择月份不能超过${r}个月`,monthTitle:"YYYY年M月",yearTitle:"YYYY年",month:"M月",hour:r=>`${r}时`,minute:r=>`${r}分`,second:r=>`${r}秒`},collapse:{expand:"展开",retract:"收起"},colPicker:{title:"请选择",placeholder:"请选择",select:"请选择"},datetimePicker:{start:"开始时间",end:"结束时间",to:"至",placeholder:"请选择",confirm:"完成",cancel:"取消"},loadmore:{loading:"正在努力加载中...",finished:"已加载完毕",error:"加载失败",retry:"点击重试"},messageBox:{inputPlaceholder:"请输入",confirm:"确定",cancel:"取消",inputNoValidate:"输入的数据不合法"},numberKeyboard:{confirm:"完成"},pagination:{prev:"上一页",next:"下一页",page:r=>`当前页：${r}`,total:r=>`当前数据：${r}条`,size:r=>`分页大小：${r}`},picker:{cancel:"取消",done:"完成",placeholder:"请选择"},imgCropper:{confirm:"完成",cancel:"取消"},search:{search:"搜索",cancel:"取消"},steps:{wait:"未开始",finished:"已完成",process:"进行中",failed:"失败"},tabs:{all:"全部"},upload:{error:"上传失败"},input:{placeholder:"请输入..."},selectPicker:{title:"请选择",placeholder:"请选择",select:"请选择",confirm:"确认",filterPlaceholder:"搜索"},tag:{placeholder:"请输入",add:"新增标签"},textarea:{placeholder:"请输入..."},tableCol:{indexLabel:"序号"},signature:{confirmText:"确认",clearText:"清空",revokeText:"撤销",restoreText:"恢复"}},vg=ge("zh-CN"),Tg=nn({"zh-CN":x$}),R$={messages(){return Tg[vg.value]},use(r,e){vg.value=r,e&&this.add({[r]:e})},add(r={}){nu(Tg,r)}},ps=r=>{const e=r?zO(r)+".":"";return{translate:(n,...i)=>{const s=R$.messages(),a=qv(s,e+n);return fn(a)?a(...i):Mt(a)?a:`${e}${n}`}}},M$=Tt(Xe({},xn),{customInputClass:lt(""),customLabelClass:lt(""),placeholder:String,placeholderStyle:String,placeholderClass:lt(""),cursorSpacing:jt(0),cursor:jt(-1),selectionStart:jt(-1),selectionEnd:jt(-1),adjustPosition:qe(!0),holdKeyboard:qe(!1),confirmType:lt("done"),confirmHold:qe(!1),focus:qe(!1),type:lt("text"),maxlength:{type:Number,default:-1},disabled:qe(!1),alwaysEmbed:qe(!1),alignRight:qe(!1),modelValue:Qu(""),showPassword:qe(!1),clearable:qe(!1),readonly:qe(!1),prefixIcon:String,suffixIcon:String,showWordLimit:qe(!1),label:String,labelWidth:lt(""),size:String,error:qe(!1),center:qe(!1),noBorder:qe(!1),required:qe(!1),prop:String,rules:eo(),clearTrigger:lt("always"),focusWhenClear:qe(!0),ignoreCompositionEvent:qe(!0),inputmode:lt("text"),markerSide:lt("before")}),P$={name:"wd-input",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},I$=Lt(Tt(Xe({},P$),{props:M$,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","clicksuffixicon","clickprefixicon","click"],setup(r,{emit:e}){const t=r,n=e,i=Vw(),{translate:s}=ps("input"),a=ge(!1),o=ge(!1),l=ge(!1),c=ge(!1),u=ge(H()),h=jv();Ge(()=>t.focus,L=>{l.value=L},{immediate:!0,deep:!0}),Ge(()=>t.modelValue,L=>{u.value=Mt(L)?String(L):""});const{parent:f}=Mp(Pp),d=Me(()=>Mt(t.placeholder)?t.placeholder:s("placeholder")),m=Me(()=>{const{disabled:L,readonly:Se,clearable:Ae,clearTrigger:ve}=t;return!!(Ae&&!Se&&!L&&u.value&&(ve==="always"||t.clearTrigger==="focus"&&c.value))}),y=Me(()=>{const{disabled:L,readonly:Se,maxlength:Ae,showWordLimit:ve}=t;return!!(!L&&!Se&&Mt(Ae)&&Ae>-1&&ve)}),T=Me(()=>f&&t.prop&&f.errorMessages&&f.errorMessages[t.prop]?f.errorMessages[t.prop]:""),b=Me(()=>{let L=!1;if(f&&f.props.rules){const Se=f.props.rules;for(const Ae in Se)Object.prototype.hasOwnProperty.call(Se,Ae)&&Ae===t.prop&&Array.isArray(Se[Ae])&&(L=Se[Ae].some(ve=>ve.required))}return t.required||t.rules.some(Se=>Se.required)||L}),S=Me(()=>`wd-input  ${t.label||i.label?"is-cell":""} ${t.center?"is-center":""} ${h.border.value?"is-border":""} ${t.size?"is-"+t.size:""} ${t.error?"is-error":""} ${t.disabled?"is-disabled":""}  ${u.value&&String(u.value).length>0?"is-not-empty":""}  ${t.noBorder?"is-no-border":""} ${t.customClass}`),N=Me(()=>`wd-input__label ${t.customLabelClass}`),C=Me(()=>`wd-input__placeholder  ${t.placeholderClass}`),I=Me(()=>t.labelWidth?Oi({"min-width":t.labelWidth,"max-width":t.labelWidth}):"");function H(){const L=Q(t.modelValue);return ue(L,t.modelValue)||n("update:modelValue",L),L}function Q(L){const{maxlength:Se}=t;return Mt(Se)&&Se!==-1&&String(L).length>Se?L.toString().slice(0,Se):L}function te(){a.value=!a.value}function V(){return v(this,null,function*(){c.value=!1,u.value="",t.focusWhenClear&&(o.value=!0,l.value=!1),yield jr(),t.focusWhenClear&&(l.value=!0,c.value=!0),n("update:modelValue",u.value),n("clear")})}function J(){return v(this,null,function*(){if(yield jr(150),o.value){o.value=!1;return}c.value=!1,n("blur",{value:u.value})})}function E({detail:L}){c.value=!0,n("focus",L)}function A({detail:L}){n("update:modelValue",u.value),n("input",L)}function x({detail:L}){n("keyboardheightchange",L)}function $({detail:L}){n("confirm",L)}function B(){n("clicksuffixicon")}function K(){n("clickprefixicon")}function ae(L){n("click",L)}function ue(L,Se){return Ua(String(L),String(Se))}return(L,Se)=>{const Ae=ju,ve=Yt,Ye=VP;return _e(),Ne(ve,{class:Nt(S.value),style:zt(L.customStyle),onClick:ae},{default:re(()=>[L.label||L.$slots.label?(_e(),Ne(ve,{key:0,class:Nt(N.value),style:zt(I.value)},{default:re(()=>[b.value&&L.markerSide==="before"?(_e(),Ne(Ae,{key:0,class:"wd-input__required wd-input__required--left"},{default:re(()=>[Ze("*")]),_:1})):gt("",!0),L.prefixIcon||L.$slots.prefix?(_e(),Ne(ve,{key:1,class:"wd-input__prefix"},{default:re(()=>[L.prefixIcon&&!L.$slots.prefix?(_e(),Ne(er,{key:0,"custom-class":"wd-input__icon",name:L.prefixIcon,onClick:K},null,8,["name"])):Bt(L.$slots,"prefix",{key:1},void 0,!0)]),_:3})):gt("",!0),X(ve,{class:"wd-input__label-inner"},{default:re(()=>[L.label&&!L.$slots.label?(_e(),Ne(Ae,{key:0},{default:re(()=>[Ze(vt(L.label),1)]),_:1})):L.$slots.label?Bt(L.$slots,"label",{key:1},void 0,!0):gt("",!0)]),_:3}),b.value&&L.markerSide==="after"?(_e(),Ne(Ae,{key:2,class:"wd-input__required"},{default:re(()=>[Ze("*")]),_:1})):gt("",!0)]),_:3},8,["class","style"])):gt("",!0),X(ve,{class:"wd-input__body"},{default:re(()=>[X(ve,{class:"wd-input__value"},{default:re(()=>[(L.prefixIcon||L.$slots.prefix)&&!L.label?(_e(),Ne(ve,{key:0,class:"wd-input__prefix"},{default:re(()=>[L.prefixIcon&&!L.$slots.prefix?(_e(),Ne(er,{key:0,"custom-class":"wd-input__icon",name:L.prefixIcon,onClick:K},null,8,["name"])):Bt(L.$slots,"prefix",{key:1},void 0,!0)]),_:3})):gt("",!0),X(Ye,{class:Nt(["wd-input__inner",L.prefixIcon?"wd-input__inner--prefix":"",y.value?"wd-input__inner--count":"",L.alignRight?"is-align-right":"",L.customInputClass]),type:L.type,password:L.showPassword&&!a.value,modelValue:u.value,"onUpdate:modelValue":Se[0]||(Se[0]=mt=>u.value=mt),placeholder:d.value,disabled:L.disabled||L.readonly,maxlength:L.maxlength,focus:l.value,"confirm-type":L.confirmType,"confirm-hold":L.confirmHold,cursor:L.cursor,"cursor-spacing":L.cursorSpacing,"placeholder-style":L.placeholderStyle,"selection-start":L.selectionStart,"selection-end":L.selectionEnd,"adjust-position":L.adjustPosition,"hold-keyboard":L.holdKeyboard,"always-embed":L.alwaysEmbed,"placeholder-class":C.value,ignoreCompositionEvent:L.ignoreCompositionEvent,inputmode:L.inputmode,onInput:A,onFocus:E,onBlur:J,onConfirm:$,onKeyboardheightchange:x},null,8,["class","type","password","modelValue","placeholder","disabled","maxlength","focus","confirm-type","confirm-hold","cursor","cursor-spacing","placeholder-style","selection-start","selection-end","adjust-position","hold-keyboard","always-embed","placeholder-class","ignoreCompositionEvent","inputmode"]),t.readonly?(_e(),Ne(ve,{key:1,class:"wd-input__readonly-mask"})):gt("",!0),m.value||L.showPassword||L.suffixIcon||y.value||L.$slots.suffix?(_e(),Ne(ve,{key:2,class:"wd-input__suffix"},{default:re(()=>[m.value?(_e(),Ne(er,{key:0,"custom-class":"wd-input__clear",name:"error-fill",onClick:V})):gt("",!0),L.showPassword?(_e(),Ne(er,{key:1,"custom-class":"wd-input__icon",name:a.value?"view":"eye-close",onClick:te},null,8,["name"])):gt("",!0),y.value?(_e(),Ne(ve,{key:2,class:"wd-input__count"},{default:re(()=>[X(Ae,{class:Nt([u.value&&String(u.value).length>0?"wd-input__count-current":"",String(u.value).length>L.maxlength?"is-error":""])},{default:re(()=>[Ze(vt(String(u.value).length),1)]),_:1},8,["class"]),Ze(" /"+vt(L.maxlength),1)]),_:1})):gt("",!0),L.suffixIcon&&!L.$slots.suffix?(_e(),Ne(er,{key:3,"custom-class":"wd-input__icon",name:L.suffixIcon,onClick:B},null,8,["name"])):Bt(L.$slots,"suffix",{key:4},void 0,!0)]),_:3})):gt("",!0)]),_:3}),T.value?(_e(),Ne(ve,{key:0,class:"wd-input__error-message"},{default:re(()=>[Ze(vt(T.value),1)]),_:1})):gt("",!0)]),_:3})]),_:3},8,["class","style"])}}})),O$=cn(I$,[["__scopeId","data-v-921fb1ee"]]),$$=Tt(Xe({},xn),{selector:lt(""),rootPortal:qe(!1)}),iu="__MESSAGE_OPTION__",Kh=Symbol("None"),bd={title:"",showCancelButton:!1,show:!1,closeOnClickModal:!0,msg:"",type:"alert",inputType:"text",inputValue:"",showErr:!1,zIndex:99,lazyRender:!0,inputError:""};function D$(r=""){const e=r?iu+r:iu,t=on(e,ge(Kh));t.value===Kh&&(t.value=bd,Qr(e,t));const n=c=>u=>{const h=Ia({type:c},typeof u=="string"?{title:u}:u);return h.type==="confirm"||h.type==="prompt"?h.showCancelButton=!0:h.showCancelButton=!1,i(h)},i=c=>new Promise((u,h)=>{const f=Ia(bd,typeof c=="string"?{title:c}:c);t.value=Ia(f,{show:!0,success:d=>{l(),u(d)},fail:d=>{l(),h(d)}})}),s=n("alert"),a=n("confirm"),o=n("prompt"),l=()=>{t.value!==Kh&&(t.value.show=!1)};return{show:i,alert:s,confirm:a,prompt:o,close:l}}const L$=r=>r?`${iu}${r}`:iu,q$={name:"wd-message-box",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},k$=Lt(Tt(Xe({},q$),{props:$$,setup(r){const e=r,{translate:t}=ps("message-box"),n=Me(()=>`wd-message-box__container ${e.customClass}`),i=Me(()=>`wd-message-box__body ${o.title?"":"is-no-title"} ${o.type==="prompt"?"is-prompt":""}`),s=L$(e.selector),a=on(s,ge(bd)),o=nn({msg:"",show:!1,title:"",showCancelButton:!1,closeOnClickModal:!0,confirmButtonText:"",cancelButtonText:"",type:"alert",inputType:"text",inputValue:"",inputPlaceholder:"",inputError:"",showErr:!1,zIndex:99,lazyRender:!0}),l=Me(()=>{const b=nu({block:!0},Mt(o.confirmButtonProps)?yg(o.confirmButtonProps,mg):{});return b.customClass=`${b.customClass||""} wd-message-box__actions-btn`,b}),c=Me(()=>{const b=nu({block:!0,type:"info"},Mt(o.cancelButtonProps)?yg(o.cancelButtonProps,mg):{});return b.customClass=`${b.customClass||""} wd-message-box__actions-btn`,b});Ge(()=>a.value,b=>{T(b)},{deep:!0,immediate:!0}),Ge(()=>o.show,b=>{m(!!b)},{deep:!0,immediate:!0});function u(b){if(!(b==="modal"&&!o.closeOnClickModal)&&!(o.type==="prompt"&&b==="confirm"&&!d()))switch(b){case"confirm":o.beforeConfirm?o.beforeConfirm({resolve:S=>{S&&h({action:b,value:o.inputValue})}}):h({action:b,value:o.inputValue});break;case"cancel":f({action:b});break;default:f({action:"modal"});break}}function h(b){o.show=!1,fn(o.success)&&o.success(b)}function f(b){o.show=!1,fn(o.fail)&&o.fail(b)}function d(){return o.inputPattern&&!o.inputPattern.test(String(o.inputValue))||typeof o.inputValidate=="function"&&!o.inputValidate(o.inputValue)?(o.showErr=!0,!1):(o.showErr=!1,!0)}function m(b){b===!1&&(o.showErr=!1)}function y({value:b}){if(b===""){o.showErr=!1;return}o.inputValue=b}function T(b){b&&(o.title=Mt(b.title)?b.title:"",o.showCancelButton=Mt(b.showCancelButton)?b.showCancelButton:!1,o.show=b.show,o.closeOnClickModal=b.closeOnClickModal,o.confirmButtonText=b.confirmButtonText,o.cancelButtonText=b.cancelButtonText,o.msg=b.msg,o.type=b.type,o.inputType=b.inputType,o.inputSize=b.inputSize,o.inputValue=b.inputValue,o.inputPlaceholder=b.inputPlaceholder,o.inputPattern=b.inputPattern,o.inputValidate=b.inputValidate,o.success=b.success,o.fail=b.fail,o.beforeConfirm=b.beforeConfirm,o.inputError=b.inputError,o.showErr=b.showErr,o.zIndex=b.zIndex,o.lazyRender=b.lazyRender,o.confirmButtonProps=b.confirmButtonProps,o.cancelButtonProps=b.cancelButtonProps)}return(b,S)=>{const N=Yt;return _e(),Ne(N,null,{default:re(()=>[X(Rp,{transition:"zoom-in",modelValue:o.show,"onUpdate:modelValue":S[3]||(S[3]=C=>o.show=C),"close-on-click-modal":o.closeOnClickModal,"lazy-render":o.lazyRender,"custom-class":"wd-message-box",onClickModal:S[4]||(S[4]=C=>u("modal")),"z-index":o.zIndex,duration:200,"root-portal":b.rootPortal},{default:re(()=>[X(N,{class:Nt(n.value)},{default:re(()=>[X(N,{class:Nt(i.value)},{default:re(()=>[o.title?(_e(),Ne(N,{key:0,class:"wd-message-box__title"},{default:re(()=>[Ze(vt(o.title),1)]),_:1})):gt("",!0),X(N,{class:"wd-message-box__content"},{default:re(()=>[o.type==="prompt"?(_e(),Gn(Ht,{key:0},[X(O$,{modelValue:o.inputValue,"onUpdate:modelValue":S[0]||(S[0]=C=>o.inputValue=C),type:o.inputType,size:o.inputSize,placeholder:o.inputPlaceholder,onInput:y},null,8,["modelValue","type","size","placeholder"]),o.showErr?(_e(),Ne(N,{key:0,class:"wd-message-box__input-error"},{default:re(()=>[Ze(vt(o.inputError||pt(t)("inputNoValidate")),1)]),_:1})):gt("",!0)],64)):gt("",!0),Bt(b.$slots,"default",{},()=>[Ze(vt(o.msg),1)],!0)]),_:3})]),_:3},8,["class"]),X(N,{class:Nt(`wd-message-box__actions ${o.showCancelButton?"wd-message-box__flex":"wd-message-box__block"}`)},{default:re(()=>[o.showCancelButton?(_e(),Ne(Va,di({key:0},c.value,{onClick:S[1]||(S[1]=C=>u("cancel"))}),{default:re(()=>[Ze(vt(o.cancelButtonText||pt(t)("cancel")),1)]),_:1},16)):gt("",!0),X(Va,di(l.value,{onClick:S[2]||(S[2]=C=>u("confirm"))}),{default:re(()=>[Ze(vt(o.confirmButtonText||pt(t)("confirm")),1)]),_:1},16)]),_:1},8,["class"])]),_:3},8,["class"])]),_:3},8,["modelValue","close-on-click-modal","lazy-render","z-index","root-portal"])]),_:3})}}})),B$=cn(k$,[["__scopeId","data-v-6722d1fb"]]),F$=Tt(Xe({},xn),{theme:lt("light"),themeVars:{type:Object,default:()=>({})}}),U$={name:"wd-config-provider",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},V$=Lt(Tt(Xe({},U$),{props:F$,setup(r){const e=r,t=Me(()=>`wot-theme-${e.theme} ${e.customClass}`),n=Me(()=>{const a=s(e.themeVars);return a?`${Oi(a)}${e.customStyle}`:e.customStyle}),i=a=>(a=a.replace(a.charAt(0),a.charAt(0).toLocaleLowerCase()),a.replace(/([a-z])([A-Z])/g,(o,l,c)=>l+"-"+c.toLowerCase())),s=a=>{if(!a)return;const o={};return Object.keys(a).forEach(l=>{o[`--wot-${i(l)}`]=a[l]}),o};return(a,o)=>{const l=Yt;return _e(),Ne(l,{class:Nt(t.value),style:zt(n.value)},{default:re(()=>[Bt(a.$slots,"default")]),_:3},8,["class","style"])}}}));/*!
* pinia v2.0.36
* (c) 2023 Eduardo San Martin Morote
* @license MIT
*/let Wv;const Yu=r=>Wv=r,Hv=Symbol();function Ed(r){return r&&typeof r=="object"&&Object.prototype.toString.call(r)==="[object Object]"&&typeof r.toJSON!="function"}var Jo;(function(r){r.direct="direct",r.patchObject="patch object",r.patchFunction="patch function"})(Jo||(Jo={}));function j$(){const r=Gd(!0),e=r.run(()=>ge({}));let t=[],n=[];const i=Da({install(s){Yu(i),i._a=s,s.provide(Hv,i),s.config.globalProperties.$pinia=i,n.forEach(a=>t.push(a)),n=[]},use(s){return this._a?t.push(s):n.push(s),this},_p:t,_a:null,_e:r,_s:new Map,state:e});return i}const Qv=()=>{};function _g(r,e,t,n=Qv){r.push(e);const i=()=>{const s=r.indexOf(e);s>-1&&(r.splice(s,1),n())};return!t&&sw()&&uC(i),i}function oa(r,...e){r.slice().forEach(t=>{t(...e)})}function wd(r,e){r instanceof Map&&e instanceof Map&&e.forEach((t,n)=>r.set(n,t)),r instanceof Set&&e instanceof Set&&e.forEach(r.add,r);for(const t in e){if(!e.hasOwnProperty(t))continue;const n=e[t],i=r[t];Ed(i)&&Ed(n)&&r.hasOwnProperty(t)&&!En(n)&&!os(n)?r[t]=wd(i,n):r[t]=n}return r}const W$=Symbol();function H$(r){return!Ed(r)||!r.hasOwnProperty(W$)}const{assign:Yi}=Object;function Q$(r){return!!(En(r)&&r.effect)}function z$(r,e,t,n){const{state:i,actions:s,getters:a}=e,o=t.state.value[r];let l;function c(){o||(t.state.value[r]=i?i():{});const u=DC(t.state.value[r]);return Yi(u,s,Object.keys(a||{}).reduce((h,f)=>(h[f]=Da(Me(()=>{Yu(t);const d=t._s.get(r);return a[f].call(d,d)})),h),{}))}return l=zv(r,c,e,t,n,!0),l}function zv(r,e,t={},n,i,s){let a;const o=Yi({actions:{}},t),l={deep:!0};let c,u,h=Da([]),f=Da([]),d;const m=n.state.value[r];!s&&!m&&(n.state.value[r]={}),ge({});let y;function T(Q){let te;c=u=!1,typeof Q=="function"?(Q(n.state.value[r]),te={type:Jo.patchFunction,storeId:r,events:d}):(wd(n.state.value[r],Q),te={type:Jo.patchObject,payload:Q,storeId:r,events:d});const V=y=Symbol();bn().then(()=>{y===V&&(c=!0)}),u=!0,oa(h,te,n.state.value[r])}const b=s?function(){const{state:te}=t,V=te?te():{};this.$patch(J=>{Yi(J,V)})}:Qv;function S(){a.stop(),h=[],f=[],n._s.delete(r)}function N(Q,te){return function(){Yu(n);const V=Array.from(arguments),J=[],E=[];function A(B){J.push(B)}function x(B){E.push(B)}oa(f,{args:V,name:Q,store:I,after:A,onError:x});let $;try{$=te.apply(this&&this.$id===r?this:I,V)}catch(B){throw oa(E,B),B}return $ instanceof Promise?$.then(B=>(oa(J,B),B)).catch(B=>(oa(E,B),Promise.reject(B))):(oa(J,$),$)}}const C={_p:n,$id:r,$onAction:_g.bind(null,f),$patch:T,$reset:b,$subscribe(Q,te={}){const V=_g(h,Q,te.detached,()=>J()),J=a.run(()=>Ge(()=>n.state.value[r],E=>{(te.flush==="sync"?u:c)&&Q({storeId:r,type:Jo.direct,events:d},E)},Yi({},l,te)));return V},$dispose:S},I=nn(C);n._s.set(r,I);const H=n._e.run(()=>(a=Gd(),a.run(()=>e())));for(const Q in H){const te=H[Q];if(En(te)&&!Q$(te)||os(te))s||(m&&H$(te)&&(En(te)?te.value=m[Q]:wd(te,m[Q])),n.state.value[r][Q]=te);else if(typeof te=="function"){const V=N(Q,te);H[Q]=V,o.actions[Q]=te}}return Yi(I,H),Yi(Vt(I),H),Object.defineProperty(I,"$state",{get:()=>n.state.value[r],set:Q=>{T(te=>{Yi(te,Q)})}}),n._p.forEach(Q=>{Yi(I,a.run(()=>Q({store:I,app:n._a,pinia:n,options:o})))}),m&&s&&t.hydrate&&t.hydrate(I.$state,m),c=!0,u=!0,I}function Ip(r,e,t){let n,i;const s=typeof e=="function";typeof r=="string"?(n=r,i=s?t:e):(i=r,n=r.id);function a(o,l){const c=Cn();return o=o||c&&on(Hv,null),o&&Yu(o),o=Wv,o._s.has(n)||(s?zv(n,e,i,o):z$(n,i,o)),o._s.get(n)}return a.$id=n,a}function G$(r){return typeof r=="object"&&r!==null}function Sg(r,e){return r=G$(r)?r:Object.create(null),new Proxy(r,{get(t,n,i){return n==="key"?Reflect.get(t,n,i):Reflect.get(t,n,i)||Reflect.get(e,n,i)}})}function K$(r,e){return e.reduce((t,n)=>t==null?void 0:t[n],r)}function Y$(r,e,t){return e.slice(0,-1).reduce((n,i)=>/^(__proto__)$/.test(i)?{}:n[i]=n[i]||{},r)[e[e.length-1]]=t,r}function J$(r,e){return e.reduce((t,n)=>{const i=n.split(".");return Y$(t,i,K$(r,i))},{})}function X$(r,e){return t=>{var n;try{const{storage:i=localStorage,beforeRestore:s=void 0,afterRestore:a=void 0,serializer:o={serialize:JSON.stringify,deserialize:JSON.parse},key:l=e.$id,paths:c=null,debug:u=!1}=t;return{storage:i,beforeRestore:s,afterRestore:a,serializer:o,key:((n=r.key)!=null?n:h=>h)(typeof l=="string"?l:l(e.$id)),paths:c,debug:u}}catch(i){return t.debug,null}}}function Cg(r,{storage:e,serializer:t,key:n,debug:i}){try{const s=e==null?void 0:e.getItem(n);s&&r.$patch(t==null?void 0:t.deserialize(s))}catch(s){}}function Ng(r,{storage:e,serializer:t,key:n,paths:i,debug:s}){try{const a=Array.isArray(i)?J$(r,i):r;e.setItem(n,t.serialize(a))}catch(a){}}function Z$(r={}){return e=>{const{auto:t=!1}=r,{options:{persist:n=t},store:i,pinia:s}=e;if(!n)return;if(!(i.$id in s.state.value)){const o=s._s.get(i.$id.replace("__hot:",""));o&&Promise.resolve().then(()=>o.$persist());return}const a=(Array.isArray(n)?n.map(o=>Sg(o,r)):[Sg(n,r)]).map(X$(r,i)).filter(Boolean);i.$persist=()=>{a.forEach(o=>{Ng(i.$state,o)})},i.$hydrate=({runHooks:o=!0}={})=>{a.forEach(l=>{const{beforeRestore:c,afterRestore:u}=l;o&&(c==null||c(e)),Cg(i,l),o&&(u==null||u(e))})},a.forEach(o=>{const{beforeRestore:l,afterRestore:c}=o;l==null||l(e),Cg(i,o),c==null||c(e),i.$subscribe((u,h)=>{Ng(h,o)},{detached:!0})})}}const Gv=Ip("theme-store",()=>{const r=ge("light"),e=ge({colorTheme:"rgba(68, 190, 147, 1)"});return{setThemeVars:i=>{e.value=Xe(Xe({},e.value),i)},toggleTheme:()=>{r.value=r.value==="light"?"dark":"light"},themeVars:e,theme:r}},{persist:!0}),su=[{path:"pages/poop",type:"home"},{path:"pages/calendar",type:"page"},{path:"pages/record",type:"page"},{path:"pages/setting",type:"page"}],eD=[{root:"pages-sub",pages:[{path:"demo/index",type:"page",style:{navigationBarTitleText:"分包页面"}}]}];var ma={},tD={VITE_APP_TITLE:"poop-rect",VITE_APP_PORT:"9001",VITE_UNI_APPID:"",VITE_WX_APPID:"wx7face5849a5dbbac",VITE_APP_PUBLIC_BASE:"/",VITE_SERVER_BASEURL:"",VITE_APP_PROXY_ENABLE:"false",VITE_APP_PROXY_PREFIX:"/fg-api",VITE_API_SECONDARY_URL:"",VITE_AUTH_MODE:"single",VITE_DELETE_CONSOLE:"true",VITE_SHOW_SOURCEMAP:"false",VITE_CJS_IGNORE_WARNING:"true",VITE_ROOT_DIR:"D:\\_repo\\myapp\\poopoo-rect",VITE_USER_NODE_ENV:"production",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1},nD={};const Ac=Object.create(null),Co=r=>{var e;return ma||tD||((e=globalThis.Deno)==null?void 0:e.env.toObject())||globalThis.__env__||(r?Ac:globalThis)},ct=new Proxy(Ac,{get(r,e){var t;return(t=Co()[e])!=null?t:Ac[e]},has(r,e){const t=Co();return e in t||e in Ac},set(r,e,t){const n=Co(!0);return n[e]=t,!0},deleteProperty(r,e){if(!e)return!1;const t=Co(!0);return delete t[e],!0},ownKeys(){const r=Co(!0);return Object.keys(r)}}),rD=typeof process<"u"&&nD&&"production"||"",iD=[["APPVEYOR"],["AWS_AMPLIFY","AWS_APP_ID",{ci:!0}],["AZURE_PIPELINES","SYSTEM_TEAMFOUNDATIONCOLLECTIONURI"],["AZURE_STATIC","INPUT_AZURE_STATIC_WEB_APPS_API_TOKEN"],["APPCIRCLE","AC_APPCIRCLE"],["BAMBOO","bamboo_planKey"],["BITBUCKET","BITBUCKET_COMMIT"],["BITRISE","BITRISE_IO"],["BUDDY","BUDDY_WORKSPACE_ID"],["BUILDKITE"],["CIRCLE","CIRCLECI"],["CIRRUS","CIRRUS_CI"],["CLOUDFLARE_PAGES","CF_PAGES",{ci:!0}],["CLOUDFLARE_WORKERS","WORKERS_CI",{ci:!0}],["CODEBUILD","CODEBUILD_BUILD_ARN"],["CODEFRESH","CF_BUILD_ID"],["DRONE"],["DRONE","DRONE_BUILD_EVENT"],["DSARI"],["GITHUB_ACTIONS"],["GITLAB","GITLAB_CI"],["GITLAB","CI_MERGE_REQUEST_ID"],["GOCD","GO_PIPELINE_LABEL"],["LAYERCI"],["HUDSON","HUDSON_URL"],["JENKINS","JENKINS_URL"],["MAGNUM"],["NETLIFY"],["NETLIFY","NETLIFY_LOCAL",{ci:!1}],["NEVERCODE"],["RENDER"],["SAIL","SAILCI"],["SEMAPHORE"],["SCREWDRIVER"],["SHIPPABLE"],["SOLANO","TDDIUM"],["STRIDER"],["TEAMCITY","TEAMCITY_VERSION"],["TRAVIS"],["VERCEL","NOW_BUILDER"],["VERCEL","VERCEL",{ci:!1}],["VERCEL","VERCEL_ENV",{ci:!1}],["APPCENTER","APPCENTER_BUILD_ID"],["CODESANDBOX","CODESANDBOX_SSE",{ci:!1}],["CODESANDBOX","CODESANDBOX_HOST",{ci:!1}],["STACKBLITZ"],["STORMKIT"],["CLEAVR"],["ZEABUR"],["CODESPHERE","CODESPHERE_APP_ID",{ci:!0}],["RAILWAY","RAILWAY_PROJECT_ID"],["RAILWAY","RAILWAY_SERVICE_ID"],["DENO-DEPLOY","DENO_DEPLOYMENT_ID"],["FIREBASE_APP_HOSTING","FIREBASE_APP_HOSTING",{ci:!0}]];function sD(){var r,e;if(ma)for(const t of iD){const n=t[1]||t[0];if(ma[n])return Xe({name:t[0].toLowerCase()},t[2])}return(ma==null?void 0:ma.SHELL)==="/bin/jsh"&&((e=(r=globalThis.process)==null?void 0:r.versions)!=null&&e.webcontainer)?{name:"stackblitz",ci:!1}:{name:"",ci:!1}}const Kv=sD();Kv.name;function Vs(r){return r?r!=="false":!1}var aE;const aD=((aE=globalThis.process)==null?void 0:aE.platform)||"",Yv=Vs(ct.CI)||Kv.ci!==!1;var oE,lE;const Jv=Vs(((oE=globalThis.process)==null?void 0:oE.stdout)&&((lE=globalThis.process)==null?void 0:lE.stdout.isTTY));Vs(ct.DEBUG);const oD=rD==="test"||Vs(ct.TEST);Vs(ct.MINIMAL);const lD=/^win/i.test(aD);!Vs(ct.NO_COLOR)&&(Vs(ct.FORCE_COLOR)||(Jv||lD)&&ct.TERM);var cE,uE;const Yh=(((uE=(cE=globalThis.process)==null?void 0:cE.versions)==null?void 0:uE.node)||"").replace(/^v/,"")||null;Number(Yh==null?void 0:Yh.split(".")[0]);const cD=globalThis.process||Object.create(null),Ag={versions:{}};new Proxy(cD,{get(r,e){if(e==="env")return ct;if(e in r)return r[e];if(e in Ag)return Ag[e]}});var hE,fE;const uD=((fE=(hE=globalThis.process)==null?void 0:hE.release)==null?void 0:fE.name)==="node";var dE,pE;const hD=!!globalThis.Bun||!!((pE=(dE=globalThis.process)==null?void 0:dE.versions)!=null&&pE.bun),fD=!!globalThis.Deno,dD=!!globalThis.fastly,pD=!!globalThis.Netlify,mD=!!globalThis.EdgeRuntime;var mE;const yD=((mE=globalThis.navigator)==null?void 0:mE.userAgent)==="Cloudflare-Workers",gD=[[pD,"netlify"],[mD,"edge-light"],[yD,"workerd"],[dD,"fastly"],[fD,"deno"],[hD,"bun"],[uD,"node"]];function bD(){const r=gD.find(e=>e[0]);if(r)return{name:r[1]}}const Jh=bD();Jh!=null&&Jh.name;function no(r){return r?r!=="false":!1}function ED(r){let e;try{e=JSON.parse(r||"{}")}catch(t){e={}}return e}const wD="h5";ct.UNI_APP_PLATFORM;ct.UNI_UTS_PLATFORM;const vD=/^mp-/i.test(wD);ct.UNI_UTS_JS_CODE_FORMAT;ct.UNI_UTS_MODULE_TYPE;ct.UNI_UTS_MODULE_PREFIX;ct.UNI_UTS_TARGET_LANGUAGE;ct.UNI_INPUT_DIR;ct.UNI_OUTPUT_DIR;ct.UNI_CLI_CONTEXT;ct.UNI_COMPILER_VERSION_TYPE;ct.UNI_HBUILDERX_PLUGINS;ct.UNI_RENDERER;ct.UNI_NVUE_COMPILER;ct.UNI_NVUE_STYLE_COMPILER;ct.UNI_APP_CODE_SPLITING;ct.UNI_AUTOMATOR_APP_WEBVIEW;ct.UNI_H5_BASE;ct.UNI_H5_BROWSER;ct.UNI_CUSTOM_SCRIPT;ct.UNI_CUSTOM_DEFINE;ct.UNI_CUSTOM_CONTEXT;ct.UNI_MINIMIZE;no(ct.UNI_MINIMIZE);ct.UNI_UVUE;no(ct.UNI_UVUE);ct.UNI_UVUE_TARGET_LANGUAGE;ct.UNI_COMPILER;ct.UNI_RENDERER_NATIVE;ct.UNI_NVUE_APP_STYLES;ct.UNI_APP_CHANGED_FILES;ct.UNI_APP_CHANGED_PAGES;ct.HX_USE_BASE_TYPE;ct.HX_DEPENDENCIES_DIR;ct.UNI_APP_X;no(ct.UNI_APP_X);ct.UNI_APP_X_CACHE_DIR;ct.HX_VERSION;ct.UNI_APP_X_PAGE_COUNT;ct.UNI_APP_X_TSC;ct.UNI_APP_X_SINGLE_THREAD;ct.UNI_APP_X_SETUP;ct.UNI_APP_X_UVUE_SCRIPT_ENGINE;ct.UNI_COMPILE_TARGET;ct.UNI_COMPILE_CLOUD_DIR;ct.UNI_MODULES_ENCRYPT_CACHE_DIR;ct.UNI_APP_PACK_TYPE;ct.UNI_APP_HARMONY_PROJECT_PATH;ED(ct.STAT_TITLE_JSON);ct.SOURCEMAP;no(ct.SOURCEMAP);ct.UNI_SSR_CLIENT;no(ct.UNI_SSR_CLIENT);ct.UNI_SSR_SERVER;no(ct.UNI_SSR_SERVER);function Xv(r){return $D.includes(r)}const Ea={invoke({url:r,query:e}){var l;if(r===void 0)return;let{path:t,query:n}=aT(r);const i=Xe(Xe({},n),e);if(!t.startsWith("/")){const c=((l=rT())==null?void 0:l.route)||"",u=c.startsWith("/")?c:`/${c}`;t=`${u.substring(0,u.lastIndexOf("/"))}/${t}`}if($o.setAutoCurIdx(t),vD)return!0;if(Ju().hasLogin){if(t!==vd)return!0;{const c=i.redirect||MD;return nT(c)?av({url:c}):Mi({url:c}),!1}}let a=t;Object.keys(i).length&&(a+=`?${Object.keys(i).map(c=>`${c}=${i[c]}`).join("&")}`);const o=`${vd}?redirect=${encodeURIComponent(a)}`;return Xv(t)?(Mi({url:o}),!1):!0}},TD={install(){ba("navigateTo",Ea),ba("reLaunch",Ea),ba("redirectTo",Ea),ba("switchTab",Ea)}},dl={NO_TABBAR:0,NATIVE_TABBAR:1,CUSTOM_TABBAR_WITH_CACHE:2,CUSTOM_TABBAR_WITHOUT_CACHE:3},Zv=dl.NO_TABBAR,eT=[{iconPath:"static/tabbar/home.png",selectedIconPath:"static/tabbar/homeHL.png",pagePath:"pages/index/index",text:"%tabbar.home%"},{iconPath:"static/tabbar/example.png",selectedIconPath:"static/tabbar/exampleHL.png",pagePath:"pages/about/about",text:"%tabbar.about%"},{iconPath:"static/tabbar/personal.png",selectedIconPath:"static/tabbar/personalHL.png",pagePath:"pages/me/me",text:"%tabbar.me%"}],tT=[{text:"%tabbar.home%",pagePath:"pages/index/index",iconType:"unocss",icon:"i-carbon-home"},{text:"%tabbar.about%",pagePath:"pages/about/about",iconType:"unocss",icon:"i-carbon-code"},{pagePath:"pages/me/me",text:"%tabbar.me%",iconType:"unocss",icon:"i-carbon-user"}],_D=[dl.NATIVE_TABBAR,dl.CUSTOM_TABBAR_WITH_CACHE].includes(Zv),Op=[dl.CUSTOM_TABBAR_WITH_CACHE,dl.CUSTOM_TABBAR_WITHOUT_CACHE].includes(Zv);Op&&tT.map(r=>({text:r.text,pagePath:r.pagePath}));const SD=Op?tT:eT,Ci=nn(SD.map(r=>Tt(Xe({},r),{pagePath:r.pagePath.startsWith("/")?r.pagePath:`/${r.pagePath}`})));function nT(r){const e=r.split("?")[0];return Ci.some(t=>t.pagePath===e)}const $o=nn({curIdx:Ko("app-tabbar-index")||0,prevIdx:Ko("app-tabbar-index")||0,setCurIdx(r){(Ju().hasLogin||ID||!Xv(Ci[r].pagePath))&&(this.curIdx=r,Go("app-tabbar-index",r))},setTabbarItemBadge(r,e){Ci[r]&&(Ci[r].badge=e)},setAutoCurIdx(r){if(r==="/"){this.setCurIdx(0);return}const e=Ci.findIndex(t=>t.pagePath===r);if(e===-1){const t=qi().map(i=>i.route.startsWith("/")?i.route:`/${i.route}`);if(!Ci.some(i=>t.includes(i.pagePath))){this.setCurIdx(0);return}}else this.setCurIdx(e)},restorePrevIdx(){this.prevIdx!==this.curIdx&&(this.setCurIdx(this.prevIdx),this.prevIdx=Ko("app-tabbar-index")||0)}}),CD="h5",ND="h5".startsWith("mp-weixin");function rT(){const r=qi();return r[r.length-1]}function iT(){const r=rT();if(!r)return{path:"",query:{}};const e=r.$page,{fullPath:t}=e;return aT(t)}function sT(r){return r.startsWith("%")?sT(decodeURIComponent(r)):r}function aT(r){const[e,t]=r.split("?");if(!t)return{path:e,query:{}};const n={};return t.split("&").forEach(i=>{const[s,a]=i.split("=");n[s]=sT(a)}),{path:e,query:n}}function AD(r="excludeLoginPath"){const e=su.filter(i=>!r||i[r]).map(i=>Tt(Xe({},i),{path:`/${i.path}`})),t=[];return eD.forEach(i=>{const{root:s}=i;i.pages.filter(a=>!r||a[r]).forEach(a=>{t.push(Tt(Xe({},a),{path:`/${s}/${a.path}`}))})}),[...e,...t]}function xD(){var t;const r=iT(),e=su.find(n=>`/${n.path}`===r.path);return e?(t=e.style)==null?void 0:t.navigationBarTitleText:""}function RD(){let r="";const e="https://ukw0y1.laf.run",t="https://ukw0y1.laf.run",n="https://ukw0y1.laf.run";if(ND){const{miniProgram:{envVersion:i}}=uni.getAccountInfoSync();switch(i){case"develop":r=e;break;case"trial":r=t;break;case"release":r=n;break}}return r}var yE;const MD=`/${((yE=su.find(r=>r.type==="home"))==null?void 0:yE.path)||su[0].path}`,oT={DEFAULT_NO_NEED_LOGIN:0,DEFAULT_NEED_LOGIN:1},PD=oT.DEFAULT_NO_NEED_LOGIN,ID=PD===oT.DEFAULT_NEED_LOGIN,vd="/pages/login/login",OD=AD("excludeLoginPath").map(r=>r.path),$D=["/pages/xxx/index",...OD];var Td=(r=>(r[r.Success0=0]="Success0",r[r.Success200=200]="Success200",r[r.Error=400]="Error",r[r.Unauthorized=401]="Unauthorized",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.RequestTimeout=408]="RequestTimeout",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout",r[r.HttpVersionNotSupported=505]="HttpVersionNotSupported",r))(Td||{});function Fn(r){return new Promise((e,t)=>{WI(Tt(Xe({},r),{dataType:"json",responseType:"json",success:n=>v(this,null,function*(){if(n.statusCode>=200&&n.statusCode<300){const{code:s,message:a,data:o}=n.data;if(s!==Td.Success0&&s!==Td.Success200)throw new Error(`请求错误[${s}]：${a}`);return e(o)}const i=n.data;if(n.statusCode===401||i.code===401)return Ju().logout(),Mi({url:vd}),t(n);!r.hideErrorToast&&Ps({icon:"none",title:n.data.msg||"请求错误"}),t(n)}),fail(n){Ps({icon:"none",title:"网络错误，换个网络试试"}),t(n)}}))})}function lT(r,e,t,n){return Fn(Xe({url:r,query:e,method:"GET",header:t},n))}function cT(r,e,t,n,i){return Fn(Xe({url:r,query:t,data:e,method:"POST",header:n},i))}function uT(r,e,t,n,i){return Fn(Xe({url:r,data:e,query:t,method:"PUT",header:n},i))}function hT(r,e,t,n){return Fn(Xe({url:r,query:e,method:"DELETE",header:t},n))}Fn.get=lT;Fn.post=cT;Fn.put=uT;Fn.delete=hT;Fn.Get=lT;Fn.Post=cT;Fn.Put=uT;Fn.Delete=hT;function DD(r){return Fn.post("/auth/login",r)}function LD(){return Fn.get("/user/info")}function qD(){return Fn.get("/auth/logout")}function kD(){return new Promise((r,e)=>{mO({provider:"weixin",success:t=>r(t),fail:t=>e(new Error(t))})})}function BD(r){return Fn.post("/auth/wxLogin",r)}function Xh(r){return"token"in r&&!("refreshToken"in r)}function FD(r){return"accessToken"in r&&"refreshToken"in r}const Zh={userId:-1,username:"",nickname:"",avatar:"/static/images/default-avatar.png"},xg=Ip("user",()=>{const r=ge(Xe({},Zh)),e=s=>{s.avatar||(s.avatar=Zh.avatar),r.value=s};return{userInfo:r,clearUserInfo:()=>{r.value=Xe({},Zh),_c("user")},fetchUserInfo:()=>v(void 0,null,function*(){const s=yield LD();return e(s),s}),setUserInfo:e,setUserAvatar:s=>{r.value.avatar=s}}},{persist:!0}),UD=!1,Rg={token:"",expiresIn:0},Ju=Ip("token",()=>{const r=ge(Xe({},Rg)),e=f=>{r.value=f;const d=Date.now();if(Xh(f)){const m=d+f.expiresIn*1e3;Go("accessTokenExpireTime",m)}else if(FD(f)){const m=d+f.accessExpiresIn*1e3,y=d+f.refreshExpiresIn*1e3;Go("accessTokenExpireTime",m),Go("refreshTokenExpireTime",y)}},t=Me(()=>{if(!r.value)return!0;const f=Date.now(),d=Ko("accessTokenExpireTime");return d?f>=d:!0});Me(()=>!0);function n(f){return v(this,null,function*(){e(f),yield xg().fetchUserInfo()})}const i=f=>v(void 0,null,function*(){try{const d=yield DD(f);return yield n(d),Ps({title:"登录成功",icon:"success"}),d}catch(d){throw Ps({title:"登录失败，请重试",icon:"error"}),d}}),s=()=>v(void 0,null,function*(){try{const f=yield kD(),d=yield BD(f);return yield n(d),Ps({title:"登录成功",icon:"success"}),d}catch(f){throw Ps({title:"微信登录失败，请重试",icon:"error"}),f}}),a=()=>v(void 0,null,function*(){try{yield qD()}catch(f){}finally{_c("accessTokenExpireTime"),_c("refreshTokenExpireTime"),r.value=Xe({},Rg),_c("token"),xg().clearUserInfo()}}),o=()=>v(void 0,null,function*(){throw new Error("单token模式不支持刷新token")}),l=Me(()=>t.value?"":Xh(r.value)?r.value.token:""),c=Me(()=>r.value?Xh(r.value)&&!!r.value.token:!1),u=Me(()=>c.value&&!t.value);return{login:i,wxLogin:s,logout:a,hasLogin:u,refreshToken:o,tryGetValidToken:()=>v(void 0,null,function*(){return l.value,l.value}),validToken:l,tokenInfo:r,setTokenInfo:e}},{persist:!0}),fT=j$();fT.use(Z$({storage:{getItem:Ko,setItem:Go}}));const VD="./static/tabbar/scan.png";/*!
* @intlify/shared v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const jD=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",ro=r=>jD?Symbol(r):r,WD=(r,e,t)=>HD({l:r,k:e,s:t}),HD=r=>JSON.stringify(r).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),Nr=r=>typeof r=="number"&&isFinite(r),QD=r=>$p(r)==="[object Date]",ja=r=>$p(r)==="[object RegExp]",Xu=r=>kt(r)&&Object.keys(r).length===0;function zD(r,e){}const nr=Object.assign;function Mg(r){return r.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const GD=Object.prototype.hasOwnProperty;function dT(r,e){return GD.call(r,e)}const Sn=Array.isArray,Ar=r=>typeof r=="function",yt=r=>typeof r=="string",Xt=r=>typeof r=="boolean",Rr=r=>r!==null&&typeof r=="object",KD=Object.prototype.toString,$p=r=>KD.call(r),kt=r=>$p(r)==="[object Object]";/*!
* @intlify/message-resolver v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const YD=Object.prototype.hasOwnProperty;function JD(r,e){return YD.call(r,e)}const xc=r=>r!==null&&typeof r=="object",ms=[];ms[0]={w:[0],i:[3,0],"[":[4],o:[7]};ms[1]={w:[1],".":[2],"[":[4],o:[7]};ms[2]={w:[2],i:[3,0],0:[3,0]};ms[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};ms[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};ms[5]={"'":[4,0],o:8,l:[5,0]};ms[6]={'"':[4,0],o:8,l:[6,0]};const XD=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function ZD(r){return XD.test(r)}function eL(r){const e=r.charCodeAt(0),t=r.charCodeAt(r.length-1);return e===t&&(e===34||e===39)?r.slice(1,-1):r}function tL(r){if(r==null)return"o";switch(r.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return r;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function nL(r){const e=r.trim();return r.charAt(0)==="0"&&isNaN(parseInt(r))?!1:ZD(e)?eL(e):"*"+e}function rL(r){const e=[];let t=-1,n=0,i=0,s,a,o,l,c,u,h;const f=[];f[0]=()=>{a===void 0?a=o:a+=o},f[1]=()=>{a!==void 0&&(e.push(a),a=void 0)},f[2]=()=>{f[0](),i++},f[3]=()=>{if(i>0)i--,n=4,f[0]();else{if(i=0,a===void 0||(a=nL(a),a===!1))return!1;f[1]()}};function d(){const m=r[t+1];if(n===5&&m==="'"||n===6&&m==='"')return t++,o="\\"+m,f[0](),!0}for(;n!==null;)if(t++,s=r[t],!(s==="\\"&&d())){if(l=tL(s),h=ms[n],c=h[l]||h.l||8,c===8||(n=c[0],c[1]!==void 0&&(u=f[c[1]],u&&(o=s,u()===!1))))return;if(n===7)return e}}const Pg=new Map;function au(r,e){if(!xc(r))return null;let t=Pg.get(e);if(t||(t=rL(e),t&&Pg.set(e,t)),!t)return null;const n=t.length;let i=r,s=0;for(;s<n;){const a=i[t[s]];if(a===void 0)return null;i=a,s++}return i}function _d(r){if(!xc(r))return r;for(const e in r)if(JD(r,e))if(!e.includes("."))xc(r[e])&&_d(r[e]);else{const t=e.split("."),n=t.length-1;let i=r;for(let s=0;s<n;s++)t[s]in i||(i[t[s]]={}),i=i[t[s]];i[t[n]]=r[e],delete r[e],xc(i[t[n]])&&_d(i[t[n]])}return r}/*!
* @intlify/shared v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const ya=r=>typeof r=="number"&&isFinite(r),pT=Object.assign,iL=Array.isArray,No=r=>typeof r=="function",wa=r=>typeof r=="string",ef=r=>r!==null&&typeof r=="object",mT=Object.prototype.toString,sL=r=>mT.call(r),Rc=r=>sL(r)==="[object Object]",aL=r=>r==null?"":iL(r)||Rc(r)&&r.toString===mT?JSON.stringify(r,null,2):String(r);/*!
* @intlify/runtime v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const oL=r=>r,lL=r=>"",cL="text",uL=r=>r.length===0?"":r.join(""),hL=aL;function Ig(r,e){return r=Math.abs(r),e===2?r?r>1?1:0:1:r?Math.min(r,2):0}function fL(r){const e=ya(r.pluralIndex)?r.pluralIndex:-1;return r.named&&(ya(r.named.count)||ya(r.named.n))?ya(r.named.count)?r.named.count:ya(r.named.n)?r.named.n:e:e}function dL(r,e){e.count||(e.count=r),e.n||(e.n=r)}function pL(r={}){const e=r.locale,t=fL(r),n=ef(r.pluralRules)&&wa(e)&&No(r.pluralRules[e])?r.pluralRules[e]:Ig,i=ef(r.pluralRules)&&wa(e)&&No(r.pluralRules[e])?Ig:void 0,s=T=>T[n(t,T.length,i)],a=r.list||[],o=T=>a[T],l=r.named||{};ya(r.pluralIndex)&&dL(t,l);const c=T=>l[T];function u(T){const b=No(r.messages)?r.messages(T):ef(r.messages)?r.messages[T]:!1;return b||(r.parent?r.parent.message(T):lL)}const h=T=>r.modifiers?r.modifiers[T]:oL,f=Rc(r.processor)&&No(r.processor.normalize)?r.processor.normalize:uL,d=Rc(r.processor)&&No(r.processor.interpolate)?r.processor.interpolate:hL,m=Rc(r.processor)&&wa(r.processor.type)?r.processor.type:cL,y={list:o,named:c,plural:s,linked:(T,b)=>{const S=u(T)(y);return wa(b)?h(b)(S):S},message:u,type:m,interpolate:d,normalize:f};return y}/*!
* @intlify/message-compiler v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/function Zu(r,e,t={}){const{domain:n,messages:i,args:s}=t,a=r,o=new SyntaxError(String(a));return o.code=r,e&&(o.location=e),o.domain=n,o}function mL(r){throw r}function yL(r,e,t){return{line:r,column:e,offset:t}}function Sd(r,e,t){return{start:r,end:e}}const vi=" ",gL="\r",Jn=`
`,bL="\u2028",EL="\u2029";function wL(r){const e=r;let t=0,n=1,i=1,s=0;const a=Q=>e[Q]===gL&&e[Q+1]===Jn,o=Q=>e[Q]===Jn,l=Q=>e[Q]===EL,c=Q=>e[Q]===bL,u=Q=>a(Q)||o(Q)||l(Q)||c(Q),h=()=>t,f=()=>n,d=()=>i,m=()=>s,y=Q=>a(Q)||l(Q)||c(Q)?Jn:e[Q],T=()=>y(t),b=()=>y(t+s);function S(){return s=0,u(t)&&(n++,i=0),a(t)&&t++,t++,i++,e[t]}function N(){return a(t+s)&&s++,s++,e[t+s]}function C(){t=0,n=1,i=1,s=0}function I(Q=0){s=Q}function H(){const Q=t+s;for(;Q!==t;)S();s=0}return{index:h,line:f,column:d,peekOffset:m,charAt:y,currentChar:T,currentPeek:b,next:S,peek:N,reset:C,resetPeek:I,skipToPeek:H}}const Gi=void 0,Og="'",vL="tokenizer";function TL(r,e={}){const t=e.location!==!1,n=wL(r),i=()=>n.index(),s=()=>yL(n.line(),n.column(),n.index()),a=s(),o=i(),l={currentType:14,offset:o,startLoc:a,endLoc:a,lastType:14,lastOffset:o,lastStartLoc:a,lastEndLoc:a,braceNest:0,inLinked:!1,text:""},c=()=>l,{onError:u}=e;function h(j,G,M,...q){const se=c();if(G.column+=M,G.offset+=M,u){const le=Sd(se.startLoc,G),be=Zu(j,le,{domain:vL,args:q});u(be)}}function f(j,G,M){j.endLoc=s(),j.currentType=G;const q={type:G};return t&&(q.loc=Sd(j.startLoc,j.endLoc)),M!=null&&(q.value=M),q}const d=j=>f(j,14);function m(j,G){return j.currentChar()===G?(j.next(),G):(h(0,s(),0,G),"")}function y(j){let G="";for(;j.currentPeek()===vi||j.currentPeek()===Jn;)G+=j.currentPeek(),j.peek();return G}function T(j){const G=y(j);return j.skipToPeek(),G}function b(j){if(j===Gi)return!1;const G=j.charCodeAt(0);return G>=97&&G<=122||G>=65&&G<=90||G===95}function S(j){if(j===Gi)return!1;const G=j.charCodeAt(0);return G>=48&&G<=57}function N(j,G){const{currentType:M}=G;if(M!==2)return!1;y(j);const q=b(j.currentPeek());return j.resetPeek(),q}function C(j,G){const{currentType:M}=G;if(M!==2)return!1;y(j);const q=j.currentPeek()==="-"?j.peek():j.currentPeek(),se=S(q);return j.resetPeek(),se}function I(j,G){const{currentType:M}=G;if(M!==2)return!1;y(j);const q=j.currentPeek()===Og;return j.resetPeek(),q}function H(j,G){const{currentType:M}=G;if(M!==8)return!1;y(j);const q=j.currentPeek()===".";return j.resetPeek(),q}function Q(j,G){const{currentType:M}=G;if(M!==9)return!1;y(j);const q=b(j.currentPeek());return j.resetPeek(),q}function te(j,G){const{currentType:M}=G;if(!(M===8||M===12))return!1;y(j);const q=j.currentPeek()===":";return j.resetPeek(),q}function V(j,G){const{currentType:M}=G;if(M!==10)return!1;const q=()=>{const le=j.currentPeek();return le==="{"?b(j.peek()):le==="@"||le==="%"||le==="|"||le===":"||le==="."||le===vi||!le?!1:le===Jn?(j.peek(),q()):b(le)},se=q();return j.resetPeek(),se}function J(j){y(j);const G=j.currentPeek()==="|";return j.resetPeek(),G}function E(j,G=!0){const M=(se=!1,le="",be=!1)=>{const xe=j.currentPeek();return xe==="{"?le==="%"?!1:se:xe==="@"||!xe?le==="%"?!0:se:xe==="%"?(j.peek(),M(se,"%",!0)):xe==="|"?le==="%"||be?!0:!(le===vi||le===Jn):xe===vi?(j.peek(),M(!0,vi,be)):xe===Jn?(j.peek(),M(!0,Jn,be)):!0},q=M();return G&&j.resetPeek(),q}function A(j,G){const M=j.currentChar();return M===Gi?Gi:G(M)?(j.next(),M):null}function x(j){return A(j,M=>{const q=M.charCodeAt(0);return q>=97&&q<=122||q>=65&&q<=90||q>=48&&q<=57||q===95||q===36})}function $(j){return A(j,M=>{const q=M.charCodeAt(0);return q>=48&&q<=57})}function B(j){return A(j,M=>{const q=M.charCodeAt(0);return q>=48&&q<=57||q>=65&&q<=70||q>=97&&q<=102})}function K(j){let G="",M="";for(;G=$(j);)M+=G;return M}function ae(j){let G="";for(;;){const M=j.currentChar();if(M==="{"||M==="}"||M==="@"||M==="|"||!M)break;if(M==="%")if(E(j))G+=M,j.next();else break;else if(M===vi||M===Jn)if(E(j))G+=M,j.next();else{if(J(j))break;G+=M,j.next()}else G+=M,j.next()}return G}function ue(j){T(j);let G="",M="";for(;G=x(j);)M+=G;return j.currentChar()===Gi&&h(6,s(),0),M}function L(j){T(j);let G="";return j.currentChar()==="-"?(j.next(),G+=`-${K(j)}`):G+=K(j),j.currentChar()===Gi&&h(6,s(),0),G}function Se(j){T(j),m(j,"'");let G="",M="";const q=le=>le!==Og&&le!==Jn;for(;G=A(j,q);)G==="\\"?M+=Ae(j):M+=G;const se=j.currentChar();return se===Jn||se===Gi?(h(2,s(),0),se===Jn&&(j.next(),m(j,"'")),M):(m(j,"'"),M)}function Ae(j){const G=j.currentChar();switch(G){case"\\":case"'":return j.next(),`\\${G}`;case"u":return ve(j,G,4);case"U":return ve(j,G,6);default:return h(3,s(),0,G),""}}function ve(j,G,M){m(j,G);let q="";for(let se=0;se<M;se++){const le=B(j);if(!le){h(4,s(),0,`\\${G}${q}${j.currentChar()}`);break}q+=le}return`\\${G}${q}`}function Ye(j){T(j);let G="",M="";const q=se=>se!=="{"&&se!=="}"&&se!==vi&&se!==Jn;for(;G=A(j,q);)M+=G;return M}function mt(j){let G="",M="";for(;G=x(j);)M+=G;return M}function et(j){const G=(M=!1,q)=>{const se=j.currentChar();return se==="{"||se==="%"||se==="@"||se==="|"||!se||se===vi?q:se===Jn?(q+=se,j.next(),G(M,q)):(q+=se,j.next(),G(!0,q))};return G(!1,"")}function ut(j){T(j);const G=m(j,"|");return T(j),G}function Ee(j,G){let M=null;switch(j.currentChar()){case"{":return G.braceNest>=1&&h(8,s(),0),j.next(),M=f(G,2,"{"),T(j),G.braceNest++,M;case"}":return G.braceNest>0&&G.currentType===2&&h(7,s(),0),j.next(),M=f(G,3,"}"),G.braceNest--,G.braceNest>0&&T(j),G.inLinked&&G.braceNest===0&&(G.inLinked=!1),M;case"@":return G.braceNest>0&&h(6,s(),0),M=$e(j,G)||d(G),G.braceNest=0,M;default:let se=!0,le=!0,be=!0;if(J(j))return G.braceNest>0&&h(6,s(),0),M=f(G,1,ut(j)),G.braceNest=0,G.inLinked=!1,M;if(G.braceNest>0&&(G.currentType===5||G.currentType===6||G.currentType===7))return h(6,s(),0),G.braceNest=0,z(j,G);if(se=N(j,G))return M=f(G,5,ue(j)),T(j),M;if(le=C(j,G))return M=f(G,6,L(j)),T(j),M;if(be=I(j,G))return M=f(G,7,Se(j)),T(j),M;if(!se&&!le&&!be)return M=f(G,13,Ye(j)),h(1,s(),0,M.value),T(j),M;break}return M}function $e(j,G){const{currentType:M}=G;let q=null;const se=j.currentChar();switch((M===8||M===9||M===12||M===10)&&(se===Jn||se===vi)&&h(9,s(),0),se){case"@":return j.next(),q=f(G,8,"@"),G.inLinked=!0,q;case".":return T(j),j.next(),f(G,9,".");case":":return T(j),j.next(),f(G,10,":");default:return J(j)?(q=f(G,1,ut(j)),G.braceNest=0,G.inLinked=!1,q):H(j,G)||te(j,G)?(T(j),$e(j,G)):Q(j,G)?(T(j),f(G,12,mt(j))):V(j,G)?(T(j),se==="{"?Ee(j,G)||q:f(G,11,et(j))):(M===8&&h(9,s(),0),G.braceNest=0,G.inLinked=!1,z(j,G))}}function z(j,G){let M={type:14};if(G.braceNest>0)return Ee(j,G)||d(G);if(G.inLinked)return $e(j,G)||d(G);const q=j.currentChar();switch(q){case"{":return Ee(j,G)||d(G);case"}":return h(5,s(),0),j.next(),f(G,3,"}");case"@":return $e(j,G)||d(G);default:if(J(j))return M=f(G,1,ut(j)),G.braceNest=0,G.inLinked=!1,M;if(E(j))return f(G,0,ae(j));if(q==="%")return j.next(),f(G,4,"%");break}return M}function Te(){const{currentType:j,offset:G,startLoc:M,endLoc:q}=l;return l.lastType=j,l.lastOffset=G,l.lastStartLoc=M,l.lastEndLoc=q,l.offset=i(),l.startLoc=s(),n.currentChar()===Gi?f(l,14):z(n,l)}return{nextToken:Te,currentOffset:i,currentPosition:s,context:c}}const _L="parser",SL=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function CL(r,e,t){switch(r){case"\\\\":return"\\";case"\\'":return"'";default:{const n=parseInt(e||t,16);return n<=55295||n>=57344?String.fromCodePoint(n):"�"}}}function NL(r={}){const e=r.location!==!1,{onError:t}=r;function n(b,S,N,C,...I){const H=b.currentPosition();if(H.offset+=C,H.column+=C,t){const Q=Sd(N,H),te=Zu(S,Q,{domain:_L,args:I});t(te)}}function i(b,S,N){const C={type:b,start:S,end:S};return e&&(C.loc={start:N,end:N}),C}function s(b,S,N,C){b.end=S,e&&b.loc&&(b.loc.end=N)}function a(b,S){const N=b.context(),C=i(3,N.offset,N.startLoc);return C.value=S,s(C,b.currentOffset(),b.currentPosition()),C}function o(b,S){const N=b.context(),{lastOffset:C,lastStartLoc:I}=N,H=i(5,C,I);return H.index=parseInt(S,10),b.nextToken(),s(H,b.currentOffset(),b.currentPosition()),H}function l(b,S){const N=b.context(),{lastOffset:C,lastStartLoc:I}=N,H=i(4,C,I);return H.key=S,b.nextToken(),s(H,b.currentOffset(),b.currentPosition()),H}function c(b,S){const N=b.context(),{lastOffset:C,lastStartLoc:I}=N,H=i(9,C,I);return H.value=S.replace(SL,CL),b.nextToken(),s(H,b.currentOffset(),b.currentPosition()),H}function u(b){const S=b.nextToken(),N=b.context(),{lastOffset:C,lastStartLoc:I}=N,H=i(8,C,I);return S.type!==12?(n(b,11,N.lastStartLoc,0),H.value="",s(H,C,I),{nextConsumeToken:S,node:H}):(S.value==null&&n(b,13,N.lastStartLoc,0,ri(S)),H.value=S.value||"",s(H,b.currentOffset(),b.currentPosition()),{node:H})}function h(b,S){const N=b.context(),C=i(7,N.offset,N.startLoc);return C.value=S,s(C,b.currentOffset(),b.currentPosition()),C}function f(b){const S=b.context(),N=i(6,S.offset,S.startLoc);let C=b.nextToken();if(C.type===9){const I=u(b);N.modifier=I.node,C=I.nextConsumeToken||b.nextToken()}switch(C.type!==10&&n(b,13,S.lastStartLoc,0,ri(C)),C=b.nextToken(),C.type===2&&(C=b.nextToken()),C.type){case 11:C.value==null&&n(b,13,S.lastStartLoc,0,ri(C)),N.key=h(b,C.value||"");break;case 5:C.value==null&&n(b,13,S.lastStartLoc,0,ri(C)),N.key=l(b,C.value||"");break;case 6:C.value==null&&n(b,13,S.lastStartLoc,0,ri(C)),N.key=o(b,C.value||"");break;case 7:C.value==null&&n(b,13,S.lastStartLoc,0,ri(C)),N.key=c(b,C.value||"");break;default:n(b,12,S.lastStartLoc,0);const I=b.context(),H=i(7,I.offset,I.startLoc);return H.value="",s(H,I.offset,I.startLoc),N.key=H,s(N,I.offset,I.startLoc),{nextConsumeToken:C,node:N}}return s(N,b.currentOffset(),b.currentPosition()),{node:N}}function d(b){const S=b.context(),N=S.currentType===1?b.currentOffset():S.offset,C=S.currentType===1?S.endLoc:S.startLoc,I=i(2,N,C);I.items=[];let H=null;do{const V=H||b.nextToken();switch(H=null,V.type){case 0:V.value==null&&n(b,13,S.lastStartLoc,0,ri(V)),I.items.push(a(b,V.value||""));break;case 6:V.value==null&&n(b,13,S.lastStartLoc,0,ri(V)),I.items.push(o(b,V.value||""));break;case 5:V.value==null&&n(b,13,S.lastStartLoc,0,ri(V)),I.items.push(l(b,V.value||""));break;case 7:V.value==null&&n(b,13,S.lastStartLoc,0,ri(V)),I.items.push(c(b,V.value||""));break;case 8:const J=f(b);I.items.push(J.node),H=J.nextConsumeToken||null;break}}while(S.currentType!==14&&S.currentType!==1);const Q=S.currentType===1?S.lastOffset:b.currentOffset(),te=S.currentType===1?S.lastEndLoc:b.currentPosition();return s(I,Q,te),I}function m(b,S,N,C){const I=b.context();let H=C.items.length===0;const Q=i(1,S,N);Q.cases=[],Q.cases.push(C);do{const te=d(b);H||(H=te.items.length===0),Q.cases.push(te)}while(I.currentType!==14);return H&&n(b,10,N,0),s(Q,b.currentOffset(),b.currentPosition()),Q}function y(b){const S=b.context(),{offset:N,startLoc:C}=S,I=d(b);return S.currentType===14?I:m(b,N,C,I)}function T(b){const S=TL(b,pT({},r)),N=S.context(),C=i(0,N.offset,N.startLoc);return e&&C.loc&&(C.loc.source=b),C.body=y(S),N.currentType!==14&&n(S,13,N.lastStartLoc,0,b[N.offset]||""),s(C,S.currentOffset(),S.currentPosition()),C}return{parse:T}}function ri(r){if(r.type===14)return"EOF";const e=(r.value||"").replace(/\r?\n/gu,"\\n");return e.length>10?e.slice(0,9)+"…":e}function AL(r,e={}){const t={ast:r,helpers:new Set};return{context:()=>t,helper:s=>(t.helpers.add(s),s)}}function $g(r,e){for(let t=0;t<r.length;t++)Dp(r[t],e)}function Dp(r,e){switch(r.type){case 1:$g(r.cases,e),e.helper("plural");break;case 2:$g(r.items,e);break;case 6:Dp(r.key,e),e.helper("linked");break;case 5:e.helper("interpolate"),e.helper("list");break;case 4:e.helper("interpolate"),e.helper("named");break}}function xL(r,e={}){const t=AL(r);t.helper("normalize"),r.body&&Dp(r.body,t);const n=t.context();r.helpers=Array.from(n.helpers)}function RL(r,e){const{filename:t,breakLineCode:n,needIndent:i}=e,s={source:r.loc.source,filename:t,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:n,needIndent:i,indentLevel:0},a=()=>s;function o(m,y){s.code+=m}function l(m,y=!0){const T=y?n:"";o(i?T+"  ".repeat(m):T)}function c(m=!0){const y=++s.indentLevel;m&&l(y)}function u(m=!0){const y=--s.indentLevel;m&&l(y)}function h(){l(s.indentLevel)}return{context:a,push:o,indent:c,deindent:u,newline:h,helper:m=>`_${m}`,needIndent:()=>s.needIndent}}function ML(r,e){const{helper:t}=r;r.push(`${t("linked")}(`),Wa(r,e.key),e.modifier&&(r.push(", "),Wa(r,e.modifier)),r.push(")")}function PL(r,e){const{helper:t,needIndent:n}=r;r.push(`${t("normalize")}([`),r.indent(n());const i=e.items.length;for(let s=0;s<i&&(Wa(r,e.items[s]),s!==i-1);s++)r.push(", ");r.deindent(n()),r.push("])")}function IL(r,e){const{helper:t,needIndent:n}=r;if(e.cases.length>1){r.push(`${t("plural")}([`),r.indent(n());const i=e.cases.length;for(let s=0;s<i&&(Wa(r,e.cases[s]),s!==i-1);s++)r.push(", ");r.deindent(n()),r.push("])")}}function OL(r,e){e.body?Wa(r,e.body):r.push("null")}function Wa(r,e){const{helper:t}=r;switch(e.type){case 0:OL(r,e);break;case 1:IL(r,e);break;case 2:PL(r,e);break;case 6:ML(r,e);break;case 8:r.push(JSON.stringify(e.value),e);break;case 7:r.push(JSON.stringify(e.value),e);break;case 5:r.push(`${t("interpolate")}(${t("list")}(${e.index}))`,e);break;case 4:r.push(`${t("interpolate")}(${t("named")}(${JSON.stringify(e.key)}))`,e);break;case 9:r.push(JSON.stringify(e.value),e);break;case 3:r.push(JSON.stringify(e.value),e);break}}const $L=(r,e={})=>{const t=wa(e.mode)?e.mode:"normal",n=wa(e.filename)?e.filename:"message.intl";e.sourceMap;const i=e.breakLineCode!=null?e.breakLineCode:t==="arrow"?";":`
`,s=e.needIndent?e.needIndent:t!=="arrow",a=r.helpers||[],o=RL(r,{filename:n,breakLineCode:i,needIndent:s});o.push(t==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),o.indent(s),a.length>0&&(o.push(`const { ${a.map(u=>`${u}: _${u}`).join(", ")} } = ctx`),o.newline()),o.push("return "),Wa(o,r),o.deindent(s),o.push("}");const{code:l,map:c}=o.context();return{ast:r,code:l,map:c?c.toJSON():void 0}};function DL(r,e={}){const t=pT({},e),i=NL(t).parse(r);return xL(i,t),$L(i,t)}/*!
* @intlify/core-base v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const LL="9.1.9",eh=-1,Dg="";function qL(){return{upper:r=>yt(r)?r.toUpperCase():r,lower:r=>yt(r)?r.toLowerCase():r,capitalize:r=>yt(r)?`${r.charAt(0).toLocaleUpperCase()}${r.substr(1)}`:r}}let yT;function kL(r){yT=r}let Lg=0;function BL(r={}){const e=yt(r.version)?r.version:LL,t=yt(r.locale)?r.locale:"en-US",n=Sn(r.fallbackLocale)||kt(r.fallbackLocale)||yt(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:t,i=kt(r.messages)?r.messages:{[t]:{}},s=kt(r.datetimeFormats)?r.datetimeFormats:{[t]:{}},a=kt(r.numberFormats)?r.numberFormats:{[t]:{}},o=nr({},r.modifiers||{},qL()),l=r.pluralRules||{},c=Ar(r.missing)?r.missing:null,u=Xt(r.missingWarn)||ja(r.missingWarn)?r.missingWarn:!0,h=Xt(r.fallbackWarn)||ja(r.fallbackWarn)?r.fallbackWarn:!0,f=!!r.fallbackFormat,d=!!r.unresolving,m=Ar(r.postTranslation)?r.postTranslation:null,y=kt(r.processor)?r.processor:null,T=Xt(r.warnHtmlMessage)?r.warnHtmlMessage:!0,b=!!r.escapeParameter,S=Ar(r.messageCompiler)?r.messageCompiler:yT,N=Ar(r.onWarn)?r.onWarn:zD,C=r,I=Rr(C.__datetimeFormatters)?C.__datetimeFormatters:new Map,H=Rr(C.__numberFormatters)?C.__numberFormatters:new Map,Q=Rr(C.__meta)?C.__meta:{};return Lg++,{version:e,cid:Lg,locale:t,fallbackLocale:n,messages:i,datetimeFormats:s,numberFormats:a,modifiers:o,pluralRules:l,missing:c,missingWarn:u,fallbackWarn:h,fallbackFormat:f,unresolving:d,postTranslation:m,processor:y,warnHtmlMessage:T,escapeParameter:b,messageCompiler:S,onWarn:N,__datetimeFormatters:I,__numberFormatters:H,__meta:Q}}function Lp(r,e,t,n,i){const{missing:s,onWarn:a}=r;if(s!==null){const o=s(r,t,e,i);return yt(o)?o:e}else return e}function Cl(r,e,t){const n=r;n.__localeChainCache||(n.__localeChainCache=new Map);let i=n.__localeChainCache.get(t);if(!i){i=[];let s=[t];for(;Sn(s);)s=qg(i,s,e);const a=Sn(e)?e:kt(e)?e.default?e.default:null:e;s=yt(a)?[a]:a,Sn(s)&&qg(i,s,!1),n.__localeChainCache.set(t,i)}return i}function qg(r,e,t){let n=!0;for(let i=0;i<e.length&&Xt(n);i++){const s=e[i];yt(s)&&(n=FL(r,e[i],t))}return n}function FL(r,e,t){let n;const i=e.split("-");do{const s=i.join("-");n=UL(r,s,t),i.splice(-1,1)}while(i.length&&n===!0);return n}function UL(r,e,t){let n=!1;if(!r.includes(e)&&(n=!0,e)){n=e[e.length-1]!=="!";const i=e.replace(/!/g,"");r.push(i),(Sn(t)||kt(t))&&t[i]&&(n=t[i])}return n}function Ao(r,e,t){const n=r;n.__localeChainCache=new Map,Cl(r,t,e)}const VL=r=>r;let kg=Object.create(null);function jL(r,e={}){{const n=(e.onCacheKey||VL)(r),i=kg[n];if(i)return i;let s=!1;const a=e.onError||mL;e.onError=c=>{s=!0,a(c)};const{code:o}=DL(r,e),l=new Function(`return ${o}`)();return s?l:kg[n]=l}}function va(r){return Zu(r,null,void 0)}const Bg=()=>"",Ds=r=>Ar(r);function Fg(r,...e){const{fallbackFormat:t,postTranslation:n,unresolving:i,fallbackLocale:s,messages:a}=r,[o,l]=Cd(...e),c=Xt(l.missingWarn)?l.missingWarn:r.missingWarn,u=Xt(l.fallbackWarn)?l.fallbackWarn:r.fallbackWarn,h=Xt(l.escapeParameter)?l.escapeParameter:r.escapeParameter,f=!!l.resolvedMessage,d=yt(l.default)||Xt(l.default)?Xt(l.default)?o:l.default:t?o:"",m=t||d!=="",y=yt(l.locale)?l.locale:r.locale;h&&WL(l);let[T,b,S]=f?[o,y,a[y]||{}]:HL(r,o,y,s,u,c),N=o;if(!f&&!(yt(T)||Ds(T))&&m&&(T=d,N=T),!f&&(!(yt(T)||Ds(T))||!yt(b)))return i?eh:o;let C=!1;const I=()=>{C=!0},H=Ds(T)?T:gT(r,o,b,T,N,I);if(C)return T;const Q=GL(r,b,S,l),te=pL(Q),V=QL(r,H,te);return n?n(V):V}function WL(r){Sn(r.list)?r.list=r.list.map(e=>yt(e)?Mg(e):e):Rr(r.named)&&Object.keys(r.named).forEach(e=>{yt(r.named[e])&&(r.named[e]=Mg(r.named[e]))})}function HL(r,e,t,n,i,s){const{messages:a,onWarn:o}=r,l=Cl(r,n,t);let c={},u,h=null;const f="translate";for(let d=0;d<l.length&&(u=l[d],c=a[u]||{},(h=au(c,e))===null&&(h=c[e]),!(yt(h)||Ar(h)));d++){const m=Lp(r,e,u,s,f);m!==e&&(h=m)}return[h,u,c]}function gT(r,e,t,n,i,s){const{messageCompiler:a,warnHtmlMessage:o}=r;if(Ds(n)){const c=n;return c.locale=c.locale||t,c.key=c.key||e,c}const l=a(n,zL(r,t,i,n,o,s));return l.locale=t,l.key=e,l.source=n,l}function QL(r,e,t){return e(t)}function Cd(...r){const[e,t,n]=r,i={};if(!yt(e)&&!Nr(e)&&!Ds(e))throw va(14);const s=Nr(e)?String(e):(Ds(e),e);return Nr(t)?i.plural=t:yt(t)?i.default=t:kt(t)&&!Xu(t)?i.named=t:Sn(t)&&(i.list=t),Nr(n)?i.plural=n:yt(n)?i.default=n:kt(n)&&nr(i,n),[s,i]}function zL(r,e,t,n,i,s){return{warnHtmlMessage:i,onError:a=>{throw s&&s(a),a},onCacheKey:a=>WD(e,t,a)}}function GL(r,e,t,n){const{modifiers:i,pluralRules:s}=r,o={locale:e,modifiers:i,pluralRules:s,messages:l=>{const c=au(t,l);if(yt(c)){let u=!1;const f=gT(r,l,e,c,l,()=>{u=!0});return u?Bg:f}else return Ds(c)?c:Bg}};return r.processor&&(o.processor=r.processor),n.list&&(o.list=n.list),n.named&&(o.named=n.named),Nr(n.plural)&&(o.pluralIndex=n.plural),o}function Ug(r,...e){const{datetimeFormats:t,unresolving:n,fallbackLocale:i,onWarn:s}=r,{__datetimeFormatters:a}=r,[o,l,c,u]=Nd(...e),h=Xt(c.missingWarn)?c.missingWarn:r.missingWarn;Xt(c.fallbackWarn)?c.fallbackWarn:r.fallbackWarn;const f=!!c.part,d=yt(c.locale)?c.locale:r.locale,m=Cl(r,i,d);if(!yt(o)||o==="")return new Intl.DateTimeFormat(d).format(l);let y={},T,b=null;const S="datetime format";for(let I=0;I<m.length&&(T=m[I],y=t[T]||{},b=y[o],!kt(b));I++)Lp(r,o,T,h,S);if(!kt(b)||!yt(T))return n?eh:o;let N=`${T}__${o}`;Xu(u)||(N=`${N}__${JSON.stringify(u)}`);let C=a.get(N);return C||(C=new Intl.DateTimeFormat(T,nr({},b,u)),a.set(N,C)),f?C.formatToParts(l):C.format(l)}function Nd(...r){const[e,t,n,i]=r;let s={},a={},o;if(yt(e)){if(!/\d{4}-\d{2}-\d{2}(T.*)?/.test(e))throw va(16);o=new Date(e);try{o.toISOString()}catch(l){throw va(16)}}else if(QD(e)){if(isNaN(e.getTime()))throw va(15);o=e}else if(Nr(e))o=e;else throw va(14);return yt(t)?s.key=t:kt(t)&&(s=t),yt(n)?s.locale=n:kt(n)&&(a=n),kt(i)&&(a=i),[s.key||"",o,s,a]}function Vg(r,e,t){const n=r;for(const i in t){const s=`${e}__${i}`;n.__datetimeFormatters.has(s)&&n.__datetimeFormatters.delete(s)}}function jg(r,...e){const{numberFormats:t,unresolving:n,fallbackLocale:i,onWarn:s}=r,{__numberFormatters:a}=r,[o,l,c,u]=Ad(...e),h=Xt(c.missingWarn)?c.missingWarn:r.missingWarn;Xt(c.fallbackWarn)?c.fallbackWarn:r.fallbackWarn;const f=!!c.part,d=yt(c.locale)?c.locale:r.locale,m=Cl(r,i,d);if(!yt(o)||o==="")return new Intl.NumberFormat(d).format(l);let y={},T,b=null;const S="number format";for(let I=0;I<m.length&&(T=m[I],y=t[T]||{},b=y[o],!kt(b));I++)Lp(r,o,T,h,S);if(!kt(b)||!yt(T))return n?eh:o;let N=`${T}__${o}`;Xu(u)||(N=`${N}__${JSON.stringify(u)}`);let C=a.get(N);return C||(C=new Intl.NumberFormat(T,nr({},b,u)),a.set(N,C)),f?C.formatToParts(l):C.format(l)}function Ad(...r){const[e,t,n,i]=r;let s={},a={};if(!Nr(e))throw va(14);const o=e;return yt(t)?s.key=t:kt(t)&&(s=t),yt(n)?s.locale=n:kt(n)&&(a=n),kt(i)&&(a=i),[s.key||"",o,s,a]}function Wg(r,e,t){const n=r;for(const i in t){const s=`${e}__${i}`;n.__numberFormatters.has(s)&&n.__numberFormatters.delete(s)}}/*!
* vue-i18n v9.1.9
* (c) 2021 kazuya kawaguchi
* Released under the MIT License.
*/const KL="9.1.9";function Hn(r,...e){return Zu(r,null,void 0)}const xd=ro("__transrateVNode"),Rd=ro("__datetimeParts"),Md=ro("__numberParts"),bT=ro("__setPluralRules"),ET=ro("__injectWithOption");let Hg=0;function Qg(r){return(e,t,n,i)=>r(t,n,Cn()||void 0,i)}function qp(r,e){const{messages:t,__i18n:n}=e,i=kt(t)?t:Sn(n)?{}:{[r]:{}};if(Sn(n)&&n.forEach(({locale:s,resource:a})=>{s?(i[s]=i[s]||{},ou(a,i[s])):ou(a,i)}),e.flatJson)for(const s in i)dT(i,s)&&_d(i[s]);return i}const cc=r=>!Rr(r)||Sn(r);function ou(r,e){if(cc(r)||cc(e))throw Hn(20);for(const t in r)dT(r,t)&&(cc(r[t])||cc(e[t])?e[t]=r[t]:ou(r[t],e[t]))}function kp(r={}){const{__root:e}=r,t=e===void 0;let n=Xt(r.inheritLocale)?r.inheritLocale:!0;const i=ge(e&&n?e.locale.value:yt(r.locale)?r.locale:"en-US"),s=ge(e&&n?e.fallbackLocale.value:yt(r.fallbackLocale)||Sn(r.fallbackLocale)||kt(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:i.value),a=ge(qp(i.value,r)),o=ge(kt(r.datetimeFormats)?r.datetimeFormats:{[i.value]:{}}),l=ge(kt(r.numberFormats)?r.numberFormats:{[i.value]:{}});let c=e?e.missingWarn:Xt(r.missingWarn)||ja(r.missingWarn)?r.missingWarn:!0,u=e?e.fallbackWarn:Xt(r.fallbackWarn)||ja(r.fallbackWarn)?r.fallbackWarn:!0,h=e?e.fallbackRoot:Xt(r.fallbackRoot)?r.fallbackRoot:!0,f=!!r.fallbackFormat,d=Ar(r.missing)?r.missing:null,m=Ar(r.missing)?Qg(r.missing):null,y=Ar(r.postTranslation)?r.postTranslation:null,T=Xt(r.warnHtmlMessage)?r.warnHtmlMessage:!0,b=!!r.escapeParameter;const S=e?e.modifiers:kt(r.modifiers)?r.modifiers:{};let N=r.pluralRules||e&&e.pluralRules,C;function I(){return BL({version:KL,locale:i.value,fallbackLocale:s.value,messages:a.value,datetimeFormats:o.value,numberFormats:l.value,modifiers:S,pluralRules:N,missing:m===null?void 0:m,missingWarn:c,fallbackWarn:u,fallbackFormat:f,unresolving:!0,postTranslation:y===null?void 0:y,warnHtmlMessage:T,escapeParameter:b,__datetimeFormatters:kt(C)?C.__datetimeFormatters:void 0,__numberFormatters:kt(C)?C.__numberFormatters:void 0,__v_emitter:kt(C)?C.__v_emitter:void 0,__meta:{framework:"vue"}})}C=I(),Ao(C,i.value,s.value);function H(){return[i.value,s.value,a.value,o.value,l.value]}const Q=Me({get:()=>i.value,set:oe=>{i.value=oe,C.locale=i.value}}),te=Me({get:()=>s.value,set:oe=>{s.value=oe,C.fallbackLocale=s.value,Ao(C,i.value,oe)}}),V=Me(()=>a.value),J=Me(()=>o.value),E=Me(()=>l.value);function A(){return Ar(y)?y:null}function x(oe){y=oe,C.postTranslation=oe}function $(){return d}function B(oe){oe!==null&&(m=Qg(oe)),d=oe,C.missing=m}function K(oe,fe,Ve,Je,ze,nt){H();let P;if(P=oe(C),Nr(P)&&P===eh){const[w,_]=fe();return e&&h?Je(e):ze(w)}else{if(nt(P))return P;throw Hn(14)}}function ae(...oe){return K(fe=>Fg(fe,...oe),()=>Cd(...oe),"translate",fe=>fe.t(...oe),fe=>fe,fe=>yt(fe))}function ue(...oe){const[fe,Ve,Je]=oe;if(Je&&!Rr(Je))throw Hn(15);return ae(fe,Ve,nr({resolvedMessage:!0},Je||{}))}function L(...oe){return K(fe=>Ug(fe,...oe),()=>Nd(...oe),"datetime format",fe=>fe.d(...oe),()=>Dg,fe=>yt(fe))}function Se(...oe){return K(fe=>jg(fe,...oe),()=>Ad(...oe),"number format",fe=>fe.n(...oe),()=>Dg,fe=>yt(fe))}function Ae(oe){return oe.map(fe=>yt(fe)?X(La,null,fe,0):fe)}const Ye={normalize:Ae,interpolate:oe=>oe,type:"vnode"};function mt(...oe){return K(fe=>{let Ve;const Je=fe;try{Je.processor=Ye,Ve=Fg(Je,...oe)}finally{Je.processor=null}return Ve},()=>Cd(...oe),"translate",fe=>fe[xd](...oe),fe=>[X(La,null,fe,0)],fe=>Sn(fe))}function et(...oe){return K(fe=>jg(fe,...oe),()=>Ad(...oe),"number format",fe=>fe[Md](...oe),()=>[],fe=>yt(fe)||Sn(fe))}function ut(...oe){return K(fe=>Ug(fe,...oe),()=>Nd(...oe),"datetime format",fe=>fe[Rd](...oe),()=>[],fe=>yt(fe)||Sn(fe))}function Ee(oe){N=oe,C.pluralRules=N}function $e(oe,fe){const Ve=yt(fe)?fe:i.value,Je=j(Ve);return au(Je,oe)!==null}function z(oe){let fe=null;const Ve=Cl(C,s.value,i.value);for(let Je=0;Je<Ve.length;Je++){const ze=a.value[Ve[Je]]||{},nt=au(ze,oe);if(nt!=null){fe=nt;break}}return fe}function Te(oe){const fe=z(oe);return fe!=null?fe:e?e.tm(oe)||{}:{}}function j(oe){return a.value[oe]||{}}function G(oe,fe){a.value[oe]=fe,C.messages=a.value}function M(oe,fe){a.value[oe]=a.value[oe]||{},ou(fe,a.value[oe]),C.messages=a.value}function q(oe){return o.value[oe]||{}}function se(oe,fe){o.value[oe]=fe,C.datetimeFormats=o.value,Vg(C,oe,fe)}function le(oe,fe){o.value[oe]=nr(o.value[oe]||{},fe),C.datetimeFormats=o.value,Vg(C,oe,fe)}function be(oe){return l.value[oe]||{}}function xe(oe,fe){l.value[oe]=fe,C.numberFormats=l.value,Wg(C,oe,fe)}function Le(oe,fe){l.value[oe]=nr(l.value[oe]||{},fe),C.numberFormats=l.value,Wg(C,oe,fe)}return Hg++,e&&(Ge(e.locale,oe=>{n&&(i.value=oe,C.locale=oe,Ao(C,i.value,s.value))}),Ge(e.fallbackLocale,oe=>{n&&(s.value=oe,C.fallbackLocale=oe,Ao(C,i.value,s.value))})),{id:Hg,locale:Q,fallbackLocale:te,get inheritLocale(){return n},set inheritLocale(oe){n=oe,oe&&e&&(i.value=e.locale.value,s.value=e.fallbackLocale.value,Ao(C,i.value,s.value))},get availableLocales(){return Object.keys(a.value).sort()},messages:V,datetimeFormats:J,numberFormats:E,get modifiers(){return S},get pluralRules(){return N||{}},get isGlobal(){return t},get missingWarn(){return c},set missingWarn(oe){c=oe,C.missingWarn=c},get fallbackWarn(){return u},set fallbackWarn(oe){u=oe,C.fallbackWarn=u},get fallbackRoot(){return h},set fallbackRoot(oe){h=oe},get fallbackFormat(){return f},set fallbackFormat(oe){f=oe,C.fallbackFormat=f},get warnHtmlMessage(){return T},set warnHtmlMessage(oe){T=oe,C.warnHtmlMessage=oe},get escapeParameter(){return b},set escapeParameter(oe){b=oe,C.escapeParameter=oe},t:ae,rt:ue,d:L,n:Se,te:$e,tm:Te,getLocaleMessage:j,setLocaleMessage:G,mergeLocaleMessage:M,getDateTimeFormat:q,setDateTimeFormat:se,mergeDateTimeFormat:le,getNumberFormat:be,setNumberFormat:xe,mergeNumberFormat:Le,getPostTranslationHandler:A,setPostTranslationHandler:x,getMissingHandler:$,setMissingHandler:B,[xd]:mt,[Md]:et,[Rd]:ut,[bT]:Ee,[ET]:r.__injectWithOption}}function YL(r){const e=yt(r.locale)?r.locale:"en-US",t=yt(r.fallbackLocale)||Sn(r.fallbackLocale)||kt(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:e,n=Ar(r.missing)?r.missing:void 0,i=Xt(r.silentTranslationWarn)||ja(r.silentTranslationWarn)?!r.silentTranslationWarn:!0,s=Xt(r.silentFallbackWarn)||ja(r.silentFallbackWarn)?!r.silentFallbackWarn:!0,a=Xt(r.fallbackRoot)?r.fallbackRoot:!0,o=!!r.formatFallbackMessages,l=kt(r.modifiers)?r.modifiers:{},c=r.pluralizationRules,u=Ar(r.postTranslation)?r.postTranslation:void 0,h=yt(r.warnHtmlInMessage)?r.warnHtmlInMessage!=="off":!0,f=!!r.escapeParameterHtml,d=Xt(r.sync)?r.sync:!0;let m=r.messages;if(kt(r.sharedMessages)){const I=r.sharedMessages;m=Object.keys(I).reduce((Q,te)=>{const V=Q[te]||(Q[te]={});return nr(V,I[te]),Q},m||{})}const{__i18n:y,__root:T,__injectWithOption:b}=r,S=r.datetimeFormats,N=r.numberFormats,C=r.flatJson;return{locale:e,fallbackLocale:t,messages:m,flatJson:C,datetimeFormats:S,numberFormats:N,missing:n,missingWarn:i,fallbackWarn:s,fallbackRoot:a,fallbackFormat:o,modifiers:l,pluralRules:c,postTranslation:u,warnHtmlMessage:h,escapeParameter:f,inheritLocale:d,__i18n:y,__root:T,__injectWithOption:b}}function Pd(r={}){const e=kp(YL(r)),t={id:e.id,get locale(){return e.locale.value},set locale(n){e.locale.value=n},get fallbackLocale(){return e.fallbackLocale.value},set fallbackLocale(n){e.fallbackLocale.value=n},get messages(){return e.messages.value},get datetimeFormats(){return e.datetimeFormats.value},get numberFormats(){return e.numberFormats.value},get availableLocales(){return e.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(n){},get missing(){return e.getMissingHandler()},set missing(n){e.setMissingHandler(n)},get silentTranslationWarn(){return Xt(e.missingWarn)?!e.missingWarn:e.missingWarn},set silentTranslationWarn(n){e.missingWarn=Xt(n)?!n:n},get silentFallbackWarn(){return Xt(e.fallbackWarn)?!e.fallbackWarn:e.fallbackWarn},set silentFallbackWarn(n){e.fallbackWarn=Xt(n)?!n:n},get modifiers(){return e.modifiers},get formatFallbackMessages(){return e.fallbackFormat},set formatFallbackMessages(n){e.fallbackFormat=n},get postTranslation(){return e.getPostTranslationHandler()},set postTranslation(n){e.setPostTranslationHandler(n)},get sync(){return e.inheritLocale},set sync(n){e.inheritLocale=n},get warnHtmlInMessage(){return e.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(n){e.warnHtmlMessage=n!=="off"},get escapeParameterHtml(){return e.escapeParameter},set escapeParameterHtml(n){e.escapeParameter=n},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(n){},get pluralizationRules(){return e.pluralRules||{}},__composer:e,t(...n){const[i,s,a]=n,o={};let l=null,c=null;if(!yt(i))throw Hn(15);const u=i;return yt(s)?o.locale=s:Sn(s)?l=s:kt(s)&&(c=s),Sn(a)?l=a:kt(a)&&(c=a),e.t(u,l||c||{},o)},rt(...n){return e.rt(...n)},tc(...n){const[i,s,a]=n,o={plural:1};let l=null,c=null;if(!yt(i))throw Hn(15);const u=i;return yt(s)?o.locale=s:Nr(s)?o.plural=s:Sn(s)?l=s:kt(s)&&(c=s),yt(a)?o.locale=a:Sn(a)?l=a:kt(a)&&(c=a),e.t(u,l||c||{},o)},te(n,i){return e.te(n,i)},tm(n){return e.tm(n)},getLocaleMessage(n){return e.getLocaleMessage(n)},setLocaleMessage(n,i){e.setLocaleMessage(n,i)},mergeLocaleMessage(n,i){e.mergeLocaleMessage(n,i)},d(...n){return e.d(...n)},getDateTimeFormat(n){return e.getDateTimeFormat(n)},setDateTimeFormat(n,i){e.setDateTimeFormat(n,i)},mergeDateTimeFormat(n,i){e.mergeDateTimeFormat(n,i)},n(...n){return e.n(...n)},getNumberFormat(n){return e.getNumberFormat(n)},setNumberFormat(n,i){e.setNumberFormat(n,i)},mergeNumberFormat(n,i){e.mergeNumberFormat(n,i)},getChoiceIndex(n,i){return-1},__onComponentInstanceCreated(n){const{componentInstanceCreatedListener:i}=r;i&&i(n,t)}};return t}const Bp={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:r=>r==="parent"||r==="global",default:"parent"},i18n:{type:Object}},zg={name:"i18n-t",props:nr({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:r=>Nr(r)||!isNaN(r)}},Bp),setup(r,e){const{slots:t,attrs:n}=e,i=r.i18n||Fp({useScope:r.scope,__useComponent:!0}),s=Object.keys(t).filter(a=>a!=="_");return()=>{const a={};r.locale&&(a.locale=r.locale),r.plural!==void 0&&(a.plural=yt(r.plural)?+r.plural:r.plural);const o=JL(e,s),l=i[xd](r.keypath,o,a),c=nr({},n);return yt(r.tag)||Rr(r.tag)?xi(r.tag,c,l):xi(Ht,c,l)}}};function JL({slots:r},e){return e.length===1&&e[0]==="default"?r.default?r.default():[]:e.reduce((t,n)=>{const i=r[n];return i&&(t[n]=i()),t},{})}function wT(r,e,t,n){const{slots:i,attrs:s}=e;return()=>{const a={part:!0};let o={};r.locale&&(a.locale=r.locale),yt(r.format)?a.key=r.format:Rr(r.format)&&(yt(r.format.key)&&(a.key=r.format.key),o=Object.keys(r.format).reduce((h,f)=>t.includes(f)?nr({},h,{[f]:r.format[f]}):h,{}));const l=n(r.value,a,o);let c=[a.key];Sn(l)?c=l.map((h,f)=>{const d=i[h.type];return d?d({[h.type]:h.value,index:f,parts:l}):[h.value]}):yt(l)&&(c=[l]);const u=nr({},s);return yt(r.tag)||Rr(r.tag)?xi(r.tag,u,c):xi(Ht,u,c)}}const XL=["localeMatcher","style","unit","unitDisplay","currency","currencyDisplay","useGrouping","numberingSystem","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","notation","formatMatcher"],Gg={name:"i18n-n",props:nr({value:{type:Number,required:!0},format:{type:[String,Object]}},Bp),setup(r,e){const t=r.i18n||Fp({useScope:"parent",__useComponent:!0});return wT(r,e,XL,(...n)=>t[Md](...n))}},ZL=["dateStyle","timeStyle","fractionalSecondDigits","calendar","dayPeriod","numberingSystem","localeMatcher","timeZone","hour12","hourCycle","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"],Kg={name:"i18n-d",props:nr({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Bp),setup(r,e){const t=r.i18n||Fp({useScope:"parent",__useComponent:!0});return wT(r,e,ZL,(...n)=>t[Rd](...n))}};function e2(r,e){const t=r;if(r.mode==="composition")return t.__getInstance(e)||r.global;{const n=t.__getInstance(e);return n!=null?n.__composer:r.global.__composer}}function t2(r){const e=(t,{instance:n,value:i,modifiers:s})=>{if(!n||!n.$)throw Hn(22);const a=e2(r,n.$),o=n2(i);t.textContent=a.t(...r2(o))};return{beforeMount:e,beforeUpdate:e}}function n2(r){if(yt(r))return{path:r};if(kt(r)){if(!("path"in r))throw Hn(19,"path");return r}else throw Hn(20)}function r2(r){const{path:e,locale:t,args:n,choice:i,plural:s}=r,a={},o=n||{};return yt(t)&&(a.locale=t),Nr(i)&&(a.plural=i),Nr(s)&&(a.plural=s),[e,o,a]}function i2(r,e,...t){const n=kt(t[0])?t[0]:{},i=!!n.useI18nComponentName;(Xt(n.globalInstall)?n.globalInstall:!0)&&(r.component(i?"i18n":zg.name,zg),r.component(Gg.name,Gg),r.component(Kg.name,Kg)),r.directive("t",t2(e))}function s2(r,e,t){return{beforeCreate(){const n=Cn();if(!n)throw Hn(22);const i=this.$options;if(i.i18n){const s=i.i18n;i.__i18n&&(s.__i18n=i.__i18n),s.__root=e,this===this.$root?this.$i18n=Yg(r,s):(s.__injectWithOption=!0,this.$i18n=Pd(s))}else i.__i18n?this===this.$root?this.$i18n=Yg(r,i):this.$i18n=Pd({__i18n:i.__i18n,__injectWithOption:!0,__root:e}):this.$i18n=r;r.__onComponentInstanceCreated(this.$i18n),t.__setInstance(n,this.$i18n),this.$t=(...s)=>this.$i18n.t(...s),this.$rt=(...s)=>this.$i18n.rt(...s),this.$tc=(...s)=>this.$i18n.tc(...s),this.$te=(s,a)=>this.$i18n.te(s,a),this.$d=(...s)=>this.$i18n.d(...s),this.$n=(...s)=>this.$i18n.n(...s),this.$tm=s=>this.$i18n.tm(s)},mounted(){},beforeUnmount(){const n=Cn();if(!n)throw Hn(22);delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,t.__deleteInstance(n),delete this.$i18n}}}function Yg(r,e){r.locale=e.locale||r.locale,r.fallbackLocale=e.fallbackLocale||r.fallbackLocale,r.missing=e.missing||r.missing,r.silentTranslationWarn=e.silentTranslationWarn||r.silentFallbackWarn,r.silentFallbackWarn=e.silentFallbackWarn||r.silentFallbackWarn,r.formatFallbackMessages=e.formatFallbackMessages||r.formatFallbackMessages,r.postTranslation=e.postTranslation||r.postTranslation,r.warnHtmlInMessage=e.warnHtmlInMessage||r.warnHtmlInMessage,r.escapeParameterHtml=e.escapeParameterHtml||r.escapeParameterHtml,r.sync=e.sync||r.sync,r.__composer[bT](e.pluralizationRules||r.pluralizationRules);const t=qp(r.locale,{messages:e.messages,__i18n:e.__i18n});return Object.keys(t).forEach(n=>r.mergeLocaleMessage(n,t[n])),e.datetimeFormats&&Object.keys(e.datetimeFormats).forEach(n=>r.mergeDateTimeFormat(n,e.datetimeFormats[n])),e.numberFormats&&Object.keys(e.numberFormats).forEach(n=>r.mergeNumberFormat(n,e.numberFormats[n])),r}function a2(r={}){const e=Xt(r.legacy)?r.legacy:!0,t=!!r.globalInjection,n=new Map,i=e?Pd(r):kp(r),s=ro(""),a={get mode(){return e?"legacy":"composition"},install(l,...c){return v(this,null,function*(){l.__VUE_I18N_SYMBOL__=s,l.provide(l.__VUE_I18N_SYMBOL__,a),!e&&t&&h2(l,a.global),i2(l,a,...c),e&&l.mixin(s2(i,i.__composer,a))})},get global(){return i},__instances:n,__getInstance(l){return n.get(l)||null},__setInstance(l,c){n.set(l,c)},__deleteInstance(l){n.delete(l)}};return a}function Fp(r={}){const e=Cn();if(e==null)throw Hn(16);if(!e.appContext.app.__VUE_I18N_SYMBOL__)throw Hn(17);const t=on(e.appContext.app.__VUE_I18N_SYMBOL__);if(!t)throw Hn(22);const n=t.mode==="composition"?t.global:t.global.__composer,i=Xu(r)?"__i18n"in e.type?"local":"global":r.useScope?r.useScope:"local";if(i==="global"){let o=Rr(r.messages)?r.messages:{};"__i18nGlobal"in e.type&&(o=qp(n.locale.value,{messages:o,__i18n:e.type.__i18nGlobal}));const l=Object.keys(o);if(l.length&&l.forEach(c=>{n.mergeLocaleMessage(c,o[c])}),Rr(r.datetimeFormats)){const c=Object.keys(r.datetimeFormats);c.length&&c.forEach(u=>{n.mergeDateTimeFormat(u,r.datetimeFormats[u])})}if(Rr(r.numberFormats)){const c=Object.keys(r.numberFormats);c.length&&c.forEach(u=>{n.mergeNumberFormat(u,r.numberFormats[u])})}return n}if(i==="parent"){let o=o2(t,e,r.__useComponent);return o==null&&(o=n),o}if(t.mode==="legacy")throw Hn(18);const s=t;let a=s.__getInstance(e);if(a==null){const o=e.type,l=nr({},r);o.__i18n&&(l.__i18n=o.__i18n),n&&(l.__root=n),a=kp(l),l2(s,e),s.__setInstance(e,a)}return a}function o2(r,e,t=!1){let n=null;const i=e.root;let s=e.parent;for(;s!=null;){const a=r;if(r.mode==="composition")n=a.__getInstance(s);else{const o=a.__getInstance(s);o!=null&&(n=o.__composer),t&&n&&!n[ET]&&(n=null)}if(n!=null||i===s)break;s=s.parent}return n}function l2(r,e,t){gn(()=>{},e),vl(()=>{r.__deleteInstance(e)},e)}const c2=["locale","fallbackLocale","availableLocales"],u2=["t","rt","d","n","tm"];function h2(r,e){const t=Object.create(null);c2.forEach(n=>{const i=Object.getOwnPropertyDescriptor(e,n);if(!i)throw Hn(22);const s=En(i.value)?{get(){return i.value.value},set(a){i.value.value=a}}:{get(){return i.get&&i.get()}};Object.defineProperty(t,n,s)}),r.config.globalProperties.$i18n=t,u2.forEach(n=>{const i=Object.getOwnPropertyDescriptor(e,n);if(!i||!i.value)throw Hn(22);Object.defineProperty(r.config.globalProperties,`$${n}`,i)})}kL(jL);const vT={en:wE,"zh-Hans":SE},f2=a2({locale:Bs(),messages:vT});function d2(r){if(!r)return"";const e=Bs(),t=vT[e];if(Object.keys(t).includes(r))return t[r];try{return r.split(".").reduce((i,s)=>i[s],t)}catch(n){return""}}function p2(r,e){return r.replace(/\{([^}]+)\}/g,(t,n)=>{const i=n.trim().split(".");let s=e;for(;i.length;){const a=i.shift();s=s[a]}return s})}function m2(r,e){return p2(d2(r),e)}function TT(r){const e=r.match(/%(.+?)%/);return e&&(r=e[1]),m2(r)}const y2="var(--wot-color-theme, #1890ff)",g2="#666",b2=Lt({__name:"index",setup(r){function e(){Ps({title:"点击了中间的鼓包tabbarItem",icon:"none"})}function t(s){if(s===$o.curIdx)return;if(Ci[s].isBulge){e();return}const a=Ci[s].pagePath;$o.setCurIdx(s),_D?av({url:a}):Mi({url:a})}Uv(()=>{});function n(s){return $o.curIdx===s?y2:g2}function i(s,a){return a.iconActive&&$o.curIdx===s?a.iconActive:a.icon}return Ku(()=>{}),(s,a)=>{const o=vp,l=Yt,c=Wn(kn("wd-icon"),er);return pt(Op)?(_e(),Ne(l,{key:0,class:"h-50px pb-safe"},{default:re(()=>[X(l,{class:"border-and-fixed bg-white",onTouchmove:a[0]||(a[0]=Ja(()=>{},["stop","prevent"]))},{default:re(()=>[X(l,{class:"h-50px flex items-center"},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(pt(Ci),(u,h)=>(_e(),Ne(l,{key:h,class:"flex flex-1 flex-col items-center justify-center",style:zt({color:n(h)}),onClick:f=>t(h)},{default:re(()=>[u.isBulge?(_e(),Ne(l,{key:0,class:"relative"},{default:re(()=>[X(l,{class:"bulge"},{default:re(()=>[X(o,{class:"mt-6rpx h-200rpx w-200rpx",src:VD})]),_:1})]),_:1})):(_e(),Ne(l,{key:1,class:"relative px-3 text-center"},{default:re(()=>[u.iconType==="uiLib"?(_e(),Ne(c,{key:0,name:u.icon,size:"20"},null,8,["name"])):gt("",!0),u.iconType==="unocss"||u.iconType==="iconfont"?(_e(),Ne(l,{key:1,class:Nt([u.icon,"text-20px"])},null,8,["class"])):gt("",!0),u.iconType==="image"?(_e(),Ne(o,{key:2,src:i(h,u),mode:"scaleToFill",class:"h-20px w-20px"},null,8,["src"])):gt("",!0),X(l,{class:"mt-2px text-12px"},{default:re(()=>[Ze(vt(pt(TT)(u.text)),1)]),_:2},1024),u.badge?(_e(),Ne(l,{key:3},{default:re(()=>[u.badge==="dot"?(_e(),Ne(l,{key:0,class:"absolute right-0 top-0 h-2 w-2 rounded-full bg-#f56c6c"})):(_e(),Ne(l,{key:1,class:"absolute top-0 box-border h-5 min-w-5 center rounded-full bg-#f56c6c px-1 text-center text-xs text-white -right-3"},{default:re(()=>[Ze(vt(u.badge>99?"99+":u.badge),1)]),_:2},1024))]),_:2},1024)):gt("",!0)]),_:2},1024))]),_:2},1032,["style","onClick"]))),128))]),_:1}),X(l,{class:"pb-safe"})]),_:1})]),_:1})):gt("",!0)}}}),E2=cn(b2,[["__scopeId","data-v-2a9101ae"]]),w2=Lt({__name:"App.ku",setup(r,{expose:e}){const t=Gv(),n=ge(!0);Ku(()=>{const{path:s}=iT();s==="/"?n.value=!0:n.value=nT(s)});const i=ge("this is form app.Ku.vue");return e({exposeRef:i}),(s,a)=>{const o=Wn(kn("wd-toast"),zu),l=Wn(kn("wd-message-box"),B$),c=Wn(kn("wd-config-provider"),V$);return _e(),Ne(c,{"theme-vars":pt(t).themeVars,theme:pt(t).theme},{default:re(()=>[Bt(s.$slots,"default"),n.value?(_e(),Ne(E2,{key:0})):gt("",!0),X(o),X(l)]),_:3},8,["theme-vars","theme"])}}});var Ni=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function th(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function v2(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}function uc(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _T={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,s){function a(c,u){if(!i[c]){if(!n[c]){var h=typeof uc=="function"&&uc;if(!u&&h)return h(c,!0);if(o)return o(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var d=i[c]={exports:{}};n[c][0].call(d.exports,function(m){var y=n[c][1][m];return a(y||m)},d,d.exports,t,n,i,s)}return i[c].exports}for(var o=typeof uc=="function"&&uc,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,n,i){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,c=new a(m),u=s.document.createTextNode("");c.observe(u,{characterData:!0}),o=function(){u.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel!="undefined"){var h=new s.MessageChannel;h.port1.onmessage=m,o=function(){h.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var T=s.document.createElement("script");T.onreadystatechange=function(){m(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},s.document.documentElement.appendChild(T)}:o=function(){setTimeout(m,0)};var f,d=[];function m(){f=!0;for(var T,b,S=d.length;S;){for(b=d,d=[],T=-1;++T<S;)b[T]();S=d.length}f=!1}n.exports=y;function y(T){d.push(T)===1&&!f&&o()}}).call(this,typeof Ni!="undefined"?Ni:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(t,n,i){var s=t(1);function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];n.exports=h;function h(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,I!==a&&y(this,I)}h.prototype.catch=function(I){return this.then(null,I)},h.prototype.then=function(I,H){if(typeof I!="function"&&this.state===c||typeof H!="function"&&this.state===l)return this;var Q=new this.constructor(a);if(this.state!==u){var te=this.state===c?I:H;d(Q,te,this.outcome)}else this.queue.push(new f(Q,I,H));return Q};function f(I,H,Q){this.promise=I,typeof H=="function"&&(this.onFulfilled=H,this.callFulfilled=this.otherCallFulfilled),typeof Q=="function"&&(this.onRejected=Q,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(I){o.resolve(this.promise,I)},f.prototype.otherCallFulfilled=function(I){d(this.promise,this.onFulfilled,I)},f.prototype.callRejected=function(I){o.reject(this.promise,I)},f.prototype.otherCallRejected=function(I){d(this.promise,this.onRejected,I)};function d(I,H,Q){s(function(){var te;try{te=H(Q)}catch(V){return o.reject(I,V)}te===I?o.reject(I,new TypeError("Cannot resolve promise with itself")):o.resolve(I,te)})}o.resolve=function(I,H){var Q=T(m,H);if(Q.status==="error")return o.reject(I,Q.value);var te=Q.value;if(te)y(I,te);else{I.state=c,I.outcome=H;for(var V=-1,J=I.queue.length;++V<J;)I.queue[V].callFulfilled(H)}return I},o.reject=function(I,H){I.state=l,I.outcome=H;for(var Q=-1,te=I.queue.length;++Q<te;)I.queue[Q].callRejected(H);return I};function m(I){var H=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof H=="function")return function(){H.apply(I,arguments)}}function y(I,H){var Q=!1;function te(A){Q||(Q=!0,o.reject(I,A))}function V(A){Q||(Q=!0,o.resolve(I,A))}function J(){H(V,te)}var E=T(J);E.status==="error"&&te(E.value)}function T(I,H){var Q={};try{Q.value=I(H),Q.status="success"}catch(te){Q.status="error",Q.value=te}return Q}h.resolve=b;function b(I){return I instanceof this?I:o.resolve(new this(a),I)}h.reject=S;function S(I){var H=new this(a);return o.reject(H,I)}h.all=N;function N(I){var H=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Q=I.length,te=!1;if(!Q)return this.resolve([]);for(var V=new Array(Q),J=0,E=-1,A=new this(a);++E<Q;)x(I[E],E);return A;function x($,B){H.resolve($).then(K,function(ae){te||(te=!0,o.reject(A,ae))});function K(ae){V[B]=ae,++J===Q&&!te&&(te=!0,o.resolve(A,V))}}}h.race=C;function C(I){var H=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Q=I.length,te=!1;if(!Q)return this.resolve([]);for(var V=-1,J=new this(a);++V<Q;)E(I[V]);return J;function E(A){H.resolve(A).then(function(x){te||(te=!0,o.resolve(J,x))},function(x){te||(te=!0,o.reject(J,x))})}}},{1:1}],3:[function(t,n,i){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof Ni!="undefined"?Ni:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(t,n,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k};function a(k,ie){if(!(k instanceof ie))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(k){return}}var l=o();function c(){try{if(!l||!l.open)return!1;var k=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ie=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!k||ie)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(F){return!1}}function u(k,ie){k=k||[],ie=ie||{};try{return new Blob(k,ie)}catch(ce){if(ce.name!=="TypeError")throw ce;for(var F=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,he=new F,pe=0;pe<k.length;pe+=1)he.append(k[pe]);return he.getBlob(ie.type)}}typeof Promise=="undefined"&&t(3);var h=Promise;function f(k,ie){ie&&k.then(function(F){ie(null,F)},function(F){ie(F)})}function d(k,ie,F){typeof ie=="function"&&k.then(ie),typeof F=="function"&&k.catch(F)}function m(k){return typeof k!="string"&&(k=String(k)),k}function y(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var T="local-forage-detect-blob-support",b=void 0,S={},N=Object.prototype.toString,C="readonly",I="readwrite";function H(k){for(var ie=k.length,F=new ArrayBuffer(ie),he=new Uint8Array(F),pe=0;pe<ie;pe++)he[pe]=k.charCodeAt(pe);return F}function Q(k){return new h(function(ie){var F=k.transaction(T,I),he=u([""]);F.objectStore(T).put(he,"key"),F.onabort=function(pe){pe.preventDefault(),pe.stopPropagation(),ie(!1)},F.oncomplete=function(){var pe=navigator.userAgent.match(/Chrome\/(\d+)/),ce=navigator.userAgent.match(/Edge\//);ie(ce||!pe||parseInt(pe[1],10)>=43)}}).catch(function(){return!1})}function te(k){return typeof b=="boolean"?h.resolve(b):Q(k).then(function(ie){return b=ie,b})}function V(k){var ie=S[k.name],F={};F.promise=new h(function(he,pe){F.resolve=he,F.reject=pe}),ie.deferredOperations.push(F),ie.dbReady?ie.dbReady=ie.dbReady.then(function(){return F.promise}):ie.dbReady=F.promise}function J(k){var ie=S[k.name],F=ie.deferredOperations.pop();if(F)return F.resolve(),F.promise}function E(k,ie){var F=S[k.name],he=F.deferredOperations.pop();if(he)return he.reject(ie),he.promise}function A(k,ie){return new h(function(F,he){if(S[k.name]=S[k.name]||ve(),k.db)if(ie)V(k),k.db.close();else return F(k.db);var pe=[k.name];ie&&pe.push(k.version);var ce=l.open.apply(l,pe);ie&&(ce.onupgradeneeded=function(Re){var De=ce.result;try{De.createObjectStore(k.storeName),Re.oldVersion<=1&&De.createObjectStore(T)}catch(Fe){if(Fe.name!=="ConstraintError")throw Fe}}),ce.onerror=function(Re){Re.preventDefault(),he(ce.error)},ce.onsuccess=function(){var Re=ce.result;Re.onversionchange=function(De){De.target.close()},F(Re),J(k)}})}function x(k){return A(k,!1)}function $(k){return A(k,!0)}function B(k,ie){if(!k.db)return!0;var F=!k.db.objectStoreNames.contains(k.storeName),he=k.version<k.db.version,pe=k.version>k.db.version;if(he&&(k.version,k.version=k.db.version),pe||F){if(F){var ce=k.db.version+1;ce>k.version&&(k.version=ce)}return!0}return!1}function K(k){return new h(function(ie,F){var he=new FileReader;he.onerror=F,he.onloadend=function(pe){var ce=btoa(pe.target.result||"");ie({__local_forage_encoded_blob:!0,data:ce,type:k.type})},he.readAsBinaryString(k)})}function ae(k){var ie=H(atob(k.data));return u([ie],{type:k.type})}function ue(k){return k&&k.__local_forage_encoded_blob}function L(k){var ie=this,F=ie._initReady().then(function(){var he=S[ie._dbInfo.name];if(he&&he.dbReady)return he.dbReady});return d(F,k,k),F}function Se(k){V(k);for(var ie=S[k.name],F=ie.forages,he=0;he<F.length;he++){var pe=F[he];pe._dbInfo.db&&(pe._dbInfo.db.close(),pe._dbInfo.db=null)}return k.db=null,x(k).then(function(ce){return k.db=ce,B(k)?$(k):ce}).then(function(ce){k.db=ie.db=ce;for(var Re=0;Re<F.length;Re++)F[Re]._dbInfo.db=ce}).catch(function(ce){throw E(k,ce),ce})}function Ae(k,ie,F,he){he===void 0&&(he=1);try{var pe=k.db.transaction(k.storeName,ie);F(null,pe)}catch(ce){if(he>0&&(!k.db||ce.name==="InvalidStateError"||ce.name==="NotFoundError"))return h.resolve().then(function(){if(!k.db||ce.name==="NotFoundError"&&!k.db.objectStoreNames.contains(k.storeName)&&k.version<=k.db.version)return k.db&&(k.version=k.db.version+1),$(k)}).then(function(){return Se(k).then(function(){Ae(k,ie,F,he-1)})}).catch(F);F(ce)}}function ve(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ye(k){var ie=this,F={db:null};if(k)for(var he in k)F[he]=k[he];var pe=S[F.name];pe||(pe=ve(),S[F.name]=pe),pe.forages.push(ie),ie._initReady||(ie._initReady=ie.ready,ie.ready=L);var ce=[];function Re(){return h.resolve()}for(var De=0;De<pe.forages.length;De++){var Fe=pe.forages[De];Fe!==ie&&ce.push(Fe._initReady().catch(Re))}var Ue=pe.forages.slice(0);return h.all(ce).then(function(){return F.db=pe.db,x(F)}).then(function(je){return F.db=je,B(F,ie._defaultConfig.version)?$(F):je}).then(function(je){F.db=pe.db=je,ie._dbInfo=F;for(var ot=0;ot<Ue.length;ot++){var Dt=Ue[ot];Dt!==ie&&(Dt._dbInfo.db=F.db,Dt._dbInfo.version=F.version)}})}function mt(k,ie){var F=this;k=m(k);var he=new h(function(pe,ce){F.ready().then(function(){Ae(F._dbInfo,C,function(Re,De){if(Re)return ce(Re);try{var Fe=De.objectStore(F._dbInfo.storeName),Ue=Fe.get(k);Ue.onsuccess=function(){var je=Ue.result;je===void 0&&(je=null),ue(je)&&(je=ae(je)),pe(je)},Ue.onerror=function(){ce(Ue.error)}}catch(je){ce(je)}})}).catch(ce)});return f(he,ie),he}function et(k,ie){var F=this,he=new h(function(pe,ce){F.ready().then(function(){Ae(F._dbInfo,C,function(Re,De){if(Re)return ce(Re);try{var Fe=De.objectStore(F._dbInfo.storeName),Ue=Fe.openCursor(),je=1;Ue.onsuccess=function(){var ot=Ue.result;if(ot){var Dt=ot.value;ue(Dt)&&(Dt=ae(Dt));var Ut=k(Dt,ot.key,je++);Ut!==void 0?pe(Ut):ot.continue()}else pe()},Ue.onerror=function(){ce(Ue.error)}}catch(ot){ce(ot)}})}).catch(ce)});return f(he,ie),he}function ut(k,ie,F){var he=this;k=m(k);var pe=new h(function(ce,Re){var De;he.ready().then(function(){return De=he._dbInfo,N.call(ie)==="[object Blob]"?te(De.db).then(function(Fe){return Fe?ie:K(ie)}):ie}).then(function(Fe){Ae(he._dbInfo,I,function(Ue,je){if(Ue)return Re(Ue);try{var ot=je.objectStore(he._dbInfo.storeName);Fe===null&&(Fe=void 0);var Dt=ot.put(Fe,k);je.oncomplete=function(){Fe===void 0&&(Fe=null),ce(Fe)},je.onabort=je.onerror=function(){var Ut=Dt.error?Dt.error:Dt.transaction.error;Re(Ut)}}catch(Ut){Re(Ut)}})}).catch(Re)});return f(pe,F),pe}function Ee(k,ie){var F=this;k=m(k);var he=new h(function(pe,ce){F.ready().then(function(){Ae(F._dbInfo,I,function(Re,De){if(Re)return ce(Re);try{var Fe=De.objectStore(F._dbInfo.storeName),Ue=Fe.delete(k);De.oncomplete=function(){pe()},De.onerror=function(){ce(Ue.error)},De.onabort=function(){var je=Ue.error?Ue.error:Ue.transaction.error;ce(je)}}catch(je){ce(je)}})}).catch(ce)});return f(he,ie),he}function $e(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){Ae(ie._dbInfo,I,function(ce,Re){if(ce)return pe(ce);try{var De=Re.objectStore(ie._dbInfo.storeName),Fe=De.clear();Re.oncomplete=function(){he()},Re.onabort=Re.onerror=function(){var Ue=Fe.error?Fe.error:Fe.transaction.error;pe(Ue)}}catch(Ue){pe(Ue)}})}).catch(pe)});return f(F,k),F}function z(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){Ae(ie._dbInfo,C,function(ce,Re){if(ce)return pe(ce);try{var De=Re.objectStore(ie._dbInfo.storeName),Fe=De.count();Fe.onsuccess=function(){he(Fe.result)},Fe.onerror=function(){pe(Fe.error)}}catch(Ue){pe(Ue)}})}).catch(pe)});return f(F,k),F}function Te(k,ie){var F=this,he=new h(function(pe,ce){if(k<0){pe(null);return}F.ready().then(function(){Ae(F._dbInfo,C,function(Re,De){if(Re)return ce(Re);try{var Fe=De.objectStore(F._dbInfo.storeName),Ue=!1,je=Fe.openKeyCursor();je.onsuccess=function(){var ot=je.result;if(!ot){pe(null);return}k===0||Ue?pe(ot.key):(Ue=!0,ot.advance(k))},je.onerror=function(){ce(je.error)}}catch(ot){ce(ot)}})}).catch(ce)});return f(he,ie),he}function j(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){Ae(ie._dbInfo,C,function(ce,Re){if(ce)return pe(ce);try{var De=Re.objectStore(ie._dbInfo.storeName),Fe=De.openKeyCursor(),Ue=[];Fe.onsuccess=function(){var je=Fe.result;if(!je){he(Ue);return}Ue.push(je.key),je.continue()},Fe.onerror=function(){pe(Fe.error)}}catch(je){pe(je)}})}).catch(pe)});return f(F,k),F}function G(k,ie){ie=y.apply(this,arguments);var F=this.config();k=typeof k!="function"&&k||{},k.name||(k.name=k.name||F.name,k.storeName=k.storeName||F.storeName);var he=this,pe;if(!k.name)pe=h.reject("Invalid arguments");else{var ce=k.name===F.name&&he._dbInfo.db,Re=ce?h.resolve(he._dbInfo.db):x(k).then(function(De){var Fe=S[k.name],Ue=Fe.forages;Fe.db=De;for(var je=0;je<Ue.length;je++)Ue[je]._dbInfo.db=De;return De});k.storeName?pe=Re.then(function(De){if(De.objectStoreNames.contains(k.storeName)){var Fe=De.version+1;V(k);var Ue=S[k.name],je=Ue.forages;De.close();for(var ot=0;ot<je.length;ot++){var Dt=je[ot];Dt._dbInfo.db=null,Dt._dbInfo.version=Fe}var Ut=new h(function(Wt,un){var sn=l.open(k.name,Fe);sn.onerror=function(ir){var ei=sn.result;ei.close(),un(ir)},sn.onupgradeneeded=function(){var ir=sn.result;ir.deleteObjectStore(k.storeName)},sn.onsuccess=function(){var ir=sn.result;ir.close(),Wt(ir)}});return Ut.then(function(Wt){Ue.db=Wt;for(var un=0;un<je.length;un++){var sn=je[un];sn._dbInfo.db=Wt,J(sn._dbInfo)}}).catch(function(Wt){throw(E(k,Wt)||h.resolve()).catch(function(){}),Wt})}}):pe=Re.then(function(De){V(k);var Fe=S[k.name],Ue=Fe.forages;De.close();for(var je=0;je<Ue.length;je++){var ot=Ue[je];ot._dbInfo.db=null}var Dt=new h(function(Ut,Wt){var un=l.deleteDatabase(k.name);un.onerror=function(){var sn=un.result;sn&&sn.close(),Wt(un.error)},un.onblocked=function(){},un.onsuccess=function(){var sn=un.result;sn&&sn.close(),Ut(sn)}});return Dt.then(function(Ut){Fe.db=Ut;for(var Wt=0;Wt<Ue.length;Wt++){var un=Ue[Wt];J(un._dbInfo)}}).catch(function(Ut){throw(E(k,Ut)||h.resolve()).catch(function(){}),Ut})})}return f(pe,ie),pe}var M={_driver:"asyncStorage",_initStorage:Ye,_support:c(),iterate:et,getItem:mt,setItem:ut,removeItem:Ee,clear:$e,length:z,key:Te,keys:j,dropInstance:G};function q(){return typeof openDatabase=="function"}var se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",le="~~local_forage_type~",be=/^~~local_forage_type~([^~]+)~/,xe="__lfsc__:",Le=xe.length,Pe="arbf",oe="blob",fe="si08",Ve="ui08",Je="uic8",ze="si16",nt="si32",P="ur16",w="ui32",_="fl32",W="fl64",O=Le+Pe.length,U=Object.prototype.toString;function ee(k){var ie=k.length*.75,F=k.length,he,pe=0,ce,Re,De,Fe;k[k.length-1]==="="&&(ie--,k[k.length-2]==="="&&ie--);var Ue=new ArrayBuffer(ie),je=new Uint8Array(Ue);for(he=0;he<F;he+=4)ce=se.indexOf(k[he]),Re=se.indexOf(k[he+1]),De=se.indexOf(k[he+2]),Fe=se.indexOf(k[he+3]),je[pe++]=ce<<2|Re>>4,je[pe++]=(Re&15)<<4|De>>2,je[pe++]=(De&3)<<6|Fe&63;return Ue}function me(k){var ie=new Uint8Array(k),F="",he;for(he=0;he<ie.length;he+=3)F+=se[ie[he]>>2],F+=se[(ie[he]&3)<<4|ie[he+1]>>4],F+=se[(ie[he+1]&15)<<2|ie[he+2]>>6],F+=se[ie[he+2]&63];return ie.length%3===2?F=F.substring(0,F.length-1)+"=":ie.length%3===1&&(F=F.substring(0,F.length-2)+"=="),F}function He(k,ie){var F="";if(k&&(F=U.call(k)),k&&(F==="[object ArrayBuffer]"||k.buffer&&U.call(k.buffer)==="[object ArrayBuffer]")){var he,pe=xe;k instanceof ArrayBuffer?(he=k,pe+=Pe):(he=k.buffer,F==="[object Int8Array]"?pe+=fe:F==="[object Uint8Array]"?pe+=Ve:F==="[object Uint8ClampedArray]"?pe+=Je:F==="[object Int16Array]"?pe+=ze:F==="[object Uint16Array]"?pe+=P:F==="[object Int32Array]"?pe+=nt:F==="[object Uint32Array]"?pe+=w:F==="[object Float32Array]"?pe+=_:F==="[object Float64Array]"?pe+=W:ie(new Error("Failed to get type for BinaryArray"))),ie(pe+me(he))}else if(F==="[object Blob]"){var ce=new FileReader;ce.onload=function(){var Re=le+k.type+"~"+me(this.result);ie(xe+oe+Re)},ce.readAsArrayBuffer(k)}else try{ie(JSON.stringify(k))}catch(Re){ie(null,Re)}}function rt(k){if(k.substring(0,Le)!==xe)return JSON.parse(k);var ie=k.substring(O),F=k.substring(Le,O),he;if(F===oe&&be.test(ie)){var pe=ie.match(be);he=pe[1],ie=ie.substring(pe[0].length)}var ce=ee(ie);switch(F){case Pe:return ce;case oe:return u([ce],{type:he});case fe:return new Int8Array(ce);case Ve:return new Uint8Array(ce);case Je:return new Uint8ClampedArray(ce);case ze:return new Int16Array(ce);case P:return new Uint16Array(ce);case nt:return new Int32Array(ce);case w:return new Uint32Array(ce);case _:return new Float32Array(ce);case W:return new Float64Array(ce);default:throw new Error("Unkown type: "+F)}}var ft={serialize:He,deserialize:rt,stringToBuffer:ee,bufferToString:me};function Qe(k,ie,F,he){k.executeSql("CREATE TABLE IF NOT EXISTS "+ie.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],F,he)}function Ke(k){var ie=this,F={db:null};if(k)for(var he in k)F[he]=typeof k[he]!="string"?k[he].toString():k[he];var pe=new h(function(ce,Re){try{F.db=openDatabase(F.name,String(F.version),F.description,F.size)}catch(De){return Re(De)}F.db.transaction(function(De){Qe(De,F,function(){ie._dbInfo=F,ce()},function(Fe,Ue){Re(Ue)})},Re)});return F.serializer=ft,pe}function We(k,ie,F,he,pe,ce){k.executeSql(F,he,pe,function(Re,De){De.code===De.SYNTAX_ERR?Re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ie.storeName],function(Fe,Ue){Ue.rows.length?ce(Fe,De):Qe(Fe,ie,function(){Fe.executeSql(F,he,pe,ce)},ce)},ce):ce(Re,De)},ce)}function tt(k,ie){var F=this;k=m(k);var he=new h(function(pe,ce){F.ready().then(function(){var Re=F._dbInfo;Re.db.transaction(function(De){We(De,Re,"SELECT * FROM "+Re.storeName+" WHERE key = ? LIMIT 1",[k],function(Fe,Ue){var je=Ue.rows.length?Ue.rows.item(0).value:null;je&&(je=Re.serializer.deserialize(je)),pe(je)},function(Fe,Ue){ce(Ue)})})}).catch(ce)});return f(he,ie),he}function st(k,ie){var F=this,he=new h(function(pe,ce){F.ready().then(function(){var Re=F._dbInfo;Re.db.transaction(function(De){We(De,Re,"SELECT * FROM "+Re.storeName,[],function(Fe,Ue){for(var je=Ue.rows,ot=je.length,Dt=0;Dt<ot;Dt++){var Ut=je.item(Dt),Wt=Ut.value;if(Wt&&(Wt=Re.serializer.deserialize(Wt)),Wt=k(Wt,Ut.key,Dt+1),Wt!==void 0){pe(Wt);return}}pe()},function(Fe,Ue){ce(Ue)})})}).catch(ce)});return f(he,ie),he}function Ot(k,ie,F,he){var pe=this;k=m(k);var ce=new h(function(Re,De){pe.ready().then(function(){ie===void 0&&(ie=null);var Fe=ie,Ue=pe._dbInfo;Ue.serializer.serialize(ie,function(je,ot){ot?De(ot):Ue.db.transaction(function(Dt){We(Dt,Ue,"INSERT OR REPLACE INTO "+Ue.storeName+" (key, value) VALUES (?, ?)",[k,je],function(){Re(Fe)},function(Ut,Wt){De(Wt)})},function(Dt){if(Dt.code===Dt.QUOTA_ERR){if(he>0){Re(Ot.apply(pe,[k,Fe,F,he-1]));return}De(Dt)}})})}).catch(De)});return f(ce,F),ce}function Oe(k,ie,F){return Ot.apply(this,[k,ie,F,1])}function rn(k,ie){var F=this;k=m(k);var he=new h(function(pe,ce){F.ready().then(function(){var Re=F._dbInfo;Re.db.transaction(function(De){We(De,Re,"DELETE FROM "+Re.storeName+" WHERE key = ?",[k],function(){pe()},function(Fe,Ue){ce(Ue)})})}).catch(ce)});return f(he,ie),he}function Kn(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){var ce=ie._dbInfo;ce.db.transaction(function(Re){We(Re,ce,"DELETE FROM "+ce.storeName,[],function(){he()},function(De,Fe){pe(Fe)})})}).catch(pe)});return f(F,k),F}function On(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){var ce=ie._dbInfo;ce.db.transaction(function(Re){We(Re,ce,"SELECT COUNT(key) as c FROM "+ce.storeName,[],function(De,Fe){var Ue=Fe.rows.item(0).c;he(Ue)},function(De,Fe){pe(Fe)})})}).catch(pe)});return f(F,k),F}function gs(k,ie){var F=this,he=new h(function(pe,ce){F.ready().then(function(){var Re=F._dbInfo;Re.db.transaction(function(De){We(De,Re,"SELECT key FROM "+Re.storeName+" WHERE id = ? LIMIT 1",[k+1],function(Fe,Ue){var je=Ue.rows.length?Ue.rows.item(0).key:null;pe(je)},function(Fe,Ue){ce(Ue)})})}).catch(ce)});return f(he,ie),he}function bs(k){var ie=this,F=new h(function(he,pe){ie.ready().then(function(){var ce=ie._dbInfo;ce.db.transaction(function(Re){We(Re,ce,"SELECT key FROM "+ce.storeName,[],function(De,Fe){for(var Ue=[],je=0;je<Fe.rows.length;je++)Ue.push(Fe.rows.item(je).key);he(Ue)},function(De,Fe){pe(Fe)})})}).catch(pe)});return f(F,k),F}function lo(k){return new h(function(ie,F){k.transaction(function(he){he.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(pe,ce){for(var Re=[],De=0;De<ce.rows.length;De++)Re.push(ce.rows.item(De).name);ie({db:k,storeNames:Re})},function(pe,ce){F(ce)})},function(he){F(he)})})}function bi(k,ie){ie=y.apply(this,arguments);var F=this.config();k=typeof k!="function"&&k||{},k.name||(k.name=k.name||F.name,k.storeName=k.storeName||F.storeName);var he=this,pe;return k.name?pe=new h(function(ce){var Re;k.name===F.name?Re=he._dbInfo.db:Re=openDatabase(k.name,"","",0),k.storeName?ce({db:Re,storeNames:[k.storeName]}):ce(lo(Re))}).then(function(ce){return new h(function(Re,De){ce.db.transaction(function(Fe){function Ue(Ut){return new h(function(Wt,un){Fe.executeSql("DROP TABLE IF EXISTS "+Ut,[],function(){Wt()},function(sn,ir){un(ir)})})}for(var je=[],ot=0,Dt=ce.storeNames.length;ot<Dt;ot++)je.push(Ue(ce.storeNames[ot]));h.all(je).then(function(){Re()}).catch(function(Ut){De(Ut)})},function(Fe){De(Fe)})})}):pe=h.reject("Invalid arguments"),f(pe,ie),pe}var Ll={_driver:"webSQLStorage",_initStorage:Ke,_support:q(),iterate:st,getItem:tt,setItem:Oe,removeItem:rn,clear:Kn,length:On,key:gs,keys:bs,dropInstance:bi};function Un(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(k){return!1}}function co(k,ie){var F=k.name+"/";return k.storeName!==ie.storeName&&(F+=k.storeName+"/"),F}function Bi(){var k="_localforage_support_test";try{return localStorage.setItem(k,!0),localStorage.removeItem(k),!1}catch(ie){return!0}}function ql(){return!Bi()||localStorage.length>0}function kl(k){var ie=this,F={};if(k)for(var he in k)F[he]=k[he];return F.keyPrefix=co(k,ie._defaultConfig),ql()?(ie._dbInfo=F,F.serializer=ft,h.resolve()):h.reject()}function Xs(k){var ie=this,F=ie.ready().then(function(){for(var he=ie._dbInfo.keyPrefix,pe=localStorage.length-1;pe>=0;pe--){var ce=localStorage.key(pe);ce.indexOf(he)===0&&localStorage.removeItem(ce)}});return f(F,k),F}function $n(k,ie){var F=this;k=m(k);var he=F.ready().then(function(){var pe=F._dbInfo,ce=localStorage.getItem(pe.keyPrefix+k);return ce&&(ce=pe.serializer.deserialize(ce)),ce});return f(he,ie),he}function Bl(k,ie){var F=this,he=F.ready().then(function(){for(var pe=F._dbInfo,ce=pe.keyPrefix,Re=ce.length,De=localStorage.length,Fe=1,Ue=0;Ue<De;Ue++){var je=localStorage.key(Ue);if(je.indexOf(ce)===0){var ot=localStorage.getItem(je);if(ot&&(ot=pe.serializer.deserialize(ot)),ot=k(ot,je.substring(Re),Fe++),ot!==void 0)return ot}}});return f(he,ie),he}function yh(k,ie){var F=this,he=F.ready().then(function(){var pe=F._dbInfo,ce;try{ce=localStorage.key(k)}catch(Re){ce=null}return ce&&(ce=ce.substring(pe.keyPrefix.length)),ce});return f(he,ie),he}function uo(k){var ie=this,F=ie.ready().then(function(){for(var he=ie._dbInfo,pe=localStorage.length,ce=[],Re=0;Re<pe;Re++){var De=localStorage.key(Re);De.indexOf(he.keyPrefix)===0&&ce.push(De.substring(he.keyPrefix.length))}return ce});return f(F,k),F}function gh(k){var ie=this,F=ie.keys().then(function(he){return he.length});return f(F,k),F}function ho(k,ie){var F=this;k=m(k);var he=F.ready().then(function(){var pe=F._dbInfo;localStorage.removeItem(pe.keyPrefix+k)});return f(he,ie),he}function Fl(k,ie,F){var he=this;k=m(k);var pe=he.ready().then(function(){ie===void 0&&(ie=null);var ce=ie;return new h(function(Re,De){var Fe=he._dbInfo;Fe.serializer.serialize(ie,function(Ue,je){if(je)De(je);else try{localStorage.setItem(Fe.keyPrefix+k,Ue),Re(ce)}catch(ot){(ot.name==="QuotaExceededError"||ot.name==="NS_ERROR_DOM_QUOTA_REACHED")&&De(ot),De(ot)}})})});return f(pe,F),pe}function Zs(k,ie){if(ie=y.apply(this,arguments),k=typeof k!="function"&&k||{},!k.name){var F=this.config();k.name=k.name||F.name,k.storeName=k.storeName||F.storeName}var he=this,pe;return k.name?pe=new h(function(ce){k.storeName?ce(co(k,he._defaultConfig)):ce(k.name+"/")}).then(function(ce){for(var Re=localStorage.length-1;Re>=0;Re--){var De=localStorage.key(Re);De.indexOf(ce)===0&&localStorage.removeItem(De)}}):pe=h.reject("Invalid arguments"),f(pe,ie),pe}var bh={_driver:"localStorageWrapper",_initStorage:kl,_support:Un(),iterate:Bl,getItem:$n,setItem:Fl,removeItem:ho,clear:Xs,length:gh,key:yh,keys:uo,dropInstance:Zs},pr=function(ie,F){return ie===F||typeof ie=="number"&&typeof F=="number"&&isNaN(ie)&&isNaN(F)},ea=function(ie,F){for(var he=ie.length,pe=0;pe<he;){if(pr(ie[pe],F))return!0;pe++}return!1},ta=Array.isArray||function(k){return Object.prototype.toString.call(k)==="[object Array]"},Fi={},fo={},mr={INDEXEDDB:M,WEBSQL:Ll,LOCALSTORAGE:bh},Ul=[mr.INDEXEDDB._driver,mr.WEBSQL._driver,mr.LOCALSTORAGE._driver],Ei=["dropInstance"],na=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ei),Ui={description:"",driver:Ul.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function po(k,ie){k[ie]=function(){var F=arguments;return k.ready().then(function(){return k[ie].apply(k,F)})}}function ra(){for(var k=1;k<arguments.length;k++){var ie=arguments[k];if(ie)for(var F in ie)ie.hasOwnProperty(F)&&(ta(ie[F])?arguments[0][F]=ie[F].slice():arguments[0][F]=ie[F])}return arguments[0]}var Vl=function(){function k(ie){a(this,k);for(var F in mr)if(mr.hasOwnProperty(F)){var he=mr[F],pe=he._driver;this[F]=pe,Fi[pe]||this.defineDriver(he)}this._defaultConfig=ra({},Ui),this._config=ra({},this._defaultConfig,ie),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return k.prototype.config=function(F){if((typeof F=="undefined"?"undefined":s(F))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var he in F){if(he==="storeName"&&(F[he]=F[he].replace(/\W/g,"_")),he==="version"&&typeof F[he]!="number")return new Error("Database version must be a number.");this._config[he]=F[he]}return"driver"in F&&F.driver?this.setDriver(this._config.driver):!0}else return typeof F=="string"?this._config[F]:this._config},k.prototype.defineDriver=function(F,he,pe){var ce=new h(function(Re,De){try{var Fe=F._driver,Ue=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!F._driver){De(Ue);return}for(var je=na.concat("_initStorage"),ot=0,Dt=je.length;ot<Dt;ot++){var Ut=je[ot],Wt=!ea(Ei,Ut);if((Wt||F[Ut])&&typeof F[Ut]!="function"){De(Ue);return}}var un=function(){for(var ei=function(ni){return function(){var ws=new Error("Method "+ni+" is not implemented by the current driver"),Wl=h.reject(ws);return f(Wl,arguments[arguments.length-1]),Wl}},Vi=0,wi=Ei.length;Vi<wi;Vi++){var Es=Ei[Vi];F[Es]||(F[Es]=ei(Es))}};un();var sn=function(ei){Fi[Fe],Fi[Fe]=F,fo[Fe]=ei,Re()};"_support"in F?F._support&&typeof F._support=="function"?F._support().then(sn,De):sn(!!F._support):sn(!0)}catch(ir){De(ir)}});return d(ce,he,pe),ce},k.prototype.driver=function(){return this._driver||null},k.prototype.getDriver=function(F,he,pe){var ce=Fi[F]?h.resolve(Fi[F]):h.reject(new Error("Driver not found."));return d(ce,he,pe),ce},k.prototype.getSerializer=function(F){var he=h.resolve(ft);return d(he,F),he},k.prototype.ready=function(F){var he=this,pe=he._driverSet.then(function(){return he._ready===null&&(he._ready=he._initDriver()),he._ready});return d(pe,F,F),pe},k.prototype.setDriver=function(F,he,pe){var ce=this;ta(F)||(F=[F]);var Re=this._getSupportedDrivers(F);function De(){ce._config.driver=ce.driver()}function Fe(ot){return ce._extend(ot),De(),ce._ready=ce._initStorage(ce._config),ce._ready}function Ue(ot){return function(){var Dt=0;function Ut(){for(;Dt<ot.length;){var Wt=ot[Dt];return Dt++,ce._dbInfo=null,ce._ready=null,ce.getDriver(Wt).then(Fe).catch(Ut)}De();var un=new Error("No available storage method found.");return ce._driverSet=h.reject(un),ce._driverSet}return Ut()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=je.then(function(){var ot=Re[0];return ce._dbInfo=null,ce._ready=null,ce.getDriver(ot).then(function(Dt){ce._driver=Dt._driver,De(),ce._wrapLibraryMethodsWithReady(),ce._initDriver=Ue(Re)})}).catch(function(){De();var ot=new Error("No available storage method found.");return ce._driverSet=h.reject(ot),ce._driverSet}),d(this._driverSet,he,pe),this._driverSet},k.prototype.supports=function(F){return!!fo[F]},k.prototype._extend=function(F){ra(this,F)},k.prototype._getSupportedDrivers=function(F){for(var he=[],pe=0,ce=F.length;pe<ce;pe++){var Re=F[pe];this.supports(Re)&&he.push(Re)}return he},k.prototype._wrapLibraryMethodsWithReady=function(){for(var F=0,he=na.length;F<he;F++)po(this,na[F])},k.prototype.createInstance=function(F){return new k(F)},k}(),jl=new Vl;n.exports=jl},{3:3}]},{},[4])(4)})})(_T);var T2=_T.exports;const _2=th(T2);var ST={exports:{}};const S2={},C2=Object.freeze(Object.defineProperty({__proto__:null,default:S2},Symbol.toStringTag,{value:"Module"})),Jg=v2(C2);(function(r,e){var t=void 0,n=function(i){return t||(t=new Promise(function(s,a){var o=typeof i!="undefined"?i:{},l=o.onAbort;o.onAbort=function(p){a(new Error(p)),l&&l(p)},o.postRun=o.postRun||[],o.postRun.push(function(){s(o)}),r=void 0;var c;c||(c=typeof o!="undefined"?o:{});var u=typeof window=="object",h=typeof WorkerGlobalScope!="undefined",f=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";c.onRuntimeInitialized=function(){function p(ye,Ie){switch(typeof Ie){case"boolean":Z_(ye,Ie?1:0);break;case"number":Y_(ye,Ie);break;case"string":J_(ye,Ie,-1,-1);break;case"object":if(Ie===null)am(ye);else if(Ie.length!=null){var ht=Vi(Ie,ei);X_(ye,ht,Ie.length,-1),Hl(ht)}else Ql(ye,"Wrong API use : tried to return a value of an unknown type ("+Ie+").",-1);break;default:am(ye)}}function g(ye,Ie){for(var ht=[],St=0;St<ye;St+=1){var Pt=G(Ie+4*St,"i32"),Gt=H_(Pt);if(Gt===1||Gt===2)Pt=K_(Pt);else if(Gt===3)Pt=z_(Pt);else if(Gt===4){Gt=Pt,Pt=Q_(Gt),Gt=G_(Gt);for(var Lr=new Uint8Array(Pt),yr=0;yr<Pt;yr+=1)Lr[yr]=J[Gt+yr];Pt=Lr}else Pt=null;ht.push(Pt)}return ht}function R(ye,Ie){this.Qa=ye,this.db=Ie,this.Oa=1,this.lb=[]}function D(ye,Ie){if(this.db=Ie,Ie=nt(ye)+1,this.eb=Eh(Ie),this.eb===null)throw Error("Unable to allocate memory for the SQL string");P(ye,E,this.eb,Ie),this.kb=this.eb,this.Za=this.pb=null}function ne(ye){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),ye!=null){var Ie=this.filename,ht="/",St=Ie;if(ht&&(ht=typeof ht=="string"?ht:gs(ht),St=Ie?Le(ht+"/"+Ie):ht),Ie=He(!0,!0),St=bh(St,Ie),ye){if(typeof ye=="string"){ht=Array(ye.length);for(var Pt=0,Gt=ye.length;Pt<Gt;++Pt)ht[Pt]=ye.charCodeAt(Pt);ye=ht}Ei(St,Ie|146),ht=Ui(St,577),jl(ht,ye,0,ye.length,0),po(ht),Ei(St,Ie)}}this.handleError(Et(this.filename,we)),this.db=G(we,"i32"),lm(this.db),this.fb={},this.Sa={}}var we=ji(4),Ce=c.cwrap,Et=Ce("sqlite3_open","number",["string","number"]),Rt=Ce("sqlite3_close_v2","number",["number"]),Ft=Ce("sqlite3_exec","number",["number","string","number","number","number"]),Zt=Ce("sqlite3_changes","number",["number"]),sr=Ce("sqlite3_prepare_v2","number",["number","string","number","number","number"]),ia=Ce("sqlite3_sql","string",["number"]),tm=Ce("sqlite3_normalized_sql","string",["number"]),nm=Ce("sqlite3_prepare_v2","number",["number","number","number","number","number"]),R_=Ce("sqlite3_bind_text","number",["number","number","number","number","number"]),rm=Ce("sqlite3_bind_blob","number",["number","number","number","number","number"]),M_=Ce("sqlite3_bind_double","number",["number","number","number"]),P_=Ce("sqlite3_bind_int","number",["number","number","number"]),I_=Ce("sqlite3_bind_parameter_index","number",["number","string"]),O_=Ce("sqlite3_step","number",["number"]),$_=Ce("sqlite3_errmsg","string",["number"]),D_=Ce("sqlite3_column_count","number",["number"]),L_=Ce("sqlite3_data_count","number",["number"]),q_=Ce("sqlite3_column_double","number",["number","number"]),im=Ce("sqlite3_column_text","string",["number","number"]),k_=Ce("sqlite3_column_blob","number",["number","number"]),B_=Ce("sqlite3_column_bytes","number",["number","number"]),F_=Ce("sqlite3_column_type","number",["number","number"]),U_=Ce("sqlite3_column_name","string",["number","number"]),V_=Ce("sqlite3_reset","number",["number"]),j_=Ce("sqlite3_clear_bindings","number",["number"]),W_=Ce("sqlite3_finalize","number",["number"]),sm=Ce("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),H_=Ce("sqlite3_value_type","number",["number"]),Q_=Ce("sqlite3_value_bytes","number",["number"]),z_=Ce("sqlite3_value_text","string",["number"]),G_=Ce("sqlite3_value_blob","number",["number"]),K_=Ce("sqlite3_value_double","number",["number"]),Y_=Ce("sqlite3_result_double","",["number","number"]),am=Ce("sqlite3_result_null","",["number"]),J_=Ce("sqlite3_result_text","",["number","string","number","number"]),X_=Ce("sqlite3_result_blob","",["number","number","number","number"]),Z_=Ce("sqlite3_result_int","",["number","number"]),Ql=Ce("sqlite3_result_error","",["number","string","number"]),om=Ce("sqlite3_aggregate_context","number",["number","number"]),lm=Ce("RegisterExtensionFunctions","number",["number"]),cm=Ce("sqlite3_update_hook","number",["number","number","number"]);R.prototype.bind=function(ye){if(!this.Qa)throw"Statement closed";return this.reset(),Array.isArray(ye)?this.Cb(ye):ye!=null&&typeof ye=="object"?this.Db(ye):!0},R.prototype.step=function(){if(!this.Qa)throw"Statement closed";this.Oa=1;var ye=O_(this.Qa);switch(ye){case 100:return!0;case 101:return!1;default:throw this.db.handleError(ye)}},R.prototype.wb=function(ye){return ye==null&&(ye=this.Oa,this.Oa+=1),q_(this.Qa,ye)},R.prototype.Gb=function(ye){if(ye==null&&(ye=this.Oa,this.Oa+=1),ye=im(this.Qa,ye),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(ye)},R.prototype.Hb=function(ye){return ye==null&&(ye=this.Oa,this.Oa+=1),im(this.Qa,ye)},R.prototype.getBlob=function(ye){ye==null&&(ye=this.Oa,this.Oa+=1);var Ie=B_(this.Qa,ye);ye=k_(this.Qa,ye);for(var ht=new Uint8Array(Ie),St=0;St<Ie;St+=1)ht[St]=J[ye+St];return ht},R.prototype.get=function(ye,Ie){Ie=Ie||{},ye!=null&&this.bind(ye)&&this.step(),ye=[];for(var ht=L_(this.Qa),St=0;St<ht;St+=1)switch(F_(this.Qa,St)){case 1:var Pt=Ie.useBigInt?this.Gb(St):this.wb(St);ye.push(Pt);break;case 2:ye.push(this.wb(St));break;case 3:ye.push(this.Hb(St));break;case 4:ye.push(this.getBlob(St));break;default:ye.push(null)}return ye},R.prototype.getColumnNames=function(){for(var ye=[],Ie=D_(this.Qa),ht=0;ht<Ie;ht+=1)ye.push(U_(this.Qa,ht));return ye},R.prototype.getAsObject=function(ye,Ie){ye=this.get(ye,Ie),Ie=this.getColumnNames();for(var ht={},St=0;St<Ie.length;St+=1)ht[Ie[St]]=ye[St];return ht},R.prototype.getSQL=function(){return ia(this.Qa)},R.prototype.getNormalizedSQL=function(){return tm(this.Qa)},R.prototype.run=function(ye){return ye!=null&&this.bind(ye),this.step(),this.reset()},R.prototype.sb=function(ye,Ie){Ie==null&&(Ie=this.Oa,this.Oa+=1),ye=w(ye);var ht=Vi(ye,ei);this.lb.push(ht),this.db.handleError(R_(this.Qa,Ie,ht,ye.length-1,0))},R.prototype.Bb=function(ye,Ie){Ie==null&&(Ie=this.Oa,this.Oa+=1);var ht=Vi(ye,ei);this.lb.push(ht),this.db.handleError(rm(this.Qa,Ie,ht,ye.length,0))},R.prototype.rb=function(ye,Ie){Ie==null&&(Ie=this.Oa,this.Oa+=1),this.db.handleError((ye===(ye|0)?P_:M_)(this.Qa,Ie,ye))},R.prototype.Eb=function(ye){ye==null&&(ye=this.Oa,this.Oa+=1),rm(this.Qa,ye,0,0,0)},R.prototype.tb=function(ye,Ie){switch(Ie==null&&(Ie=this.Oa,this.Oa+=1),typeof ye){case"string":this.sb(ye,Ie);return;case"number":this.rb(ye,Ie);return;case"bigint":this.sb(ye.toString(),Ie);return;case"boolean":this.rb(ye+0,Ie);return;case"object":if(ye===null){this.Eb(Ie);return}if(ye.length!=null){this.Bb(ye,Ie);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+ye+")."},R.prototype.Db=function(ye){var Ie=this;return Object.keys(ye).forEach(function(ht){var St=I_(Ie.Qa,ht);St!==0&&Ie.tb(ye[ht],St)}),!0},R.prototype.Cb=function(ye){for(var Ie=0;Ie<ye.length;Ie+=1)this.tb(ye[Ie],Ie+1);return!0},R.prototype.reset=function(){return this.freemem(),j_(this.Qa)===0&&V_(this.Qa)===0},R.prototype.freemem=function(){for(var ye;(ye=this.lb.pop())!==void 0;)Hl(ye)},R.prototype.free=function(){this.freemem();var ye=W_(this.Qa)===0;return delete this.db.fb[this.Qa],this.Qa=0,ye},D.prototype.next=function(){if(this.eb===null)return{done:!0};if(this.Za!==null&&(this.Za.free(),this.Za=null),!this.db.db)throw this.mb(),Error("Database closed");var ye=yo(),Ie=ji(4);q(we),q(Ie);try{this.db.handleError(nm(this.db.db,this.kb,-1,we,Ie)),this.kb=G(Ie,"i32");var ht=G(we,"i32");return ht===0?(this.mb(),{done:!0}):(this.Za=new R(ht,this.db),this.db.fb[ht]=this.Za,{value:this.Za,done:!1})}catch(St){throw this.pb=be(this.kb),this.mb(),St}finally{mo(ye)}},D.prototype.mb=function(){Hl(this.eb),this.eb=null},D.prototype.getRemainingSQL=function(){return this.pb!==null?this.pb:be(this.kb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(D.prototype[Symbol.iterator]=function(){return this}),ne.prototype.run=function(ye,Ie){if(!this.db)throw"Database closed";if(Ie){ye=this.prepare(ye,Ie);try{ye.step()}finally{ye.free()}}else this.handleError(Ft(this.db,ye,0,0,we));return this},ne.prototype.exec=function(ye,Ie,ht){if(!this.db)throw"Database closed";var St=yo(),Pt=null;try{var Gt=sn(ye),Lr=ji(4);for(ye=[];G(Gt,"i8")!==0;){q(we),q(Lr),this.handleError(nm(this.db,Gt,-1,we,Lr));var yr=G(we,"i32");if(Gt=G(Lr,"i32"),yr!==0){var ur=null;for(Pt=new R(yr,this),Ie!=null&&Pt.bind(Ie);Pt.step();)ur===null&&(ur={columns:Pt.getColumnNames(),values:[]},ye.push(ur)),ur.values.push(Pt.get(null,ht));Pt.free()}}return ye}catch(qr){throw Pt&&Pt.free(),qr}finally{mo(St)}},ne.prototype.each=function(ye,Ie,ht,St,Pt){typeof Ie=="function"&&(St=ht,ht=Ie,Ie=void 0),ye=this.prepare(ye,Ie);try{for(;ye.step();)ht(ye.getAsObject(null,Pt))}finally{ye.free()}if(typeof St=="function")return St()},ne.prototype.prepare=function(ye,Ie){if(q(we),this.handleError(sr(this.db,ye,-1,we,0)),ye=G(we,"i32"),ye===0)throw"Nothing to prepare";var ht=new R(ye,this);return Ie!=null&&ht.bind(Ie),this.fb[ye]=ht},ne.prototype.iterateStatements=function(ye){return new D(ye,this)},ne.prototype.export=function(){Object.values(this.fb).forEach(function(Ie){Ie.free()}),Object.values(this.Sa).forEach(ni),this.Sa={},this.handleError(Rt(this.db));var ye=k(this.filename);return this.handleError(Et(this.filename,we)),this.db=G(we,"i32"),lm(this.db),ye},ne.prototype.close=function(){this.db!==null&&(Object.values(this.fb).forEach(function(ye){ye.free()}),Object.values(this.Sa).forEach(ni),this.Sa={},this.Ya&&(ni(this.Ya),this.Ya=void 0),this.handleError(Rt(this.db)),fo("/"+this.filename),this.db=null)},ne.prototype.handleError=function(ye){if(ye===0)return null;throw ye=$_(this.db),Error(ye)},ne.prototype.getRowsModified=function(){return Zt(this.db)},ne.prototype.create_function=function(ye,Ie){Object.prototype.hasOwnProperty.call(this.Sa,ye)&&(ni(this.Sa[ye]),delete this.Sa[ye]);var ht=ws(function(St,Pt,Gt){Pt=g(Pt,Gt);try{var Lr=Ie.apply(null,Pt)}catch(yr){Ql(St,yr,-1);return}p(St,Lr)},"viii");return this.Sa[ye]=ht,this.handleError(sm(this.db,ye,Ie.length,1,0,ht,0,0,0)),this},ne.prototype.create_aggregate=function(ye,Ie){var ht=Ie.init||function(){return null},St=Ie.finalize||function(ur){return ur},Pt=Ie.step;if(!Pt)throw"An aggregate function must have a step function in "+ye;var Gt={};Object.hasOwnProperty.call(this.Sa,ye)&&(ni(this.Sa[ye]),delete this.Sa[ye]),Ie=ye+"__finalize",Object.hasOwnProperty.call(this.Sa,Ie)&&(ni(this.Sa[Ie]),delete this.Sa[Ie]);var Lr=ws(function(ur,qr,vh){var vs=om(ur,1);Object.hasOwnProperty.call(Gt,vs)||(Gt[vs]=ht()),qr=g(qr,vh),qr=[Gt[vs]].concat(qr);try{Gt[vs]=Pt.apply(null,qr)}catch(eS){delete Gt[vs],Ql(ur,eS,-1)}},"viii"),yr=ws(function(ur){var qr=om(ur,1);try{var vh=St(Gt[qr])}catch(vs){delete Gt[qr],Ql(ur,vs,-1);return}p(ur,vh),delete Gt[qr]},"vi");return this.Sa[ye]=Lr,this.Sa[Ie]=yr,this.handleError(sm(this.db,ye,Pt.length-1,1,0,0,Lr,yr,0)),this},ne.prototype.updateHook=function(ye){this.Ya&&(cm(this.db,0,0),ni(this.Ya),this.Ya=void 0),ye&&(this.Ya=ws(function(Ie,ht,St,Pt,Gt){switch(ht){case 18:Ie="insert";break;case 23:Ie="update";break;case 9:Ie="delete";break;default:throw"unknown operationCode in updateHook callback: "+ht}if(St=St?le(E,St):"",Pt=Pt?le(E,Pt):"",Gt>Number.MAX_SAFE_INTEGER)throw"rowId too big to fit inside a Number";ye(Ie,St,Pt,Number(Gt))},"viiiij"),cm(this.db,this.Ya,0))},c.Database=ne};var d=Xe({},c),m="./this.program",y=(p,g)=>{throw g},T="",b,S;if(f){var N=Jg;T=__dirname+"/",S=p=>(p=ue(p)?new URL(p):p,N.readFileSync(p)),b=p=>v(this,null,function*(){return p=ue(p)?new URL(p):p,N.readFileSync(p,void 0)}),!c.thisProgram&&1<process.argv.length&&(m=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),r.exports=c,y=(p,g)=>{throw process.exitCode=p,g}}else(u||h)&&(h?T=self.location.href:typeof document!="undefined"&&document.currentScript&&(T=document.currentScript.src),T=T.startsWith("blob:")?"":T.slice(0,T.replace(/[?#].*/,"").lastIndexOf("/")+1),h&&(S=p=>{var g=new XMLHttpRequest;return g.open("GET",p,!1),g.responseType="arraybuffer",g.send(null),new Uint8Array(g.response)}),b=p=>v(this,null,function*(){if(ue(p))return new Promise((R,D)=>{var ne=new XMLHttpRequest;ne.open("GET",p,!0),ne.responseType="arraybuffer",ne.onload=()=>{ne.status==200||ne.status==0&&ne.response?R(ne.response):D(ne.status)},ne.onerror=D,ne.send(null)});var g=yield fetch(p,{credentials:"same-origin"});if(g.ok)return g.arrayBuffer();throw Error(g.status+" : "+g.url)}));var C=c.print||void 0,I=c.printErr||void 0;Object.assign(c,d),d=null,c.thisProgram&&(m=c.thisProgram);var H=c.wasmBinary,Q,te=!1,V,J,E,A,x,$,B,K,ae,ue=p=>p.startsWith("file://");function L(){var p=Q.buffer;c.HEAP8=J=new Int8Array(p),c.HEAP16=A=new Int16Array(p),c.HEAPU8=E=new Uint8Array(p),c.HEAPU16=new Uint16Array(p),c.HEAP32=x=new Int32Array(p),c.HEAPU32=$=new Uint32Array(p),c.HEAPF32=B=new Float32Array(p),c.HEAPF64=ae=new Float64Array(p),c.HEAP64=K=new BigInt64Array(p),c.HEAPU64=new BigUint64Array(p)}var Se=0,Ae=null;function ve(p){var g;throw(g=c.onAbort)==null||g.call(c,p),p="Aborted("+p+")",I(p),te=!0,new WebAssembly.RuntimeError(p+". Build with -sASSERTIONS for more info.")}var Ye;function mt(p){return v(this,null,function*(){if(!H)try{var g=yield b(p);return new Uint8Array(g)}catch(R){}if(p==Ye&&H)p=new Uint8Array(H);else if(S)p=S(p);else throw"both async and sync fetching of the wasm failed";return p})}function et(p,g){return v(this,null,function*(){try{var R=yield mt(p);return yield WebAssembly.instantiate(R,g)}catch(D){I(`failed to asynchronously prepare wasm: ${D}`),ve(D)}})}function ut(p){return v(this,null,function*(){var g=Ye;if(!H&&typeof WebAssembly.instantiateStreaming=="function"&&!ue(g)&&!f)try{var R=fetch(g,{credentials:"same-origin"});return yield WebAssembly.instantiateStreaming(R,p)}catch(D){I(`wasm streaming compile failed: ${D}`),I("falling back to ArrayBuffer instantiation")}return et(g,p)})}class Ee{constructor(g){wn(this,"name","ExitStatus");this.message=`Program terminated with exit(${g})`,this.status=g}}var $e=p=>{for(;0<p.length;)p.shift()(c)},z=[],Te=[],j=()=>{var p=c.preRun.shift();Te.unshift(p)};function G(p,g="i8"){switch(g.endsWith("*")&&(g="*"),g){case"i1":return J[p];case"i8":return J[p];case"i16":return A[p>>1];case"i32":return x[p>>2];case"i64":return K[p>>3];case"float":return B[p>>2];case"double":return ae[p>>3];case"*":return $[p>>2];default:ve(`invalid type for getValue: ${g}`)}}var M=c.noExitRuntime||!0;function q(p){var g="i32";switch(g.endsWith("*")&&(g="*"),g){case"i1":J[p]=0;break;case"i8":J[p]=0;break;case"i16":A[p>>1]=0;break;case"i32":x[p>>2]=0;break;case"i64":K[p>>3]=BigInt(0);break;case"float":B[p>>2]=0;break;case"double":ae[p>>3]=0;break;case"*":$[p>>2]=0;break;default:ve(`invalid type for setValue: ${g}`)}}var se=typeof TextDecoder!="undefined"?new TextDecoder:void 0,le=(p,g=0,R=NaN)=>{var D=g+R;for(R=g;p[R]&&!(R>=D);)++R;if(16<R-g&&p.buffer&&se)return se.decode(p.subarray(g,R));for(D="";g<R;){var ne=p[g++];if(ne&128){var we=p[g++]&63;if((ne&224)==192)D+=String.fromCharCode((ne&31)<<6|we);else{var Ce=p[g++]&63;ne=(ne&240)==224?(ne&15)<<12|we<<6|Ce:(ne&7)<<18|we<<12|Ce<<6|p[g++]&63,65536>ne?D+=String.fromCharCode(ne):(ne-=65536,D+=String.fromCharCode(55296|ne>>10,56320|ne&1023))}}else D+=String.fromCharCode(ne)}return D},be=(p,g)=>p?le(E,p,g):"",xe=(p,g)=>{for(var R=0,D=p.length-1;0<=D;D--){var ne=p[D];ne==="."?p.splice(D,1):ne===".."?(p.splice(D,1),R++):R&&(p.splice(D,1),R--)}if(g)for(;R;R--)p.unshift("..");return p},Le=p=>{var g=p.charAt(0)==="/",R=p.slice(-1)==="/";return(p=xe(p.split("/").filter(D=>!!D),!g).join("/"))||g||(p="."),p&&R&&(p+="/"),(g?"/":"")+p},Pe=p=>{var g=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(p).slice(1);return p=g[0],g=g[1],!p&&!g?".":(g&&(g=g.slice(0,-1)),p+g)},oe=p=>p&&p.match(/([^\/]+|\/)\/*$/)[1],fe=()=>{if(f){var p=Jg;return g=>p.randomFillSync(g)}return g=>crypto.getRandomValues(g)},Ve=p=>{(Ve=fe())(p)},Je=(...p)=>{for(var g="",R=!1,D=p.length-1;-1<=D&&!R;D--){if(R=0<=D?p[D]:"/",typeof R!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!R)return"";g=R+"/"+g,R=R.charAt(0)==="/"}return g=xe(g.split("/").filter(ne=>!!ne),!R).join("/"),(R?"/":"")+g||"."},ze=[],nt=p=>{for(var g=0,R=0;R<p.length;++R){var D=p.charCodeAt(R);127>=D?g++:2047>=D?g+=2:55296<=D&&57343>=D?(g+=4,++R):g+=3}return g},P=(p,g,R,D)=>{if(!(0<D))return 0;var ne=R;D=R+D-1;for(var we=0;we<p.length;++we){var Ce=p.charCodeAt(we);if(55296<=Ce&&57343>=Ce){var Et=p.charCodeAt(++we);Ce=65536+((Ce&1023)<<10)|Et&1023}if(127>=Ce){if(R>=D)break;g[R++]=Ce}else{if(2047>=Ce){if(R+1>=D)break;g[R++]=192|Ce>>6}else{if(65535>=Ce){if(R+2>=D)break;g[R++]=224|Ce>>12}else{if(R+3>=D)break;g[R++]=240|Ce>>18,g[R++]=128|Ce>>12&63}g[R++]=128|Ce>>6&63}g[R++]=128|Ce&63}}return g[R]=0,R-ne},w=(p,g)=>{var R=Array(nt(p)+1);return p=P(p,R,0,R.length),g&&(R.length=p),R},_=[];function W(p,g){_[p]={input:[],output:[],cb:g},ho(p,O)}var O={open(p){var g=_[p.node.rdev];if(!g)throw new Oe(43);p.tty=g,p.seekable=!1},close(p){p.tty.cb.fsync(p.tty)},fsync(p){p.tty.cb.fsync(p.tty)},read(p,g,R,D){if(!p.tty||!p.tty.cb.xb)throw new Oe(60);for(var ne=0,we=0;we<D;we++){try{var Ce=p.tty.cb.xb(p.tty)}catch(Et){throw new Oe(29)}if(Ce===void 0&&ne===0)throw new Oe(6);if(Ce==null)break;ne++,g[R+we]=Ce}return ne&&(p.node.atime=Date.now()),ne},write(p,g,R,D){if(!p.tty||!p.tty.cb.qb)throw new Oe(60);try{for(var ne=0;ne<D;ne++)p.tty.cb.qb(p.tty,g[R+ne])}catch(we){throw new Oe(29)}return D&&(p.node.mtime=p.node.ctime=Date.now()),ne}},U={xb(){e:{if(!ze.length){var p=null;if(f){var g=Buffer.alloc(256),R=0,D=process.stdin.fd;try{R=N.readSync(D,g,0,256)}catch(ne){if(ne.toString().includes("EOF"))R=0;else throw ne}0<R&&(p=g.slice(0,R).toString("utf-8"))}else typeof window!="undefined"&&typeof window.prompt=="function"&&(p=window.prompt("Input: "),p!==null&&(p+=`
`));if(!p){p=null;break e}ze=w(p,!0)}p=ze.shift()}return p},qb(p,g){g===null||g===10?(C(le(p.output)),p.output=[]):g!=0&&p.output.push(g)},fsync(p){var g;0<((g=p.output)==null?void 0:g.length)&&(C(le(p.output)),p.output=[])},Tb(){return{Ob:25856,Qb:5,Nb:191,Pb:35387,Mb:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Ub(){return 0},Vb(){return[24,80]}},ee={qb(p,g){g===null||g===10?(I(le(p.output)),p.output=[]):g!=0&&p.output.push(g)},fsync(p){var g;0<((g=p.output)==null?void 0:g.length)&&(I(le(p.output)),p.output=[])}},me={Wa:null,Xa(){return me.createNode(null,"/",16895,0)},createNode(p,g,R,D){if((R&61440)===24576||(R&61440)===4096)throw new Oe(63);return me.Wa||(me.Wa={dir:{node:{Ta:me.La.Ta,Ua:me.La.Ua,lookup:me.La.lookup,hb:me.La.hb,rename:me.La.rename,unlink:me.La.unlink,rmdir:me.La.rmdir,readdir:me.La.readdir,symlink:me.La.symlink},stream:{Va:me.Ma.Va}},file:{node:{Ta:me.La.Ta,Ua:me.La.Ua},stream:{Va:me.Ma.Va,read:me.Ma.read,write:me.Ma.write,ib:me.Ma.ib,jb:me.Ma.jb}},link:{node:{Ta:me.La.Ta,Ua:me.La.Ua,readlink:me.La.readlink},stream:{}},ub:{node:{Ta:me.La.Ta,Ua:me.La.Ua},stream:gh}}),R=Ll(p,g,R,D),Un(R.mode)?(R.La=me.Wa.dir.node,R.Ma=me.Wa.dir.stream,R.Na={}):(R.mode&61440)===32768?(R.La=me.Wa.file.node,R.Ma=me.Wa.file.stream,R.Ra=0,R.Na=null):(R.mode&61440)===40960?(R.La=me.Wa.link.node,R.Ma=me.Wa.link.stream):(R.mode&61440)===8192&&(R.La=me.Wa.ub.node,R.Ma=me.Wa.ub.stream),R.atime=R.mtime=R.ctime=Date.now(),p&&(p.Na[g]=R,p.atime=p.mtime=p.ctime=R.atime),R},Sb(p){return p.Na?p.Na.subarray?p.Na.subarray(0,p.Ra):new Uint8Array(p.Na):new Uint8Array(0)},La:{Ta(p){var g={};return g.dev=(p.mode&61440)===8192?p.id:1,g.ino=p.id,g.mode=p.mode,g.nlink=1,g.uid=0,g.gid=0,g.rdev=p.rdev,Un(p.mode)?g.size=4096:(p.mode&61440)===32768?g.size=p.Ra:(p.mode&61440)===40960?g.size=p.link.length:g.size=0,g.atime=new Date(p.atime),g.mtime=new Date(p.mtime),g.ctime=new Date(p.ctime),g.blksize=4096,g.blocks=Math.ceil(g.size/g.blksize),g},Ua(p,g){for(var R of["mode","atime","mtime","ctime"])g[R]!=null&&(p[R]=g[R]);g.size!==void 0&&(g=g.size,p.Ra!=g&&(g==0?(p.Na=null,p.Ra=0):(R=p.Na,p.Na=new Uint8Array(g),R&&p.Na.set(R.subarray(0,Math.min(g,p.Ra))),p.Ra=g)))},lookup(){throw me.vb},hb(p,g,R,D){return me.createNode(p,g,R,D)},rename(p,g,R){try{var D=bi(g,R)}catch(we){}if(D){if(Un(p.mode))for(var ne in D.Na)throw new Oe(55);lo(D)}delete p.parent.Na[p.name],g.Na[R]=p,p.name=R,g.ctime=g.mtime=p.parent.ctime=p.parent.mtime=Date.now()},unlink(p,g){delete p.Na[g],p.ctime=p.mtime=Date.now()},rmdir(p,g){var R=bi(p,g),D;for(D in R.Na)throw new Oe(55);delete p.Na[g],p.ctime=p.mtime=Date.now()},readdir(p){return[".","..",...Object.keys(p.Na)]},symlink(p,g,R){return p=me.createNode(p,g,41471,0),p.link=R,p},readlink(p){if((p.mode&61440)!==40960)throw new Oe(28);return p.link}},Ma:{read(p,g,R,D,ne){var we=p.node.Na;if(ne>=p.node.Ra)return 0;if(p=Math.min(p.node.Ra-ne,D),8<p&&we.subarray)g.set(we.subarray(ne,ne+p),R);else for(D=0;D<p;D++)g[R+D]=we[ne+D];return p},write(p,g,R,D,ne,we){if(g.buffer===J.buffer&&(we=!1),!D)return 0;if(p=p.node,p.mtime=p.ctime=Date.now(),g.subarray&&(!p.Na||p.Na.subarray)){if(we)return p.Na=g.subarray(R,R+D),p.Ra=D;if(p.Ra===0&&ne===0)return p.Na=g.slice(R,R+D),p.Ra=D;if(ne+D<=p.Ra)return p.Na.set(g.subarray(R,R+D),ne),D}we=ne+D;var Ce=p.Na?p.Na.length:0;if(Ce>=we||(we=Math.max(we,Ce*(1048576>Ce?2:1.125)>>>0),Ce!=0&&(we=Math.max(we,256)),Ce=p.Na,p.Na=new Uint8Array(we),0<p.Ra&&p.Na.set(Ce.subarray(0,p.Ra),0)),p.Na.subarray&&g.subarray)p.Na.set(g.subarray(R,R+D),ne);else for(we=0;we<D;we++)p.Na[ne+we]=g[R+we];return p.Ra=Math.max(p.Ra,ne+D),D},Va(p,g,R){if(R===1?g+=p.position:R===2&&(p.node.mode&61440)===32768&&(g+=p.node.Ra),0>g)throw new Oe(28);return g},ib(p,g,R,D,ne){if((p.node.mode&61440)!==32768)throw new Oe(43);if(p=p.node.Na,ne&2||!p||p.buffer!==J.buffer){ne=!0,D=65536*Math.ceil(g/65536);var we=Zp(65536,D);if(we&&E.fill(0,we,we+D),D=we,!D)throw new Oe(48);p&&((0<R||R+g<p.length)&&(p.subarray?p=p.subarray(R,R+g):p=Array.prototype.slice.call(p,R,R+g)),J.set(p,D))}else ne=!1,D=p.byteOffset;return{Kb:D,Ab:ne}},jb(p,g,R,D){return me.Ma.write(p,g,0,D,R,!1),0}}},He=(p,g)=>{var R=0;return p&&(R|=365),g&&(R|=146),R},rt=null,ft={},Qe=[],Ke=1,We=null,tt=!1,st=!0,Ot={},Oe=class{constructor(p){wn(this,"name","ErrnoError");this.Pa=p}},rn=class{constructor(){wn(this,"gb",{});wn(this,"node",null)}get flags(){return this.gb.flags}set flags(p){this.gb.flags=p}get position(){return this.gb.position}set position(p){this.gb.position=p}},Kn=class{constructor(p,g,R,D){wn(this,"La",{});wn(this,"Ma",{});wn(this,"ab",null);p||(p=this),this.parent=p,this.Xa=p.Xa,this.id=Ke++,this.name=g,this.mode=R,this.rdev=D,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&365)===365}set read(p){p?this.mode|=365:this.mode&=-366}get write(){return(this.mode&146)===146}set write(p){p?this.mode|=146:this.mode&=-147}};function On(p,g={}){var Et;if(!p)throw new Oe(44);(Et=g.nb)!=null||(g.nb=!0),p.charAt(0)==="/"||(p="//"+p);var R=0;e:for(;40>R;R++){p=p.split("/").filter(Rt=>!!Rt);for(var D=rt,ne="/",we=0;we<p.length;we++){var Ce=we===p.length-1;if(Ce&&g.parent)break;if(p[we]!==".")if(p[we]==="..")ne=Pe(ne),D=D.parent;else{ne=Le(ne+"/"+p[we]);try{D=bi(D,p[we])}catch(Rt){if((Rt==null?void 0:Rt.Pa)===44&&Ce&&g.Jb)return{path:ne};throw Rt}if(!D.ab||Ce&&!g.nb||(D=D.ab.root),(D.mode&61440)===40960&&(!Ce||g.$a)){if(!D.La.readlink)throw new Oe(52);D=D.La.readlink(D),D.charAt(0)==="/"||(D=Pe(ne)+"/"+D),p=D+"/"+p.slice(we+1).join("/");continue e}}}return{path:ne,node:D}}throw new Oe(32)}function gs(p){for(var g;;){if(p===p.parent)return p=p.Xa.zb,g?p[p.length-1]!=="/"?`${p}/${g}`:p+g:p;g=g?`${p.name}/${g}`:p.name,p=p.parent}}function bs(p,g){for(var R=0,D=0;D<g.length;D++)R=(R<<5)-R+g.charCodeAt(D)|0;return(p+R>>>0)%We.length}function lo(p){var g=bs(p.parent.id,p.name);if(We[g]===p)We[g]=p.bb;else for(g=We[g];g;){if(g.bb===p){g.bb=p.bb;break}g=g.bb}}function bi(p,g){var R=Un(p.mode)?(R=Bi(p,"x"))?R:p.La.lookup?0:2:54;if(R)throw new Oe(R);for(R=We[bs(p.id,g)];R;R=R.bb){var D=R.name;if(R.parent.id===p.id&&D===g)return R}return p.La.lookup(p,g)}function Ll(p,g,R,D){return p=new Kn(p,g,R,D),g=bs(p.parent.id,p.name),p.bb=We[g],We[g]=p}function Un(p){return(p&61440)===16384}function co(p){var g=["r","w","rw"][p&3];return p&512&&(g+="w"),g}function Bi(p,g){if(st)return 0;if(!g.includes("r")||p.mode&292){if(g.includes("w")&&!(p.mode&146)||g.includes("x")&&!(p.mode&73))return 2}else return 2;return 0}function ql(p,g){if(!Un(p.mode))return 54;try{return bi(p,g),20}catch(R){}return Bi(p,"wx")}function kl(p,g,R){try{var D=bi(p,g)}catch(ne){return ne.Pa}if(p=Bi(p,"wx"))return p;if(R){if(!Un(D.mode))return 54;if(D===D.parent||gs(D)==="/")return 10}else if(Un(D.mode))return 31;return 0}function Xs(p){if(!p)throw new Oe(63);return p}function $n(p){if(p=Qe[p],!p)throw new Oe(8);return p}function Bl(p,g=-1){if(p=Object.assign(new rn,p),g==-1)e:{for(g=0;4096>=g;g++)if(!Qe[g])break e;throw new Oe(33)}return p.fd=g,Qe[g]=p}function yh(p,g=-1){var R,D;return p=Bl(p,g),(D=(R=p.Ma)==null?void 0:R.Rb)==null||D.call(R,p),p}function uo(p,g,R){var D=p==null?void 0:p.Ma.Ua;p=D?p:g,D!=null||(D=g.La.Ua),Xs(D),D(p,R)}var gh={open(p){var g,R;p.Ma=ft[p.node.rdev].Ma,(R=(g=p.Ma).open)==null||R.call(g,p)},Va(){throw new Oe(70)}};function ho(p,g){ft[p]={Ma:g}}function Fl(p,g){var R=g==="/";if(R&&rt)throw new Oe(10);if(!R&&g){var D=On(g,{nb:!1});if(g=D.path,D=D.node,D.ab)throw new Oe(10);if(!Un(D.mode))throw new Oe(54)}g={type:p,Wb:{},zb:g,Ib:[]},p=p.Xa(g),p.Xa=g,g.root=p,R?rt=p:D&&(D.ab=g,D.Xa&&D.Xa.Ib.push(g))}function Zs(p,g,R){var D=On(p,{parent:!0}).node;if(p=oe(p),!p)throw new Oe(28);if(p==="."||p==="..")throw new Oe(20);var ne=ql(D,p);if(ne)throw new Oe(ne);if(!D.La.hb)throw new Oe(63);return D.La.hb(D,p,g,R)}function bh(p,g=438){return Zs(p,g&4095|32768,0)}function pr(p,g=511){return Zs(p,g&1023|16384,0)}function ea(p,g,R){typeof R=="undefined"&&(R=g,g=438),Zs(p,g|8192,R)}function ta(p,g){if(!Je(p))throw new Oe(44);var R=On(g,{parent:!0}).node;if(!R)throw new Oe(44);g=oe(g);var D=ql(R,g);if(D)throw new Oe(D);if(!R.La.symlink)throw new Oe(63);R.La.symlink(R,g,p)}function Fi(p){var g=On(p,{parent:!0}).node;p=oe(p);var R=bi(g,p),D=kl(g,p,!0);if(D)throw new Oe(D);if(!g.La.rmdir)throw new Oe(63);if(R.ab)throw new Oe(10);g.La.rmdir(g,p),lo(R)}function fo(p){var g=On(p,{parent:!0}).node;if(!g)throw new Oe(44);p=oe(p);var R=bi(g,p),D=kl(g,p,!1);if(D)throw new Oe(D);if(!g.La.unlink)throw new Oe(63);if(R.ab)throw new Oe(10);g.La.unlink(g,p),lo(R)}function mr(p,g){return p=On(p,{$a:!g}).node,Xs(p.La.Ta)(p)}function Ul(p,g,R,D){uo(p,g,{mode:R&4095|g.mode&-4096,ctime:Date.now(),Fb:D})}function Ei(p,g){p=typeof p=="string"?On(p,{$a:!0}).node:p,Ul(null,p,g)}function na(p,g,R){if(Un(g.mode))throw new Oe(31);if((g.mode&61440)!==32768)throw new Oe(28);var D=Bi(g,"w");if(D)throw new Oe(D);uo(p,g,{size:R,timestamp:Date.now()})}function Ui(p,g,R=438){if(p==="")throw new Oe(44);if(typeof g=="string"){var D={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[g];if(typeof D=="undefined")throw Error(`Unknown file open mode: ${g}`);g=D}if(R=g&64?R&4095|32768:0,typeof p=="object")D=p;else{var ne=p.endsWith("/");p=On(p,{$a:!(g&131072),Jb:!0}),D=p.node,p=p.path}var we=!1;if(g&64)if(D){if(g&128)throw new Oe(20)}else{if(ne)throw new Oe(31);D=Zs(p,R|511,0),we=!0}if(!D)throw new Oe(44);if((D.mode&61440)===8192&&(g&=-513),g&65536&&!Un(D.mode))throw new Oe(54);if(!we&&(ne=D?(D.mode&61440)===40960?32:Un(D.mode)&&(co(g)!=="r"||g&576)?31:Bi(D,co(g)):44))throw new Oe(ne);return g&512&&!we&&(ne=D,ne=typeof ne=="string"?On(ne,{$a:!0}).node:ne,na(null,ne,0)),g&=-131713,ne=Bl({node:D,path:gs(D),flags:g,seekable:!0,position:0,Ma:D.Ma,Lb:[],error:!1}),ne.Ma.open&&ne.Ma.open(ne),we&&Ei(D,R&511),!c.logReadFiles||g&1||p in Ot||(Ot[p]=1),ne}function po(p){if(p.fd===null)throw new Oe(8);p.ob&&(p.ob=null);try{p.Ma.close&&p.Ma.close(p)}catch(g){throw g}finally{Qe[p.fd]=null}p.fd=null}function ra(p,g,R){if(p.fd===null)throw new Oe(8);if(!p.seekable||!p.Ma.Va)throw new Oe(70);if(R!=0&&R!=1&&R!=2)throw new Oe(28);p.position=p.Ma.Va(p,g,R),p.Lb=[]}function Vl(p,g,R,D,ne){if(0>D||0>ne)throw new Oe(28);if(p.fd===null)throw new Oe(8);if((p.flags&2097155)===1)throw new Oe(8);if(Un(p.node.mode))throw new Oe(31);if(!p.Ma.read)throw new Oe(28);var we=typeof ne!="undefined";if(!we)ne=p.position;else if(!p.seekable)throw new Oe(70);return g=p.Ma.read(p,g,R,D,ne),we||(p.position+=g),g}function jl(p,g,R,D,ne){if(0>D||0>ne)throw new Oe(28);if(p.fd===null)throw new Oe(8);if(!(p.flags&2097155))throw new Oe(8);if(Un(p.node.mode))throw new Oe(31);if(!p.Ma.write)throw new Oe(28);p.seekable&&p.flags&1024&&ra(p,0,2);var we=typeof ne!="undefined";if(!we)ne=p.position;else if(!p.seekable)throw new Oe(70);return g=p.Ma.write(p,g,R,D,ne,void 0),we||(p.position+=g),g}function k(p){var g,R=Ui(p,R||0);p=mr(p).size;var D=new Uint8Array(p);return Vl(R,D,0,p,0),g=D,po(R),g}function ie(p,g,R){var we;p=Le("/dev/"+p);var D=He(!!g,!!R);(we=ie.yb)!=null||(ie.yb=64);var ne=ie.yb++<<8|0;ho(ne,{open(Ce){Ce.seekable=!1},close(){var Ce;(Ce=R==null?void 0:R.buffer)!=null&&Ce.length&&R(10)},read(Ce,Et,Rt,Ft){for(var Zt=0,sr=0;sr<Ft;sr++){try{var ia=g()}catch(tm){throw new Oe(29)}if(ia===void 0&&Zt===0)throw new Oe(6);if(ia==null)break;Zt++,Et[Rt+sr]=ia}return Zt&&(Ce.node.atime=Date.now()),Zt},write(Ce,Et,Rt,Ft){for(var Zt=0;Zt<Ft;Zt++)try{R(Et[Rt+Zt])}catch(sr){throw new Oe(29)}return Ft&&(Ce.node.mtime=Ce.node.ctime=Date.now()),Zt}}),ea(p,D,ne)}var F={};function he(p,g,R){if(g.charAt(0)==="/")return g;if(p=p===-100?"/":$n(p).path,g.length==0){if(!R)throw new Oe(44);return p}return p+"/"+g}function pe(p,g){x[p>>2]=g.dev,x[p+4>>2]=g.mode,$[p+8>>2]=g.nlink,x[p+12>>2]=g.uid,x[p+16>>2]=g.gid,x[p+20>>2]=g.rdev,K[p+24>>3]=BigInt(g.size),x[p+32>>2]=4096,x[p+36>>2]=g.blocks;var R=g.atime.getTime(),D=g.mtime.getTime(),ne=g.ctime.getTime();return K[p+40>>3]=BigInt(Math.floor(R/1e3)),$[p+48>>2]=R%1e3*1e6,K[p+56>>3]=BigInt(Math.floor(D/1e3)),$[p+64>>2]=D%1e3*1e6,K[p+72>>3]=BigInt(Math.floor(ne/1e3)),$[p+80>>2]=ne%1e3*1e6,K[p+88>>3]=BigInt(g.ino),0}var ce=void 0,Re=()=>{var p=x[+ce>>2];return ce+=4,p},De=0,Fe=[0,31,60,91,121,152,182,213,244,274,305,335],Ue=[0,31,59,90,120,151,181,212,243,273,304,334],je={},ot=p=>{var g;V=p,M||0<De||((g=c.onExit)==null||g.call(c,p),te=!0),y(p,new Ee(p))},Dt=p=>{if(!te)try{if(p(),!(M||0<De))try{V=p=V,ot(p)}catch(g){g instanceof Ee||g=="unwind"||y(1,g)}}catch(g){g instanceof Ee||g=="unwind"||y(1,g)}},Ut={},Wt=()=>{if(!un){var p={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:m||"./this.program"},g;for(g in Ut)Ut[g]===void 0?delete p[g]:p[g]=Ut[g];var R=[];for(g in p)R.push(`${g}=${p[g]}`);un=R}return un},un,sn=p=>{var g=nt(p)+1,R=ji(g);return P(p,E,R,g),R},ir=(p,g,R,D)=>{var ne={string:Ft=>{var Zt=0;return Ft!=null&&Ft!==0&&(Zt=sn(Ft)),Zt},array:Ft=>{var Zt=ji(Ft.length);return J.set(Ft,Zt),Zt}};p=c["_"+p];var we=[],Ce=0;if(D)for(var Et=0;Et<D.length;Et++){var Rt=ne[R[Et]];Rt?(Ce===0&&(Ce=yo()),we[Et]=Rt(D[Et])):we[Et]=D[Et]}return R=p(...we),R=function(Ft){return Ce!==0&&mo(Ce),g==="string"?Ft?le(E,Ft):"":g==="boolean"?!!Ft:Ft}(R)},ei=0,Vi=(p,g)=>(g=g==1?ji(p.length):Eh(p.length),p.subarray||p.slice||(p=new Uint8Array(p)),E.set(p,g),g),wi,Es=[],ti,ni=p=>{wi.delete(ti.get(p)),ti.set(p,null),Es.push(p)},ws=(p,g)=>{if(!wi){wi=new WeakMap;var R=ti.length;if(wi)for(var D=0;D<0+R;D++){var ne=ti.get(D);ne&&wi.set(ne,D)}}if(R=wi.get(p)||0)return R;if(Es.length)R=Es.pop();else{try{ti.grow(1)}catch(Rt){throw Rt instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":Rt}R=ti.length-1}try{ti.set(R,p)}catch(Rt){if(!(Rt instanceof TypeError))throw Rt;if(typeof WebAssembly.Function=="function"){var we=WebAssembly.Function;D={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},ne={parameters:[],results:g[0]=="v"?[]:[D[g[0]]]};for(var Ce=1;Ce<g.length;++Ce)ne.parameters.push(D[g[Ce]]);g=new we(ne,p)}else{D=[1],ne=g.slice(0,1),g=g.slice(1),Ce={i:127,p:127,j:126,f:125,d:124,e:111},D.push(96);var Et=g.length;128>Et?D.push(Et):D.push(Et%128|128,Et>>7);for(we of g)D.push(Ce[we]);ne=="v"?D.push(0):D.push(1,Ce[ne]),g=[0,97,115,109,1,0,0,0,1],we=D.length,128>we?g.push(we):g.push(we%128|128,we>>7),g.push(...D),g.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),g=new WebAssembly.Module(new Uint8Array(g)),g=new WebAssembly.Instance(g,{e:{f:p}}).exports.f}ti.set(R,g)}return wi.set(p,R),R};We=Array(4096),Fl(me,"/"),pr("/tmp"),pr("/home"),pr("/home/web_user"),function(){pr("/dev"),ho(259,{read:()=>0,write:(D,ne,we,Ce)=>Ce,Va:()=>0}),ea("/dev/null",259),W(1280,U),W(1536,ee),ea("/dev/tty",1280),ea("/dev/tty1",1536);var p=new Uint8Array(1024),g=0,R=()=>(g===0&&(Ve(p),g=p.byteLength),p[--g]);ie("random",R),ie("urandom",R),pr("/dev/shm"),pr("/dev/shm/tmp")}(),function(){pr("/proc");var p=pr("/proc/self");pr("/proc/self/fd"),Fl({Xa(){var g=Ll(p,"fd",16895,73);return g.Ma={Va:me.Ma.Va},g.La={lookup(R,D){R=+D;var ne=$n(R);return R={parent:null,Xa:{zb:"fake"},La:{readlink:()=>ne.path},id:R+1},R.parent=R},readdir(){return Array.from(Qe.entries()).filter(([,R])=>R).map(([R])=>R.toString())}},g}},"/proc/self/fd")}(),me.vb=new Oe(44),me.vb.stack="<generic error, no stack>";var Wl={a:(p,g,R,D)=>ve(`Assertion failed: ${p?le(E,p):""}, at: `+[g?g?le(E,g):"":"unknown filename",R,D?D?le(E,D):"":"unknown function"]),i:function(p,g){try{return p=p?le(E,p):"",Ei(p,g),0}catch(R){if(typeof F=="undefined"||R.name!=="ErrnoError")throw R;return-R.Pa}},L:function(p,g,R){try{if(g=g?le(E,g):"",g=he(p,g),R&-8)return-28;var D=On(g,{$a:!0}).node;return D?(p="",R&4&&(p+="r"),R&2&&(p+="w"),R&1&&(p+="x"),p&&Bi(D,p)?-2:0):-44}catch(ne){if(typeof F=="undefined"||ne.name!=="ErrnoError")throw ne;return-ne.Pa}},j:function(p,g){try{var R=$n(p);return Ul(R,R.node,g,!1),0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return-D.Pa}},h:function(p){try{var g=$n(p);return uo(g,g.node,{timestamp:Date.now(),Fb:!1}),0}catch(R){if(typeof F=="undefined"||R.name!=="ErrnoError")throw R;return-R.Pa}},b:function(p,g,R){ce=R;try{var D=$n(p);switch(g){case 0:var ne=Re();if(0>ne)break;for(;Qe[ne];)ne++;return yh(D,ne).fd;case 1:case 2:return 0;case 3:return D.flags;case 4:return ne=Re(),D.flags|=ne,0;case 12:return ne=Re(),A[ne+0>>1]=2,0;case 13:case 14:return 0}return-28}catch(we){if(typeof F=="undefined"||we.name!=="ErrnoError")throw we;return-we.Pa}},g:function(p,g){try{var R=$n(p),D=R.node,ne=R.Ma.Ta;p=ne?R:D,ne!=null||(ne=D.La.Ta),Xs(ne);var we=ne(p);return pe(g,we)}catch(Ce){if(typeof F=="undefined"||Ce.name!=="ErrnoError")throw Ce;return-Ce.Pa}},H:function(p,g){g=-9007199254740992>g||9007199254740992<g?NaN:Number(g);try{if(isNaN(g))return 61;var R=$n(p);if(0>g||!(R.flags&2097155))throw new Oe(28);return na(R,R.node,g),0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return-D.Pa}},G:function(p,g){try{if(g===0)return-28;var R=nt("/")+1;return g<R?-68:(P("/",E,p,g),R)}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return-D.Pa}},K:function(p,g){try{return p=p?le(E,p):"",pe(g,mr(p,!0))}catch(R){if(typeof F=="undefined"||R.name!=="ErrnoError")throw R;return-R.Pa}},C:function(p,g,R){try{return g=g?le(E,g):"",g=he(p,g),pr(g,R),0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return-D.Pa}},J:function(p,g,R,D){try{g=g?le(E,g):"";var ne=D&256;return g=he(p,g,D&4096),pe(R,ne?mr(g,!0):mr(g))}catch(we){if(typeof F=="undefined"||we.name!=="ErrnoError")throw we;return-we.Pa}},x:function(p,g,R,D){ce=D;try{g=g?le(E,g):"",g=he(p,g);var ne=D?Re():0;return Ui(g,R,ne).fd}catch(we){if(typeof F=="undefined"||we.name!=="ErrnoError")throw we;return-we.Pa}},v:function(p,g,R,D){try{if(g=g?le(E,g):"",g=he(p,g),0>=D)return-28;var ne=On(g).node;if(!ne)throw new Oe(44);if(!ne.La.readlink)throw new Oe(28);var we=ne.La.readlink(ne),Ce=Math.min(D,nt(we)),Et=J[R+Ce];return P(we,E,R,D+1),J[R+Ce]=Et,Ce}catch(Rt){if(typeof F=="undefined"||Rt.name!=="ErrnoError")throw Rt;return-Rt.Pa}},u:function(p){try{return p=p?le(E,p):"",Fi(p),0}catch(g){if(typeof F=="undefined"||g.name!=="ErrnoError")throw g;return-g.Pa}},f:function(p,g){try{return p=p?le(E,p):"",pe(g,mr(p))}catch(R){if(typeof F=="undefined"||R.name!=="ErrnoError")throw R;return-R.Pa}},r:function(p,g,R){try{return g=g?le(E,g):"",g=he(p,g),R===0?fo(g):R===512?Fi(g):ve("Invalid flags passed to unlinkat"),0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return-D.Pa}},q:function(p,g,R){try{g=g?le(E,g):"",g=he(p,g,!0);var D=Date.now(),ne,we;if(R){var Ce=$[R>>2]+4294967296*x[R+4>>2],Et=x[R+8>>2];Et==1073741823?ne=D:Et==1073741822?ne=null:ne=1e3*Ce+Et/1e6,R+=16,Ce=$[R>>2]+4294967296*x[R+4>>2],Et=x[R+8>>2],Et==1073741823?we=D:Et==1073741822?we=null:we=1e3*Ce+Et/1e6}else we=ne=D;if((we!=null?we:ne)!==null){p=ne;var Rt=On(g,{$a:!0}).node;Xs(Rt.La.Ua)(Rt,{atime:p,mtime:we})}return 0}catch(Ft){if(typeof F=="undefined"||Ft.name!=="ErrnoError")throw Ft;return-Ft.Pa}},m:()=>ve(""),l:()=>{M=!1,De=0},A:function(p,g){p=-9007199254740992>p||9007199254740992<p?NaN:Number(p),p=new Date(1e3*p),x[g>>2]=p.getSeconds(),x[g+4>>2]=p.getMinutes(),x[g+8>>2]=p.getHours(),x[g+12>>2]=p.getDate(),x[g+16>>2]=p.getMonth(),x[g+20>>2]=p.getFullYear()-1900,x[g+24>>2]=p.getDay();var R=p.getFullYear();x[g+28>>2]=(R%4!==0||R%100===0&&R%400!==0?Ue:Fe)[p.getMonth()]+p.getDate()-1|0,x[g+36>>2]=-(60*p.getTimezoneOffset()),R=new Date(p.getFullYear(),6,1).getTimezoneOffset();var D=new Date(p.getFullYear(),0,1).getTimezoneOffset();x[g+32>>2]=(R!=D&&p.getTimezoneOffset()==Math.min(D,R))|0},y:function(p,g,R,D,ne,we,Ce){ne=-9007199254740992>ne||9007199254740992<ne?NaN:Number(ne);try{if(isNaN(ne))return 61;var Et=$n(D);if(g&2&&!(R&2)&&(Et.flags&2097155)!==2)throw new Oe(2);if((Et.flags&2097155)===1)throw new Oe(2);if(!Et.Ma.ib)throw new Oe(43);if(!p)throw new Oe(28);var Rt=Et.Ma.ib(Et,p,ne,g,R),Ft=Rt.Kb;return x[we>>2]=Rt.Ab,$[Ce>>2]=Ft,0}catch(Zt){if(typeof F=="undefined"||Zt.name!=="ErrnoError")throw Zt;return-Zt.Pa}},z:function(p,g,R,D,ne,we){we=-9007199254740992>we||9007199254740992<we?NaN:Number(we);try{var Ce=$n(ne);if(R&2){if(R=we,(Ce.node.mode&61440)!==32768)throw new Oe(43);if(!(D&2)){var Et=E.slice(p,p+g);Ce.Ma.jb&&Ce.Ma.jb(Ce,Et,R,g,D)}}}catch(Rt){if(typeof F=="undefined"||Rt.name!=="ErrnoError")throw Rt;return-Rt.Pa}},n:(p,g)=>{if(je[p]&&(clearTimeout(je[p].id),delete je[p]),!g)return 0;var R=setTimeout(()=>{delete je[p],Dt(()=>em(p,performance.now()))},g);return je[p]={id:R,Xb:g},0},B:(p,g,R,D)=>{var ne=new Date().getFullYear(),we=new Date(ne,0,1).getTimezoneOffset();ne=new Date(ne,6,1).getTimezoneOffset(),$[p>>2]=60*Math.max(we,ne),x[g>>2]=+(we!=ne),g=Ce=>{var Et=Math.abs(Ce);return`UTC${0<=Ce?"-":"+"}${String(Math.floor(Et/60)).padStart(2,"0")}${String(Et%60).padStart(2,"0")}`},p=g(we),g=g(ne),ne<we?(P(p,E,R,17),P(g,E,D,17)):(P(p,E,D,17),P(g,E,R,17))},d:()=>Date.now(),s:()=>2147483648,c:()=>performance.now(),o:p=>{var g=E.length;if(p>>>=0,2147483648<p)return!1;for(var R=1;4>=R;R*=2){var D=g*(1+.2/R);D=Math.min(D,p+100663296);e:{D=(Math.min(2147483648,65536*Math.ceil(Math.max(p,D)/65536))-Q.buffer.byteLength+65535)/65536|0;try{Q.grow(D),L();var ne=1;break e}catch(we){}ne=void 0}if(ne)return!0}return!1},E:(p,g)=>{var R=0;return Wt().forEach((D,ne)=>{var we=g+R;for(ne=$[p+4*ne>>2]=we,we=0;we<D.length;++we)J[ne++]=D.charCodeAt(we);J[ne]=0,R+=D.length+1}),0},F:(p,g)=>{var R=Wt();$[p>>2]=R.length;var D=0;return R.forEach(ne=>D+=ne.length+1),$[g>>2]=D,0},e:function(p){try{var g=$n(p);return po(g),0}catch(R){if(typeof F=="undefined"||R.name!=="ErrnoError")throw R;return R.Pa}},p:function(p,g){try{var R=$n(p);return J[g]=R.tty?2:Un(R.mode)?3:(R.mode&61440)===40960?7:4,A[g+2>>1]=0,K[g+8>>3]=BigInt(0),K[g+16>>3]=BigInt(0),0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return D.Pa}},w:function(p,g,R,D){try{e:{var ne=$n(p);p=g;for(var we,Ce=g=0;Ce<R;Ce++){var Et=$[p>>2],Rt=$[p+4>>2];p+=8;var Ft=Vl(ne,J,Et,Rt,we);if(0>Ft){var Zt=-1;break e}if(g+=Ft,Ft<Rt)break;typeof we!="undefined"&&(we+=Ft)}Zt=g}return $[D>>2]=Zt,0}catch(sr){if(typeof F=="undefined"||sr.name!=="ErrnoError")throw sr;return sr.Pa}},D:function(p,g,R,D){g=-9007199254740992>g||9007199254740992<g?NaN:Number(g);try{if(isNaN(g))return 61;var ne=$n(p);return ra(ne,g,R),K[D>>3]=BigInt(ne.position),ne.ob&&g===0&&R===0&&(ne.ob=null),0}catch(we){if(typeof F=="undefined"||we.name!=="ErrnoError")throw we;return we.Pa}},I:function(p){var R;try{var g=$n(p);return(R=g.Ma)!=null&&R.fsync?g.Ma.fsync(g):0}catch(D){if(typeof F=="undefined"||D.name!=="ErrnoError")throw D;return D.Pa}},t:function(p,g,R,D){try{e:{var ne=$n(p);p=g;for(var we,Ce=g=0;Ce<R;Ce++){var Et=$[p>>2],Rt=$[p+4>>2];p+=8;var Ft=jl(ne,J,Et,Rt,we);if(0>Ft){var Zt=-1;break e}if(g+=Ft,Ft<Rt)break;typeof we!="undefined"&&(we+=Ft)}Zt=g}return $[D>>2]=Zt,0}catch(sr){if(typeof F=="undefined"||sr.name!=="ErrnoError")throw sr;return sr.Pa}},k:ot},bt;(function(){return v(this,null,function*(){var R;function p(D){var ne;return bt=D.exports,Q=bt.M,L(),ti=bt.O,Se--,(ne=c.monitorRunDependencies)==null||ne.call(c,Se),Se==0&&Ae&&(D=Ae,Ae=null,D()),bt}Se++,(R=c.monitorRunDependencies)==null||R.call(c,Se);var g={a:Wl};return c.instantiateWasm?new Promise(D=>{c.instantiateWasm(g,(ne,we)=>{p(ne),D(ne.exports)})}):(Ye!=null||(Ye=c.locateFile?c.locateFile("sql-wasm.wasm",T):T+"sql-wasm.wasm"),p((yield ut(g)).instance))})})(),c._sqlite3_free=p=>(c._sqlite3_free=bt.P)(p),c._sqlite3_value_text=p=>(c._sqlite3_value_text=bt.Q)(p),c._sqlite3_prepare_v2=(p,g,R,D,ne)=>(c._sqlite3_prepare_v2=bt.R)(p,g,R,D,ne),c._sqlite3_step=p=>(c._sqlite3_step=bt.S)(p),c._sqlite3_reset=p=>(c._sqlite3_reset=bt.T)(p),c._sqlite3_exec=(p,g,R,D,ne)=>(c._sqlite3_exec=bt.U)(p,g,R,D,ne),c._sqlite3_finalize=p=>(c._sqlite3_finalize=bt.V)(p),c._sqlite3_column_name=(p,g)=>(c._sqlite3_column_name=bt.W)(p,g),c._sqlite3_column_text=(p,g)=>(c._sqlite3_column_text=bt.X)(p,g),c._sqlite3_column_type=(p,g)=>(c._sqlite3_column_type=bt.Y)(p,g),c._sqlite3_errmsg=p=>(c._sqlite3_errmsg=bt.Z)(p),c._sqlite3_clear_bindings=p=>(c._sqlite3_clear_bindings=bt._)(p),c._sqlite3_value_blob=p=>(c._sqlite3_value_blob=bt.$)(p),c._sqlite3_value_bytes=p=>(c._sqlite3_value_bytes=bt.aa)(p),c._sqlite3_value_double=p=>(c._sqlite3_value_double=bt.ba)(p),c._sqlite3_value_int=p=>(c._sqlite3_value_int=bt.ca)(p),c._sqlite3_value_type=p=>(c._sqlite3_value_type=bt.da)(p),c._sqlite3_result_blob=(p,g,R,D)=>(c._sqlite3_result_blob=bt.ea)(p,g,R,D),c._sqlite3_result_double=(p,g)=>(c._sqlite3_result_double=bt.fa)(p,g),c._sqlite3_result_error=(p,g,R)=>(c._sqlite3_result_error=bt.ga)(p,g,R),c._sqlite3_result_int=(p,g)=>(c._sqlite3_result_int=bt.ha)(p,g),c._sqlite3_result_int64=(p,g)=>(c._sqlite3_result_int64=bt.ia)(p,g),c._sqlite3_result_null=p=>(c._sqlite3_result_null=bt.ja)(p),c._sqlite3_result_text=(p,g,R,D)=>(c._sqlite3_result_text=bt.ka)(p,g,R,D),c._sqlite3_aggregate_context=(p,g)=>(c._sqlite3_aggregate_context=bt.la)(p,g),c._sqlite3_column_count=p=>(c._sqlite3_column_count=bt.ma)(p),c._sqlite3_data_count=p=>(c._sqlite3_data_count=bt.na)(p),c._sqlite3_column_blob=(p,g)=>(c._sqlite3_column_blob=bt.oa)(p,g),c._sqlite3_column_bytes=(p,g)=>(c._sqlite3_column_bytes=bt.pa)(p,g),c._sqlite3_column_double=(p,g)=>(c._sqlite3_column_double=bt.qa)(p,g),c._sqlite3_bind_blob=(p,g,R,D,ne)=>(c._sqlite3_bind_blob=bt.ra)(p,g,R,D,ne),c._sqlite3_bind_double=(p,g,R)=>(c._sqlite3_bind_double=bt.sa)(p,g,R),c._sqlite3_bind_int=(p,g,R)=>(c._sqlite3_bind_int=bt.ta)(p,g,R),c._sqlite3_bind_text=(p,g,R,D,ne)=>(c._sqlite3_bind_text=bt.ua)(p,g,R,D,ne),c._sqlite3_bind_parameter_index=(p,g)=>(c._sqlite3_bind_parameter_index=bt.va)(p,g),c._sqlite3_sql=p=>(c._sqlite3_sql=bt.wa)(p),c._sqlite3_normalized_sql=p=>(c._sqlite3_normalized_sql=bt.xa)(p),c._sqlite3_changes=p=>(c._sqlite3_changes=bt.ya)(p),c._sqlite3_close_v2=p=>(c._sqlite3_close_v2=bt.za)(p),c._sqlite3_create_function_v2=(p,g,R,D,ne,we,Ce,Et,Rt)=>(c._sqlite3_create_function_v2=bt.Aa)(p,g,R,D,ne,we,Ce,Et,Rt),c._sqlite3_update_hook=(p,g,R)=>(c._sqlite3_update_hook=bt.Ba)(p,g,R),c._sqlite3_open=(p,g)=>(c._sqlite3_open=bt.Ca)(p,g);var Eh=c._malloc=p=>(Eh=c._malloc=bt.Da)(p),Hl=c._free=p=>(Hl=c._free=bt.Ea)(p);c._RegisterExtensionFunctions=p=>(c._RegisterExtensionFunctions=bt.Fa)(p);var Zp=(p,g)=>(Zp=bt.Ga)(p,g),em=(p,g)=>(em=bt.Ha)(p,g),mo=p=>(mo=bt.Ia)(p),ji=p=>(ji=bt.Ja)(p),yo=()=>(yo=bt.Ka)();c.stackSave=()=>yo(),c.stackRestore=p=>mo(p),c.stackAlloc=p=>ji(p),c.cwrap=(p,g,R,D)=>{var ne=!R||R.every(we=>we==="number"||we==="boolean");return g!=="string"&&ne&&!D?c["_"+p]:(...we)=>ir(p,g,R,we)},c.addFunction=ws,c.removeFunction=ni,c.UTF8ToString=be,c.ALLOC_NORMAL=ei,c.allocate=Vi,c.allocateUTF8OnStack=sn;function wh(){function p(){var ne;if(c.calledRun=!0,!te){if(!c.noFSInit&&!tt){var g,R;tt=!0,D!=null||(D=c.stdin),g!=null||(g=c.stdout),R!=null||(R=c.stderr),D?ie("stdin",D):ta("/dev/tty","/dev/stdin"),g?ie("stdout",null,g):ta("/dev/tty","/dev/stdout"),R?ie("stderr",null,R):ta("/dev/tty1","/dev/stderr"),Ui("/dev/stdin",0),Ui("/dev/stdout",1),Ui("/dev/stderr",1)}if(bt.N(),st=!1,(ne=c.onRuntimeInitialized)==null||ne.call(c),c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;){var D=c.postRun.shift();z.unshift(D)}$e(z)}}if(0<Se)Ae=wh;else{if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)j();$e(Te),0<Se?Ae=wh:c.setStatus?(c.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>c.setStatus(""),1),p()},1)):p()}}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return wh(),o}),t)};r.exports=n,r.exports.default=n})(ST);var N2=ST.exports;const A2=th(N2);/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Xg;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof Ni=="object"?Ni:typeof self=="object"?self:typeof this=="object"?this:o(),n=i(r);typeof t.Reflect!="undefined"&&(n=i(t.Reflect,n)),e(n,t),typeof t.Reflect=="undefined"&&(t.Reflect=r);function i(l,c){return function(u,h){Object.defineProperty(l,u,{configurable:!0,writable:!0,value:h}),c&&c(u,h)}}function s(){try{return Function("return this;")()}catch(l){}}function a(){try{return(0,eval)("(function() { return this; })()")}catch(l){}}function o(){return s()||a()}})(function(e,t){var n=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",s=i&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",a=i&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",l={__proto__:[]}instanceof Array,c=!o&&!l,u={create:o?function(){return W(Object.create(null))}:l?function(){return W({__proto__:null})}:function(){return W({})},has:c?function(O,U){return n.call(O,U)}:function(O,U){return U in O},get:c?function(O,U){return n.call(O,U)?O[U]:void 0}:function(O,U){return O[U]}},h=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:P(),d=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:w(),m=typeof WeakMap=="function"?WeakMap:_(),y=i?Symbol.for("@reflect-metadata:registry"):void 0,T=Ve(),b=Je(T);function S(O,U,ee,me){if(ve(ee)){if(!j(O))throw new TypeError;if(!M(U))throw new TypeError;return A(O,U)}else{if(!j(O))throw new TypeError;if(!et(U))throw new TypeError;if(!et(me)&&!ve(me)&&!Ye(me))throw new TypeError;return Ye(me)&&(me=void 0),ee=Te(ee),x(O,U,ee,me)}}e("decorate",S);function N(O,U){function ee(me,He){if(!et(me))throw new TypeError;if(!ve(He)&&!q(He))throw new TypeError;ue(O,U,me,He)}return ee}e("metadata",N);function C(O,U,ee,me){if(!et(ee))throw new TypeError;return ve(me)||(me=Te(me)),ue(O,U,ee,me)}e("defineMetadata",C);function I(O,U,ee){if(!et(U))throw new TypeError;return ve(ee)||(ee=Te(ee)),$(O,U,ee)}e("hasMetadata",I);function H(O,U,ee){if(!et(U))throw new TypeError;return ve(ee)||(ee=Te(ee)),B(O,U,ee)}e("hasOwnMetadata",H);function Q(O,U,ee){if(!et(U))throw new TypeError;return ve(ee)||(ee=Te(ee)),K(O,U,ee)}e("getMetadata",Q);function te(O,U,ee){if(!et(U))throw new TypeError;return ve(ee)||(ee=Te(ee)),ae(O,U,ee)}e("getOwnMetadata",te);function V(O,U){if(!et(O))throw new TypeError;return ve(U)||(U=Te(U)),L(O,U)}e("getMetadataKeys",V);function J(O,U){if(!et(O))throw new TypeError;return ve(U)||(U=Te(U)),Se(O,U)}e("getOwnMetadataKeys",J);function E(O,U,ee){if(!et(U))throw new TypeError;if(ve(ee)||(ee=Te(ee)),!et(U))throw new TypeError;ve(ee)||(ee=Te(ee));var me=nt(U,ee,!1);return ve(me)?!1:me.OrdinaryDeleteMetadata(O,U,ee)}e("deleteMetadata",E);function A(O,U){for(var ee=O.length-1;ee>=0;--ee){var me=O[ee],He=me(U);if(!ve(He)&&!Ye(He)){if(!M(He))throw new TypeError;U=He}}return U}function x(O,U,ee,me){for(var He=O.length-1;He>=0;--He){var rt=O[He],ft=rt(U,ee,me);if(!ve(ft)&&!Ye(ft)){if(!et(ft))throw new TypeError;me=ft}}return me}function $(O,U,ee){var me=B(O,U,ee);if(me)return!0;var He=oe(U);return Ye(He)?!1:$(O,He,ee)}function B(O,U,ee){var me=nt(U,ee,!1);return ve(me)?!1:$e(me.OrdinaryHasOwnMetadata(O,U,ee))}function K(O,U,ee){var me=B(O,U,ee);if(me)return ae(O,U,ee);var He=oe(U);if(!Ye(He))return K(O,He,ee)}function ae(O,U,ee){var me=nt(U,ee,!1);if(!ve(me))return me.OrdinaryGetOwnMetadata(O,U,ee)}function ue(O,U,ee,me){var He=nt(ee,me,!0);He.OrdinaryDefineOwnMetadata(O,U,ee,me)}function L(O,U){var ee=Se(O,U),me=oe(O);if(me===null)return ee;var He=L(me,U);if(He.length<=0)return ee;if(ee.length<=0)return He;for(var rt=new d,ft=[],Qe=0,Ke=ee;Qe<Ke.length;Qe++){var We=Ke[Qe],tt=rt.has(We);tt||(rt.add(We),ft.push(We))}for(var st=0,Ot=He;st<Ot.length;st++){var We=Ot[st],tt=rt.has(We);tt||(rt.add(We),ft.push(We))}return ft}function Se(O,U){var ee=nt(O,U,!1);return ee?ee.OrdinaryOwnMetadataKeys(O,U):[]}function Ae(O){if(O===null)return 1;switch(typeof O){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return O===null?1:6;default:return 6}}function ve(O){return O===void 0}function Ye(O){return O===null}function mt(O){return typeof O=="symbol"}function et(O){return typeof O=="object"?O!==null:typeof O=="function"}function ut(O,U){switch(Ae(O)){case 0:return O;case 1:return O;case 2:return O;case 3:return O;case 4:return O;case 5:return O}var ee="string",me=le(O,s);if(me!==void 0){var He=me.call(O,ee);if(et(He))throw new TypeError;return He}return Ee(O)}function Ee(O,U){var ee,me,He;{var rt=O.toString;if(G(rt)){var me=rt.call(O);if(!et(me))return me}var ee=O.valueOf;if(G(ee)){var me=ee.call(O);if(!et(me))return me}}throw new TypeError}function $e(O){return!!O}function z(O){return""+O}function Te(O){var U=ut(O);return mt(U)?U:z(U)}function j(O){return Array.isArray?Array.isArray(O):O instanceof Object?O instanceof Array:Object.prototype.toString.call(O)==="[object Array]"}function G(O){return typeof O=="function"}function M(O){return typeof O=="function"}function q(O){switch(Ae(O)){case 3:return!0;case 4:return!0;default:return!1}}function se(O,U){return O===U||O!==O&&U!==U}function le(O,U){var ee=O[U];if(ee!=null){if(!G(ee))throw new TypeError;return ee}}function be(O){var U=le(O,a);if(!G(U))throw new TypeError;var ee=U.call(O);if(!et(ee))throw new TypeError;return ee}function xe(O){return O.value}function Le(O){var U=O.next();return U.done?!1:U}function Pe(O){var U=O.return;U&&U.call(O)}function oe(O){var U=Object.getPrototypeOf(O);if(typeof O!="function"||O===h||U!==h)return U;var ee=O.prototype,me=ee&&Object.getPrototypeOf(ee);if(me==null||me===Object.prototype)return U;var He=me.constructor;return typeof He!="function"||He===O?U:He}function fe(){var O;!ve(y)&&typeof t.Reflect!="undefined"&&!(y in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(O=ze(t.Reflect));var U,ee,me,He=new m,rt={registerProvider:ft,getProvider:Ke,setProvider:tt};return rt;function ft(st){if(!Object.isExtensible(rt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case O===st:break;case ve(U):U=st;break;case U===st:break;case ve(ee):ee=st;break;case ee===st:break;default:me===void 0&&(me=new d),me.add(st);break}}function Qe(st,Ot){if(!ve(U)){if(U.isProviderFor(st,Ot))return U;if(!ve(ee)){if(ee.isProviderFor(st,Ot))return U;if(!ve(me))for(var Oe=be(me);;){var rn=Le(Oe);if(!rn)return;var Kn=xe(rn);if(Kn.isProviderFor(st,Ot))return Pe(Oe),Kn}}}if(!ve(O)&&O.isProviderFor(st,Ot))return O}function Ke(st,Ot){var Oe=He.get(st),rn;return ve(Oe)||(rn=Oe.get(Ot)),ve(rn)&&(rn=Qe(st,Ot),ve(rn)||(ve(Oe)&&(Oe=new f,He.set(st,Oe)),Oe.set(Ot,rn))),rn}function We(st){if(ve(st))throw new TypeError;return U===st||ee===st||!ve(me)&&me.has(st)}function tt(st,Ot,Oe){if(!We(Oe))throw new Error("Metadata provider not registered.");var rn=Ke(st,Ot);if(rn!==Oe){if(!ve(rn))return!1;var Kn=He.get(st);ve(Kn)&&(Kn=new f,He.set(st,Kn)),Kn.set(Ot,Oe)}return!0}}function Ve(){var O;return!ve(y)&&et(t.Reflect)&&Object.isExtensible(t.Reflect)&&(O=t.Reflect[y]),ve(O)&&(O=fe()),!ve(y)&&et(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:O}),O}function Je(O){var U=new m,ee={isProviderFor:function(We,tt){var st=U.get(We);return ve(st)?!1:st.has(tt)},OrdinaryDefineOwnMetadata:ft,OrdinaryHasOwnMetadata:He,OrdinaryGetOwnMetadata:rt,OrdinaryOwnMetadataKeys:Qe,OrdinaryDeleteMetadata:Ke};return T.registerProvider(ee),ee;function me(We,tt,st){var Ot=U.get(We),Oe=!1;if(ve(Ot)){if(!st)return;Ot=new f,U.set(We,Ot),Oe=!0}var rn=Ot.get(tt);if(ve(rn)){if(!st)return;if(rn=new f,Ot.set(tt,rn),!O.setProvider(We,tt,ee))throw Ot.delete(tt),Oe&&U.delete(We),new Error("Wrong provider for target.")}return rn}function He(We,tt,st){var Ot=me(tt,st,!1);return ve(Ot)?!1:$e(Ot.has(We))}function rt(We,tt,st){var Ot=me(tt,st,!1);if(!ve(Ot))return Ot.get(We)}function ft(We,tt,st,Ot){var Oe=me(st,Ot,!0);Oe.set(We,tt)}function Qe(We,tt){var st=[],Ot=me(We,tt,!1);if(ve(Ot))return st;for(var Oe=Ot.keys(),rn=be(Oe),Kn=0;;){var On=Le(rn);if(!On)return st.length=Kn,st;var gs=xe(On);try{st[Kn]=gs}catch(bs){try{Pe(rn)}finally{throw bs}}Kn++}}function Ke(We,tt,st){var Ot=me(tt,st,!1);if(ve(Ot)||!Ot.delete(We))return!1;if(Ot.size===0){var Oe=U.get(tt);ve(Oe)||(Oe.delete(st),Oe.size===0&&U.delete(Oe))}return!0}}function ze(O){var U=O.defineMetadata,ee=O.hasOwnMetadata,me=O.getOwnMetadata,He=O.getOwnMetadataKeys,rt=O.deleteMetadata,ft=new m,Qe={isProviderFor:function(Ke,We){var tt=ft.get(Ke);return!ve(tt)&&tt.has(We)?!0:He(Ke,We).length?(ve(tt)&&(tt=new d,ft.set(Ke,tt)),tt.add(We),!0):!1},OrdinaryDefineOwnMetadata:U,OrdinaryHasOwnMetadata:ee,OrdinaryGetOwnMetadata:me,OrdinaryOwnMetadataKeys:He,OrdinaryDeleteMetadata:rt};return Qe}function nt(O,U,ee){var me=T.getProvider(O,U);if(!ve(me))return me;if(ee){if(T.setProvider(O,U,b))return b;throw new Error("Illegal state.")}}function P(){var O={},U=[],ee=function(){function Qe(Ke,We,tt){this._index=0,this._keys=Ke,this._values=We,this._selector=tt}return Qe.prototype["@@iterator"]=function(){return this},Qe.prototype[a]=function(){return this},Qe.prototype.next=function(){var Ke=this._index;if(Ke>=0&&Ke<this._keys.length){var We=this._selector(this._keys[Ke],this._values[Ke]);return Ke+1>=this._keys.length?(this._index=-1,this._keys=U,this._values=U):this._index++,{value:We,done:!1}}return{value:void 0,done:!0}},Qe.prototype.throw=function(Ke){throw this._index>=0&&(this._index=-1,this._keys=U,this._values=U),Ke},Qe.prototype.return=function(Ke){return this._index>=0&&(this._index=-1,this._keys=U,this._values=U),{value:Ke,done:!0}},Qe}(),me=function(){function Qe(){this._keys=[],this._values=[],this._cacheKey=O,this._cacheIndex=-2}return Object.defineProperty(Qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Qe.prototype.has=function(Ke){return this._find(Ke,!1)>=0},Qe.prototype.get=function(Ke){var We=this._find(Ke,!1);return We>=0?this._values[We]:void 0},Qe.prototype.set=function(Ke,We){var tt=this._find(Ke,!0);return this._values[tt]=We,this},Qe.prototype.delete=function(Ke){var We=this._find(Ke,!1);if(We>=0){for(var tt=this._keys.length,st=We+1;st<tt;st++)this._keys[st-1]=this._keys[st],this._values[st-1]=this._values[st];return this._keys.length--,this._values.length--,se(Ke,this._cacheKey)&&(this._cacheKey=O,this._cacheIndex=-2),!0}return!1},Qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=O,this._cacheIndex=-2},Qe.prototype.keys=function(){return new ee(this._keys,this._values,He)},Qe.prototype.values=function(){return new ee(this._keys,this._values,rt)},Qe.prototype.entries=function(){return new ee(this._keys,this._values,ft)},Qe.prototype["@@iterator"]=function(){return this.entries()},Qe.prototype[a]=function(){return this.entries()},Qe.prototype._find=function(Ke,We){if(!se(this._cacheKey,Ke)){this._cacheIndex=-1;for(var tt=0;tt<this._keys.length;tt++)if(se(this._keys[tt],Ke)){this._cacheIndex=tt;break}}return this._cacheIndex<0&&We&&(this._cacheIndex=this._keys.length,this._keys.push(Ke),this._values.push(void 0)),this._cacheIndex},Qe}();return me;function He(Qe,Ke){return Qe}function rt(Qe,Ke){return Ke}function ft(Qe,Ke){return[Qe,Ke]}}function w(){var O=function(){function U(){this._map=new f}return Object.defineProperty(U.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),U.prototype.has=function(ee){return this._map.has(ee)},U.prototype.add=function(ee){return this._map.set(ee,ee),this},U.prototype.delete=function(ee){return this._map.delete(ee)},U.prototype.clear=function(){this._map.clear()},U.prototype.keys=function(){return this._map.keys()},U.prototype.values=function(){return this._map.keys()},U.prototype.entries=function(){return this._map.entries()},U.prototype["@@iterator"]=function(){return this.keys()},U.prototype[a]=function(){return this.keys()},U}();return O}function _(){var O=16,U=u.create(),ee=me();return function(){function Ke(){this._key=me()}return Ke.prototype.has=function(We){var tt=He(We,!1);return tt!==void 0?u.has(tt,this._key):!1},Ke.prototype.get=function(We){var tt=He(We,!1);return tt!==void 0?u.get(tt,this._key):void 0},Ke.prototype.set=function(We,tt){var st=He(We,!0);return st[this._key]=tt,this},Ke.prototype.delete=function(We){var tt=He(We,!1);return tt!==void 0?delete tt[this._key]:!1},Ke.prototype.clear=function(){this._key=me()},Ke}();function me(){var Ke;do Ke="@@WeakMap@@"+Qe();while(u.has(U,Ke));return U[Ke]=!0,Ke}function He(Ke,We){if(!n.call(Ke,ee)){if(!We)return;Object.defineProperty(Ke,ee,{value:u.create()})}return Ke[ee]}function rt(Ke,We){for(var tt=0;tt<We;++tt)Ke[tt]=Math.random()*255|0;return Ke}function ft(Ke){if(typeof Uint8Array=="function"){var We=new Uint8Array(Ke);return typeof crypto!="undefined"?crypto.getRandomValues(We):typeof msCrypto!="undefined"?msCrypto.getRandomValues(We):rt(We,Ke),We}return rt(new Array(Ke),Ke)}function Qe(){var Ke=ft(O);Ke[6]=Ke[6]&79|64,Ke[8]=Ke[8]&191|128;for(var We="",tt=0;tt<O;++tt){var st=Ke[tt];(tt===4||tt===6||tt===8)&&(We+="-"),st<16&&(We+="0"),We+=st.toString(16).toLowerCase()}return We}}function W(O){return O.__=void 0,delete O.__,O}})})(Xg||(Xg={}));class Mc{static getInheritanceTree(e){const t=[e],n=i=>{const s=Object.getPrototypeOf(i);s&&s.name&&(t.push(s),n(s))};return n(e),t}static isInherited(e,t){return e.prototype instanceof t}static filterByTarget(e,t){return t?e.filter(n=>n.target&&t.indexOf(n.target)!==-1):e}}class CT{constructor(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}filterTables(e){return this.filterByTarget(this.tables,e)}filterColumns(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)}findGenerated(e,t){return this.generations.find(n=>(Array.isArray(e)?e.indexOf(n.target)!==-1:n.target===e)&&n.propertyName===t)}findTree(e){return this.trees.find(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterRelations(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)}filterRelationIds(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)}filterRelationCounts(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)}filterIndices(e){return this.indices.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterForeignKeys(e){return this.foreignKeys.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterUniques(e){return this.uniques.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterChecks(e){return this.checks.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterExclusions(e){return this.exclusions.filter(t=>Array.isArray(e)?e.indexOf(t.target)!==-1:t.target===e)}filterListeners(e){return this.filterByTarget(this.entityListeners,e)}filterEmbeddeds(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)}findJoinTable(e,t){return this.joinTables.find(n=>n.target===e&&n.propertyName===t)}filterJoinColumns(e,t){return this.joinColumns.filter(n=>n.target===e&&n.propertyName===t)}filterSubscribers(e){return this.filterByTarget(this.entitySubscribers,e)}filterNamingStrategies(e){return this.filterByTarget(this.namingStrategies,e)}filterTransactionEntityManagers(e,t){return this.transactionEntityManagers.filter(n=>(Array.isArray(e)?e.indexOf(n.target)!==-1:n.target===e)&&n.methodName===t)}filterTransactionRepository(e,t){return this.transactionRepositories.filter(n=>(Array.isArray(e)?e.indexOf(n.target)!==-1:n.target===e)&&n.methodName===t)}filterSingleTableChildren(e){return this.tables.filter(t=>typeof t.target=="function"&&typeof e=="function"&&Mc.isInherited(t.target,e)&&t.type==="entity-child")}findInheritanceType(e){return this.inheritances.find(t=>t.target===e)}findDiscriminatorValue(e){return this.discriminatorValues.find(t=>t.target===e)}filterByTarget(e,t){return e.filter(n=>Array.isArray(t)?t.indexOf(n.target)!==-1:n.target===t)}filterByTargetAndWithoutDuplicateProperties(e,t){const n=[];return e.forEach(i=>{(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t)&&(n.find(a=>a.propertyName===i.propertyName)||n.push(i))}),n}filterByTargetAndWithoutDuplicateRelationProperties(e,t){const n=[];return e.forEach(i=>{if(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t){const a=n.findIndex(o=>o.propertyName===i.propertyName);if(Array.isArray(t)&&a!==-1&&t.indexOf(i.target)<t.indexOf(n[a].target)){const o=Object.create(n[a]);o.type=i.type,n[a]=o}else a===-1&&n.push(i)}}),n}filterByTargetAndWithoutDuplicateEmbeddedProperties(e,t){const n=[];return e.forEach(i=>{(Array.isArray(t)?t.indexOf(i.target)!==-1:i.target===t)&&(n.find(o=>o.prefix===i.prefix&&o.propertyName===i.propertyName)||n.push(i))}),n}}var nh={},rh={};rh.byteLength=M2;rh.toByteArray=I2;rh.fromByteArray=D2;var ci=[],wr=[],x2=typeof Uint8Array!="undefined"?Uint8Array:Array,tf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var la=0,R2=tf.length;la<R2;++la)ci[la]=tf[la],wr[tf.charCodeAt(la)]=la;wr[45]=62;wr[95]=63;function NT(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function M2(r){var e=NT(r),t=e[0],n=e[1];return(t+n)*3/4-n}function P2(r,e,t){return(e+t)*3/4-t}function I2(r){var e,t=NT(r),n=t[0],i=t[1],s=new x2(P2(r,n,i)),a=0,o=i>0?n-4:n,l;for(l=0;l<o;l+=4)e=wr[r.charCodeAt(l)]<<18|wr[r.charCodeAt(l+1)]<<12|wr[r.charCodeAt(l+2)]<<6|wr[r.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=wr[r.charCodeAt(l)]<<2|wr[r.charCodeAt(l+1)]>>4,s[a++]=e&255),i===1&&(e=wr[r.charCodeAt(l)]<<10|wr[r.charCodeAt(l+1)]<<4|wr[r.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function O2(r){return ci[r>>18&63]+ci[r>>12&63]+ci[r>>6&63]+ci[r&63]}function $2(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(O2(n));return i.join("")}function D2(r){for(var e,t=r.length,n=t%3,i=[],s=16383,a=0,o=t-n;a<o;a+=s)i.push($2(r,a,a+s>o?o:a+s));return n===1?(e=r[t-1],i.push(ci[e>>2]+ci[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(ci[e>>10]+ci[e>>4&63]+ci[e<<2&63]+"=")),i.join("")}var Up={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Up.read=function(r,e,t,n,i){var s,a,o=i*8-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=t?i-1:0,f=t?-1:1,d=r[e+h];for(h+=f,s=d&(1<<-u)-1,d>>=-u,u+=o;u>0;s=s*256+r[e+h],h+=f,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=n;u>0;a=a*256+r[e+h],h+=f,u-=8);if(s===0)s=1-c;else{if(s===l)return a?NaN:(d?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-c}return(d?-1:1)*a*Math.pow(2,s-n)};Up.write=function(r,e,t,n,i,s){var a,o,l,c=s*8-i-1,u=(1<<c)-1,h=u>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,m=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?e+=f/l:e+=f*Math.pow(2,1-h),e*l>=2&&(a++,l/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(e*l-1)*Math.pow(2,i),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;r[t+d]=o&255,d+=m,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;r[t+d]=a&255,d+=m,a/=256,c-=8);r[t+d-m]|=y*128};/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/(function(r){const e=rh,t=Up,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=o,r.SlowBuffer=S,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),o.TYPED_ARRAY_SUPPORT;function s(){try{const P=new Uint8Array(1),w={foo:function(){return 42}};return Object.setPrototypeOf(w,Uint8Array.prototype),Object.setPrototypeOf(P,w),P.foo()===42}catch(P){return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(P){if(P>i)throw new RangeError('The value "'+P+'" is invalid for option "size"');const w=new Uint8Array(P);return Object.setPrototypeOf(w,o.prototype),w}function o(P,w,_){if(typeof P=="number"){if(typeof w=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(P)}return l(P,w,_)}o.poolSize=8192;function l(P,w,_){if(typeof P=="string")return f(P,w);if(ArrayBuffer.isView(P))return m(P);if(P==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P);if(fe(P,ArrayBuffer)||P&&fe(P.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(fe(P,SharedArrayBuffer)||P&&fe(P.buffer,SharedArrayBuffer)))return y(P,w,_);if(typeof P=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const W=P.valueOf&&P.valueOf();if(W!=null&&W!==P)return o.from(W,w,_);const O=T(P);if(O)return O;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof P[Symbol.toPrimitive]=="function")return o.from(P[Symbol.toPrimitive]("string"),w,_);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P)}o.from=function(P,w,_){return l(P,w,_)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function c(P){if(typeof P!="number")throw new TypeError('"size" argument must be of type number');if(P<0)throw new RangeError('The value "'+P+'" is invalid for option "size"')}function u(P,w,_){return c(P),P<=0?a(P):w!==void 0?typeof _=="string"?a(P).fill(w,_):a(P).fill(w):a(P)}o.alloc=function(P,w,_){return u(P,w,_)};function h(P){return c(P),a(P<0?0:b(P)|0)}o.allocUnsafe=function(P){return h(P)},o.allocUnsafeSlow=function(P){return h(P)};function f(P,w){if((typeof w!="string"||w==="")&&(w="utf8"),!o.isEncoding(w))throw new TypeError("Unknown encoding: "+w);const _=N(P,w)|0;let W=a(_);const O=W.write(P,w);return O!==_&&(W=W.slice(0,O)),W}function d(P){const w=P.length<0?0:b(P.length)|0,_=a(w);for(let W=0;W<w;W+=1)_[W]=P[W]&255;return _}function m(P){if(fe(P,Uint8Array)){const w=new Uint8Array(P);return y(w.buffer,w.byteOffset,w.byteLength)}return d(P)}function y(P,w,_){if(w<0||P.byteLength<w)throw new RangeError('"offset" is outside of buffer bounds');if(P.byteLength<w+(_||0))throw new RangeError('"length" is outside of buffer bounds');let W;return w===void 0&&_===void 0?W=new Uint8Array(P):_===void 0?W=new Uint8Array(P,w):W=new Uint8Array(P,w,_),Object.setPrototypeOf(W,o.prototype),W}function T(P){if(o.isBuffer(P)){const w=b(P.length)|0,_=a(w);return _.length===0||P.copy(_,0,0,w),_}if(P.length!==void 0)return typeof P.length!="number"||Ve(P.length)?a(0):d(P);if(P.type==="Buffer"&&Array.isArray(P.data))return d(P.data)}function b(P){if(P>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return P|0}function S(P){return+P!=P&&(P=0),o.alloc(+P)}o.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==o.prototype},o.compare=function(w,_){if(fe(w,Uint8Array)&&(w=o.from(w,w.offset,w.byteLength)),fe(_,Uint8Array)&&(_=o.from(_,_.offset,_.byteLength)),!o.isBuffer(w)||!o.isBuffer(_))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===_)return 0;let W=w.length,O=_.length;for(let U=0,ee=Math.min(W,O);U<ee;++U)if(w[U]!==_[U]){W=w[U],O=_[U];break}return W<O?-1:O<W?1:0},o.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(w,_){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return o.alloc(0);let W;if(_===void 0)for(_=0,W=0;W<w.length;++W)_+=w[W].length;const O=o.allocUnsafe(_);let U=0;for(W=0;W<w.length;++W){let ee=w[W];if(fe(ee,Uint8Array))U+ee.length>O.length?(o.isBuffer(ee)||(ee=o.from(ee)),ee.copy(O,U)):Uint8Array.prototype.set.call(O,ee,U);else if(o.isBuffer(ee))ee.copy(O,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=ee.length}return O};function N(P,w){if(o.isBuffer(P))return P.length;if(ArrayBuffer.isView(P)||fe(P,ArrayBuffer))return P.byteLength;if(typeof P!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof P);const _=P.length,W=arguments.length>2&&arguments[2]===!0;if(!W&&_===0)return 0;let O=!1;for(;;)switch(w){case"ascii":case"latin1":case"binary":return _;case"utf8":case"utf-8":return be(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _*2;case"hex":return _>>>1;case"base64":return Pe(P).length;default:if(O)return W?-1:be(P).length;w=(""+w).toLowerCase(),O=!0}}o.byteLength=N;function C(P,w,_){let W=!1;if((w===void 0||w<0)&&(w=0),w>this.length||((_===void 0||_>this.length)&&(_=this.length),_<=0)||(_>>>=0,w>>>=0,_<=w))return"";for(P||(P="utf8");;)switch(P){case"hex":return L(this,w,_);case"utf8":case"utf-8":return $(this,w,_);case"ascii":return ae(this,w,_);case"latin1":case"binary":return ue(this,w,_);case"base64":return x(this,w,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Se(this,w,_);default:if(W)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),W=!0}}o.prototype._isBuffer=!0;function I(P,w,_){const W=P[w];P[w]=P[_],P[_]=W}o.prototype.swap16=function(){const w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let _=0;_<w;_+=2)I(this,_,_+1);return this},o.prototype.swap32=function(){const w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let _=0;_<w;_+=4)I(this,_,_+3),I(this,_+1,_+2);return this},o.prototype.swap64=function(){const w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let _=0;_<w;_+=8)I(this,_,_+7),I(this,_+1,_+6),I(this,_+2,_+5),I(this,_+3,_+4);return this},o.prototype.toString=function(){const w=this.length;return w===0?"":arguments.length===0?$(this,0,w):C.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(w){if(!o.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:o.compare(this,w)===0},o.prototype.inspect=function(){let w="";const _=r.INSPECT_MAX_BYTES;return w=this.toString("hex",0,_).replace(/(.{2})/g,"$1 ").trim(),this.length>_&&(w+=" ... "),"<Buffer "+w+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(w,_,W,O,U){if(fe(w,Uint8Array)&&(w=o.from(w,w.offset,w.byteLength)),!o.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(_===void 0&&(_=0),W===void 0&&(W=w?w.length:0),O===void 0&&(O=0),U===void 0&&(U=this.length),_<0||W>w.length||O<0||U>this.length)throw new RangeError("out of range index");if(O>=U&&_>=W)return 0;if(O>=U)return-1;if(_>=W)return 1;if(_>>>=0,W>>>=0,O>>>=0,U>>>=0,this===w)return 0;let ee=U-O,me=W-_;const He=Math.min(ee,me),rt=this.slice(O,U),ft=w.slice(_,W);for(let Qe=0;Qe<He;++Qe)if(rt[Qe]!==ft[Qe]){ee=rt[Qe],me=ft[Qe];break}return ee<me?-1:me<ee?1:0};function H(P,w,_,W,O){if(P.length===0)return-1;if(typeof _=="string"?(W=_,_=0):_>2147483647?_=2147483647:_<-2147483648&&(_=-2147483648),_=+_,Ve(_)&&(_=O?0:P.length-1),_<0&&(_=P.length+_),_>=P.length){if(O)return-1;_=P.length-1}else if(_<0)if(O)_=0;else return-1;if(typeof w=="string"&&(w=o.from(w,W)),o.isBuffer(w))return w.length===0?-1:Q(P,w,_,W,O);if(typeof w=="number")return w=w&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(P,w,_):Uint8Array.prototype.lastIndexOf.call(P,w,_):Q(P,[w],_,W,O);throw new TypeError("val must be string, number or Buffer")}function Q(P,w,_,W,O){let U=1,ee=P.length,me=w.length;if(W!==void 0&&(W=String(W).toLowerCase(),W==="ucs2"||W==="ucs-2"||W==="utf16le"||W==="utf-16le")){if(P.length<2||w.length<2)return-1;U=2,ee/=2,me/=2,_/=2}function He(ft,Qe){return U===1?ft[Qe]:ft.readUInt16BE(Qe*U)}let rt;if(O){let ft=-1;for(rt=_;rt<ee;rt++)if(He(P,rt)===He(w,ft===-1?0:rt-ft)){if(ft===-1&&(ft=rt),rt-ft+1===me)return ft*U}else ft!==-1&&(rt-=rt-ft),ft=-1}else for(_+me>ee&&(_=ee-me),rt=_;rt>=0;rt--){let ft=!0;for(let Qe=0;Qe<me;Qe++)if(He(P,rt+Qe)!==He(w,Qe)){ft=!1;break}if(ft)return rt}return-1}o.prototype.includes=function(w,_,W){return this.indexOf(w,_,W)!==-1},o.prototype.indexOf=function(w,_,W){return H(this,w,_,W,!0)},o.prototype.lastIndexOf=function(w,_,W){return H(this,w,_,W,!1)};function te(P,w,_,W){_=Number(_)||0;const O=P.length-_;W?(W=Number(W),W>O&&(W=O)):W=O;const U=w.length;W>U/2&&(W=U/2);let ee;for(ee=0;ee<W;++ee){const me=parseInt(w.substr(ee*2,2),16);if(Ve(me))return ee;P[_+ee]=me}return ee}function V(P,w,_,W){return oe(be(w,P.length-_),P,_,W)}function J(P,w,_,W){return oe(xe(w),P,_,W)}function E(P,w,_,W){return oe(Pe(w),P,_,W)}function A(P,w,_,W){return oe(Le(w,P.length-_),P,_,W)}o.prototype.write=function(w,_,W,O){if(_===void 0)O="utf8",W=this.length,_=0;else if(W===void 0&&typeof _=="string")O=_,W=this.length,_=0;else if(isFinite(_))_=_>>>0,isFinite(W)?(W=W>>>0,O===void 0&&(O="utf8")):(O=W,W=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const U=this.length-_;if((W===void 0||W>U)&&(W=U),w.length>0&&(W<0||_<0)||_>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");let ee=!1;for(;;)switch(O){case"hex":return te(this,w,_,W);case"utf8":case"utf-8":return V(this,w,_,W);case"ascii":case"latin1":case"binary":return J(this,w,_,W);case"base64":return E(this,w,_,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,w,_,W);default:if(ee)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),ee=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function x(P,w,_){return w===0&&_===P.length?e.fromByteArray(P):e.fromByteArray(P.slice(w,_))}function $(P,w,_){_=Math.min(P.length,_);const W=[];let O=w;for(;O<_;){const U=P[O];let ee=null,me=U>239?4:U>223?3:U>191?2:1;if(O+me<=_){let He,rt,ft,Qe;switch(me){case 1:U<128&&(ee=U);break;case 2:He=P[O+1],(He&192)===128&&(Qe=(U&31)<<6|He&63,Qe>127&&(ee=Qe));break;case 3:He=P[O+1],rt=P[O+2],(He&192)===128&&(rt&192)===128&&(Qe=(U&15)<<12|(He&63)<<6|rt&63,Qe>2047&&(Qe<55296||Qe>57343)&&(ee=Qe));break;case 4:He=P[O+1],rt=P[O+2],ft=P[O+3],(He&192)===128&&(rt&192)===128&&(ft&192)===128&&(Qe=(U&15)<<18|(He&63)<<12|(rt&63)<<6|ft&63,Qe>65535&&Qe<1114112&&(ee=Qe))}}ee===null?(ee=65533,me=1):ee>65535&&(ee-=65536,W.push(ee>>>10&1023|55296),ee=56320|ee&1023),W.push(ee),O+=me}return K(W)}const B=4096;function K(P){const w=P.length;if(w<=B)return String.fromCharCode.apply(String,P);let _="",W=0;for(;W<w;)_+=String.fromCharCode.apply(String,P.slice(W,W+=B));return _}function ae(P,w,_){let W="";_=Math.min(P.length,_);for(let O=w;O<_;++O)W+=String.fromCharCode(P[O]&127);return W}function ue(P,w,_){let W="";_=Math.min(P.length,_);for(let O=w;O<_;++O)W+=String.fromCharCode(P[O]);return W}function L(P,w,_){const W=P.length;(!w||w<0)&&(w=0),(!_||_<0||_>W)&&(_=W);let O="";for(let U=w;U<_;++U)O+=Je[P[U]];return O}function Se(P,w,_){const W=P.slice(w,_);let O="";for(let U=0;U<W.length-1;U+=2)O+=String.fromCharCode(W[U]+W[U+1]*256);return O}o.prototype.slice=function(w,_){const W=this.length;w=~~w,_=_===void 0?W:~~_,w<0?(w+=W,w<0&&(w=0)):w>W&&(w=W),_<0?(_+=W,_<0&&(_=0)):_>W&&(_=W),_<w&&(_=w);const O=this.subarray(w,_);return Object.setPrototypeOf(O,o.prototype),O};function Ae(P,w,_){if(P%1!==0||P<0)throw new RangeError("offset is not uint");if(P+w>_)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(w,_,W){w=w>>>0,_=_>>>0,W||Ae(w,_,this.length);let O=this[w],U=1,ee=0;for(;++ee<_&&(U*=256);)O+=this[w+ee]*U;return O},o.prototype.readUintBE=o.prototype.readUIntBE=function(w,_,W){w=w>>>0,_=_>>>0,W||Ae(w,_,this.length);let O=this[w+--_],U=1;for(;_>0&&(U*=256);)O+=this[w+--_]*U;return O},o.prototype.readUint8=o.prototype.readUInt8=function(w,_){return w=w>>>0,_||Ae(w,1,this.length),this[w]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(w,_){return w=w>>>0,_||Ae(w,2,this.length),this[w]|this[w+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(w,_){return w=w>>>0,_||Ae(w,2,this.length),this[w]<<8|this[w+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},o.prototype.readBigUInt64LE=ze(function(w){w=w>>>0,M(w,"offset");const _=this[w],W=this[w+7];(_===void 0||W===void 0)&&q(w,this.length-8);const O=_+this[++w]*tn(2,8)+this[++w]*tn(2,16)+this[++w]*tn(2,24),U=this[++w]+this[++w]*tn(2,8)+this[++w]*tn(2,16)+W*tn(2,24);return BigInt(O)+(BigInt(U)<<BigInt(32))}),o.prototype.readBigUInt64BE=ze(function(w){w=w>>>0,M(w,"offset");const _=this[w],W=this[w+7];(_===void 0||W===void 0)&&q(w,this.length-8);const O=_*tn(2,24)+this[++w]*tn(2,16)+this[++w]*tn(2,8)+this[++w],U=this[++w]*tn(2,24)+this[++w]*tn(2,16)+this[++w]*tn(2,8)+W;return(BigInt(O)<<BigInt(32))+BigInt(U)}),o.prototype.readIntLE=function(w,_,W){w=w>>>0,_=_>>>0,W||Ae(w,_,this.length);let O=this[w],U=1,ee=0;for(;++ee<_&&(U*=256);)O+=this[w+ee]*U;return U*=128,O>=U&&(O-=Math.pow(2,8*_)),O},o.prototype.readIntBE=function(w,_,W){w=w>>>0,_=_>>>0,W||Ae(w,_,this.length);let O=_,U=1,ee=this[w+--O];for(;O>0&&(U*=256);)ee+=this[w+--O]*U;return U*=128,ee>=U&&(ee-=Math.pow(2,8*_)),ee},o.prototype.readInt8=function(w,_){return w=w>>>0,_||Ae(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},o.prototype.readInt16LE=function(w,_){w=w>>>0,_||Ae(w,2,this.length);const W=this[w]|this[w+1]<<8;return W&32768?W|4294901760:W},o.prototype.readInt16BE=function(w,_){w=w>>>0,_||Ae(w,2,this.length);const W=this[w+1]|this[w]<<8;return W&32768?W|4294901760:W},o.prototype.readInt32LE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},o.prototype.readInt32BE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},o.prototype.readBigInt64LE=ze(function(w){w=w>>>0,M(w,"offset");const _=this[w],W=this[w+7];(_===void 0||W===void 0)&&q(w,this.length-8);const O=this[w+4]+this[w+5]*tn(2,8)+this[w+6]*tn(2,16)+(W<<24);return(BigInt(O)<<BigInt(32))+BigInt(_+this[++w]*tn(2,8)+this[++w]*tn(2,16)+this[++w]*tn(2,24))}),o.prototype.readBigInt64BE=ze(function(w){w=w>>>0,M(w,"offset");const _=this[w],W=this[w+7];(_===void 0||W===void 0)&&q(w,this.length-8);const O=(_<<24)+this[++w]*tn(2,16)+this[++w]*tn(2,8)+this[++w];return(BigInt(O)<<BigInt(32))+BigInt(this[++w]*tn(2,24)+this[++w]*tn(2,16)+this[++w]*tn(2,8)+W)}),o.prototype.readFloatLE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),t.read(this,w,!0,23,4)},o.prototype.readFloatBE=function(w,_){return w=w>>>0,_||Ae(w,4,this.length),t.read(this,w,!1,23,4)},o.prototype.readDoubleLE=function(w,_){return w=w>>>0,_||Ae(w,8,this.length),t.read(this,w,!0,52,8)},o.prototype.readDoubleBE=function(w,_){return w=w>>>0,_||Ae(w,8,this.length),t.read(this,w,!1,52,8)};function ve(P,w,_,W,O,U){if(!o.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>O||w<U)throw new RangeError('"value" argument is out of bounds');if(_+W>P.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(w,_,W,O){if(w=+w,_=_>>>0,W=W>>>0,!O){const me=Math.pow(2,8*W)-1;ve(this,w,_,W,me,0)}let U=1,ee=0;for(this[_]=w&255;++ee<W&&(U*=256);)this[_+ee]=w/U&255;return _+W},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(w,_,W,O){if(w=+w,_=_>>>0,W=W>>>0,!O){const me=Math.pow(2,8*W)-1;ve(this,w,_,W,me,0)}let U=W-1,ee=1;for(this[_+U]=w&255;--U>=0&&(ee*=256);)this[_+U]=w/ee&255;return _+W},o.prototype.writeUint8=o.prototype.writeUInt8=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,1,255,0),this[_]=w&255,_+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,2,65535,0),this[_]=w&255,this[_+1]=w>>>8,_+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,2,65535,0),this[_]=w>>>8,this[_+1]=w&255,_+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,4,4294967295,0),this[_+3]=w>>>24,this[_+2]=w>>>16,this[_+1]=w>>>8,this[_]=w&255,_+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,4,4294967295,0),this[_]=w>>>24,this[_+1]=w>>>16,this[_+2]=w>>>8,this[_+3]=w&255,_+4};function Ye(P,w,_,W,O){G(w,W,O,P,_,7);let U=Number(w&BigInt(4294967295));P[_++]=U,U=U>>8,P[_++]=U,U=U>>8,P[_++]=U,U=U>>8,P[_++]=U;let ee=Number(w>>BigInt(32)&BigInt(4294967295));return P[_++]=ee,ee=ee>>8,P[_++]=ee,ee=ee>>8,P[_++]=ee,ee=ee>>8,P[_++]=ee,_}function mt(P,w,_,W,O){G(w,W,O,P,_,7);let U=Number(w&BigInt(4294967295));P[_+7]=U,U=U>>8,P[_+6]=U,U=U>>8,P[_+5]=U,U=U>>8,P[_+4]=U;let ee=Number(w>>BigInt(32)&BigInt(4294967295));return P[_+3]=ee,ee=ee>>8,P[_+2]=ee,ee=ee>>8,P[_+1]=ee,ee=ee>>8,P[_]=ee,_+8}o.prototype.writeBigUInt64LE=ze(function(w,_=0){return Ye(this,w,_,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=ze(function(w,_=0){return mt(this,w,_,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(w,_,W,O){if(w=+w,_=_>>>0,!O){const He=Math.pow(2,8*W-1);ve(this,w,_,W,He-1,-He)}let U=0,ee=1,me=0;for(this[_]=w&255;++U<W&&(ee*=256);)w<0&&me===0&&this[_+U-1]!==0&&(me=1),this[_+U]=(w/ee>>0)-me&255;return _+W},o.prototype.writeIntBE=function(w,_,W,O){if(w=+w,_=_>>>0,!O){const He=Math.pow(2,8*W-1);ve(this,w,_,W,He-1,-He)}let U=W-1,ee=1,me=0;for(this[_+U]=w&255;--U>=0&&(ee*=256);)w<0&&me===0&&this[_+U+1]!==0&&(me=1),this[_+U]=(w/ee>>0)-me&255;return _+W},o.prototype.writeInt8=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,1,127,-128),w<0&&(w=255+w+1),this[_]=w&255,_+1},o.prototype.writeInt16LE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,2,32767,-32768),this[_]=w&255,this[_+1]=w>>>8,_+2},o.prototype.writeInt16BE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,2,32767,-32768),this[_]=w>>>8,this[_+1]=w&255,_+2},o.prototype.writeInt32LE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,4,2147483647,-2147483648),this[_]=w&255,this[_+1]=w>>>8,this[_+2]=w>>>16,this[_+3]=w>>>24,_+4},o.prototype.writeInt32BE=function(w,_,W){return w=+w,_=_>>>0,W||ve(this,w,_,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[_]=w>>>24,this[_+1]=w>>>16,this[_+2]=w>>>8,this[_+3]=w&255,_+4},o.prototype.writeBigInt64LE=ze(function(w,_=0){return Ye(this,w,_,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=ze(function(w,_=0){return mt(this,w,_,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function et(P,w,_,W,O,U){if(_+W>P.length)throw new RangeError("Index out of range");if(_<0)throw new RangeError("Index out of range")}function ut(P,w,_,W,O){return w=+w,_=_>>>0,O||et(P,w,_,4),t.write(P,w,_,W,23,4),_+4}o.prototype.writeFloatLE=function(w,_,W){return ut(this,w,_,!0,W)},o.prototype.writeFloatBE=function(w,_,W){return ut(this,w,_,!1,W)};function Ee(P,w,_,W,O){return w=+w,_=_>>>0,O||et(P,w,_,8),t.write(P,w,_,W,52,8),_+8}o.prototype.writeDoubleLE=function(w,_,W){return Ee(this,w,_,!0,W)},o.prototype.writeDoubleBE=function(w,_,W){return Ee(this,w,_,!1,W)},o.prototype.copy=function(w,_,W,O){if(!o.isBuffer(w))throw new TypeError("argument should be a Buffer");if(W||(W=0),!O&&O!==0&&(O=this.length),_>=w.length&&(_=w.length),_||(_=0),O>0&&O<W&&(O=W),O===W||w.length===0||this.length===0)return 0;if(_<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),w.length-_<O-W&&(O=w.length-_+W);const U=O-W;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(_,W,O):Uint8Array.prototype.set.call(w,this.subarray(W,O),_),U},o.prototype.fill=function(w,_,W,O){if(typeof w=="string"){if(typeof _=="string"?(O=_,_=0,W=this.length):typeof W=="string"&&(O=W,W=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!o.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(w.length===1){const ee=w.charCodeAt(0);(O==="utf8"&&ee<128||O==="latin1")&&(w=ee)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(_<0||this.length<_||this.length<W)throw new RangeError("Out of range index");if(W<=_)return this;_=_>>>0,W=W===void 0?this.length:W>>>0,w||(w=0);let U;if(typeof w=="number")for(U=_;U<W;++U)this[U]=w;else{const ee=o.isBuffer(w)?w:o.from(w,O),me=ee.length;if(me===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(U=0;U<W-_;++U)this[U+_]=ee[U%me]}return this};const $e={};function z(P,w,_){$e[P]=class extends _{constructor(){super(),Object.defineProperty(this,"message",{value:w.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${P}]`,this.stack,delete this.name}get code(){return P}set code(O){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:O,writable:!0})}toString(){return`${this.name} [${P}]: ${this.message}`}}}z("ERR_BUFFER_OUT_OF_BOUNDS",function(P){return P?`${P} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),z("ERR_INVALID_ARG_TYPE",function(P,w){return`The "${P}" argument must be of type number. Received type ${typeof w}`},TypeError),z("ERR_OUT_OF_RANGE",function(P,w,_){let W=`The value of "${P}" is out of range.`,O=_;return Number.isInteger(_)&&Math.abs(_)>tn(2,32)?O=Te(String(_)):typeof _=="bigint"&&(O=String(_),(_>tn(BigInt(2),BigInt(32))||_<-tn(BigInt(2),BigInt(32)))&&(O=Te(O)),O+="n"),W+=` It must be ${w}. Received ${O}`,W},RangeError);function Te(P){let w="",_=P.length;const W=P[0]==="-"?1:0;for(;_>=W+4;_-=3)w=`_${P.slice(_-3,_)}${w}`;return`${P.slice(0,_)}${w}`}function j(P,w,_){M(w,"offset"),(P[w]===void 0||P[w+_]===void 0)&&q(w,P.length-(_+1))}function G(P,w,_,W,O,U){if(P>_||P<w){const ee=typeof w=="bigint"?"n":"";let me;throw w===0||w===BigInt(0)?me=`>= 0${ee} and < 2${ee} ** ${(U+1)*8}${ee}`:me=`>= -(2${ee} ** ${(U+1)*8-1}${ee}) and < 2 ** ${(U+1)*8-1}${ee}`,new $e.ERR_OUT_OF_RANGE("value",me,P)}j(W,O,U)}function M(P,w){if(typeof P!="number")throw new $e.ERR_INVALID_ARG_TYPE(w,"number",P)}function q(P,w,_){throw Math.floor(P)!==P?(M(P,_),new $e.ERR_OUT_OF_RANGE("offset","an integer",P)):w<0?new $e.ERR_BUFFER_OUT_OF_BOUNDS:new $e.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${w}`,P)}const se=/[^+/0-9A-Za-z-_]/g;function le(P){if(P=P.split("=")[0],P=P.trim().replace(se,""),P.length<2)return"";for(;P.length%4!==0;)P=P+"=";return P}function be(P,w){w=w||1/0;let _;const W=P.length;let O=null;const U=[];for(let ee=0;ee<W;++ee){if(_=P.charCodeAt(ee),_>55295&&_<57344){if(!O){if(_>56319){(w-=3)>-1&&U.push(239,191,189);continue}else if(ee+1===W){(w-=3)>-1&&U.push(239,191,189);continue}O=_;continue}if(_<56320){(w-=3)>-1&&U.push(239,191,189),O=_;continue}_=(O-55296<<10|_-56320)+65536}else O&&(w-=3)>-1&&U.push(239,191,189);if(O=null,_<128){if((w-=1)<0)break;U.push(_)}else if(_<2048){if((w-=2)<0)break;U.push(_>>6|192,_&63|128)}else if(_<65536){if((w-=3)<0)break;U.push(_>>12|224,_>>6&63|128,_&63|128)}else if(_<1114112){if((w-=4)<0)break;U.push(_>>18|240,_>>12&63|128,_>>6&63|128,_&63|128)}else throw new Error("Invalid code point")}return U}function xe(P){const w=[];for(let _=0;_<P.length;++_)w.push(P.charCodeAt(_)&255);return w}function Le(P,w){let _,W,O;const U=[];for(let ee=0;ee<P.length&&!((w-=2)<0);++ee)_=P.charCodeAt(ee),W=_>>8,O=_%256,U.push(O),U.push(W);return U}function Pe(P){return e.toByteArray(le(P))}function oe(P,w,_,W){let O;for(O=0;O<W&&!(O+_>=w.length||O>=P.length);++O)w[O+_]=P[O];return O}function fe(P,w){return P instanceof w||P!=null&&P.constructor!=null&&P.constructor.name!=null&&P.constructor.name===w.name}function Ve(P){return P!==P}const Je=function(){const P="0123456789abcdef",w=new Array(256);for(let _=0;_<16;++_){const W=_*16;for(let O=0;O<16;++O)w[W+O]=P[_]+P[O]}return w}();function ze(P){return typeof BigInt=="undefined"?nt:P}function nt(){throw new Error("BigInt not supported")}})(nh);class Kt{static getGlobalVariable(){return typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global}static load(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: require("${e}").`);return""}static pathNormalize(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.normalize("${e}").`);return""}static pathExtname(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.extname("${e}").`);return""}static pathResolve(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.resolve("${e}").`);return""}static fileExist(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.existsSync("${e}").`);return!1}static dotenv(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "${e}" }).`)}static getEnvVariable(e){}static readFileSync(e){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("${e}").`);return null}static appendFileSync(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("${e}").`)}static writeFile(e,t){if(this.type==="browser")throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.writeFile("${e}").`);return Promise.reject(null)}static highlightSql(e){return e}static logInfo(e,t){}static logError(e,t){}static logWarn(e,t){}static log(e){}static warn(e){return e}}Kt.type="browser";typeof window!="undefined"&&(window.Buffer=nh.Buffer);typeof globalThis!="undefined"&&(globalThis.Buffer=nh.Buffer);typeof global!="undefined"&&typeof require!="undefined"&&(global.Buffer=require("buffer/").Buffer);class _t{static isObject(e){return e!==null&&typeof e=="object"}static isObjectWithName(e){return e!==null&&typeof e=="object"&&e.name!==void 0}static assign(e,...t){for(const n of t)for(const i of Object.getOwnPropertyNames(n))e[i]=n[i]}static mixedListToArray(e){return e!==null&&typeof e=="object"?Object.keys(e).map(t=>e[t]):e}}class Z extends Error{get name(){return this.constructor.name}constructor(e){super(e),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}class hc extends Z{constructor(e){super(`Internal error. Subject ${e.metadata.targetName} must have an identifier to perform operation.`)}}class L2 extends Z{constructor(e){super(`Cannot create a "${e}" connection because connection to the database already established.`)}}class ca extends Z{constructor(){super("Locking not supported on given driver.")}}class q2 extends Z{constructor(e,t){super();const n=e.primaryColumns.reduce((i,s,a)=>(s.setEntityValue(i,a+1),i),{});this.message=`Cannot use given entity id "${t}" because "${e.targetName}" contains multiple primary columns, you must provide object in following form: ${JSON.stringify(n)} as an id.`}}class k2 extends Z{constructor(e){super(`Cannot ${e}, given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.`)}}class Id extends Z{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}class B2 extends Z{constructor(e){super(`Tree repositories are not supported in ${e.options.type} driver.`)}}class AT extends Z{constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} was not found. Did you forgot to put @EntityRepository decorator on it?`)}}class Ir extends Z{constructor(){super("Transaction is not started yet, start transaction before committing or rolling it back.")}}class F2 extends Z{constructor(){super("Transaction already started for the given connection, commit current transaction before starting a new one.")}}class de{static isMssqlParameter(e){return this.check(e,"MssqlParameter")}static isEntityMetadata(e){return this.check(e,"EntityMetadata")}static isColumnMetadata(e){return this.check(e,"ColumnMetadata")}static isSelectQueryBuilder(e){return this.check(e,"SelectQueryBuilder")}static isInsertQueryBuilder(e){return this.check(e,"InsertQueryBuilder")}static isDeleteQueryBuilder(e){return this.check(e,"DeleteQueryBuilder")}static isUpdateQueryBuilder(e){return this.check(e,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(e){return this.check(e,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(e){return this.check(e,"RelationQueryBuilder")}static isBrackets(e){return this.check(e,"Brackets")||this.check(e,"NotBrackets")}static isNotBrackets(e){return this.check(e,"NotBrackets")}static isSubject(e){return this.check(e,"Subject")}static isRdbmsSchemaBuilder(e){return this.check(e,"RdbmsSchemaBuilder")}static isMongoEntityManager(e){return this.check(e,"MongoEntityManager")}static isSqljsEntityManager(e){return this.check(e,"SqljsEntityManager")}static isEntitySchema(e){return this.check(e,"EntitySchema")}static isBaseEntityConstructor(e){return typeof e=="function"&&typeof e.hasId=="function"&&typeof e.save=="function"&&typeof e.useDataSource=="function"}static isFindOperator(e){return this.check(e,"FindOperator")||this.check(e,"EqualOperator")}static isEqualOperator(e){return this.check(e,"EqualOperator")}static isQuery(e){return this.check(e,"Query")}static isTable(e){return this.check(e,"Table")}static isTableCheck(e){return this.check(e,"TableCheck")}static isTableColumn(e){return this.check(e,"TableColumn")}static isTableExclusion(e){return this.check(e,"TableExclusion")}static isTableForeignKey(e){return this.check(e,"TableForeignKey")}static isTableIndex(e){return this.check(e,"TableIndex")}static isTableUnique(e){return this.check(e,"TableUnique")}static isView(e){return this.check(e,"View")}static isDataSource(e){return this.check(e,"DataSource")}static check(e,t){return typeof e=="object"&&e!==null&&e["@instanceof"]===Symbol.for(t)}}class Od extends Z{constructor(e,t){super(),this.entityClass=e,this.criteria=t,this.message=`Could not find any entity of type "${this.stringifyTarget(e)}" matching: ${this.stringifyCriteria(t)}`}stringifyTarget(e){return de.isEntitySchema(e)?e.options.name:typeof e=="function"||_t.isObject(e)&&"name"in e?e.name:e}stringifyCriteria(e){try{return JSON.stringify(e,null,4)}catch(t){}return""+e}}class U2 extends Z{constructor(e){super(),this.message=`No metadata for "${this.stringifyTarget(e)}" was found.`}stringifyTarget(e){return de.isEntitySchema(e)?e.options.name:typeof e=="function"||_t.isObject(e)&&"name"in e?e.name:e}}class V2 extends Z{constructor(e,t){super(`Cannot ${e}, given value must be an entity, instead "${t}" is given.`)}}class Zg extends Z{constructor(e,t,n){super(`The optimistic lock on entity ${e} failed, version ${t} was expected, but is actually ${n}.`)}}class xT extends Z{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}class j2 extends Z{constructor(e){super(`Custom entity repository ${typeof e=="function"?e.name:e.constructor.name}  cannot inherit Repository class without entity being set in the @EntityRepository decorator.`)}}class RT extends Z{constructor(){super("Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.")}}class eb extends Z{constructor(e){super(`Cannot attach entity "${e}" to its parent. Please make sure parent is saved in the database before saving children nodes.`)}}class nf extends Z{constructor(e){super(`Custom repository ${typeof e=="function"?e.name:e.constructor.name} does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? `)}}class W2 extends Z{constructor(e){super(`Entity "${e.name}" does not have delete date columns.`)}}class H2 extends Z{constructor(e){super(`Circular relations detected: ${e}. To resolve this issue you need to set nullable: true somewhere in this dependency structure.`)}}class ih extends Z{constructor(){super("OUTPUT or RETURNING clause only supported by PostgreSQL, MariaDB, Microsoft SqlServer or Google Spanner.")}}class Q2 extends Z{constructor(e){super(`Entity "${e.name}" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.`)}}class Wr extends Z{constructor(e,t){super(e),Object.setPrototypeOf(this,Wr.prototype),this.message=`Property "${e}" was not found in "${t.targetName}". Make sure your query is correct.`}}class z2 extends Z{constructor(e,t=[]){super(`Wrong driver: "${e}" given. Supported drivers are: ${t.map(n=>`"${n}"`).join(", ")}.`)}}class io extends Z{constructor(e,t){super(`${e} package has not been found installed. Please run "npm install ${t}".`)}}class G2 extends Z{constructor(e){super(`Entity ${e} does not have version or update date columns.`)}}class K2 extends Z{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}class xo extends Z{constructor(){super("The optimistic lock can be used only with getOne() method.")}}class Y2 extends Z{constructor(e){super(`Driver option (${e}) is not set. Please set it to perform connection to the database.`)}}class J2 extends Z{constructor(e){super(),e.length===1?this.message=`Relation "${e[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${e.map(t=>`"${t}"`).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}class X2 extends Z{constructor(){super("An open transaction is required for pessimistic lock.")}}class Z2 extends Z{constructor(e,t,n){super();const i=typeof t=="string"?t:t.name;this.message=`Data type "${i}" in "${e.entityMetadata.targetName}.${e.propertyName}" is not supported by "${n}" database.`}}class eq extends Z{constructor(e){super(`Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "${e.entityMetadata.targetName}#${e.propertyPath}". This is ORM requirement to make relations to work properly. Refer docs for more information.`)}}class zr extends Z{constructor(e,t,n){if(super(n.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,"")),this.query=e,this.parameters=t,this.driverError=n,n){const i=n,{name:s}=i,a=Gl(i,["name"]);_t.assign(this,Xe({},a))}}}class tq extends Z{constructor(){super("Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.")}}class nq extends Z{constructor(e){super(`Removed entity "${e.metadata.name}" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).`)}}class rq extends Z{constructor(e,t){super(`Column type for ${e.constructor.name}#${t} is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.`)}}class zn extends Z{constructor(){super("Query runner already released. Cannot run queries anymore.")}}class iq extends Z{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}class Ro extends Z{constructor(e){super(`Cannot execute operation on "${e}" connection because connection is not yet established.`)}}class sq extends Z{constructor(e){super(`Option "${e}" is not set in your connection options, please define "${e}" option in your connection options or ormconfig.json`)}}class aq extends Z{constructor(e){const t=e.map(n=>`"${n.name}"`);super(`Migrations ${t.join(", ")} override the transaction mode, but the global transaction mode is "all"`)}}class tb{constructor(e){_t.assign(this,e||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(e){this._metadata=e}get metadata(){if(!this._metadata)throw new Z(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}class hi{static isAliasProperty(e){if(typeof e!="string"||e.indexOf(".")===-1)return!1;const[t,n]=e.split(".");return!(!t||!n||e.indexOf("(")!==-1||e.indexOf(")")!==-1)}}var MT={exports:{}},$d={exports:{}};typeof Object.create=="function"?$d.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:$d.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}};var so=$d.exports,Dd={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(r,e){var t=nh,n=t.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?r.exports=t:(i(t,e),e.Buffer=s);function s(a,o,l){return n(a,o,l)}s.prototype=Object.create(n.prototype),i(n,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return n(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=n(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(a)}})(Dd,Dd.exports);var ys=Dd.exports,oq={}.toString,lq=Array.isArray||function(r){return oq.call(r)=="[object Array]"},Nl=TypeError,PT=Object,cq=Error,uq=EvalError,hq=RangeError,fq=ReferenceError,IT=SyntaxError,dq=URIError,pq=Math.abs,mq=Math.floor,yq=Math.max,gq=Math.min,bq=Math.pow,Eq=Math.round,wq=Number.isNaN||function(e){return e!==e},vq=wq,Tq=function(e){return vq(e)||e===0?e:e<0?-1:1},_q=Object.getOwnPropertyDescriptor,Pc=_q;if(Pc)try{Pc([],"length")}catch(r){Pc=null}var Al=Pc,Ic=Object.defineProperty||!1;if(Ic)try{Ic({},"a",{value:1})}catch(r){Ic=!1}var sh=Ic,rf,nb;function OT(){return nb||(nb=1,rf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),rf}var sf,rb;function Sq(){if(rb)return sf;rb=1;var r=typeof Symbol!="undefined"&&Symbol,e=OT();return sf=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},sf}var af,ib;function $T(){return ib||(ib=1,af=typeof Reflect!="undefined"&&Reflect.getPrototypeOf||null),af}var of,sb;function DT(){if(sb)return of;sb=1;var r=PT;return of=r.getPrototypeOf||null,of}var Cq="Function.prototype.bind called on incompatible ",Nq=Object.prototype.toString,Aq=Math.max,xq="[object Function]",ab=function(e,t){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var s=0;s<t.length;s+=1)n[s+e.length]=t[s];return n},Rq=function(e,t){for(var n=[],i=t,s=0;i<e.length;i+=1,s+=1)n[s]=e[i];return n},Mq=function(r,e){for(var t="",n=0;n<r.length;n+=1)t+=r[n],n+1<r.length&&(t+=e);return t},Pq=function(e){var t=this;if(typeof t!="function"||Nq.apply(t)!==xq)throw new TypeError(Cq+t);for(var n=Rq(arguments,1),i,s=function(){if(this instanceof i){var u=t.apply(this,ab(n,arguments));return Object(u)===u?u:this}return t.apply(e,ab(n,arguments))},a=Aq(0,t.length-n.length),o=[],l=0;l<a;l++)o[l]="$"+l;if(i=Function("binder","return function ("+Mq(o,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var c=function(){};c.prototype=t.prototype,i.prototype=new c,c.prototype=null}return i},Iq=Pq,xl=Function.prototype.bind||Iq,Vp=Function.prototype.call,jp=Function.prototype.apply,Oq=typeof Reflect!="undefined"&&Reflect&&Reflect.apply,$q=xl,Dq=jp,Lq=Vp,qq=Oq,LT=qq||$q.call(Lq,Dq),kq=xl,Bq=Nl,Fq=Vp,Uq=LT,Wp=function(e){if(e.length<1||typeof e[0]!="function")throw new Bq("a function is required");return Uq(kq,Fq,e)},lf,ob;function Vq(){if(ob)return lf;ob=1;var r=Wp,e=Al,t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return lf=n&&typeof n.get=="function"?r([n.get]):typeof s=="function"?function(o){return s(o==null?o:i(o))}:!1,lf}var cf,lb;function qT(){if(lb)return cf;lb=1;var r=$T(),e=DT(),t=Vq();return cf=r?function(i){return r(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,cf}var uf,cb;function jq(){if(cb)return uf;cb=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=xl;return uf=t.call(r,e),uf}var qt,Wq=PT,Hq=cq,Qq=uq,zq=hq,Gq=fq,Ha=IT,Oa=Nl,Kq=dq,Yq=pq,Jq=mq,Xq=yq,Zq=gq,ek=bq,tk=Eq,nk=Tq,kT=Function,hf=function(r){try{return kT('"use strict"; return ('+r+").constructor;")()}catch(e){}},pl=Al,rk=sh,ff=function(){throw new Oa},ik=pl?function(){try{return arguments.callee,ff}catch(r){try{return pl(arguments,"callee").get}catch(e){return ff}}}():ff,ua=Sq()(),Pn=qT(),sk=DT(),ak=$T(),BT=jp,Rl=Vp,ga={},ok=typeof Uint8Array=="undefined"||!Pn?qt:Pn(Uint8Array),Ls={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?qt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?qt:ArrayBuffer,"%ArrayIteratorPrototype%":ua&&Pn?Pn([][Symbol.iterator]()):qt,"%AsyncFromSyncIteratorPrototype%":qt,"%AsyncFunction%":ga,"%AsyncGenerator%":ga,"%AsyncGeneratorFunction%":ga,"%AsyncIteratorPrototype%":ga,"%Atomics%":typeof Atomics=="undefined"?qt:Atomics,"%BigInt%":typeof BigInt=="undefined"?qt:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?qt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?qt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?qt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Hq,"%eval%":eval,"%EvalError%":Qq,"%Float16Array%":typeof Float16Array=="undefined"?qt:Float16Array,"%Float32Array%":typeof Float32Array=="undefined"?qt:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?qt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?qt:FinalizationRegistry,"%Function%":kT,"%GeneratorFunction%":ga,"%Int8Array%":typeof Int8Array=="undefined"?qt:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?qt:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?qt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ua&&Pn?Pn(Pn([][Symbol.iterator]())):qt,"%JSON%":typeof JSON=="object"?JSON:qt,"%Map%":typeof Map=="undefined"?qt:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!ua||!Pn?qt:Pn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Wq,"%Object.getOwnPropertyDescriptor%":pl,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?qt:Promise,"%Proxy%":typeof Proxy=="undefined"?qt:Proxy,"%RangeError%":zq,"%ReferenceError%":Gq,"%Reflect%":typeof Reflect=="undefined"?qt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?qt:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!ua||!Pn?qt:Pn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?qt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ua&&Pn?Pn(""[Symbol.iterator]()):qt,"%Symbol%":ua?Symbol:qt,"%SyntaxError%":Ha,"%ThrowTypeError%":ik,"%TypedArray%":ok,"%TypeError%":Oa,"%Uint8Array%":typeof Uint8Array=="undefined"?qt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?qt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?qt:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?qt:Uint32Array,"%URIError%":Kq,"%WeakMap%":typeof WeakMap=="undefined"?qt:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?qt:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?qt:WeakSet,"%Function.prototype.call%":Rl,"%Function.prototype.apply%":BT,"%Object.defineProperty%":rk,"%Object.getPrototypeOf%":sk,"%Math.abs%":Yq,"%Math.floor%":Jq,"%Math.max%":Xq,"%Math.min%":Zq,"%Math.pow%":ek,"%Math.round%":tk,"%Math.sign%":nk,"%Reflect.getPrototypeOf%":ak};if(Pn)try{null.error}catch(r){var lk=Pn(Pn(r));Ls["%Error.prototype%"]=lk}var ck=function r(e){var t;if(e==="%AsyncFunction%")t=hf("async function () {}");else if(e==="%GeneratorFunction%")t=hf("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=hf("async function* () {}");else if(e==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=r("%AsyncGenerator%");i&&Pn&&(t=Pn(i.prototype))}return Ls[e]=t,t},ub={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ml=xl,lu=jq(),uk=Ml.call(Rl,Array.prototype.concat),hk=Ml.call(BT,Array.prototype.splice),hb=Ml.call(Rl,String.prototype.replace),cu=Ml.call(Rl,String.prototype.slice),fk=Ml.call(Rl,RegExp.prototype.exec),dk=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,pk=/\\(\\)?/g,mk=function(e){var t=cu(e,0,1),n=cu(e,-1);if(t==="%"&&n!=="%")throw new Ha("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new Ha("invalid intrinsic syntax, expected opening `%`");var i=[];return hb(e,dk,function(s,a,o,l){i[i.length]=o?hb(l,pk,"$1"):a||s}),i},yk=function(e,t){var n=e,i;if(lu(ub,n)&&(i=ub[n],n="%"+i[0]+"%"),lu(Ls,n)){var s=Ls[n];if(s===ga&&(s=ck(n)),typeof s=="undefined"&&!t)throw new Oa("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Ha("intrinsic "+e+" does not exist!")},FT=function(e,t){if(typeof e!="string"||e.length===0)throw new Oa("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Oa('"allowMissing" argument must be a boolean');if(fk(/^%?[^%]*%?$/,e)===null)throw new Ha("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=mk(e),i=n.length>0?n[0]:"",s=yk("%"+i+"%",t),a=s.name,o=s.value,l=!1,c=s.alias;c&&(i=c[0],hk(n,uk([0,1],c)));for(var u=1,h=!0;u<n.length;u+=1){var f=n[u],d=cu(f,0,1),m=cu(f,-1);if((d==='"'||d==="'"||d==="`"||m==='"'||m==="'"||m==="`")&&d!==m)throw new Ha("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),i+="."+f,a="%"+i+"%",lu(Ls,a))o=Ls[a];else if(o!=null){if(!(f in o)){if(!t)throw new Oa("base intrinsic for "+e+" exists, but the property is not available.");return}if(pl&&u+1>=n.length){var y=pl(o,f);h=!!y,h&&"get"in y&&!("originalValue"in y.get)?o=y.get:o=o[f]}else h=lu(o,f),o=o[f];h&&!l&&(Ls[a]=o)}}return o},UT=FT,VT=Wp,gk=VT([UT("%String.prototype.indexOf%")]),jT=function(e,t){var n=UT(e,!!t);return typeof n=="function"&&gk(e,".prototype.")>-1?VT([n]):n},df,fb;function bk(){if(fb)return df;fb=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(S){S!==n&&(e=null)}else e=null;var i=/^\s*class\b/,s=function(N){try{var C=r.call(N);return i.test(C)}catch(I){return!1}},a=function(N){try{return s(N)?!1:(r.call(N),!0)}catch(C){return!1}},o=Object.prototype.toString,l="[object Object]",c="[object Function]",u="[object GeneratorFunction]",h="[object HTMLAllCollection]",f="[object HTML document.all class]",d="[object HTMLCollection]",m=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),T=function(){return!1};if(typeof document=="object"){var b=document.all;o.call(b)===o.call(document.all)&&(T=function(N){if((y||!N)&&(typeof N=="undefined"||typeof N=="object"))try{var C=o.call(N);return(C===h||C===f||C===d||C===l)&&N("")==null}catch(I){}return!1})}return df=e?function(N){if(T(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;try{e(N,null,t)}catch(C){if(C!==n)return!1}return!s(N)&&a(N)}:function(N){if(T(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;if(m)return a(N);if(s(N))return!1;var C=o.call(N);return C!==c&&C!==u&&!/^\[object HTML/.test(C)?!1:a(N)},df}var pf,db;function Ek(){if(db)return pf;db=1;var r=bk(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(l,c,u){for(var h=0,f=l.length;h<f;h++)t.call(l,h)&&(u==null?c(l[h],h,l):c.call(u,l[h],h,l))},i=function(l,c,u){for(var h=0,f=l.length;h<f;h++)u==null?c(l.charAt(h),h,l):c.call(u,l.charAt(h),h,l)},s=function(l,c,u){for(var h in l)t.call(l,h)&&(u==null?c(l[h],h,l):c.call(u,l[h],h,l))};function a(o){return e.call(o)==="[object Array]"}return pf=function(l,c,u){if(!r(c))throw new TypeError("iterator must be a function");var h;arguments.length>=3&&(h=u),a(l)?n(l,c,h):typeof l=="string"?i(l,c,h):s(l,c,h)},pf}var mf,pb;function wk(){return pb||(pb=1,mf=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),mf}var yf,mb;function vk(){if(mb)return yf;mb=1;var r=wk(),e=typeof globalThis=="undefined"?Ni:globalThis;return yf=function(){for(var n=[],i=0;i<r.length;i++)typeof e[r[i]]=="function"&&(n[n.length]=r[i]);return n},yf}var gf={exports:{}},bf,yb;function Tk(){if(yb)return bf;yb=1;var r=sh,e=IT,t=Nl,n=Al;return bf=function(s,a,o){if(!s||typeof s!="object"&&typeof s!="function")throw new t("`obj` must be an object or a function`");if(typeof a!="string"&&typeof a!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,f=!!n&&n(s,a);if(r)r(s,a,{configurable:u===null&&f?f.configurable:!u,enumerable:l===null&&f?f.enumerable:!l,value:o,writable:c===null&&f?f.writable:!c});else if(h||!l&&!c&&!u)s[a]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},bf}var Ef,gb;function _k(){if(gb)return Ef;gb=1;var r=sh,e=function(){return!!r};return e.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch(n){return!0}},Ef=e,Ef}var wf,bb;function Sk(){if(bb)return wf;bb=1;var r=FT,e=Tk(),t=_k()(),n=Al,i=Nl,s=r("%Math.floor%");return wf=function(o,l){if(typeof o!="function")throw new i("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||s(l)!==l)throw new i("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],u=!0,h=!0;if("length"in o&&n){var f=n(o,"length");f&&!f.configurable&&(u=!1),f&&!f.writable&&(h=!1)}return(u||h||!c)&&(t?e(o,"length",l,!0,!0):e(o,"length",l)),o},wf}var vf,Eb;function Ck(){if(Eb)return vf;Eb=1;var r=xl,e=jp,t=LT;return vf=function(){return t(r,e,arguments)},vf}var wb;function Nk(){return wb||(wb=1,function(r){var e=Sk(),t=sh,n=Wp,i=Ck();r.exports=function(a){var o=n(arguments),l=a.length-(arguments.length-1);return e(o,1+(l>0?l:0),!0)},t?t(r.exports,"apply",{value:i}):r.exports.apply=i}(gf)),gf.exports}var Tf,vb;function Ak(){if(vb)return Tf;vb=1;var r=OT();return Tf=function(){return r()&&!!Symbol.toStringTag},Tf}var _f,Tb;function xk(){if(Tb)return _f;Tb=1;var r=Ek(),e=vk(),t=Nk(),n=jT,i=Al,s=qT(),a=n("Object.prototype.toString"),o=Ak()(),l=typeof globalThis=="undefined"?Ni:globalThis,c=e(),u=n("String.prototype.slice"),h=n("Array.prototype.indexOf",!0)||function(T,b){for(var S=0;S<T.length;S+=1)if(T[S]===b)return S;return-1},f={__proto__:null};o&&i&&s?r(c,function(y){var T=new l[y];if(Symbol.toStringTag in T&&s){var b=s(T),S=i(b,Symbol.toStringTag);if(!S&&b){var N=s(b);S=i(N,Symbol.toStringTag)}f["$"+y]=t(S.get)}}):r(c,function(y){var T=new l[y],b=T.slice||T.set;b&&(f["$"+y]=t(b))});var d=function(T){var b=!1;return r(f,function(S,N){if(!b)try{"$"+S(T)===N&&(b=u(N,1))}catch(C){}}),b},m=function(T){var b=!1;return r(f,function(S,N){if(!b)try{S(T),b=u(N,1)}catch(C){}}),b};return _f=function(T){if(!T||typeof T!="object")return!1;if(!o){var b=u(a(T),8,-1);return h(c,b)>-1?b:b!=="Object"?!1:m(T)}return i?d(T):null},_f}var Sf,_b;function Rk(){if(_b)return Sf;_b=1;var r=xk();return Sf=function(t){return!!r(t)},Sf}var Mk=Nl,Pk=jT,Ik=Pk("TypedArray.prototype.buffer",!0),Ok=Rk(),$k=Ik||function(e){if(!Ok(e))throw new Mk("Not a Typed Array");return e.buffer},ai=ys.Buffer,Dk=lq,Lk=$k,qk=ArrayBuffer.isView||function(e){try{return Lk(e),!0}catch(t){return!1}},kk=typeof Uint8Array!="undefined",WT=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",Bk=WT&&(ai.prototype instanceof Uint8Array||ai.TYPED_ARRAY_SUPPORT),Fk=function(e,t){if(e instanceof ai)return e;if(typeof e=="string")return ai.from(e,t);if(WT&&qk(e)){if(e.byteLength===0)return ai.alloc(0);if(Bk){var n=ai.from(e.buffer,e.byteOffset,e.byteLength);if(n.byteLength===e.byteLength)return n}var i=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s=ai.from(i);if(s.length===e.byteLength)return s}if(kk&&e instanceof Uint8Array)return ai.from(e);var a=Dk(e);if(a)for(var o=0;o<e.length;o+=1){var l=e[o];if(typeof l!="number"||l<0||l>255||~~l!==l)throw new RangeError("Array items must be numbers in the range 0-255.")}if(a||ai.isBuffer(e)&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e))return ai.from(e);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},Uk=ys.Buffer,Vk=Fk;function ah(r,e){this._block=Uk.alloc(r),this._finalSize=e,this._blockSize=r,this._len=0}ah.prototype.update=function(r,e){r=Vk(r,e||"utf8");for(var t=this._block,n=this._blockSize,i=r.length,s=this._len,a=0;a<i;){for(var o=s%n,l=Math.min(i-a,n-o),c=0;c<l;c++)t[o+c]=r[a+c];s+=l,a+=l,s%n===0&&this._update(t)}return this._len+=i,this};ah.prototype.digest=function(r){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var t=this._len*8;if(t<=4294967295)this._block.writeUInt32BE(t,this._blockSize-4);else{var n=(t&4294967295)>>>0,i=(t-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var s=this._hash();return r?s.toString(r):s};ah.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var ao=ah,jk=so,HT=ao,Wk=ys.Buffer,Hk=[1518500249,1859775393,-1894007588,-899497514],Qk=new Array(80);function Pl(){this.init(),this._w=Qk,HT.call(this,64,56)}jk(Pl,HT);Pl.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function zk(r){return r<<5|r>>>27}function Gk(r){return r<<30|r>>>2}function Kk(r,e,t,n){return r===0?e&t|~e&n:r===2?e&t|e&n|t&n:e^t^n}Pl.prototype._update=function(r){for(var e=this._w,t=this._a|0,n=this._b|0,i=this._c|0,s=this._d|0,a=this._e|0,o=0;o<16;++o)e[o]=r.readInt32BE(o*4);for(;o<80;++o)e[o]=e[o-3]^e[o-8]^e[o-14]^e[o-16];for(var l=0;l<80;++l){var c=~~(l/20),u=zk(t)+Kk(c,n,i,s)+a+e[l]+Hk[c]|0;a=s,s=i,i=Gk(n),n=t,t=u}this._a=t+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0};Pl.prototype._hash=function(){var r=Wk.allocUnsafe(20);return r.writeInt32BE(this._a|0,0),r.writeInt32BE(this._b|0,4),r.writeInt32BE(this._c|0,8),r.writeInt32BE(this._d|0,12),r.writeInt32BE(this._e|0,16),r};var Yk=Pl,Jk=so,QT=ao,Xk=ys.Buffer,Zk=[1518500249,1859775393,-1894007588,-899497514],eB=new Array(80);function Il(){this.init(),this._w=eB,QT.call(this,64,56)}Jk(Il,QT);Il.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function tB(r){return r<<1|r>>>31}function nB(r){return r<<5|r>>>27}function rB(r){return r<<30|r>>>2}function iB(r,e,t,n){return r===0?e&t|~e&n:r===2?e&t|e&n|t&n:e^t^n}Il.prototype._update=function(r){for(var e=this._w,t=this._a|0,n=this._b|0,i=this._c|0,s=this._d|0,a=this._e|0,o=0;o<16;++o)e[o]=r.readInt32BE(o*4);for(;o<80;++o)e[o]=tB(e[o-3]^e[o-8]^e[o-14]^e[o-16]);for(var l=0;l<80;++l){var c=~~(l/20),u=nB(t)+iB(c,n,i,s)+a+e[l]+Zk[c]|0;a=s,s=i,i=rB(n),n=t,t=u}this._a=t+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0};Il.prototype._hash=function(){var r=Xk.allocUnsafe(20);return r.writeInt32BE(this._a|0,0),r.writeInt32BE(this._b|0,4),r.writeInt32BE(this._c|0,8),r.writeInt32BE(this._d|0,12),r.writeInt32BE(this._e|0,16),r};var sB=Il,aB=so,zT=ao,oB=ys.Buffer,lB=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],cB=new Array(64);function Ol(){this.init(),this._w=cB,zT.call(this,64,56)}aB(Ol,zT);Ol.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function uB(r,e,t){return t^r&(e^t)}function hB(r,e,t){return r&e|t&(r|e)}function fB(r){return(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10)}function dB(r){return(r>>>6|r<<26)^(r>>>11|r<<21)^(r>>>25|r<<7)}function pB(r){return(r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3}function mB(r){return(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10}Ol.prototype._update=function(r){for(var e=this._w,t=this._a|0,n=this._b|0,i=this._c|0,s=this._d|0,a=this._e|0,o=this._f|0,l=this._g|0,c=this._h|0,u=0;u<16;++u)e[u]=r.readInt32BE(u*4);for(;u<64;++u)e[u]=mB(e[u-2])+e[u-7]+pB(e[u-15])+e[u-16]|0;for(var h=0;h<64;++h){var f=c+dB(a)+uB(a,o,l)+lB[h]+e[h]|0,d=fB(t)+hB(t,n,i)|0;c=l,l=o,o=a,a=s+f|0,s=i,i=n,n=t,t=f+d|0}this._a=t+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0,this._f=o+this._f|0,this._g=l+this._g|0,this._h=c+this._h|0};Ol.prototype._hash=function(){var r=oB.allocUnsafe(32);return r.writeInt32BE(this._a,0),r.writeInt32BE(this._b,4),r.writeInt32BE(this._c,8),r.writeInt32BE(this._d,12),r.writeInt32BE(this._e,16),r.writeInt32BE(this._f,20),r.writeInt32BE(this._g,24),r.writeInt32BE(this._h,28),r};var GT=Ol,yB=so,gB=GT,bB=ao,EB=ys.Buffer,wB=new Array(64);function oh(){this.init(),this._w=wB,bB.call(this,64,56)}yB(oh,gB);oh.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};oh.prototype._hash=function(){var r=EB.allocUnsafe(28);return r.writeInt32BE(this._a,0),r.writeInt32BE(this._b,4),r.writeInt32BE(this._c,8),r.writeInt32BE(this._d,12),r.writeInt32BE(this._e,16),r.writeInt32BE(this._f,20),r.writeInt32BE(this._g,24),r};var vB=oh,TB=so,KT=ao,_B=ys.Buffer,Sb=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],SB=new Array(160);function $l(){this.init(),this._w=SB,KT.call(this,128,112)}TB($l,KT);$l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function Cb(r,e,t){return t^r&(e^t)}function Nb(r,e,t){return r&e|t&(r|e)}function Ab(r,e){return(r>>>28|e<<4)^(e>>>2|r<<30)^(e>>>7|r<<25)}function xb(r,e){return(r>>>14|e<<18)^(r>>>18|e<<14)^(e>>>9|r<<23)}function CB(r,e){return(r>>>1|e<<31)^(r>>>8|e<<24)^r>>>7}function NB(r,e){return(r>>>1|e<<31)^(r>>>8|e<<24)^(r>>>7|e<<25)}function AB(r,e){return(r>>>19|e<<13)^(e>>>29|r<<3)^r>>>6}function xB(r,e){return(r>>>19|e<<13)^(e>>>29|r<<3)^(r>>>6|e<<26)}function Rn(r,e){return r>>>0<e>>>0?1:0}$l.prototype._update=function(r){for(var e=this._w,t=this._ah|0,n=this._bh|0,i=this._ch|0,s=this._dh|0,a=this._eh|0,o=this._fh|0,l=this._gh|0,c=this._hh|0,u=this._al|0,h=this._bl|0,f=this._cl|0,d=this._dl|0,m=this._el|0,y=this._fl|0,T=this._gl|0,b=this._hl|0,S=0;S<32;S+=2)e[S]=r.readInt32BE(S*4),e[S+1]=r.readInt32BE(S*4+4);for(;S<160;S+=2){var N=e[S-30],C=e[S-15*2+1],I=CB(N,C),H=NB(C,N);N=e[S-2*2],C=e[S-2*2+1];var Q=AB(N,C),te=xB(C,N),V=e[S-7*2],J=e[S-7*2+1],E=e[S-16*2],A=e[S-16*2+1],x=H+J|0,$=I+V+Rn(x,H)|0;x=x+te|0,$=$+Q+Rn(x,te)|0,x=x+A|0,$=$+E+Rn(x,A)|0,e[S]=$,e[S+1]=x}for(var B=0;B<160;B+=2){$=e[B],x=e[B+1];var K=Nb(t,n,i),ae=Nb(u,h,f),ue=Ab(t,u),L=Ab(u,t),Se=xb(a,m),Ae=xb(m,a),ve=Sb[B],Ye=Sb[B+1],mt=Cb(a,o,l),et=Cb(m,y,T),ut=b+Ae|0,Ee=c+Se+Rn(ut,b)|0;ut=ut+et|0,Ee=Ee+mt+Rn(ut,et)|0,ut=ut+Ye|0,Ee=Ee+ve+Rn(ut,Ye)|0,ut=ut+x|0,Ee=Ee+$+Rn(ut,x)|0;var $e=L+ae|0,z=ue+K+Rn($e,L)|0;c=l,b=T,l=o,T=y,o=a,y=m,m=d+ut|0,a=s+Ee+Rn(m,d)|0,s=i,d=f,i=n,f=h,n=t,h=u,u=ut+$e|0,t=Ee+z+Rn(u,ut)|0}this._al=this._al+u|0,this._bl=this._bl+h|0,this._cl=this._cl+f|0,this._dl=this._dl+d|0,this._el=this._el+m|0,this._fl=this._fl+y|0,this._gl=this._gl+T|0,this._hl=this._hl+b|0,this._ah=this._ah+t+Rn(this._al,u)|0,this._bh=this._bh+n+Rn(this._bl,h)|0,this._ch=this._ch+i+Rn(this._cl,f)|0,this._dh=this._dh+s+Rn(this._dl,d)|0,this._eh=this._eh+a+Rn(this._el,m)|0,this._fh=this._fh+o+Rn(this._fl,y)|0,this._gh=this._gh+l+Rn(this._gl,T)|0,this._hh=this._hh+c+Rn(this._hl,b)|0};$l.prototype._hash=function(){var r=_B.allocUnsafe(64);function e(t,n,i){r.writeInt32BE(t,i),r.writeInt32BE(n,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),r};var YT=$l,RB=so,MB=YT,PB=ao,IB=ys.Buffer,OB=new Array(160);function lh(){this.init(),this._w=OB,PB.call(this,128,112)}RB(lh,MB);lh.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};lh.prototype._hash=function(){var r=IB.allocUnsafe(48);function e(t,n,i){r.writeInt32BE(t,i),r.writeInt32BE(n,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),r};var $B=lh;(function(r){r.exports=function(t){var n=t.toLowerCase(),i=r.exports[n];if(!i)throw new Error(n+" is not supported (we accept pull requests)");return new i},r.exports.sha=Yk,r.exports.sha1=sB,r.exports.sha224=vB,r.exports.sha256=GT,r.exports.sha384=$B,r.exports.sha512=YT})(MT);var DB=MT.exports;const LB=th(DB);function Cf(r,e=!1){return e&&(r=" "+r),r.replace(/^([A-Z])|[\s-_](\w)/g,function(t,n,i){return i?i.toUpperCase():n.toLowerCase()})}function Rb(r){return r.replace(/([A-Z])([A-Z])([a-z])/g,"$1_$2$3").replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase()}function qB(r){return r.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())}function JT(r,e={}){const{segmentLength:t=4,separator:n="__",termLength:i=2}=e;return r.split(n).reduce((o,l)=>{const c=l.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),u=c.length>1?i:t,h=c.map(f=>f.substr(0,u)).join("");return o.push(h),o},[]).join(n)}function kB(r,e={}){const t=LB("sha1");t.update(r,"utf8");const n=t.digest("hex");return e.length&&e.length>0?n.slice(0,e.length):n}class BB{static isGreaterOrEqual(e,t){if(!e)return!1;const n=Mb(e),i=Mb(t);for(let s=0;s<n.length&&s<i.length;s++){if(n[s]>i[s])return!0;if(n[s]<i[s])return!1}return!0}}function Mb(r){return r.split(".").map(e=>parseInt(e,10))}class Be{static isSQLiteFamily(e){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(e.options.type)}static isMySQLFamily(e){return["mysql","mariadb"].includes(e.options.type)}static isReleaseVersionOrGreater(e,t){return BB.isGreaterOrEqual(e.version,t)}static isPostgresFamily(e){return["postgres","aurora-postgres","cockroachdb"].includes(e.options.type)}static buildDriverOptions(e,t){if(e.url){const n=this.parseConnectionUrl(e.url);t&&t.useSid&&n.database&&(n.sid=n.database);for(const i of Object.keys(n))typeof n[i]=="undefined"&&delete n[i];return Object.assign({},e,n)}return Object.assign({},e)}static buildMongoDBDriverOptions(e,t){if(e.url){const n=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&n.database&&(n.sid=n.database);for(const i of Object.keys(n))typeof n[i]=="undefined"&&delete n[i];return Object.assign({},e,n)}return Object.assign({},e)}static buildAlias({maxAliasLength:e},t,...n){const i=t&&t.joiner?t.joiner:"_",s=n.length===1?n[0]:n.join(i);if(e&&e>0&&s.length>e){if(t&&t.shorten===!0){const a=JT(s);if(a.length<e)return a}return kB(s,{length:e})}return s}static buildColumnAlias({maxAliasLength:e},t,...n){return typeof t=="string"?(n.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t),this.buildAlias({maxAliasLength:e},t,...n)}static parseConnectionUrl(e){const t=e.split(":")[0],n=e.indexOf("//"),i=e.substr(n+2),s=i.indexOf("/"),a=s!==-1?i.substr(0,s):i;let o=s!==-1?i.substr(s+1):void 0;o&&o.indexOf("?")!==-1&&(o=o.substr(0,o.indexOf("?")));const l=a.lastIndexOf("@"),c=a.substr(0,l),u=a.substr(l+1);let h=c,f="";const d=c.indexOf(":");d!==-1&&(h=c.substr(0,d),f=c.substr(d+1));const[m,y]=u.split(":");return{type:t,host:m,username:decodeURIComponent(h),password:decodeURIComponent(f),port:y?parseInt(y):void 0,database:o||void 0}}static parseMongoDBConnectionUrl(e){const t=e.split(":")[0],n=e.indexOf("//"),i=e.substr(n+2),s=i.indexOf("/"),a=s!==-1?i.substr(0,s):i;let o=s!==-1?i.substr(s+1):void 0,l="",c,u,h,f;const d={};if(o&&o.indexOf("?")!==-1){l=o.substr(o.indexOf("?")+1,o.length);const I=l.split("&");let H,Q;I.forEach(te=>{H=te.split("=")[0],Q=te.split("=")[1],d[H]=Q}),f=d.replicaSet,o=o.substr(0,o.indexOf("?"))}const m=a.lastIndexOf("@"),y=a.substr(0,m),T=a.substr(m+1);let b=y,S="";const N=y.indexOf(":");N!==-1&&(b=y.substr(0,N),S=y.substr(N+1)),f?h=T:[c,u]=T.split(":");const C={type:t,host:c,hostReplicaSet:h,username:decodeURIComponent(b),password:decodeURIComponent(S),port:u?parseInt(u):void 0,database:o||void 0};for(const[I,H]of Object.entries(d))C[I]=H;return C}}class XT{constructor(e,t,n){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,n&&_t.assign(this,n)}get isMany(){return this.isMappingMany!==void 0?this.isMappingMany:this.relation?this.relation.isManyToMany||this.relation.isOneToMany:!1}get isSelected(){if(!this.isSelectedEvaluated){const e=()=>{for(const t of this.queryExpressionMap.selects)if(t.selection===this.alias.name||this.metadata&&this.metadata.columns.find(n=>t.selection===this.alias.name+"."+n.propertyPath))return!0;return!1};this.isSelectedCache=e(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(hi.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(hi.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){const e=()=>{if(!hi.isAliasProperty(this.entityOrProperty))return;const t=this.queryExpressionMap.findAliasByName(this.parentAlias);let n=t.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(n||t.metadata.parentEntityMetadata&&(n=t.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),n))return n;throw new Z(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=e.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){if(this.relation)return this.relation.inverseEntityMetadata;if(this.connection.hasMetadata(this.entityOrProperty))return this.connection.getMetadata(this.entityOrProperty);if(this.mapAsEntity&&this.connection.hasMetadata(this.mapAsEntity))return this.connection.getMetadata(this.mapAsEntity)}get junctionAlias(){if(!this.relation)throw new Z("Cannot get junction table for join without relation.");if(typeof this.entityOrProperty!="string")throw new Z("Junction property is not defined.");const e=this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."));return this.relation.isOwning?Be.buildAlias(this.connection.driver,void 0,e,this.alias.name):Be.buildAlias(this.connection.driver,void 0,this.alias.name,e)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}class Hp{constructor(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,_t.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value must be a string representation of alias property");const t=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!t)throw new Z(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return t}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}class Qp{constructor(e,t){this.expressionMap=e,_t.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rc"}get relation(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value is a string representation of alias property");const[e,t]=this.relationName.split("."),i=this.expressionMap.findAliasByName(e).metadata.findRelationWithPropertyPath(t);if(!i)throw new Z(`Relation with property path ${t} in entity was not found.`);return i}get metadata(){if(!hi.isAliasProperty(this.relationName))throw new Z("Given value is a string representation of alias property");const e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}class zp{constructor(e){var t;this.connection=e,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],e.options.relationLoadStrategy&&(this.relationLoadStrategy=e.options.relationLoadStrategy),this.timeTravel=((t=e.options)==null?void 0:t.timeTravelQueries)||!1}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&this.options.indexOf("disable-global-order")===-1){const e=this.mainAlias.metadata.orderBy||{};return Object.keys(e).reduce((t,n)=>(t[this.mainAlias.name+"."+n]=e[n],t),{})}return this.orderBys}setMainAlias(e){return this.mainAlias=e,e}createAlias(e){let t=e.name;!t&&e.tablePath&&(t=e.tablePath),!t&&typeof e.target=="function"&&(t=e.target.name),!t&&typeof e.target=="string"&&(t=e.target);const n=new tb;return n.type=e.type,t&&(n.name=t),e.metadata&&(n.metadata=e.metadata),e.target&&!n.hasMetadata&&(n.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(n.tablePath=e.tablePath),e.subQuery&&(n.subQuery=e.subQuery),this.aliases.push(n),n}findAliasByName(e){const t=this.aliases.find(n=>n.name===e);if(!t)throw new Z(`"${e}" alias was not found. Maybe you forgot to join it?`);return t}findColumnByAliasExpression(e){const[t,n]=e.split(".");return this.findAliasByName(t).metadata.findColumnWithPropertyName(n)}get relationMetadata(){if(!this.mainAlias)throw new Z("Entity to work with is not specified!");const e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new Z(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return e}clone(){const e=new zp(this.connection);return e.queryType=this.queryType,e.selects=this.selects.map(t=>t),e.maxExecutionTime=this.maxExecutionTime,e.selectDistinct=this.selectDistinct,e.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach(t=>e.aliases.push(new tb(t))),e.relationLoadStrategy=this.relationLoadStrategy,e.mainAlias=this.mainAlias,e.valuesSet=this.valuesSet,e.returning=this.returning,e.onConflict=this.onConflict,e.onIgnore=this.onIgnore,e.onUpdate=this.onUpdate,e.joinAttributes=this.joinAttributes.map(t=>new XT(this.connection,this,t)),e.relationIdAttributes=this.relationIdAttributes.map(t=>new Hp(this,t)),e.relationCountAttributes=this.relationCountAttributes.map(t=>new Qp(this,t)),e.wheres=this.wheres.map(t=>Xe({},t)),e.havings=this.havings.map(t=>Xe({},t)),e.orderBys=Object.assign({},this.orderBys),e.groupBys=this.groupBys.map(t=>t),e.limit=this.limit,e.offset=this.offset,e.skip=this.skip,e.take=this.take,e.useIndex=this.useIndex,e.lockMode=this.lockMode,e.onLocked=this.onLocked,e.lockVersion=this.lockVersion,e.lockTables=this.lockTables,e.withDeleted=this.withDeleted,e.parameters=Object.assign({},this.parameters),e.disableEscaping=this.disableEscaping,e.enableRelationIdValues=this.enableRelationIdValues,e.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,e.subQuery=this.subQuery,e.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,e.cache=this.cache,e.cacheId=this.cacheId,e.cacheDuration=this.cacheDuration,e.relationPropertyPath=this.relationPropertyPath,e.of=this.of,e.insertColumns=this.insertColumns,e.whereEntities=this.whereEntities,e.updateEntity=this.updateEntity,e.callListeners=this.callListeners,e.useTransaction=this.useTransaction,e.timeTravel=this.timeTravel,e.nativeParameters=Object.assign({},this.nativeParameters),e.comment=this.comment,e.commonTableExpressions=this.commonTableExpressions.map(t=>({alias:t.alias,queryBuilder:typeof t.queryBuilder=="string"?t.queryBuilder:t.queryBuilder.clone(),options:t.options})),e}}class uu{constructor(e){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=e}}class An{static transformFrom(e,t){return Array.isArray(e)?e.slice().reverse().reduce((i,s)=>s.from(i),t):e.from(t)}static transformTo(e,t){return Array.isArray(e)?e.reduce((n,i)=>i.to(n),t):e.to(t)}}class Dl{constructor(e,t,n=!0,i=!1,s,a){this["@instanceof"]=Symbol.for("FindOperator"),this._type=e,this._value=t,this._useParameter=n,this._multipleParameters=i,this._getSql=s,this._objectLiteralParameters=a}get useParameter(){return de.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return de.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return de.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return de.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(de.isFindOperator(this._value))return this._value}get getSql(){return de.isFindOperator(this._value)?this._value.getSql:this._getSql}transformValue(e){this._value instanceof Dl?this._value.transformValue(e):this._value=Array.isArray(this._value)&&this._multipleParameters?this._value.map(t=>e&&An.transformTo(e,t)):An.transformTo(e,this._value)}}function FB(r){return new Dl("in",r,!0,!0)}const UB=/[.*+\-?^${}()|[\]\\]/g,VB=r=>r.replace(UB,"\\$&");class pn{constructor(e,t){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,de.isDataSource(e)?(this.connection=e,this.queryRunner=t,this.expressionMap=new zp(this.connection)):(this.connection=e.connection,this.queryRunner=e.queryRunner,this.expressionMap=e.expressionMap.clone())}static registerQueryBuilderClass(e,t){pn.queryBuilderRegistry[e]=t}get alias(){if(!this.expressionMap.mainAlias)throw new Z("Main alias is not set");return this.expressionMap.mainAlias.name}select(e,t){return this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map(n=>({selection:n})):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]),de.isSelectQueryBuilder(this)?this:pn.queryBuilderRegistry.SelectQueryBuilder(this)}insert(){return this.expressionMap.queryType="insert",de.isInsertQueryBuilder(this)?this:pn.queryBuilderRegistry.InsertQueryBuilder(this)}update(e,t){const n=t||e;if(e=de.isEntitySchema(e)?e.options.name:e,typeof e=="function"||typeof e=="string"){const i=this.createFromAlias(e);this.expressionMap.setMainAlias(i)}return this.expressionMap.queryType="update",this.expressionMap.valuesSet=n,de.isUpdateQueryBuilder(this)?this:pn.queryBuilderRegistry.UpdateQueryBuilder(this)}delete(){return this.expressionMap.queryType="delete",de.isDeleteQueryBuilder(this)?this:pn.queryBuilderRegistry.DeleteQueryBuilder(this)}softDelete(){return this.expressionMap.queryType="soft-delete",de.isSoftDeleteQueryBuilder(this)?this:pn.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}restore(){return this.expressionMap.queryType="restore",de.isSoftDeleteQueryBuilder(this)?this:pn.queryBuilderRegistry.SoftDeleteQueryBuilder(this)}relation(e,t){const n=arguments.length===2?e:void 0,i=arguments.length===2?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=i,n){const s=this.createFromAlias(n);this.expressionMap.setMainAlias(s)}return de.isRelationQueryBuilder(this)?this:pn.queryBuilderRegistry.RelationQueryBuilder(this)}hasRelation(e,t){const n=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every(s=>!!n.findRelationWithPropertyPath(s))}hasParameter(e){var t;return((t=this.parentQueryBuilder)==null?void 0:t.hasParameter(e))||e in this.expressionMap.parameters}setParameter(e,t){if(typeof t=="function")throw new Z(`Function parameter isn't supported in the parameters. Please check "${e}" parameter.`);if(!e.match(/^([A-Za-z0-9_.]+)$/))throw new Z("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(e,t),this.expressionMap.parameters[e]=t,this}setParameters(e){for(const[t,n]of Object.entries(e))this.setParameter(t,n);return this}createParameter(e){let t;do t=`orm_param_${this.parameterIndex++}`;while(this.hasParameter(t));return this.setParameter(t,e),`:${t}`}setNativeParameters(e){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach(t=>{this.expressionMap.nativeParameters[t]=e[t]}),this}getParameters(){const e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){const n=t.childEntityMetadatas.filter(i=>i.discriminatorColumn).map(i=>i.discriminatorValue);n.push(t.discriminatorValue),e.discriminatorColumnValues=n}}return e}printSql(){const[e,t]=this.getQueryAndParameters();return this.connection.logger.logQuery(e,t),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)}execute(){return v(this,null,function*(){const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();try{return yield n.query(e,t)}finally{n!==this.queryRunner&&(yield n.release())}})}createQueryBuilder(e){return new this.constructor(this.connection,e!=null?e:this.queryRunner)}clone(){return new this.constructor(this)}comment(e){return this.expressionMap.comment=e,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e}setQueryRunner(e){return this.queryRunner=e,this}callListeners(e){return this.expressionMap.callListeners=e,this}useTransaction(e){return this.expressionMap.useTransaction=e,this}addCommonTableExpression(e,t,n){return this.expressionMap.commonTableExpressions.push({queryBuilder:e,alias:t,options:n||{}}),this}getTableName(e){return e.split(".").map(t=>t===""?t:this.escape(t)).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new Z('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(e,t){if(this.connection.hasMetadata(e)){const n=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:n.tablePath})}else{if(typeof e=="string"){const s=e.substr(0,1)==="("&&e.substr(-1)===")";return this.expressionMap.createAlias({type:"from",name:t,tablePath:s?void 0:e,subQuery:s?e:void 0})}const n=e(this.subQuery());this.setParameters(n.getParameters());const i=n.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:i})}}replacePropertyNames(e){return e}replacePropertyNamesForTheWholeQuery(e){const t={};for(const s of this.expressionMap.aliases){if(!s.hasMetadata)continue;const a=this.expressionMap.aliasNamePrefixingEnabled&&s.name?`${s.name}.`:"";t[a]||(t[a]={});for(const o of s.metadata.relations)o.joinColumns.length>0&&(t[a][o.propertyPath]=o.joinColumns[0].databaseName);for(const o of s.metadata.relations){const l=[...o.joinColumns,...o.inverseJoinColumns];for(const c of l){const u=`${o.propertyPath}.${c.referencedColumn.propertyPath}`;t[a][u]=c.databaseName}}for(const o of s.metadata.columns)t[a][o.databaseName]=o.databaseName;for(const o of s.metadata.columns)t[a][o.propertyName]=o.databaseName;for(const o of s.metadata.columns)t[a][o.propertyPath]=o.databaseName}const n=Object.keys(t),i=n.map(s=>VB(s)).join("|");return n.length>0&&(e=e.replace(new RegExp(`([ =(]|^.{0})${i?"("+i+")":""}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),(...s)=>{let a,o,l;if(i){if(a=s[0],o=s[1],l=s[3],t[s[2]][l])return`${o}${this.escape(s[2].substring(0,s[2].length-1))}.${this.escape(t[s[2]][l])}`}else if(a=s[0],o=s[1],l=s[2],t[""][l])return`${o}${this.escape(t[""][l])}`;return a})),e}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace(/\*\//g,"")} */ `:""}createTimeTravelQuery(){return this.expressionMap.queryType==="select"&&this.expressionMap.timeTravel?` AS OF SYSTEM TIME ${this.expressionMap.timeTravel}`:""}createWhereExpression(){const e=[],t=this.createWhereClausesExpression(this.expressionMap.wheres);if(t.length>0&&t!=="1=1"&&e.push(this.replacePropertyNames(t)),this.expressionMap.mainAlias.hasMetadata){const i=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&i.deleteDateColumn){const s=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.deleteDateColumn.propertyName:i.deleteDateColumn.propertyName,a=`${this.replacePropertyNames(s)} IS NULL`;e.push(a)}if(i.discriminatorColumn&&i.parentEntityMetadata){const s=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.discriminatorColumn.databaseName:i.discriminatorColumn.databaseName,a=`${this.replacePropertyNames(s)} IN (:...discriminatorColumnValues)`;e.push(a)}}if(this.expressionMap.extraAppendedAndWhereCondition){const i=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(i)}let n="";return n+=this.createTimeTravelQuery(),e.length?e.length===1?n+=` WHERE ${e[0]}`:n+=` WHERE ( ${e.join(" ) AND ( ")} )`:n+="",n}createReturningExpression(e){const t=this.getReturningColumns(),n=this.connection.driver;if(typeof this.expressionMap.returning!="string"&&this.expressionMap.extraReturningColumns.length>0&&n.isReturningSqlSupported(e)&&t.push(...this.expressionMap.extraReturningColumns.filter(i=>t.indexOf(i)===-1)),t.length){let i=t.map(s=>{const a=this.escape(s.databaseName);return n.options.type==="mssql"?this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update"||this.expressionMap.queryType==="soft-delete"||this.expressionMap.queryType==="restore"?"INSERTED."+a:this.escape(this.getMainTableName())+"."+a:a}).join(", ");return n.options.type==="oracle"&&(i+=" INTO "+t.map(s=>this.createParameter({type:n.columnTypeToNativeParameter(s.type),dir:n.oracle.BIND_OUT})).join(", ")),n.options.type==="mssql"&&(this.expressionMap.queryType==="insert"||this.expressionMap.queryType==="update")&&(i+=" INTO @OutputTable"),i}else if(typeof this.expressionMap.returning=="string")return this.expressionMap.returning;return""}getReturningColumns(){const e=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach(t=>{this.expressionMap.mainAlias.hasMetadata&&e.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(t))}),e}createWhereClausesExpression(e){return e.map((t,n)=>{const i=this.createWhereConditionExpression(t.condition);switch(t.type){case"and":return(n>0?"AND ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${i}${this.connection.options.isolateWhereStatements?")":""}`;case"or":return(n>0?"OR ":"")+`${this.connection.options.isolateWhereStatements?"(":""}${i}${this.connection.options.isolateWhereStatements?")":""}`}return i}).join(" ").trim()}createWhereConditionExpression(e,t=!1){if(typeof e=="string")return e;if(Array.isArray(e))return e.length===0?"1=1":e.length===1&&!t?this.createWhereClausesExpression(e):"("+this.createWhereClausesExpression(e)+")";const{driver:n}=this.connection;switch(e.operator){case"lessThan":return`${e.parameters[0]} < ${e.parameters[1]}`;case"lessThanOrEqual":return`${e.parameters[0]} <= ${e.parameters[1]}`;case"arrayContains":return`${e.parameters[0]} @> ${e.parameters[1]}`;case"jsonContains":return`${e.parameters[0]} ::jsonb @> ${e.parameters[1]}`;case"arrayContainedBy":return`${e.parameters[0]} <@ ${e.parameters[1]}`;case"arrayOverlap":return`${e.parameters[0]} && ${e.parameters[1]}`;case"moreThan":return`${e.parameters[0]} > ${e.parameters[1]}`;case"moreThanOrEqual":return`${e.parameters[0]} >= ${e.parameters[1]}`;case"notEqual":return`${e.parameters[0]} != ${e.parameters[1]}`;case"equal":return`${e.parameters[0]} = ${e.parameters[1]}`;case"ilike":return n.options.type==="postgres"||n.options.type==="cockroachdb"?`${e.parameters[0]} ILIKE ${e.parameters[1]}`:`UPPER(${e.parameters[0]}) LIKE UPPER(${e.parameters[1]})`;case"like":return`${e.parameters[0]} LIKE ${e.parameters[1]}`;case"between":return`${e.parameters[0]} BETWEEN ${e.parameters[1]} AND ${e.parameters[2]}`;case"in":return e.parameters.length<=1?"0=1":`${e.parameters[0]} IN (${e.parameters.slice(1).join(", ")})`;case"any":return n.options.type==="cockroachdb"?`${e.parameters[0]}::STRING = ANY(${e.parameters[1]}::STRING[])`:`${e.parameters[0]} = ANY(${e.parameters[1]})`;case"isNull":return`${e.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(e.condition)})`;case"brackets":return`${this.createWhereConditionExpression(e.condition,!0)}`;case"and":return"("+e.parameters.join(" AND ")+")";case"or":return"("+e.parameters.join(" OR ")+")"}throw new TypeError(`Unsupported FindOperator ${Dl.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const e=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map(n=>{let i=typeof n.queryBuilder=="string"?n.queryBuilder:"";if(typeof n.queryBuilder!="string"){if(n.queryBuilder.hasCommonTableExpressions())throw new Z(`Nested CTEs aren't supported (CTE: ${n.alias})`);if(i=n.queryBuilder.getQuery(),!this.connection.driver.cteCapabilities.writable&&!de.isSelectQueryBuilder(n.queryBuilder))throw new Z(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${n.alias})`);this.setParameters(n.queryBuilder.getParameters())}let s=this.escape(n.alias);if(n.options.columnNames){const l=n.options.columnNames.map(c=>this.escape(c));if(de.isSelectQueryBuilder(n.queryBuilder)&&n.queryBuilder.expressionMap.selects.length&&n.options.columnNames.length!==n.queryBuilder.expressionMap.selects.length)throw new Z(`cte.options.columnNames length (${n.options.columnNames.length}) doesn't match subquery select list length ${n.queryBuilder.expressionMap.selects.length} (CTE: ${n.alias})`);s+=`(${l.join(", ")})`}const a=n.options.recursive&&e?"RECURSIVE":"";let o="";return this.connection.driver.cteCapabilities.materializedHint&&n.options.materialized!==void 0&&(o=n.options.materialized?"MATERIALIZED":"NOT MATERIALIZED"),[a,s,"AS",o,`(${i})`].filter(Boolean).join(" ")}).join(", ")+" "}getWhereInIdsCondition(e){const t=this.expressionMap.mainAlias.metadata,n=(Array.isArray(e)?e:[e]).map(i=>t.ensureEntityIdMap(i));if(!t.hasMultiplePrimaryKeys){const i=t.primaryColumns[0];if(!i.transformer&&!i.relationMetadata&&!i.embeddedMetadata)return{[i.propertyName]:FB(n.map(s=>i.getEntityValue(s,!1)))}}return new uu(i=>{for(const s of n)i.orWhere(new uu(a=>a.where(s)))})}getExistsCondition(e){const t=e.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select("1").setOption("disable-global-order");return[`EXISTS (${t.getQuery()})`,t.getParameters()]}findColumnsForPropertyPath(e){let t=this.expressionMap.mainAlias;const n=[],i=e.split(".");for(;i.length>1;){const o=i[0];if(!(t!=null&&t.hasMetadata))break;if(t.metadata.hasEmbeddedWithPropertyPath(o)){i.unshift(`${i.shift()}.${i.shift()}`);continue}if(t.metadata.hasRelationWithPropertyPath(o)){const l=this.expressionMap.joinAttributes.find(c=>c.relationPropertyPath===o);if(!(l!=null&&l.alias)){const c=n.length>0?`${n.join(".")}.${o}`:o;throw new Error(`Cannot find alias for relation at ${c}`)}t=l.alias,n.push(...o.split(".")),i.shift();continue}break}if(!t)throw new Error(`Cannot find alias for property ${e}`);const s=i.join("."),a=t.metadata.findColumnsWithPropertyPath(s);if(!a.length)throw new Wr(e,t.metadata);return[t,n,a]}createPropertyPath(e,t,n=""){const i=[];for(const s of Object.keys(t)){const a=n?`${n}.${s}`:s;if(t[s]===null||typeof t[s]!="object"||de.isFindOperator(t[s])){i.push(a);continue}if(e.hasEmbeddedWithPropertyPath(a)){const o=this.createPropertyPath(e,t[s],a);i.push(...o);continue}if(e.hasRelationWithPropertyPath(a)){const o=e.findRelationWithPropertyPath(a);if(o.relationType==="one-to-one"||o.relationType==="many-to-one"){const h=o.joinColumns.map(d=>d.referencedColumn).filter(d=>!!d);if(h.length>0&&h.every(d=>d.getEntityValue(t[s],!1))){i.push(a);continue}}if(o.relationType==="one-to-many"||o.relationType==="many-to-many")throw new Error(`Cannot query across ${o.relationType} for property ${a}`);const l=o.inverseEntityMetadata.primaryColumns;if(l.length>0&&l.every(h=>h.getEntityValue(t[s],!1))){const h=l.map(f=>`${a}.${f.propertyPath}`);i.push(...h);continue}const u=this.createPropertyPath(o.inverseEntityMetadata,t[s]).map(h=>`${a}.${h}`);i.push(...u);continue}i.push(a)}return i}*getPredicates(e){if(this.expressionMap.mainAlias.hasMetadata){const t=this.createPropertyPath(this.expressionMap.mainAlias.metadata,e);for(const n of t){const[i,s,a]=this.findColumnsForPropertyPath(n);for(const o of a){let l=e;for(const h of s){if(!l||!(h in l)){l={};break}l=l[h]}const c=this.expressionMap.aliasNamePrefixingEnabled?`${i.name}.${o.propertyPath}`:o.propertyPath,u=o.getEntityValue(l,!0);yield[c,u]}}}else for(const t of Object.keys(e)){const n=e[t];yield[this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${t}`:t,n]}}getWherePredicateCondition(e,t){var n,i;if(de.isFindOperator(t)){const s=[];if(t.useParameter)if(t.objectLiteralParameters)this.setParameters(t.objectLiteralParameters);else if(t.multipleParameters)for(const a of t.value)s.push(this.createParameter(a));else s.push(this.createParameter(t.value));if(t.type==="raw")return t.getSql?t.getSql(e):{operator:"equal",parameters:[e,t.value]};if(t.type==="not")return t.child?{operator:t.type,condition:this.getWherePredicateCondition(e,t.child)}:{operator:"notEqual",parameters:[e,...s]};if(t.type==="and"){const a=t.value;return{operator:t.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(e,o)))}}else if(t.type==="or"){const a=t.value;return{operator:t.type,parameters:a.map(o=>this.createWhereConditionExpression(this.getWherePredicateCondition(e,o)))}}else return{operator:t.type,parameters:[e,...s]}}else if(t===null){const s=((n=this.connection.options.invalidWhereValuesBehavior)==null?void 0:n.null)||"ignore";if(s==="sql-null")return{operator:"isNull",parameters:[e]};if(s==="throw")throw new Z(`Null value encountered in property '${e}' of a where condition. To match with SQL NULL, the IsNull() operator must be used. Set 'invalidWhereValuesBehavior.null' to 'ignore' or 'sql-null' in connection options to skip or handle null values.`)}else if(t===void 0&&(((i=this.connection.options.invalidWhereValuesBehavior)==null?void 0:i.undefined)||"ignore")==="throw")throw new Z(`Undefined value encountered in property '${e}' of a where condition. Set 'invalidWhereValuesBehavior.undefined' to 'ignore' in connection options to skip properties with undefined values.`);return{operator:"equal",parameters:[e,this.createParameter(t)]}}getWhereCondition(e){if(typeof e=="string")return e;if(de.isBrackets(e)){const i=this.createQueryBuilder();return i.parentQueryBuilder=this,i.expressionMap.mainAlias=this.expressionMap.mainAlias,i.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,i.expressionMap.parameters=this.expressionMap.parameters,i.expressionMap.nativeParameters=this.expressionMap.nativeParameters,i.expressionMap.wheres=[],e.whereFactory(i),{operator:de.isNotBrackets(e)?"not":"brackets",condition:i.expressionMap.wheres}}if(typeof e=="function")return e(this);const t=Array.isArray(e)?e:[e],n=[];for(const i of t){const s=[];for(const[a,o]of this.getPredicates(i))s.push({type:"and",condition:this.getWherePredicateCondition(a,o)});n.push({type:"or",condition:s})}return n.length===1?n[0].condition:n}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}pn.queryBuilderRegistry={};class jB{static from(e){const t=new this;return t.raw=e.records,t.affected=e.affected,t}}class WB extends pn{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createDeleteExpression(),this.replacePropertyNamesForTheWholeQuery(e.trim())}execute(){return v(this,null,function*(){const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();let i=!1;try{this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(yield n.startTransaction(),i=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield n.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata));const s=yield n.query(e,t,!0),a=jB.from(s);return this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield n.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata)),i&&(yield n.commitTransaction()),a}catch(s){if(i)try{yield n.rollbackTransaction()}catch(a){}throw s}finally{n!==this.queryRunner&&(yield n.release())}})}from(e,t){e=de.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new ih;return this.expressionMap.returning=e,this}createDeleteExpression(){const e=this.getTableName(this.getMainTableName()),t=this.createWhereExpression(),n=this.createReturningExpression("delete");return n===""?`DELETE FROM ${e}${t}`:this.connection.driver.options.type==="mssql"?`DELETE FROM ${e} OUTPUT ${n}${t}`:this.connection.driver.options.type==="spanner"?`DELETE FROM ${e}${t} THEN RETURN ${n}`:`DELETE FROM ${e}${t} RETURNING ${n}`}}const Dn=[];for(let r=0;r<256;++r)Dn.push((r+256).toString(16).slice(1));function HB(r,e=0){return(Dn[r[e+0]]+Dn[r[e+1]]+Dn[r[e+2]]+Dn[r[e+3]]+"-"+Dn[r[e+4]]+Dn[r[e+5]]+"-"+Dn[r[e+6]]+Dn[r[e+7]]+"-"+Dn[r[e+8]]+Dn[r[e+9]]+"-"+Dn[r[e+10]]+Dn[r[e+11]]+Dn[r[e+12]]+Dn[r[e+13]]+Dn[r[e+14]]+Dn[r[e+15]]).toLowerCase()}let Nf;const QB=new Uint8Array(16);function zB(){if(!Nf){if(typeof crypto=="undefined"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Nf=crypto.getRandomValues.bind(crypto)}return Nf(QB)}const GB=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Pb={randomUUID:GB};function ZT(r,e,t){var i,s,a;if(Pb.randomUUID&&!r)return Pb.randomUUID();r=r||{};const n=(a=(s=r.random)!=null?s:(i=r.rng)==null?void 0:i.call(r))!=null?a:zB();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,HB(n)}class Or{constructor(){this.count=0,this.promises=[]}wait(){return v(this,null,function*(){return this.promises.length>0&&(yield Promise.all(this.promises)),this})}}class Ib{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(e){const t=new this;return t.raw=e.raw,t}}class Gp{constructor(e,t){this.queryRunner=e,this.expressionMap=t}update(e,t){return v(this,null,function*(){const n=this.expressionMap.mainAlias.metadata;yield Promise.all(t.map((i,s)=>v(this,null,function*(){if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){this.queryRunner.connection.driver.options.type==="oracle"&&Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce((l,c,u)=>(l[this.expressionMap.extraReturningColumns[u].databaseName]=c[0],l),{}));const a=Array.isArray(e.raw)?e.raw[s]:e.raw,o=this.queryRunner.connection.driver.createGeneratedMap(n,a);o&&(this.queryRunner.manager.merge(n.target,i,o),e.generatedMaps.push(o))}else{const a=this.expressionMap.extraReturningColumns;if(a.length>0){const o=this.expressionMap.mainAlias.metadata.getEntityIdMap(i);if(!o)throw new Z("Cannot update entity because entity id is not set in the entity.");const l=yield this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map(c=>n.targetName+"."+c.propertyPath)).addSelect(a.map(c=>n.targetName+"."+c.propertyPath)).from(n.target,n.targetName).where(o).withDeleted().setOption("create-pojo").getOne();l&&(this.queryRunner.manager.merge(n.target,i,l),e.generatedMaps.push(l))}}})))})}insert(e,t){return v(this,null,function*(){const n=this.expressionMap.mainAlias.metadata;let i=n.getInsertionReturningColumns();const s=this.queryRunner.connection.driver.isReturningSqlSupported("insert");i=i.filter(o=>o.isGenerated?s===!0:!0);const a=t.map((o,l)=>{Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(this.queryRunner.connection.driver.options.type==="oracle"?e.raw=e.raw.reduce((h,f,d)=>(h[this.expressionMap.extraReturningColumns[d].databaseName]=f[0],h),{}):this.queryRunner.connection.driver.options.type==="spanner"&&(e.raw=e.raw[0]));const c=Array.isArray(e.raw)?e.raw[l]:e.raw,u=this.queryRunner.connection.driver.createGeneratedMap(n,c,l,t.length)||{};return l in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(n.target,u,this.expressionMap.locallyGenerated[l]),this.queryRunner.manager.merge(n.target,o,u),u});if(i.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const o=t.map(c=>{const u=n.getEntityIdMap(c);if(!u)throw new Z("Cannot update entity because entity id is not set in the entity.");return u}),l=yield this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map(c=>n.targetName+"."+c.propertyPath)).addSelect(i.map(c=>n.targetName+"."+c.propertyPath)).from(n.target,n.targetName).where(o).setOption("create-pojo").getMany();t.forEach((c,u)=>{this.queryRunner.manager.merge(n.target,a[u],l[u]),this.queryRunner.manager.merge(n.target,c,l[u])})}t.forEach((o,l)=>{const c=n.getEntityIdMap(o);e.identifiers.push(c),e.generatedMaps.push(a[l])})})}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(e=>e.asExpression!==void 0||e.isUpdateDate||e.isVersion)}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter(e=>e.asExpression!==void 0||e.isUpdateDate||e.isVersion||e.isDeleteDate)}}class KB extends pn{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createInsertExpression(),this.replacePropertyNamesForTheWholeQuery(e.trim())}execute(){return v(this,null,function*(){const e=this.getValueSets();if(e.length===0)return new Ib;const t=this.obtainQueryRunner();let n=!1;try{if(this.expressionMap.useTransaction===!0&&t.isTransactionActive===!1&&(yield t.startTransaction(),n=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const m=new Or;e.forEach(y=>{t.broadcaster.broadcastBeforeInsertEvent(m,this.expressionMap.mainAlias.metadata,y)}),yield m.wait()}let i=null,s=null;const a=new Gp(t,this.expressionMap),o=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const m of this.expressionMap.returning)o.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(m));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(e.length>1&&this.connection.driver.options.type==="oracle"||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),o.push(...this.expressionMap.extraReturningColumns.filter(m=>!o.includes(m)))),o.length>0&&this.connection.driver.options.type==="mssql"&&(i=this.connection.driver.buildTableVariableDeclaration("@OutputTable",o),s="SELECT * FROM @OutputTable");const[l,c]=this.getQueryAndParameters(),h=[i,l,s].filter(m=>m!=null).join(`;

`),f=yield t.query(h,c,!0),d=Ib.from(f);if(this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield a.insert(d,e)),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata){const m=new Or;e.forEach(y=>{t.broadcaster.broadcastAfterInsertEvent(m,this.expressionMap.mainAlias.metadata,y)}),yield m.wait()}return n&&(yield t.commitTransaction()),d}catch(i){if(n)try{yield t.rollbackTransaction()}catch(s){}throw i}finally{t!==this.queryRunner&&(yield t.release())}})}into(e,t){e=de.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e);return this.expressionMap.setMainAlias(n),this.expressionMap.insertColumns=t||[],this}values(e){return this.expressionMap.valuesSet=e,this}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new ih;return this.expressionMap.returning=e,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}onConflict(e){return this.expressionMap.onConflict=e,this}orIgnore(e=!0){return this.expressionMap.onIgnore=!!e,this}orUpdate(e,t,n){var o;const{where:i,parameters:s}=(o=n==null?void 0:n.overwriteCondition)!=null?o:{};let a;if(i){const l=this.getWhereCondition(i);(Array.isArray(l)?l.length!==0:l)&&(a=[{type:"simple",condition:l}])}return s&&this.setParameters(s),Array.isArray(e)?(this.expressionMap.onUpdate={overwrite:e,conflict:t,skipUpdateIfNoValuesChanged:n==null?void 0:n.skipUpdateIfNoValuesChanged,indexPredicate:n==null?void 0:n.indexPredicate,upsertType:n==null?void 0:n.upsertType,overwriteCondition:a},this):(this.expressionMap.onUpdate={conflict:e==null?void 0:e.conflict_target,columns:e==null?void 0:e.columns,overwrite:e==null?void 0:e.overwrite,skipUpdateIfNoValuesChanged:n==null?void 0:n.skipUpdateIfNoValuesChanged,upsertType:n==null?void 0:n.upsertType,overwriteCondition:a},this)}createInsertExpression(){var o,l,c,u,h,f;if((this.expressionMap.onUpdate||this.expressionMap.onIgnore)&&((l=(o=this.expressionMap.onUpdate)==null?void 0:o.upsertType)!=null?l:"merge-into")==="merge-into"&&this.connection.driver.supportedUpsertTypes.includes("merge-into"))return this.createMergeExpression();const e=this.getTableName(this.getMainTableName()),t=this.alias!==this.getMainTableName()?this.escape(this.alias):e,n=this.createValuesExpression(),i=this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),s=this.createColumnNamesExpression();let a="INSERT ";if(((c=this.expressionMap.onUpdate)==null?void 0:c.upsertType)==="primary-key"&&(a="UPSERT "),(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(a+=`${this.expressionMap.onIgnore?" IGNORE ":""}`),a+=`INTO ${e}`,this.alias!==this.getMainTableName()&&Be.isPostgresFamily(this.connection.driver)&&(a+=` AS "${this.alias}"`),s?a+=`(${s})`:!n&&(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(a+="()"),i&&this.connection.driver.options.type==="mssql"&&(a+=` OUTPUT ${i}`),n?(this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="sap")&&this.getValueSets().length>1?a+=` ${n}`:a+=` VALUES ${n}`:Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"?a+=" VALUES ()":a+=" DEFAULT VALUES",((u=this.expressionMap.onUpdate)==null?void 0:u.upsertType)!=="primary-key"){if(this.connection.driver.supportedUpsertTypes.includes("on-conflict-do-update")){if(this.expressionMap.onIgnore)a+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)a+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:d,columns:m,conflict:y,skipUpdateIfNoValuesChanged:T,indexPredicate:b}=this.expressionMap.onUpdate;let S="ON CONFLICT";if(Array.isArray(y)){if(S+=` ( ${y.map(C=>this.escape(C)).join(", ")} )`,b&&!Be.isPostgresFamily(this.connection.driver))throw new Z("indexPredicate option is not supported by the current database driver");b&&Be.isPostgresFamily(this.connection.driver)&&(S+=` WHERE ( ${b} )`)}else y&&(S+=` ON CONSTRAINT ${this.escape(y)}`);const N=[];if(Array.isArray(d)?N.push(...d.map(C=>`${this.escape(C)} = EXCLUDED.${this.escape(C)}`)):m&&N.push(...m.map(C=>`${this.escape(C)} = :${C}`)),N.length>0&&(a+=` ${S} DO UPDATE SET `,N.push(...this.expressionMap.mainAlias.metadata.columns.filter(C=>C.isUpdateDate&&!(d!=null&&d.includes(C.databaseName))&&!(this.connection.driver.options.type==="oracle"&&this.getValueSets().length>1||Be.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")).map(C=>`${this.escape(C.databaseName)} = DEFAULT`)),a+=N.join(", ")),Array.isArray(d)&&T){(f=(h=this.expressionMap.onUpdate).overwriteCondition)!=null||(h.overwriteCondition=[]);const C=d.map(I=>({type:"or",condition:`${t}.${this.escape(I)} IS DISTINCT FROM EXCLUDED.${this.escape(I)}`}));this.expressionMap.onUpdate.overwriteCondition.push({type:"and",condition:C})}Be.isPostgresFamily(this.connection.driver)&&this.expressionMap.onUpdate.overwriteCondition&&this.expressionMap.onUpdate.overwriteCondition.length>0&&(a+=` WHERE ${this.createUpsertConditionExpression()}`)}}else if(this.connection.driver.supportedUpsertTypes.includes("on-duplicate-key-update")){if(this.expressionMap.onUpdate){const{overwrite:d,columns:m}=this.expressionMap.onUpdate;Array.isArray(d)?(a+=" ON DUPLICATE KEY UPDATE ",a+=d.map(y=>`${this.escape(y)} = VALUES(${this.escape(y)})`).join(", "),a+=" "):Array.isArray(m)&&(a+=" ON DUPLICATE KEY UPDATE ",a+=m.map(y=>`${this.escape(y)} = :${y}`).join(", "),a+=" ")}}else if(this.expressionMap.onUpdate)throw new Z("onUpdate is not supported by the current database driver")}return i&&(Be.isPostgresFamily(this.connection.driver)||this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="cockroachdb"||Be.isMySQLFamily(this.connection.driver))&&(a+=` RETURNING ${i}`),i&&this.connection.driver.options.type==="spanner"&&(a+=` THEN RETURN ${i}`),this.connection.driver.options.type==="mssql"&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter(d=>this.expressionMap.insertColumns.length>0?this.expressionMap.insertColumns.indexOf(d.propertyPath)!==-1:d.isInsert).some(d=>this.isOverridingAutoIncrementBehavior(d))&&(a=`SET IDENTITY_INSERT ${e} ON; ${a}; SET IDENTITY_INSERT ${e} OFF`),a}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter(e=>this.expressionMap.insertColumns.length?this.expressionMap.insertColumns.indexOf(e.propertyPath)!==-1:!(!e.isInsert||e.isGenerated&&e.generationStrategy==="increment"&&this.connection.driver.options.type!=="spanner"&&this.connection.driver.options.type!=="oracle"&&!Be.isSQLiteFamily(this.connection.driver)&&!Be.isMySQLFamily(this.connection.driver)&&this.connection.driver.options.type!=="aurora-mysql"&&!(this.connection.driver.options.type==="mssql"&&this.isOverridingAutoIncrementBehavior(e)))):[]}createColumnNamesExpression(){const e=this.getInsertedColumns();if(e.length>0)return e.map(t=>this.escape(t.databaseName)).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const t=this.getValueSets();if(t.length===1)return Object.keys(t[0]).map(n=>this.escape(n)).join(", ")}return this.expressionMap.insertColumns.map(t=>this.escape(t)).join(", ")}createValuesExpression(){const e=this.getValueSets(),t=this.getInsertedColumns();if(t.length>0){let n="";return e.forEach((i,s)=>{t.forEach((a,o)=>{o===0&&(this.connection.driver.options.type==="oracle"&&e.length>1||this.connection.driver.options.type==="sap"&&e.length>1?n+=" SELECT ":n+="("),n+=this.createColumnValueExpression(e,s,a),o===t.length-1?s===e.length-1?["oracle","sap"].includes(this.connection.driver.options.type)&&e.length>1?n+=" FROM "+this.connection.driver.dummyTableName:n+=")":["oracle","sap"].includes(this.connection.driver.options.type)&&e.length>1?n+=" FROM "+this.connection.driver.dummyTableName+" UNION ALL ":n+="), ":n+=", "})}),n==="()"?"":n}else{let n="";return e.forEach((i,s)=>{Object.keys(i).forEach((o,l)=>{l===0&&(n+="(");const c=i[o];typeof c=="function"?n+=c():c===void 0?this.connection.driver.options.type==="oracle"&&e.length>1||Be.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?n+="NULL":n+="DEFAULT":c===null&&this.connection.driver.options.type==="spanner"||(n+=this.createParameter(c)),l===Object.keys(i).length-1?s===e.length-1?n+=")":n+="), ":n+=", "})}),n==="()"?"":n}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(_t.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new K2}isOverridingAutoIncrementBehavior(e){return e.isPrimary&&e.isGenerated&&e.generationStrategy==="increment"&&this.getValueSets().some(t=>e.getEntityValue(t)!==void 0&&e.getEntityValue(t)!==null)}createMergeExpression(){var u,h,f,d;if(!this.connection.driver.supportedUpsertTypes.includes("merge-into"))throw new Z('Upsert type "merge-into" is not supported by current database driver');if((u=this.expressionMap.onUpdate)!=null&&u.upsertType&&this.expressionMap.onUpdate.upsertType!=="merge-into")throw new Z(`Upsert type "${this.expressionMap.onUpdate.upsertType}" is not supported by current database driver`);const e=this.getTableName(this.getMainTableName()),t=this.escape(this.alias),n=this.getInsertedColumns(),i=this.createColumnNamesExpression();let s=`MERGE INTO ${e} ${this.escape(this.alias)}`;const a=this.escape("mergeIntoSource"),o=this.createMergeIntoSourceExpression(a);if(s+=` ${o}`,this.expressionMap.onIgnore){const m=n.find(y=>y.isPrimary);m?s+=` ON (${t}.${this.escape(m.databaseName)} = ${a}.${this.escape(m.databaseName)})`:s+=`ON (${this.expressionMap.mainAlias.metadata.uniques.map(y=>`(${y.columns.map(T=>`${t}.${this.escape(T.databaseName)} = ${a}.${this.escape(T.databaseName)}`).join(" AND ")})`).join(" OR ")})`}else if(this.expressionMap.onUpdate){const{conflict:m,indexPredicate:y}=this.expressionMap.onUpdate;if(y)throw new Z('indexPredicate option is not supported by upsert type "merge-into"');Array.isArray(m)?s+=` ON (${m.map(T=>`${t}.${this.escape(T)} = ${a}.${this.escape(T)}`).join(" AND ")})`:m?s+=` ON (${t}.${this.escape(m)} = ${a}.${this.escape(m)})`:s+=`ON (${this.expressionMap.mainAlias.metadata.uniques.map(T=>`(${T.columns.map(b=>`${t}.${this.escape(b.databaseName)} = ${a}.${this.escape(b.databaseName)}`).join(" AND ")})`).join(" OR ")})`}if(this.expressionMap.onUpdate){const{overwrite:m,columns:y,conflict:T,skipUpdateIfNoValuesChanged:b}=this.expressionMap.onUpdate;let S="";if(Array.isArray(m)&&(S+=(h=m||y)==null?void 0:h.filter(C=>!(T!=null&&T.includes(C))).map(C=>`${t}.${this.escape(C)} = ${a}.${this.escape(C)}`).join(", ")),Array.isArray(m)&&b){(d=(f=this.expressionMap.onUpdate).overwriteCondition)!=null||(f.overwriteCondition=[]);const C=m.map(I=>({type:"or",condition:{operator:"notEqual",parameters:[`${t}.${this.escape(I)}`,`${a}.${this.escape(I)}`]}}));this.expressionMap.onUpdate.overwriteCondition.push({type:"and",condition:C})}const N=this.createUpsertConditionExpression();S.trim()&&((this.connection.driver.options.type==="mssql"||this.connection.driver.options.type==="sap")&&N!=""?s+=` WHEN MATCHED AND ${N} THEN UPDATE SET ${S}`:(s+=` WHEN MATCHED THEN UPDATE SET ${S}`,N!=""&&(s+=` WHERE ${N}`)))}const l=this.createMergeIntoInsertValuesExpression(a),c=this.connection.driver.options.type==="mssql"?this.createReturningExpression("insert"):null;return s+=" WHEN NOT MATCHED THEN INSERT",i&&(s+=`(${i})`),l&&(s+=` VALUES ${l}`),c&&this.connection.driver.options.type==="mssql"&&(s+=` OUTPUT ${c}`),this.connection.driver.options.type==="mssql"&&(s+=";"),s}createMergeIntoSourceExpression(e){const t=this.getValueSets(),n=this.getInsertedColumns();let i="USING (";if(n.length>0)this.connection.driver.options.type==="mssql"&&(i+="VALUES "),t.forEach((s,a)=>{n.forEach((o,l)=>{l===0&&(this.connection.driver.options.type==="mssql"?i+="(":i+="SELECT ");const c=o.getEntityValue(s);c===void 0&&!(o.isGenerated&&o.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported())?o.default!==void 0&&o.default!==null?i+=this.connection.driver.normalizeDefault(o):i+="NULL":c===null?i+="NULL":i+=this.createColumnValueExpression(t,a,o),this.connection.driver.options.type!=="mssql"&&(i+=` AS ${this.escape(o.databaseName)}`),l===n.length-1?a===t.length-1?["oracle","sap"].includes(this.connection.driver.options.type)?i+=" FROM "+this.connection.driver.dummyTableName:this.connection.driver.options.type==="mssql"&&(i+=")"):["oracle","sap"].includes(this.connection.driver.options.type)&&t.length>1?i+=" FROM "+this.connection.driver.dummyTableName+" UNION ALL ":this.connection.driver.options.type==="mssql"?i+="), ":i+=" UNION ALL ":i+=", "})});else throw new Z('Upsert type "merge-into" is not supported without metadata tables');return i+=`) ${e}`,this.connection.driver.options.type==="mssql"&&(i+=` (${n.map(s=>this.escape(s.databaseName)).join(", ")})`),i}createMergeIntoInsertValuesExpression(e){const t=this.getInsertedColumns();let n="";if(t.length>0)t.forEach((i,s)=>{s===0&&(n+="("),i.isGenerated&&i.generationStrategy==="uuid"&&this.connection.driver.isUUIDGenerationSupported()||i.isGenerated&&i.generationStrategy!=="uuid"?n+="DEFAULT":n+=`${e}.${this.escape(i.databaseName)}`,s===t.length-1?n+=")":n+=", "});else throw new Z('Upsert type "merge-into" is not supported without metadata tables');return n==="()"?"":n}createUpsertConditionExpression(){if(!this.expressionMap.onUpdate.overwriteCondition)return"";const e=[],t=this.createWhereClausesExpression(this.expressionMap.onUpdate.overwriteCondition);if(t.length>0&&t!=="1=1"&&e.push(t),this.expressionMap.mainAlias.hasMetadata){const i=this.expressionMap.mainAlias.metadata;if(this.expressionMap.queryType==="select"&&!this.expressionMap.withDeleted&&i.deleteDateColumn){const a=`${this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.deleteDateColumn.propertyName:i.deleteDateColumn.propertyName} IS NULL`;e.push(a)}if(i.discriminatorColumn&&i.parentEntityMetadata){const a=`${this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+i.discriminatorColumn.databaseName:i.discriminatorColumn.databaseName} IN (:...discriminatorColumnValues)`;e.push(a)}}if(this.expressionMap.extraAppendedAndWhereCondition){const i=this.expressionMap.extraAppendedAndWhereCondition;e.push(i)}let n="";return e.length?e.length===1?n+=`${e[0]}`:n+=`( ${e.join(" ) AND ( ")} )`:n+="",n}createColumnValueExpression(e,t,n){const i=e[t];let s="",a=n.getEntityValue(i);if(typeof a!="function"&&(a=this.connection.driver.preparePersistentValue(a,n)),n.isVersion&&a===void 0)s+="1";else if(n.isDiscriminator)s+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(n.isGenerated&&n.generationStrategy==="uuid"&&!this.connection.driver.isUUIDGenerationSupported()&&a===void 0)a=ZT(),s+=this.createParameter(a),t in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[t]={}),n.setEntityValue(this.expressionMap.locallyGenerated[t],a);else if(a===void 0)this.connection.driver.options.type==="oracle"&&e.length>1||Be.isSQLiteFamily(this.connection.driver)||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"?n.default!==void 0&&n.default!==null?s+=this.connection.driver.normalizeDefault(n):this.connection.driver.options.type==="spanner"&&n.isGenerated&&n.generationStrategy==="uuid"?s+="GENERATE_UUID()":s+="NULL":s+="DEFAULT";else if(a===null&&(this.connection.driver.options.type==="spanner"||this.connection.driver.options.type==="oracle"))s+="NULL";else if(typeof a=="function")s+=a();else{this.connection.driver.options.type==="mssql"&&(a=this.connection.driver.parametrizeValue(n,a));const o=this.createParameter(a);if((Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.includes(n.type)){const c=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";n.srid!=null?s+=`${c}(${o}, ${n.srid})`:s+=`${c}(${o})`}else Be.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.includes(n.type)?n.srid!=null?s+=`ST_SetSRID(ST_GeomFromGeoJSON(${o}), ${n.srid})::${n.type}`:s+=`ST_GeomFromGeoJSON(${o})::${n.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.includes(n.type)?s+=n.type+"::STGeomFromText("+o+", "+(n.srid||"0")+")":s+=o}return s}}class Ob{constructor(e,t){this.queryBuilder=e,this.expressionMap=t}update(e){return v(this,null,function*(){const t=this.expressionMap.relationMetadata;if(t.isManyToOne||t.isOneToOneOwner){const n=t.joinColumns.reduce((i,s)=>{const a=_t.isObject(e)?s.referencedColumn.getEntityValue(e):e;return s.setEntityValue(i,a),i},{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;yield this.queryBuilder.createQueryBuilder().update(t.entityMetadata.target).set(n).whereInIds(this.expressionMap.of).execute()}else if((t.isOneToOneNotOwner||t.isOneToMany)&&e===null){const n={};t.inverseRelation.joinColumns.forEach(l=>{n[l.propertyName]=null});const i=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],s={},a=[];i.forEach((l,c)=>{t.inverseRelation.joinColumns.map((u,h)=>{const f="joinColumn_"+c+"_"+h;s[f]=_t.isObject(l)?u.referencedColumn.getEntityValue(l):l,a.push(`${u.propertyPath} = :${f}`)})});const o=a.map(l=>"("+l+")").join(" OR ");if(!o)return;yield this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(n).where(o).setParameters(s).execute()}else if(t.isOneToOneNotOwner||t.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new Z("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const n=this.expressionMap.of,i=t.inverseRelation.joinColumns.reduce((s,a)=>{const o=_t.isObject(n)?a.referencedColumn.getEntityValue(n):n;return a.setEntityValue(s,o),s},{});if(!e||Array.isArray(e)&&!e.length)return;yield this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(i).whereInIds(e).execute()}else{const n=t.junctionEntityMetadata,i=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],s=Array.isArray(e)?e:[e],a=t.isManyToManyOwner?i:s,o=t.isManyToManyOwner?s:i,l=[];if(a.forEach(c=>{o.forEach(u=>{const h={};n.ownerColumns.forEach(f=>{h[f.databaseName]=_t.isObject(c)?f.referencedColumn.getEntityValue(c):c}),n.inverseColumns.forEach(f=>{h[f.databaseName]=_t.isObject(u)?f.referencedColumn.getEntityValue(u):u}),l.push(h)})}),!l.length)return;this.queryBuilder.connection.driver.options.type==="oracle"||this.queryBuilder.connection.driver.options.type==="sap"?yield Promise.all(l.map(c=>this.queryBuilder.createQueryBuilder().insert().into(n.tableName).values(c).execute())):yield this.queryBuilder.createQueryBuilder().insert().into(n.tableName).values(l).execute()}})}}class YB{constructor(e,t){this.queryBuilder=e,this.expressionMap=t}remove(e){return v(this,null,function*(){const t=this.expressionMap.relationMetadata;if(t.isOneToMany){const n=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],i=Array.isArray(e)?e:[e],s={};t.inverseRelation.joinColumns.forEach(c=>{s[c.propertyName]=null});const a={},o=[];n.forEach((c,u)=>{o.push(...i.map((h,f)=>[...t.inverseRelation.joinColumns.map((d,m)=>{const y="joinColumn_"+u+"_"+f+"_"+m;return a[y]=_t.isObject(c)?d.referencedColumn.getEntityValue(c):c,`${d.propertyPath} = :${y}`}),...t.inverseRelation.entityMetadata.primaryColumns.map((d,m)=>{const y="primaryColumn_"+f+"_"+f+"_"+m;return a[y]=_t.isObject(h)?d.getEntityValue(h):h,`${d.propertyPath} = :${y}`})].join(" AND ")))});const l=o.map(c=>"("+c+")").join(" OR ");if(!l)return;yield this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(s).where(l).setParameters(a).execute()}else{const n=t.junctionEntityMetadata,i=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],s=Array.isArray(e)?e:[e],a=t.isManyToManyOwner?i:s,o=t.isManyToManyOwner?s:i,l={},c=[];a.forEach((h,f)=>{c.push(...o.map((d,m)=>[...n.ownerColumns.map((y,T)=>{const b="firstValue_"+f+"_"+m+"_"+T;return l[b]=_t.isObject(h)?y.referencedColumn.getEntityValue(h):h,`${y.databaseName} = :${b}`}),...n.inverseColumns.map((y,T)=>{const b="secondValue_"+f+"_"+m+"_"+T;return l[b]=_t.isObject(d)?y.referencedColumn.getEntityValue(d):d,`${y.databaseName} = :${b}`})].join(" AND ")))});const u=c.map(h=>"("+h+")").join(" OR ");yield this.queryBuilder.createQueryBuilder().delete().from(n.tableName).where(u).setParameters(l).execute()}})}}class JB extends pn{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(e){return this.expressionMap.of=e,this}set(e){return v(this,null,function*(){const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Z("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToMany||t.isOneToMany)throw new Z(`Set operation is only supported for many-to-one and one-to-one relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .add() method instead.`);if(t.joinColumns&&t.joinColumns.length>1&&(!_t.isObject(e)||Object.keys(e).length<t.joinColumns.length))throw new Z('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new Ob(this,this.expressionMap).update(e)})}add(e){return v(this,null,function*(){if(Array.isArray(e)&&e.length===0)return;const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Z("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new Z(`Add operation is only supported for many-to-many and one-to-many relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .set() method instead.`);if(t.joinColumns&&t.joinColumns.length>1&&(!_t.isObject(e)||Object.keys(e).length<t.joinColumns.length))throw new Z('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new Ob(this,this.expressionMap).update(e)})}remove(e){return v(this,null,function*(){if(Array.isArray(e)&&e.length===0)return;const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new Z("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new Z(`Add operation is only supported for many-to-many and one-to-many relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .set(null) method instead.`);return new YB(this,this.expressionMap).remove(e)})}addAndRemove(e,t){return v(this,null,function*(){yield this.remove(t),yield this.add(e)})}loadOne(){return v(this,null,function*(){return this.loadMany().then(e=>e[0])})}loadMany(){return v(this,null,function*(){let e=this.expressionMap.of;if(!_t.isObject(e)){const t=this.expressionMap.mainAlias.metadata;if(t.hasMultiplePrimaryKeys)throw new Z("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");e=t.primaryColumns[0].createValueMap(e)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,e,this.queryRunner)})}}class ke{static chunk(e,t){return Array.from(Array(Math.ceil(e.length/t)),(n,i)=>e.slice(i*t,i*t+t))}static splitClassesAndStrings(e){return[e.filter(t=>typeof t!="string"),e.filter(t=>typeof t=="string")]}static groupBy(e,t){return e.reduce((n,i)=>{const s=t(i);let a=n.find(o=>o.id===s);return a||(a={id:s,items:[]},n.push(a)),a.items.push(i),n},[])}static uniq(e,t){return e.reduce((n,i)=>{let s=!1;if(typeof t=="function"){const a=t(i);s=!!n.find(o=>t(o)===a)}else typeof t=="string"?s=!!n.find(a=>a[t]===i[t]):s=n.indexOf(i)!==-1;return s||n.push(i),n},[])}static mergeDeep(e,...t){if(!t.length)return e;for(const n of t)ke.merge(e,n);return e}static cloneObject(e){return e==null?e:Object.assign(Object.create(Object.getPrototypeOf(e)),e)}static deepCompare(...e){let t,n,i,s;if(e.length<1)return!0;for(t=1,n=e.length;t<n;t++)if(i=[],s=[],!ke.compare2Objects(i,s,e[0],e[t]))return!1;return!0}static deepValue(e,t){const n=t.split(".");for(let i=0,s=n.length;i<s;i++)e=e[n[i]];return e}static replaceEmptyObjectsWithBooleans(e){for(const t in e)e[t]&&typeof e[t]=="object"&&(Object.keys(e[t]).length===0?e[t]=!0:ke.replaceEmptyObjectsWithBooleans(e[t]))}static propertyPathsToTruthyObject(e){const t={};for(const n of e){const i=n.split(".");if(!i.length)continue;(!t[i[0]]||t[i[0]]===!0)&&(t[i[0]]={});let s=t[i[0]];for(const[a,o]of i.entries())a!==0&&(s[o]?s=s[o]:a===i.length-1?(s[o]={},s=null):(s[o]={},s=s[o]))}return ke.replaceEmptyObjectsWithBooleans(t),t}static compareIds(e,t){return e==null||t===void 0||t===null?!1:(typeof e.id=="string"&&typeof t.id=="string"||typeof e.id=="number"&&typeof t.id=="number")&&Object.keys(e).length===1&&Object.keys(t).length===1?e.id===t.id:ke.deepCompare(e,t)}static toBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e==="true"||e==="1":typeof e=="number"?e>0:!1}static isArraysEqual(e,t){return e.length!==t.length?!1:e.every(n=>t.includes(n))}static areMutuallyExclusive(...e){return!e.some(n=>{const i=e.filter(s=>s!==n);return n.some(s=>i.some(a=>a.includes(s)))})}static parseSqlCheckExpression(e,t){const n=e.match(new RegExp(`"${t}" varchar CHECK\\s*\\(\\s*"${t}"\\s+IN\\s*`));if(n&&n.index){const s=e.substring(n.index+n[0].length);let a="",o="";const l=[];for(let c=0;c<s.length;c++){const u=s[c];switch(u){case",":a==""?(l.push(o),o=""):o+=u;break;case"'":a==u?s[c+1]===u?(o+=u,c+=1):a="":a=u;break;case")":if(a=="")return l.push(o),l;o+=u;break;default:a!=""&&(o+=u)}}}}static isCriteriaNullOrEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||ke.isPlainObject(e)&&Object.keys(e).length===0}static isSinglePrimitiveCriteria(e){return typeof e=="string"||typeof e=="number"||e instanceof Date}static isPrimitiveCriteria(e){return Array.isArray(e)?e.every(t=>ke.isSinglePrimitiveCriteria(t)):ke.isSinglePrimitiveCriteria(e)}static compare2Objects(e,t,n,i){let s;if(Number.isNaN(n)&&Number.isNaN(i)||n===i)return!0;if(n===null||i===null||n===void 0||i===void 0)return!1;if((typeof n.equals=="function"||typeof n.equals=="function")&&n.equals(i))return!0;if(typeof n=="function"&&typeof i=="function"||n instanceof Date&&i instanceof Date||n instanceof RegExp&&i instanceof RegExp||typeof n=="string"&&typeof i=="string"||typeof n=="number"&&typeof i=="number")return n.toString()===i.toString();if(!(typeof n=="object"&&typeof i=="object")||Object.prototype.isPrototypeOf.call(n,i)||Object.prototype.isPrototypeOf.call(i,n)||n.constructor!==i.constructor||n.prototype!==i.prototype||e.indexOf(n)>-1||t.indexOf(i)>-1)return!1;for(s in i){if(i.hasOwnProperty(s)!==n.hasOwnProperty(s))return!1;if(typeof i[s]!=typeof n[s])return!1}for(s in n){if(i.hasOwnProperty(s)!==n.hasOwnProperty(s))return!1;if(typeof i[s]!=typeof n[s])return!1;switch(typeof n[s]){case"object":case"function":if(e.push(n),t.push(i),!ke.compare2Objects(e,t,n[s],i[s]))return!1;e.pop(),t.pop();break;default:if(n[s]!==i[s])return!1;break}}return!0}static isPlainObject(e){return e==null?!1:!e.constructor||e.constructor===Object}static mergeArrayKey(e,t,n,i){if(i.has(n)){e[t]=i.get(n);return}if(!(n instanceof Promise)){if(!ke.isPlainObject(n)&&!Array.isArray(n)){e[t]=n;return}e[t]||(e[t]=Array.isArray(n)?[]:{}),i.set(n,e[t]),ke.merge(e[t],n,i),i.delete(n)}}static mergeObjectKey(e,t,n,i){if(i.has(n)){Object.assign(e,{[t]:i.get(n)});return}if(!(n instanceof Promise)){if(!ke.isPlainObject(n)&&!Array.isArray(n)){Object.assign(e,{[t]:n});return}e[t]||Object.assign(e,{[t]:Array.isArray(n)?[]:{}}),i.set(n,e[t]),ke.merge(e[t],n,i),i.delete(n)}}static merge(e,t,n=new Map){if(ke.isPlainObject(e)&&ke.isPlainObject(t))for(const[i,s]of Object.entries(t))i!=="__proto__"&&ke.mergeObjectKey(e,i,s,n);if(Array.isArray(e)&&Array.isArray(t))for(let i=0;i<t.length;i++)ke.mergeArrayKey(e,i,t[i],n)}}class XB{constructor(e,t,n,i,s){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=n,this.rawRelationCountResults=i,this.queryRunner=s,this.pojo=this.expressionMap.options.includes("create-pojo"),this.selections=new Set(this.expressionMap.selects.map(a=>a.selection)),this.aliasCache=new Map,this.columnsCache=new Map}transform(e,t){const n=this.group(e,t),i=[];for(const s of n.values()){const a=this.transformRawResultsGroup(s,t);a!==void 0&&i.push(a)}return i}buildAlias(e,t){let n=this.aliasCache.get(e);n||(n=new Map,this.aliasCache.set(e,n));let i=n.get(t);return i||(i=Be.buildAlias(this.driver,void 0,e,t),n.set(t,i)),i}group(e,t){const n=new Map,i=[];t.metadata.tableType==="view"?i.push(...t.metadata.columns.map(s=>this.buildAlias(t.name,s.databaseName))):i.push(...t.metadata.primaryColumns.map(s=>this.buildAlias(t.name,s.databaseName)));for(const s of e){const a=i.map(l=>{const c=s[l];return Buffer.isBuffer(c)?c.toString("hex"):_t.isObject(c)?JSON.stringify(c):c}).join("_"),o=n.get(a);o?o.push(s):n.set(a,[s])}return n}transformRawResultsGroup(e,t){let n=t.metadata;if(n.discriminatorColumn){const u=e.map(f=>f[this.buildAlias(t.name,t.metadata.discriminatorColumn.databaseName)]),h=n.childEntityMetadatas.find(f=>typeof u.find(d=>d===f.discriminatorValue)!="undefined");h&&(n=h)}const i=n.create(this.queryRunner,{fromDeserializer:!0,pojo:this.pojo}),s=this.transformColumns(e,t,i,n),a=this.transformJoins(e,i,t,n),o=this.transformRelationIds(e,t,i,n),l=this.transformRelationCounts(e,t,i);if(s||n.primaryColumns.every(u=>u.isVirtual===!0)&&(a||o||l))return i}transformColumns(e,t,n,i){let s=!1;const a=e[0];for(const[o,l]of this.getColumnsToProcess(t.name,i)){const c=a[o];c!==void 0&&(c!==null&&!l.isVirtualProperty&&(s=!0),l.setEntityValue(n,this.driver.prepareHydratedValue(c,l)))}return s}transformJoins(e,t,n,i){let s=!1;for(const a of this.expressionMap.joinAttributes){if(!a.metadata||!a.isSelected||a.relation&&!i.relations.find(l=>l===a.relation))continue;if(a.mapToProperty){if(a.mapToPropertyParentAlias!==n.name)continue}else if(!a.relation||a.parentAlias!==n.name||a.relationPropertyPath!==a.relation.propertyPath)continue;let o=this.transform(e,a.alias);o=a.isMany?o:o[0],o=!a.isMany&&o===void 0?null:o,o!==void 0&&(a.mapToPropertyPropertyName?t[a.mapToPropertyPropertyName]=o:a.relation.setEntityValue(t,o),s=!0)}return s}transformRelationIds(e,t,n,i){let s=!1;for(const[a,o]of this.rawRelationIdResults.entries()){if(o.relationIdAttribute.parentAlias!==t.name)continue;const l=o.relationIdAttribute.relation,c=this.createValueMapFromJoinColumns(l,o.relationIdAttribute.parentAlias,e);if(c==null)continue;this.prepareDataForTransformRelationIds();const u=this.hashEntityIds(l,c),h=this.relationIdMaps[a][u]||[],f=o.relationIdAttribute.mapToPropertyPropertyPath.split("."),d=(m,y,T)=>{const b=m.shift();if(b&&m.length===0)return y[b]=T,y;if(b&&m.length>0)d(m,y[b],T);else return y};l.isOneToOne||l.isManyToOne?h[0]!==void 0&&(d(f,n,h[0]),s=!0):(d(f,n,h),s=s||h.length>0)}return s}transformRelationCounts(e,t,n){let i=!1;for(const s of this.rawRelationCountResults){if(s.relationCountAttribute.parentAlias!==t.name)continue;const a=s.relationCountAttribute.relation;let o;a.isOneToMany?o=a.inverseRelation.joinColumns[0].referencedColumn.databaseName:o=a.isOwning?a.joinColumns[0].referencedColumn.databaseName:a.inverseRelation.joinColumns[0].referencedColumn.databaseName;const l=e[0][this.buildAlias(t.name,o)];if(l!=null){n[s.relationCountAttribute.mapToPropertyPropertyName]=0;for(const c of s.results)c.parentId===l&&(n[s.relationCountAttribute.mapToPropertyPropertyName]=parseInt(c.cnt),i=!0)}}return i}getColumnsToProcess(e,t){let n=this.columnsCache.get(e);n||(n=new Map,this.columnsCache.set(e,n));let i=n.get(t);return i||(i=t.columns.filter(s=>!s.isVirtual&&(this.selections.has(e)||this.selections.has(`${e}.${s.propertyPath}`))&&!t.childEntityMetadatas.some(a=>a.target===s.target)).map(s=>[this.buildAlias(e,s.databaseName),s]),n.set(t,i)),i}createValueMapFromJoinColumns(e,t,n){let i;return e.isManyToOne||e.isOneToOneOwner?i=e.entityMetadata.primaryColumns.map(s=>s):e.isOneToMany||e.isOneToOneNotOwner?i=e.inverseRelation.joinColumns.map(s=>s):e.isOwning?i=e.joinColumns.map(s=>s):i=e.inverseRelation.inverseJoinColumns.map(s=>s),i.reduce((s,a)=>{for(const o of n)e.isManyToOne||e.isOneToOneOwner?s[a.databaseName]=this.driver.prepareHydratedValue(o[this.buildAlias(t,a.databaseName)],a):s[a.databaseName]=this.driver.prepareHydratedValue(o[this.buildAlias(t,a.referencedColumn.databaseName)],a.referencedColumn);return s},{})}extractEntityPrimaryIds(e,t){let n;return e.isManyToOne||e.isOneToOneOwner?n=e.entityMetadata.primaryColumns.map(i=>i):e.isOneToMany||e.isOneToOneNotOwner?n=e.inverseRelation.joinColumns.map(i=>i):e.isOwning?n=e.joinColumns.map(i=>i):n=e.inverseRelation.inverseJoinColumns.map(i=>i),n.reduce((i,s)=>(i[s.databaseName]=t[s.databaseName],i),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map(e=>{const t=e.relationIdAttribute.relation;let n;return t.isManyToOne||t.isOneToOneOwner?n=t.joinColumns:t.isOneToMany||t.isOneToOneNotOwner?n=t.inverseEntityMetadata.primaryColumns:t.isOwning?n=t.inverseJoinColumns:n=t.inverseRelation.joinColumns,e.results.reduce((i,s)=>{let a=n.reduce((o,l)=>{let c=s[l.databaseName];return t.isOneToMany||t.isOneToOneNotOwner?(l.isVirtual&&l.referencedColumn&&l.referencedColumn.propertyName!==l.propertyName&&(c=l.referencedColumn.createValueMap(c)),ke.mergeDeep(o,l.createValueMap(c))):(!l.isPrimary&&l.referencedColumn.referencedColumn&&(c=l.referencedColumn.referencedColumn.createValueMap(c)),ke.mergeDeep(o,l.referencedColumn.createValueMap(c)))},{});if(n.length===1&&!e.relationIdAttribute.disableMixedMap&&(t.isOneToMany||t.isOneToOneNotOwner?a=n[0].getEntityValue(a):a=n[0].referencedColumn.getEntityValue(a)),a!==void 0){const o=this.hashEntityIds(t,s);i[o]?i[o].push(a):i[o]=[a]}return i},{})}))}hashEntityIds(e,t){const n=this.extractEntityPrimaryIds(e,t);return JSON.stringify(n)}}let ZB=class{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}load(e){return v(this,null,function*(){const t=this.relationIdAttributes.map(n=>v(this,null,function*(){if(n.relation.isManyToOne||n.relation.isOneToOneOwner){if(n.queryBuilderFactory)throw new Z("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const i={},s=e.map(a=>{const o={},l=[];n.relation.joinColumns.forEach(u=>{o[u.databaseName]=this.connection.driver.prepareHydratedValue(a[Be.buildAlias(this.connection.driver,void 0,n.parentAlias,u.databaseName)],u.referencedColumn);const h=`${u.databaseName}:${o[u.databaseName]}`;l.indexOf(h)===-1&&l.push(h)}),n.relation.entityMetadata.primaryColumns.forEach(u=>{o[u.databaseName]=this.connection.driver.prepareHydratedValue(a[Be.buildAlias(this.connection.driver,void 0,n.parentAlias,u.databaseName)],u);const h=`${u.databaseName}:${o[u.databaseName]}`;l.indexOf(h)===-1&&l.push(h)}),l.sort();const c=l.join("::");return i[c]?null:(i[c]=!0,o)}).filter(a=>a);return{relationIdAttribute:n,results:s}}else if(n.relation.isOneToMany||n.relation.isOneToOneNotOwner){const i=n.relation,s=i.isOwning?i.joinColumns:i.inverseRelation.joinColumns,a=i.inverseEntityMetadata.target,o=i.inverseEntityMetadata.tableName,l=n.alias||o,c={},u={},h=e.map((y,T)=>{const b=[],S={},N=s.map(I=>{const H=I.databaseName+T,Q=y[Be.buildAlias(this.connection.driver,void 0,n.parentAlias,I.referencedColumn.databaseName)],te=`${l}:${I.propertyPath}:${Q}`;return b.indexOf(te)!==-1?"":(b.push(te),S[H]=Q,l+"."+I.propertyPath+" = :"+H)}).filter(I=>I).join(" AND ");b.sort();const C=b.join("::");return c[C]?"":(c[C]=!0,Object.assign(u,S),N)}).filter(y=>y).map(y=>"("+y+")").join(" OR ");if(!h)return{relationIdAttribute:n,results:[]};const f=this.connection.createQueryBuilder(this.queryRunner);ke.uniq([...s,...i.inverseRelation.entityMetadata.primaryColumns],y=>y.propertyPath).forEach(y=>{f.addSelect(l+"."+y.propertyPath,y.databaseName)}),f.from(a,l).where("("+h+")").setParameters(u),n.queryBuilderFactory&&n.queryBuilderFactory(f);const m=yield f.getRawMany();return m.forEach(y=>{s.forEach(T=>{y[T.databaseName]=this.connection.driver.prepareHydratedValue(y[T.databaseName],T.referencedColumn)}),i.inverseRelation.entityMetadata.primaryColumns.forEach(T=>{y[T.databaseName]=this.connection.driver.prepareHydratedValue(y[T.databaseName],T)})}),{relationIdAttribute:n,results:m}}else{const i=n.relation,s=i.isOwning?i.joinColumns:i.inverseRelation.inverseJoinColumns,a=i.isOwning?i.inverseJoinColumns:i.inverseRelation.joinColumns,o=n.junctionAlias,l=n.joinInverseSideMetadata.tableName,c=n.alias||l,u=i.isOwning?i.junctionEntityMetadata.tableName:i.inverseRelation.junctionEntityMetadata.tableName,h=e.map(N=>s.reduce((C,I)=>(C[I.propertyPath]=N[Be.buildAlias(this.connection.driver,void 0,n.parentAlias,I.referencedColumn.databaseName)],C),{}));if(h.length===0)return{relationIdAttribute:n,results:[]};const f={},d={},m=h.map((N,C)=>{const I=[],H={},Q=Object.keys(N).map(V=>{const J=V+C,E=N[V],A=`${o}:${V}:${E}`;return I.indexOf(A)!==-1?"":(I.push(A),H[J]=E,o+"."+V+" = :"+J)}).filter(V=>V).join(" AND ");I.sort();const te=I.join("::");return d[te]?"":(d[te]=!0,Object.assign(f,H),Q)}).filter(N=>N),y=a.map(N=>o+"."+N.propertyPath+" = "+c+"."+N.referencedColumn.propertyPath).join(" AND "),T=m.map(N=>"("+N+" AND "+y+")").join(" OR "),b=this.connection.createQueryBuilder(this.queryRunner);a.forEach(N=>{b.addSelect(o+"."+N.propertyPath,N.databaseName).addOrderBy(o+"."+N.propertyPath)}),s.forEach(N=>{b.addSelect(o+"."+N.propertyPath,N.databaseName).addOrderBy(o+"."+N.propertyPath)}),b.from(l,c).innerJoin(u,o,T).setParameters(f),n.queryBuilderFactory&&n.queryBuilderFactory(b);const S=yield b.getRawMany();return S.forEach(N=>{[...s,...a].forEach(C=>{N[C.databaseName]=this.connection.driver.prepareHydratedValue(N[C.databaseName],C.referencedColumn)})}),{relationIdAttribute:n,results:S}}}));return Promise.all(t)})}};class e_{constructor(e,t){this.connection=e,this.queryRunner=t}load(e,t,n){const i=Array.isArray(t)?t:[t],s=Array.isArray(n)?n:n?[n]:void 0;return e.isManyToMany?this.loadForManyToMany(e,i,s):e.isManyToOne||e.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(e,i,s):this.loadForOneToManyAndOneToOneNotOwner(e,i,s)}loadManyToManyRelationIdsAndGroup(e,t,n,i){return v(this,null,function*(){const s=e.isManyToMany||e.isOneToMany,a=Array.isArray(t)?t:[t];if(!n&&(n=yield this.connection.relationLoader.load(e,t,this.queryRunner,i),!n.length))return a.map(h=>({entity:h,related:s?[]:void 0}));const o=yield this.load(e,t,n),l=Array.isArray(n)?n:[n];let c=[],u=[];return e.isManyToManyOwner?(c=e.junctionEntityMetadata.inverseColumns.map(h=>h.referencedColumn),u=e.junctionEntityMetadata.ownerColumns.map(h=>h.referencedColumn)):e.isManyToManyNotOwner?(c=e.junctionEntityMetadata.ownerColumns.map(h=>h.referencedColumn),u=e.junctionEntityMetadata.inverseColumns.map(h=>h.referencedColumn)):e.isManyToOne||e.isOneToOneOwner?(c=e.joinColumns.map(h=>h.referencedColumn),u=e.entityMetadata.primaryColumns):(e.isOneToMany||e.isOneToOneNotOwner)&&(c=e.inverseRelation.entityMetadata.primaryColumns,u=e.inverseRelation.joinColumns.map(h=>h.referencedColumn)),a.map(h=>{const f={entity:h,related:s?[]:void 0},d=o.filter(m=>u.every(y=>y.compareEntityValue(h,m[y.entityMetadata.name+"_"+y.propertyAliasName])));return d.length&&l.forEach(m=>{d.forEach(y=>{c.every(b=>b.compareEntityValue(m,y[Be.buildAlias(this.connection.driver,void 0,b.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+b.propertyPath.replace(".","_"))]))&&(s?f.related.push(m):f.related=m)})}),f})})}loadForManyToMany(e,t,n){const i=e.junctionEntityMetadata,s=i.name,a=e.isOwning?i.ownerColumns:i.inverseColumns,o=e.isOwning?i.inverseColumns:i.ownerColumns,l=this.connection.createQueryBuilder(this.queryRunner);a.forEach(f=>{const d=Be.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+f.referencedColumn.propertyPath.replace(".","_"));l.addSelect(s+"."+f.propertyPath,d)}),o.forEach(f=>{const d=Be.buildAlias(this.connection.driver,void 0,f.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_"));l.addSelect(s+"."+f.propertyPath,d)});let c="";if(a.length===1){const f=t.map(m=>a[0].referencedColumn.getEntityValue(m));f.every(m=>typeof m=="number")?c=`${s}.${a[0].propertyPath} IN (${f.join(", ")})`:(l.setParameter("values1",f),c=s+"."+a[0].propertyPath+" IN (:...values1)")}else c="("+t.map((f,d)=>a.map(m=>{const y="entity1_"+d+"_"+m.propertyName;return l.setParameter(y,m.referencedColumn.getEntityValue(f)),s+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";let u="";if(n)if(o.length===1){const f=n.map(m=>o[0].referencedColumn.getEntityValue(m));f.every(m=>typeof m=="number")?u=`${s}.${o[0].propertyPath} IN (${f.join(", ")})`:(l.setParameter("values2",f),u=s+"."+o[0].propertyPath+" IN (:...values2)")}else u="("+n.map((f,d)=>o.map(m=>{const y="entity2_"+d+"_"+m.propertyName;return l.setParameter(y,m.referencedColumn.getEntityValue(f)),s+"."+m.propertyPath+" = :"+y}).join(" AND ")).map(f=>"("+f+")").join(" OR ")+")";const h=[c,u].filter(f=>f.length>0).join(" AND ");return l.from(i.target,s).where(h).getRawMany()}loadForManyToOneAndOneToOneOwner(e,t,n){const i=e.entityMetadata.targetName,s=e.joinColumns.every(l=>!!e.entityMetadata.nonVirtualColumns.find(c=>c===l));if(n&&s){const l=[];if(t.forEach(c=>{const u={};e.entityMetadata.primaryColumns.forEach(h=>{const f=h.entityMetadata.name+"_"+h.propertyPath.replace(".","_");u[f]=h.getEntityValue(c)}),n.forEach(h=>{e.joinColumns.forEach(f=>{const d=f.getEntityValue(c),m=f.referencedColumn.getEntityValue(h);if(!(d===void 0||m===void 0)&&d===m){const y=f.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+f.referencedColumn.propertyPath.replace(".","_");u[y]=m}})}),Object.keys(u).length===e.entityMetadata.primaryColumns.length+e.joinColumns.length&&l.push(u)}),l.length===t.length)return Promise.resolve(l)}const a=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(l=>{const c=Be.buildAlias(this.connection.driver,void 0,l.entityMetadata.name+"_"+l.propertyPath.replace(".","_"));a.addSelect(i+"."+l.propertyPath,c)}),e.joinColumns.forEach(l=>{const c=Be.buildAlias(this.connection.driver,void 0,l.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+l.referencedColumn.propertyPath.replace(".","_"));a.addSelect(i+"."+l.propertyPath,c)});let o="";if(e.entityMetadata.primaryColumns.length===1){const l=t.map(u=>e.entityMetadata.primaryColumns[0].getEntityValue(u));l.every(u=>typeof u=="number")?o=`${i}.${e.entityMetadata.primaryColumns[0].propertyPath} IN (${l.join(", ")})`:(a.setParameter("values",l),o=i+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else o=t.map((l,c)=>e.entityMetadata.primaryColumns.map((u,h)=>{const f="entity"+c+"_"+h;return a.setParameter(f,u.getEntityValue(l)),i+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(l=>"("+l+")").join(" OR ");return a.from(e.entityMetadata.target,i).where(o).getRawMany()}loadForOneToManyAndOneToOneNotOwner(e,t,n){const i=e;if(e=e.inverseRelation,e.entityMetadata.primaryColumns.length===e.joinColumns.length&&e.entityMetadata.primaryColumns.every(c=>e.joinColumns.indexOf(c)!==-1))return Promise.resolve(t.map(c=>{const u={};return e.joinColumns.forEach(function(h){const f=h.referencedColumn.getEntityValue(c),d=h.referencedColumn.entityMetadata.name+"_"+h.referencedColumn.propertyPath.replace(".","_"),m=h.entityMetadata.name+"_"+i.propertyPath.replace(".","_")+"_"+h.propertyPath.replace(".","_");u[d]=f,u[m]=f}),u}));const s=e.entityMetadata.targetName,a=this.connection.createQueryBuilder(this.queryRunner);e.entityMetadata.primaryColumns.forEach(l=>{const c=Be.buildAlias(this.connection.driver,void 0,l.entityMetadata.name+"_"+i.propertyPath.replace(".","_")+"_"+l.propertyPath.replace(".","_"));a.addSelect(s+"."+l.propertyPath,c)}),e.joinColumns.forEach(l=>{const c=Be.buildAlias(this.connection.driver,void 0,l.referencedColumn.entityMetadata.name+"_"+l.referencedColumn.propertyPath.replace(".","_"));a.addSelect(s+"."+l.propertyPath,c)});let o="";if(e.joinColumns.length===1){const l=t.map(u=>e.joinColumns[0].referencedColumn.getEntityValue(u));l.every(u=>typeof u=="number")?o=`${s}.${e.joinColumns[0].propertyPath} IN (${l.join(", ")})`:(a.setParameter("values",l),o=s+"."+e.joinColumns[0].propertyPath+" IN (:...values)")}else o=t.map((l,c)=>e.joinColumns.map((u,h)=>{const f="entity"+c+"_"+h;return a.setParameter(f,u.referencedColumn.getEntityValue(l)),s+"."+u.propertyPath+" = :"+f}).join(" AND ")).map(l=>"("+l+")").join(" OR ");return a.from(e.entityMetadata.target,s).where(o).getRawMany()}}class e3{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationIdAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationIds.forEach(t=>{const n=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationIdAttributes.push(n)})})}metadataToAttribute(e,t){return new Hp(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class t3{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationCountAttributes=n}load(e){return v(this,null,function*(){const t=(i,s,a)=>a.indexOf(i)===s,n=this.relationCountAttributes.map(i=>v(this,null,function*(){if(i.relation.isOneToMany){const s=i.relation,a=s.inverseRelation,o=a.joinColumns[0].referencedColumn.propertyName,l=s.inverseEntityMetadata.target,c=s.inverseEntityMetadata.tableName,u=i.alias||c,h=a.propertyName;let f=e.map(m=>m[i.parentAlias+"_"+o]).filter(m=>!!m);if(f=f.filter(t),f.length===0)return{relationCountAttribute:i,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);return d.select(u+"."+h,"parentId").addSelect("COUNT(*)","cnt").from(l,u).where(u+"."+h+" IN (:...ids)").addGroupBy(u+"."+h).setParameter("ids",f),i.queryBuilderFactory&&i.queryBuilderFactory(d),{relationCountAttribute:i,results:yield d.getRawMany()}}else{let s,a,o,l;i.relation.isOwning?(s=i.relation.joinColumns[0].referencedColumn.databaseName,a=i.relation.inverseJoinColumns[0].referencedColumn.databaseName,o=i.relation.junctionEntityMetadata.columns[0],l=i.relation.junctionEntityMetadata.columns[1]):(s=i.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,a=i.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,o=i.relation.junctionEntityMetadata.columns[1],l=i.relation.junctionEntityMetadata.columns[0]);let c=e.map(T=>T[i.parentAlias+"_"+s]).filter(T=>!!T);if(c=c.filter(t),c.length===0)return{relationCountAttribute:i,results:[]};const u=i.junctionAlias,h=i.joinInverseSideMetadata.tableName,f=i.alias||h,d=i.relation.junctionEntityMetadata.tableName,m=u+"."+o.propertyName+" IN ("+c.map(T=>isNaN(T)?"'"+T+"'":T)+") AND "+u+"."+l.propertyName+" = "+f+"."+a,y=this.connection.createQueryBuilder(this.queryRunner);return y.select(u+"."+o.propertyName,"parentId").addSelect("COUNT("+y.escape(f)+"."+y.escape(a)+")","cnt").from(h,f).innerJoin(d,u,m).addGroupBy(u+"."+o.propertyName),i.queryBuilderFactory&&i.queryBuilderFactory(y),{relationCountAttribute:i,results:yield y.getRawMany()}}}));return Promise.all(n)})}}class n3{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach(e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationCountAttributes.push(t)}),this.expressionMap.joinAttributes.forEach(e=>{!e.metadata||e.metadata.isJunction||e.metadata.relationCounts.forEach(t=>{const n=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationCountAttributes.push(n)})})}metadataToAttribute(e,t){return new Qp(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class jn{static isFindOneOptions(e){const t=e;return t&&(Array.isArray(t.select)||Array.isArray(t.relations)||typeof t.select=="object"||typeof t.relations=="object"||typeof t.where=="object"||typeof t.join=="object"||typeof t.order=="object"||typeof t.cache=="object"||typeof t.cache=="boolean"||typeof t.cache=="number"||typeof t.comment=="string"||typeof t.lock=="object"||typeof t.loadRelationIds=="object"||typeof t.loadRelationIds=="boolean"||typeof t.loadEagerRelations=="boolean"||typeof t.withDeleted=="boolean"||typeof t.relationLoadStrategy=="string"||typeof t.transaction=="boolean")}static isFindManyOptions(e){const t=e;return t&&(this.isFindOneOptions(t)||typeof t.skip=="number"||typeof t.take=="number"||typeof t.skip=="string"||typeof t.take=="string")}static extractFindManyOptionsAlias(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias}static applyOptionsToTreeQueryBuilder(e,t){if(t!=null&&t.relations){const n=[...t.relations];if(jn.applyRelationsRecursively(e,n,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),n.length>0)throw new J2(n)}return e}static applyRelationsRecursively(e,t,n,i,s){let a=[];if(s){const o=new RegExp("^"+s.replace(".","\\.")+"\\.");a=t.filter(l=>l.match(o)).map(l=>i.findRelationWithPropertyPath(l.replace(o,""))).filter(l=>l)}else a=t.map(o=>i.findRelationWithPropertyPath(o)).filter(o=>o);a.forEach(o=>{const l=Be.buildAlias(e.connection.driver,{joiner:"__"},n,o.propertyPath),c=n+"."+o.propertyPath;e.expressionMap.relationLoadStrategy==="query"?e.concatRelationMetadata(o):e.leftJoinAndSelect(c,l),t.splice(t.indexOf(s?s+"."+o.propertyPath:o.propertyPath),1);let u,h;if(e.expressionMap.relationLoadStrategy==="query")u=o.inverseEntityMetadata,h=l;else{const f=e.expressionMap.joinAttributes.find(d=>d.entityOrProperty===c);u=f.metadata,h=f.alias.name}if(!h||!u)throw new Wr(o.propertyPath,i);if(this.applyRelationsRecursively(e,t,h,u,s?s+"."+o.propertyPath:o.propertyPath),e.expressionMap.relationLoadStrategy==="join"){const f=i.relations.find(d=>d.propertyName===o.propertyPath);f&&this.joinEagerRelations(e,l,f.inverseEntityMetadata)}})}static joinEagerRelations(e,t,n){n.eagerRelations.forEach(i=>{let s=Be.buildAlias(e.connection.driver,{joiner:"__"},t,i.propertyName),a=!0;for(const c of e.expressionMap.joinAttributes)if(!(c.condition!==void 0||c.mapToProperty!==void 0||c.isMappingMany!==void 0||c.direction!=="LEFT"||c.entityOrProperty!==`${t}.${i.propertyPath}`)){a=!1,s=c.alias.name;break}const o=!!e.expressionMap.joinAttributes.find(c=>c.alias.name===s);a&&!o&&e.leftJoin(t+"."+i.propertyPath,s);let l=!0;for(const c of e.expressionMap.selects)if(!(c.aliasName!==void 0||c.virtual!==void 0||c.selection!==s)){l=!1;break}l&&e.addSelect(s),this.joinEagerRelations(e,s,i.inverseEntityMetadata)})}}class ml extends pn{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e+=this.createLockExpression(),e=e.trim(),this.expressionMap.subQuery&&(e="("+e+")"),this.replacePropertyNamesForTheWholeQuery(e)}setFindOptions(e){return this.findOptions=e,this.applyFindOptions(),this}subQuery(){const e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.parentQueryBuilder=this,e}select(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map(n=>({selection:n}));else if(typeof e=="function"){const n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this}addSelect(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map(n=>({selection:n})));else if(typeof e=="function"){const n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this}maxExecutionTime(e){return this.expressionMap.maxExecutionTime=e,this}distinct(e=!0){return this.expressionMap.selectDistinct=e,this}distinctOn(e){return this.expressionMap.selectDistinctOn=e,this}fromDummy(){var e;return this.from((e=this.connection.driver.dummyTableName)!=null?e:"(SELECT 1 AS dummy_column)","dummy_table")}from(e,t){const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}addFrom(e,t){const n=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(n),this}innerJoin(e,t,n,i){return this.join("INNER",e,t,n,i),this}leftJoin(e,t,n,i){return this.join("LEFT",e,t,n,i),this}innerJoinAndSelect(e,t,n,i){return this.addSelect(t),this.innerJoin(e,t,n,i),this}leftJoinAndSelect(e,t,n,i){return this.addSelect(t),this.leftJoin(e,t,n,i),this}innerJoinAndMapMany(e,t,n,i,s){return this.addSelect(n),this.join("INNER",t,n,i,s,e,!0),this}innerJoinAndMapOne(e,t,n,i,s,a){return this.addSelect(n),this.join("INNER",t,n,i,s,e,!1,a),this}leftJoinAndMapMany(e,t,n,i,s){return this.addSelect(n),this.join("LEFT",t,n,i,s,e,!0),this}leftJoinAndMapOne(e,t,n,i,s,a){return this.addSelect(n),this.join("LEFT",t,n,i,s,e,!1,a),this}loadRelationIdAndMap(e,t,n,i){const s=new Hp(this.expressionMap);return s.mapToProperty=e,s.relationName=t,typeof n=="string"&&(s.alias=n),typeof n=="object"&&n.disableMixedMap&&(s.disableMixedMap=!0),s.queryBuilderFactory=i,this.expressionMap.relationIdAttributes.push(s),s.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:s.junctionAlias,metadata:s.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(e,t,n,i){const s=new Qp(this.expressionMap);return s.mapToProperty=e,s.relationName=t,s.alias=n,s.queryBuilderFactory=i,this.expressionMap.relationCountAttributes.push(s),this.expressionMap.createAlias({type:"other",name:s.junctionAlias}),s.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:s.junctionAlias,metadata:s.relation.junctionEntityMetadata}),this}loadAllRelationIds(e){return this.expressionMap.mainAlias.metadata.relations.forEach(t=>{e!==void 0&&e.relations!==void 0&&e.relations.indexOf(t.propertyPath)===-1||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+t.propertyPath,this.expressionMap.mainAlias.name+"."+t.propertyPath,e)}),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereExists(e){return this.where(...this.getExistsCondition(e))}andWhereExists(e){return this.andWhere(...this.getExistsCondition(e))}orWhereExists(e){return this.orWhere(...this.getExistsCondition(e))}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}having(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this}andHaving(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this}orHaving(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this}groupBy(e){return e?this.expressionMap.groupBys=[e]:this.expressionMap.groupBys=[],this}addGroupBy(e){return this.expressionMap.groupBys.push(e),this}timeTravelQuery(e){return this.connection.driver.options.type==="cockroachdb"&&(e===void 0?this.expressionMap.timeTravel="follower_read_timestamp()":this.expressionMap.timeTravel=e),this}orderBy(e,t="ASC",n){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new Z('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(n!==void 0&&n!=="NULLS FIRST"&&n!=="NULLS LAST")throw new Z('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return e?typeof e=="object"?this.expressionMap.orderBys=e:n?this.expressionMap.orderBys={[e]:{order:t,nulls:n}}:this.expressionMap.orderBys={[e]:t}:this.expressionMap.orderBys={},this}addOrderBy(e,t="ASC",n){if(t!==void 0&&t!=="ASC"&&t!=="DESC")throw new Z('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(n!==void 0&&n!=="NULLS FIRST"&&n!=="NULLS LAST")throw new Z('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return n?this.expressionMap.orderBys[e]={order:t,nulls:n}:this.expressionMap.orderBys[e]=t,this}limit(e){if(this.expressionMap.limit=this.normalizeNumber(e),this.expressionMap.limit!==void 0&&isNaN(this.expressionMap.limit))throw new Z('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(e){if(this.expressionMap.offset=this.normalizeNumber(e),this.expressionMap.offset!==void 0&&isNaN(this.expressionMap.offset))throw new Z('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(e){if(this.expressionMap.take=this.normalizeNumber(e),this.expressionMap.take!==void 0&&isNaN(this.expressionMap.take))throw new Z('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(e){if(this.expressionMap.skip=this.normalizeNumber(e),this.expressionMap.skip!==void 0&&isNaN(this.expressionMap.skip))throw new Z('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(e){return this.expressionMap.useIndex=e,this}setLock(e,t,n){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=n,this}setOnLocked(e){return this.expressionMap.onLocked=e,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}getRawOne(){return v(this,null,function*(){return(yield this.getRawMany())[0]})}getRawMany(){return v(this,null,function*(){if(this.expressionMap.lockMode==="optimistic")throw new xo;this.expressionMap.queryEntity=!1;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0);const n=yield this.loadRawResults(e);return t&&(yield e.commitTransaction()),n}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}getRawAndEntities(){return v(this,null,function*(){const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const n=yield this.executeEntitiesAndRawResults(e);return t&&(yield e.commitTransaction()),n}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}getOne(){return v(this,null,function*(){const t=(yield this.getRawAndEntities()).entities[0];if(t&&this.expressionMap.lockMode==="optimistic"&&this.expressionMap.lockVersion){const n=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const i=n.updateDateColumn.getEntityValue(t);if(i.getTime()!==this.expressionMap.lockVersion.getTime())throw new Zg(n.name,this.expressionMap.lockVersion,i)}else{const i=n.versionColumn.getEntityValue(t);if(i!==this.expressionMap.lockVersion)throw new Zg(n.name,this.expressionMap.lockVersion,i)}}return t===void 0?null:t})}getOneOrFail(){return v(this,null,function*(){const e=yield this.getOne();if(!e)throw new Od(this.expressionMap.mainAlias.target,this.expressionMap.parameters);return e})}getMany(){return v(this,null,function*(){if(this.expressionMap.lockMode==="optimistic")throw new xo;return(yield this.getRawAndEntities()).entities})}getCount(){return v(this,null,function*(){if(this.expressionMap.lockMode==="optimistic")throw new xo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const n=yield this.executeCountQuery(e);return t&&(yield e.commitTransaction()),n}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}getExists(){return v(this,null,function*(){if(this.expressionMap.lockMode==="optimistic")throw new xo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const n=yield this.executeExistsQuery(e);return t&&(yield e.commitTransaction()),n}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}getManyAndCount(){return v(this,null,function*(){if(this.expressionMap.lockMode==="optimistic")throw new xo;const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const n=yield this.executeEntitiesAndRawResults(e);this.expressionMap.queryEntity=!1;let i=this.lazyCount(n);if(i===void 0){const a=this.expressionMap.cacheId;a&&(this.expressionMap.cacheId=`${a}-count`),i=yield this.executeCountQuery(e)}const s=[n.entities,i];return t&&(yield e.commitTransaction()),s}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}lazyCount(e){const t=this.expressionMap.limit!==void 0&&this.expressionMap.limit!==null;if(this.expressionMap.joinAttributes.length>0&&t)return;const n=this.expressionMap.take!==void 0&&this.expressionMap.take!==null,i=t?this.expressionMap.limit:n?this.expressionMap.take:void 0;if(i!==void 0&&e.entities.length===i)return;const s=this.expressionMap.skip!==void 0&&this.expressionMap.skip!==null&&this.expressionMap.skip>0,a=this.expressionMap.offset!==void 0&&this.expressionMap.offset!==null&&this.expressionMap.offset>0;if(e.entities.length===0&&(s||a))return;const o=a?this.expressionMap.offset:s?this.expressionMap.skip:0;return e.entities.length+o}stream(){return v(this,null,function*(){this.expressionMap.queryEntity=!1;const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();let i=!1;try{this.expressionMap.useTransaction===!0&&n.isTransactionActive===!1&&(yield n.startTransaction(),i=!0);const s=()=>{if(n!==this.queryRunner)return n.release()},a=n.stream(e,t,s,s);return i&&(yield n.commitTransaction()),a}catch(s){if(i)try{yield n.rollbackTransaction()}catch(a){}throw s}})}cache(e,t){return typeof e=="boolean"?this.expressionMap.cache=e:typeof e=="number"?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):(typeof e=="string"||typeof e=="number")&&(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this}setOption(e){return this.expressionMap.options.push(e),this}join(e,t,n,i,s,a,o,l){s&&this.setParameters(s);const c=new XT(this.connection,this.expressionMap);c.direction=e,c.mapAsEntity=l,c.mapToProperty=a,c.isMappingMany=o,c.entityOrProperty=t,c.condition=i,this.expressionMap.joinAttributes.push(c);const u=c.metadata;if(u){if(u.deleteDateColumn&&!this.expressionMap.withDeleted){const h=`${n}.${u.deleteDateColumn.propertyName} IS NULL`;c.condition=c.condition?` ${c.condition} AND ${h}`:`${h}`}c.alias=this.expressionMap.createAlias({type:"join",name:n,metadata:u}),c.relation&&c.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:c.junctionAlias,metadata:c.relation.junctionEntityMetadata})}else{let h="";if(typeof t=="function"){const d=t(this.subQuery());this.setParameters(d.getParameters()),h=d.getQuery()}else h=t;const f=typeof t=="function"||t.substr(0,1)==="("&&t.substr(-1)===")";c.alias=this.expressionMap.createAlias({type:"join",name:n,tablePath:f===!1?t:void 0,subQuery:f===!0?h:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new Z("Cannot build query because main alias is not set (call qb#from method)");const e=[],t=[];if(this.expressionMap.mainAlias.hasMetadata){const o=this.expressionMap.mainAlias.metadata;e.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,o)),t.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,o))}this.expressionMap.joinAttributes.forEach(o=>{if(o.metadata)e.push(...this.buildEscapedEntityColumnSelects(o.alias.name,o.metadata)),t.push(...this.findEntityColumnSelects(o.alias.name,o.metadata));else if(this.expressionMap.selects.some(c=>c.selection===o.alias.name)){e.push({selection:this.escape(o.alias.name)+".*"});const c=this.expressionMap.selects.find(u=>u.selection===o.alias.name);t.push(c)}}),this.expressionMap.selects.filter(o=>t.indexOf(o)===-1).forEach(o=>e.push({selection:this.replacePropertyNames(o.selection),aliasName:o.aliasName})),e.length===0&&e.push({selection:"*"});let n="";this.expressionMap.useIndex&&Be.isMySQLFamily(this.connection.driver)&&(n=` USE INDEX (${this.expressionMap.useIndex})`);const i=this.expressionMap.aliases.filter(o=>o.type==="from"&&(o.tablePath||o.subQuery)).map(o=>o.subQuery?o.subQuery+" "+this.escape(o.name):this.getTableName(o.tablePath)+" "+this.escape(o.name)),s=this.createSelectDistinctExpression(),a=e.map(o=>o.selection+(o.aliasName?" AS "+this.escape(o.aliasName):"")).join(", ");return s+a+" FROM "+i.join(", ")+this.createTableLockExpression()+n}createSelectDistinctExpression(){const{selectDistinct:e,selectDistinctOn:t,maxExecutionTime:n}=this.expressionMap,{driver:i}=this.connection;let s="SELECT ";return n>0&&Be.isMySQLFamily(i)&&(s+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),Be.isPostgresFamily(i)&&t.length>0?s=`SELECT DISTINCT ON (${t.map(o=>this.replacePropertyNames(o)).join(", ")}) `:e&&(s="SELECT DISTINCT "),s}createJoinExpression(){return this.expressionMap.joinAttributes.map(t=>{const n=t.relation,i=t.tablePath,s=t.alias.name;let a=t.condition?" AND ("+t.condition+")":"";const o=t.parentAlias;if(!o||!n){const l=t.alias.subQuery?t.alias.subQuery:this.getTableName(i);return" "+t.direction+" JOIN "+l+" "+this.escape(s)+this.createTableLockExpression()+(t.condition?" ON "+this.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){const l=n.joinColumns.map(c=>s+"."+c.referencedColumn.propertyPath+"="+o+"."+n.propertyPath+"."+c.referencedColumn.propertyPath).join(" AND ");return" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(s)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l+a)}else if(n.isOneToMany||n.isOneToOneNotOwner){const l=n.inverseRelation.joinColumns.map(c=>(n.inverseEntityMetadata.tableType==="entity-child"&&n.inverseEntityMetadata.discriminatorColumn&&(a+=" AND "+s+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),s+"."+n.inverseRelation.propertyPath+"."+c.referencedColumn.propertyPath+"="+o+"."+c.referencedColumn.propertyPath)).join(" AND ");if(!l)throw new Z(`Relation ${n.entityMetadata.name}.${n.propertyName} does not have join columns.`);return" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(s)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l+a)}else{const l=n.junctionEntityMetadata.tablePath,c=t.junctionAlias;let u="",h="";return n.isOwning?(u=n.joinColumns.map(f=>c+"."+f.propertyPath+"="+o+"."+f.referencedColumn.propertyPath).join(" AND "),h=n.inverseJoinColumns.map(f=>s+"."+f.referencedColumn.propertyPath+"="+c+"."+f.propertyPath).join(" AND ")):(u=n.inverseRelation.inverseJoinColumns.map(f=>c+"."+f.propertyPath+"="+o+"."+f.referencedColumn.propertyPath).join(" AND "),h=n.inverseRelation.joinColumns.map(f=>s+"."+f.referencedColumn.propertyPath+"="+c+"."+f.propertyPath).join(" AND "))," "+t.direction+" JOIN "+this.getTableName(l)+" "+this.escape(c)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(u)+" "+t.direction+" JOIN "+this.getTableName(i)+" "+this.escape(s)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(h+a)}}).join(" ")}createGroupByExpression(){return!this.expressionMap.groupBys||!this.expressionMap.groupBys.length?"":" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", "))}createOrderByExpression(){const e=this.expressionMap.allOrderBys;return Object.keys(e).length===0?"":" ORDER BY "+Object.keys(e).map(t=>{const n=typeof e[t]=="string"?e[t]:e[t].order+" "+e[t].nulls,i=this.expressionMap.selects.find(s=>s.selection===t);if(i&&!i.aliasName&&t.indexOf(".")!==-1){const s=t.split("."),a=s[0],o=s.slice(1).join("."),l=this.expressionMap.aliases.find(c=>c.name===a);if(l){const c=l.metadata.findColumnWithPropertyPath(o);if(c){const u=Be.buildAlias(this.connection.driver,void 0,a,c.databaseName);return this.escape(u)+" "+n}}}return this.replacePropertyNames(t)+" "+n}).join(", ")}createLimitOffsetExpression(){let e=this.expressionMap.offset,t=this.expressionMap.limit;e===void 0&&t===void 0&&this.expressionMap.joinAttributes.length===0&&(e=this.expressionMap.skip,t=this.expressionMap.take);const n=t!=null,i=e!=null;if(this.connection.driver.options.type==="mssql"){let s="";if((n||i)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(s=" ORDER BY (SELECT NULL)"),n&&i)return s+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(n)return s+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(i)return s+" OFFSET "+e+" ROWS"}else if(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){if(n&&i)return" LIMIT "+t+" OFFSET "+e;if(n)return" LIMIT "+t;if(i)throw new iq}else if(Be.isSQLiteFamily(this.connection.driver)){if(n&&i)return" LIMIT "+t+" OFFSET "+e;if(n)return" LIMIT "+t;if(i)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver.options.type==="oracle"){if(n&&i)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(n)return" FETCH NEXT "+t+" ROWS ONLY";if(i)return" OFFSET "+e+" ROWS"}else{if(n&&i)return" LIMIT "+t+" OFFSET "+e;if(n)return" LIMIT "+t;if(i)return" OFFSET "+e}return""}createTableLockExpression(){if(this.connection.driver.options.type==="mssql")switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const e=this.connection.driver;let t="";if(this.expressionMap.lockTables){if(!(Be.isPostgresFamily(e)||e.options.type==="cockroachdb"))throw new Z("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new Z("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}let n="";switch(this.expressionMap.onLocked==="nowait"?n=" NOWAIT":this.expressionMap.onLocked==="skip_locked"&&(n=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if(e.options.type==="mysql"||e.options.type==="aurora-mysql")return Be.isReleaseVersionOrGreater(e,"8.0.0")?" FOR SHARE"+t+n:" LOCK IN SHARE MODE";if(e.options.type==="mariadb")return" LOCK IN SHARE MODE";if(Be.isPostgresFamily(e))return" FOR SHARE"+t+n;if(e.options.type==="oracle")return" FOR UPDATE";if(e.options.type==="mssql")return"";throw new ca;case"pessimistic_write":if(Be.isMySQLFamily(e)||e.options.type==="aurora-mysql"||e.options.type==="oracle")return" FOR UPDATE"+n;if(Be.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+n;if(e.options.type==="mssql")return"";throw new ca;case"pessimistic_partial_write":if(Be.isPostgresFamily(e))return" FOR UPDATE"+t+" SKIP LOCKED";if(Be.isMySQLFamily(e))return" FOR UPDATE SKIP LOCKED";throw new ca;case"pessimistic_write_or_fail":if(Be.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR UPDATE"+t+" NOWAIT";if(Be.isMySQLFamily(e))return" FOR UPDATE NOWAIT";throw new ca;case"for_no_key_update":if(Be.isPostgresFamily(e)||e.options.type==="cockroachdb")return" FOR NO KEY UPDATE"+t+n;throw new ca;case"for_key_share":if(Be.isPostgresFamily(e))return" FOR KEY SHARE"+t+n;throw new ca;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const e=this.expressionMap.havings.map((t,n)=>{switch(t.type){case"and":return(n>0?"AND ":"")+this.replacePropertyNames(t.condition);case"or":return(n>0?"OR ":"")+this.replacePropertyNames(t.condition);default:return this.replacePropertyNames(t.condition)}}).join(" ");return e.length?" HAVING "+e:""}buildEscapedEntityColumnSelects(e,t){const n=this.expressionMap.selects.some(c=>c.selection===e),i=[];if(n&&i.push(...t.columns.filter(c=>c.isSelect===!0)),i.push(...t.columns.filter(c=>this.expressionMap.selects.some(u=>u.selection===e+"."+c.propertyPath))),i.length===0)return[];const s=this.expressionMap.queryEntity?t.primaryColumns.filter(c=>i.indexOf(c)===-1):[],a=[...i,...s],o=[],l=this.escape(e);return a.forEach(c=>{let u=l+"."+this.escape(c.databaseName);c.isVirtualProperty&&c.query&&(u=`(${c.query(l)})`),this.connection.driver.spatialTypes.indexOf(c.type)!==-1&&((Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&(u=`${this.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText"}(${u})`),Be.isPostgresFamily(this.connection.driver)&&(c.precision?u=`ST_AsGeoJSON(${u}, ${c.precision})::json`:u=`ST_AsGeoJSON(${u})::json`),this.connection.driver.options.type==="mssql"&&(u=`${u}.ToString()`));const h=this.expressionMap.selects.filter(f=>f.selection===e+"."+c.propertyPath);h.length?h.forEach(f=>{o.push({selection:u,aliasName:f.aliasName?f.aliasName:Be.buildAlias(this.connection.driver,void 0,e,c.databaseName),virtual:f.virtual})}):o.push({selection:u,aliasName:Be.buildAlias(this.connection.driver,void 0,e,c.databaseName),virtual:n})}),o}findEntityColumnSelects(e,t){return this.expressionMap.selects.filter(n=>n.selection===e||t.columns.some(i=>n.selection===e+"."+i.propertyPath))}computeCountExpression(){const e=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,i=this.escape(e);if(this.expressionMap.joinAttributes.length===0&&this.expressionMap.relationIdAttributes.length===0&&this.expressionMap.relationCountAttributes.length===0)return"COUNT(1)";if(this.connection.driver.options.type==="cockroachdb"||Be.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+n.map(s=>`${i}.${this.escape(s.databaseName)}`).join(", ")+"))";if(Be.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+n.map(s=>`${i}.${this.escape(s.databaseName)}`).join(", ")+")";if(this.connection.driver.options.type==="mssql"){const s=n.map(a=>`${i}.${this.escape(a.databaseName)}`).join(", '|;|', ");return n.length===1?`COUNT(DISTINCT(${s}))`:`COUNT(DISTINCT(CONCAT(${s})))`}return this.connection.driver.options.type==="spanner"?n.length===1?`COUNT(DISTINCT(${i}.${this.escape(n[0].databaseName)}))`:`COUNT(DISTINCT(CONCAT(${n.map(a=>`CAST(${i}.${this.escape(a.databaseName)} AS STRING)`).join(", '|;|', ")})))`:"COUNT(DISTINCT("+n.map(s=>`${i}.${this.escape(s.databaseName)}`).join(" || '|;|' || ")+"))"}executeCountQuery(e){return v(this,null,function*(){const t=this.computeCountExpression(),n=yield this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e);return!n||!n[0]||!n[0].cnt?0:parseInt(n[0].cnt)})}executeExistsQuery(e){return v(this,null,function*(){return(yield this.connection.createQueryBuilder().fromDummy().select("1","row_exists").whereExists(this).limit(1).loadRawResults(e)).length>0})}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const e=Array.isArray(this.findOptions.select)?ke.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(e,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const e=Array.isArray(this.findOptions.relations)?ke.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.findOptions.loadEagerRelations!==!1&&this.expressionMap.relationLoadStrategy==="join"&&this.buildEagerRelations(e,typeof this.findOptions.select=="object"?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere(this.conditions.substr(0,1)!=="("?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach(e=>{e.select&&!e.selection?e.type==="inner"?this.innerJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):e.type==="inner"?this.innerJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias)}),this.findOptions.skip!==void 0&&this.skip(this.findOptions.skip),this.findOptions.take!==void 0&&this.take(this.findOptions.take),typeof this.findOptions.cache=="number"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="boolean"?this.cache(this.findOptions.cache):typeof this.findOptions.cache=="object"&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach(e=>{this.leftJoin(this.findOptions.join.leftJoin[e],e)}),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach(e=>{this.innerJoin(this.findOptions.join.innerJoin[e],e)}),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach(e=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[e],e)}),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach(e=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[e],e)})),this.findOptions.lock){if(this.findOptions.lock.mode==="optimistic")this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if(this.findOptions.lock.mode==="pessimistic_read"||this.findOptions.lock.mode==="pessimistic_write"||this.findOptions.lock.mode==="dirty_read"||this.findOptions.lock.mode==="pessimistic_partial_write"||this.findOptions.lock.mode==="pessimistic_write_or_fail"||this.findOptions.lock.mode==="for_no_key_update"||this.findOptions.lock.mode==="for_key_share"){const e=this.findOptions.lock.tables?this.findOptions.lock.tables.map(t=>{const n=this.expressionMap.aliases.find(i=>i.metadata.tableNameWithoutPrefix===t);if(!n)throw new Z(`"${t}" is not part of this query`);return this.escape(n.name)}):void 0;this.setLock(this.findOptions.lock.mode,void 0,e),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}}this.findOptions.loadRelationIds===!0?this.loadAllRelationIds():typeof this.findOptions.loadRelationIds=="object"&&this.loadAllRelationIds(this.findOptions.loadRelationIds),this.findOptions.loadEagerRelations!==!1&&jn.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),this.findOptions.transaction===!0&&(this.expressionMap.useTransaction=!0)}}concatRelationMetadata(e){this.relationMetadatas.push(e)}executeEntitiesAndRawResults(e){return v(this,null,function*(){if(!this.expressionMap.mainAlias)throw new Z('Alias is not set. Use "from" method to set an alias.');if((this.expressionMap.lockMode==="pessimistic_read"||this.expressionMap.lockMode==="pessimistic_write"||this.expressionMap.lockMode==="pessimistic_partial_write"||this.expressionMap.lockMode==="pessimistic_write_or_fail"||this.expressionMap.lockMode==="for_no_key_update"||this.expressionMap.lockMode==="for_key_share")&&!e.isTransactionActive)throw new X2;if(this.expressionMap.lockMode==="optimistic"){const l=this.expressionMap.mainAlias.metadata;if(!l.versionColumn&&!l.updateDateColumn)throw new G2(l.name)}const t=new ZB(this.connection,e,this.expressionMap.relationIdAttributes),n=new t3(this.connection,e,this.expressionMap.relationCountAttributes);new e3(this.expressionMap).transform(),new n3(this.expressionMap).transform();let a=[],o=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[l,c]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),u=this.expressionMap.mainAlias.metadata,h=this.expressionMap.mainAlias.name,f=u.primaryColumns.map(y=>{const T=this.escape("distinctAlias"),b=this.escape(Be.buildAlias(this.connection.driver,void 0,h,y.databaseName));c[b]||(c[b]="ASC");const S=Be.buildAlias(this.connection.driver,void 0,"ids_"+h,y.databaseName);return`${T}.${b} AS ${this.escape(S)}`}),d=this.clone(),m=d.expressionMap.timeTravel;if(a=yield new ml(this.connection,e).select(`DISTINCT ${f.join(", ")}`).addSelect(l).from(`(${d.orderBy().timeTravelQuery(!1).getQuery()})`,"distinctAlias").timeTravelQuery(m).offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(c).cache(this.expressionMap.cache&&this.expressionMap.cacheId?`${this.expressionMap.cacheId}-pagination`:this.expressionMap.cache,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let y="";const T={};if(u.hasMultiplePrimaryKeys)y=a.map((b,S)=>u.primaryColumns.map(N=>{const C=`orm_distinct_ids_${S}_${N.databaseName}`,I=Be.buildAlias(this.connection.driver,void 0,"ids_"+h,N.databaseName);return T[C]=b[I],`${h}.${N.propertyPath}=:${C}`}).join(" AND ")).join(" OR ");else{const b=Be.buildAlias(this.connection.driver,void 0,"ids_"+h,u.primaryColumns[0].databaseName),S=a.map(C=>C[b]);S.every(C=>typeof C=="number")?y=`${h}.${u.primaryColumns[0].propertyPath} IN (${S.join(", ")})`:(T.orm_distinct_ids=S,y=h+"."+u.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=yield this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:y}).setParameters(T).loadRawResults(e)}}else a=yield this.loadRawResults(e);if(a.length>0){const l=yield t.load(a),c=yield n.load(a);o=new XB(this.expressionMap,this.connection.driver,l,c,this.queryRunner).transform(a,this.expressionMap.mainAlias),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield e.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,o))}if(this.expressionMap.relationLoadStrategy==="query"){const l=new e_(this.connection,e);yield Promise.all(this.relationMetadatas.map(c=>v(this,null,function*(){const u=c.inverseEntityMetadata.target,h=c.inverseEntityMetadata.targetName,f=Array.isArray(this.findOptions.select)?ke.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,d=Array.isArray(this.findOptions.relations)?ke.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,m=this.createQueryBuilder(e).select(h).from(u,h).setFindOptions({select:f?ke.deepValue(f,c.propertyPath):void 0,order:this.findOptions.order?ke.deepValue(this.findOptions.order,c.propertyPath):void 0,relations:d?ke.deepValue(d,c.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(o.length>0){const y=yield l.loadManyToManyRelationIdsAndGroup(c,o,void 0,m);o.forEach(T=>{const b=y.find(S=>S.entity===T);if(b){const S=b.related===void 0?null:b.related;c.setEntityValue(T,S)}})}})))}return{raw:a,entities:o}})}createOrderByCombinedWithSelectExpression(e){const t=this.expressionMap.allOrderBys,n=Object.keys(t).map(s=>{if(s.indexOf(".")!==-1){const a=s.split("."),o=a[0],l=a.slice(1).join("."),u=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);return this.escape(e)+"."+this.escape(Be.buildAlias(this.connection.driver,void 0,o,u.databaseName))}else return this.expressionMap.selects.find(a=>a.selection===s||a.aliasName===s)?this.escape(e)+"."+this.escape(s):""}).join(", "),i={};return Object.keys(t).forEach(s=>{if(s.indexOf(".")!==-1){const a=s.split("."),o=a[0],l=a.slice(1).join("."),u=this.expressionMap.findAliasByName(o).metadata.findColumnWithPropertyPath(l);i[this.escape(e)+"."+this.escape(Be.buildAlias(this.connection.driver,void 0,o,u.databaseName))]=t[s]}else this.expressionMap.selects.find(a=>a.selection===s||a.aliasName===s)?i[this.escape(e)+"."+this.escape(s)]=t[s]:i[s]=t[s]}),[n,i]}loadRawResults(e){return v(this,null,function*(){const[t,n]=this.getQueryAndParameters(),i=t+" -- PARAMETERS: "+JSON.stringify(n,(u,h)=>typeof h=="bigint"?h.toString():h),s=typeof this.connection.options.cache=="object"?this.connection.options.cache:{};let a;const o=s.alwaysEnabled&&this.expressionMap.cache!==!1||this.expressionMap.cache===!0;let l=!1;if(this.connection.queryResultCache&&o)try{if(a=yield this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:i,duration:this.expressionMap.cacheDuration||s.duration||1e3},e),a&&!this.connection.queryResultCache.isExpired(a))return JSON.parse(a.result)}catch(u){if(!s.ignoreErrors)throw u;l=!0}const c=yield e.query(t,n,!0);if(!l&&this.connection.queryResultCache&&o)try{yield this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:i,time:Date.now(),duration:this.expressionMap.cacheDuration||s.duration||1e3,result:JSON.stringify(c.records)},a,e)}catch(u){if(!s.ignoreErrors)throw u}return c.records})}mergeExpressionMap(e){return _t.assign(this.expressionMap,e),this}normalizeNumber(e){return typeof e=="number"||e===void 0||e===null?e:Number(e)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner(this.connection.defaultReplicationModeForReads())}buildSelect(e,t,n,i){for(const s in e){if(e[s]===void 0||e[s]===!1)continue;const a=i?i+"."+s:s,o=t.findColumnWithPropertyPathStrict(a),l=t.findEmbeddedWithPropertyPath(a),c=t.findRelationWithPropertyPath(a);if(!l&&!o&&!c)throw new Wr(a,t);o?this.selects.push(n+"."+a):l&&this.buildSelect(e[s],t,n,a)}}buildRelations(e,t,n,i,s){e&&Object.keys(e).forEach(a=>{const o=e[a],l=s?s+"."+a:a,c=n.findEmbeddedWithPropertyPath(l),u=n.findRelationWithPropertyPath(l);if(!c&&!u)throw new Wr(l,n);if(c)this.buildRelations(o,typeof t=="object"?ke.deepValue(t,c.propertyPath):void 0,n,i,l);else if(u){let h=i+"_"+l.replace(".","_");h=Be.buildAlias(this.connection.driver,{joiner:"__"},i,h),(o===!0||typeof o=="object")&&(this.expressionMap.relationLoadStrategy==="query"?this.concatRelationMetadata(u):(this.joins.push({type:"left",select:!0,selection:t&&typeof t[a]=="object"?t[a]:void 0,alias:h,parentAlias:i,relationMetadata:u}),t&&typeof t[a]=="object"&&this.buildSelect(t[a],u.inverseEntityMetadata,h))),typeof o=="object"&&this.expressionMap.relationLoadStrategy==="join"&&this.buildRelations(o,typeof t=="object"?ke.deepValue(t,u.propertyPath):void 0,u.inverseEntityMetadata,h,void 0)}})}buildEagerRelations(e,t,n,i,s){e&&Object.keys(e).forEach(a=>{const o=e[a],l=s?s+"."+a:a,c=n.findEmbeddedWithPropertyPath(l),u=n.findRelationWithPropertyPath(l);if(!c&&!u)throw new Wr(l,n);if(c)this.buildEagerRelations(o,typeof t=="object"?ke.deepValue(t,c.propertyPath):void 0,n,i,l);else if(u){let h=i+"_"+l.replace(".","_");h=Be.buildAlias(this.connection.driver,{joiner:"__"},i,h),(o===!0||typeof o=="object")&&u.inverseEntityMetadata.eagerRelations.forEach(f=>{let d=h+"_"+f.propertyPath.replace(".","_");d=Be.buildAlias(this.connection.driver,{joiner:"__"},h,d),this.joins.find(y=>y.alias===d)||this.joins.push({type:"left",select:!0,alias:d,parentAlias:h,selection:void 0,relationMetadata:f}),t&&typeof t[a]=="object"&&this.buildSelect(t[a],u.inverseEntityMetadata,h)}),typeof o=="object"&&this.buildEagerRelations(o,typeof t=="object"?ke.deepValue(t,u.propertyPath):void 0,u.inverseEntityMetadata,h,void 0)}})}buildOrder(e,t,n,i){for(const s in e){if(e[s]===void 0)continue;const a=i?i+"."+s:s,o=t.findColumnWithPropertyPathStrict(a),l=t.findEmbeddedWithPropertyPath(a),c=t.findRelationWithPropertyPath(a);if(!l&&!o&&!c)throw new Wr(a,t);if(o){let u=typeof e[s]=="object"?e[s].direction:e[s];u=u==="DESC"||u==="desc"||u===-1?"DESC":"ASC";let h=typeof e[s]=="object"?e[s].nulls:void 0;h=(h==null?void 0:h.toLowerCase())==="first"?"NULLS FIRST":(h==null?void 0:h.toLowerCase())==="last"?"NULLS LAST":void 0;const f=`${n}.${a}`;this.addOrderBy(f,u,h)}else if(l)this.buildOrder(e[s],t,n,a);else if(c){let u=n+"_"+a.replace(".","_");u=Be.buildAlias(this.connection.driver,{joiner:"__"},n,u),this.joins.find(f=>f.alias===u)||this.joins.push({type:"left",select:!1,alias:u,parentAlias:n,selection:void 0,relationMetadata:c}),this.buildOrder(e[s],c.inverseEntityMetadata,u)}}}buildWhere(e,t,n,i){var a,o,l;let s="";if(Array.isArray(e))e.length&&(s=e.map(c=>this.buildWhere(c,t,n,i)).filter(c=>!!c).map(c=>"("+c+")").join(" OR "));else{const c=[];for(const u in e){let h=e[u];const f=i?i+"."+u:u,d=t.findColumnWithPropertyPathStrict(f),m=t.findEmbeddedWithPropertyPath(f),y=t.findRelationWithPropertyPath(f);if(!m&&!d&&!y)throw new Wr(f,t);if(h===void 0){if((((a=this.connection.options.invalidWhereValuesBehavior)==null?void 0:a.undefined)||"ignore")==="throw")throw new Z(`Undefined value encountered in property '${n}.${u}' of a where condition. Set 'invalidWhereValuesBehavior.undefined' to 'ignore' in connection options to skip properties with undefined values.`);continue}if(h===null){const T=((o=this.connection.options.invalidWhereValuesBehavior)==null?void 0:o.null)||"ignore";if(T==="ignore")continue;if(T==="throw")throw new Z(`Null value encountered in property '${n}.${u}' of a where condition. To match with SQL NULL, the IsNull() operator must be used. Set 'invalidWhereValuesBehavior.null' to 'ignore' or 'sql-null' in connection options to skip or handle null values.`)}if(d){let T=`${n}.${f}`;if(d.isVirtualProperty&&d.query&&(T=`(${d.query(this.escape(n))})`),h===null){c.push(`${T} IS NULL`);continue}de.isEqualOperator(e[u])&&(h=e[u].value),d.transformer&&(h instanceof Dl?h.transformValue(d.transformer):h=An.transformTo(d.transformer,h)),this.connection.driver.options.type==="mssql"&&(h=this.connection.driver.parametrizeValues(d,h)),c.push(this.createWhereConditionExpression(this.getWherePredicateCondition(T,h)))}else if(m){const T=this.buildWhere(e[u],t,n,f);T&&c.push(T)}else if(y){if(e[u]===null){const T=((l=this.connection.options.invalidWhereValuesBehavior)==null?void 0:l.null)||"ignore";if(T==="sql-null")c.push(`${n}.${f} IS NULL`);else if(T==="throw")throw new Z(`Null value encountered in property '${n}.${u}' of a where condition. Set 'invalidWhereValuesBehavior.null' to 'ignore' or 'sql-null' in connection options to skip or handle null values.`);continue}if(typeof e[u]=="object"&&Object.keys(e[u]).every(b=>e[u][b]===void 0))continue;if(de.isFindOperator(e[u]))if(e[u].type==="moreThan"||e[u].type==="lessThan"||e[u].type==="moreThanOrEqual"||e[u].type==="lessThanOrEqual"){let T="";e[u].type==="moreThan"?T=">":e[u].type==="lessThan"?T="<":e[u].type==="moreThanOrEqual"?T=">=":e[u].type==="lessThanOrEqual"&&(T="<=");const b=this.subQuery();if(y.isManyToManyOwner)b.select("COUNT(*)").from(y.joinTableName,y.joinTableName).where(y.joinColumns.map(S=>`${y.joinTableName}.${S.propertyName} = ${n}.${S.referencedColumn.propertyName}`).join(" AND "));else if(y.isManyToManyNotOwner)b.select("COUNT(*)").from(y.inverseRelation.joinTableName,y.inverseRelation.joinTableName).where(y.inverseRelation.inverseJoinColumns.map(S=>`${y.inverseRelation.joinTableName}.${S.propertyName} = ${n}.${S.referencedColumn.propertyName}`).join(" AND "));else if(y.isOneToMany)b.select("COUNT(*)").from(y.inverseEntityMetadata.target,y.inverseEntityMetadata.tableName).where(y.inverseRelation.joinColumns.map(S=>`${y.inverseEntityMetadata.tableName}.${S.propertyName} = ${n}.${S.referencedColumn.propertyName}`).join(" AND "));else throw new Error("This relation isn't supported by given find operator");this.andWhere(b.getSql()+" "+T+" "+parseInt(e[u].value))}else if(y.isManyToOne||y.isOneToOne&&y.isOneToOneOwner){const T=`${n}.${f}`;c.push(this.createWhereConditionExpression(this.getWherePredicateCondition(T,e[u])))}else throw new Error("This relation isn't supported by given find operator");else{let T=n+"_"+y.propertyPath.replace(".","_");T=Be.buildAlias(this.connection.driver,{joiner:"__"},n,T),this.joins.find(N=>N.alias===T)||this.joins.push({type:"left",select:!1,selection:void 0,alias:T,parentAlias:n,relationMetadata:y});const S=this.buildWhere(e[u],y.inverseEntityMetadata,T);S&&c.push(S)}}}s=c.length?"("+c.join(") AND (")+")":c.join(" AND ")}return s.length?"("+s+")":s}}class t_{constructor(){this.generatedMaps=[]}static from(e){const t=new this;return t.raw=e.records,t.affected=e.affected,t}}class r3 extends pn{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createUpdateExpression();return e+=this.createCteExpression(),e+=this.createOrderByExpression(),e+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(e.trim())}execute(){return v(this,null,function*(){const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?yield e.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&(yield e.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata)));const n=new Gp(e,this.expressionMap);this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=n.getSoftDeletionReturningColumns());const[i,s]=this.getQueryAndParameters(),a=yield e.query(i,s,!0),o=t_.from(a);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(yield n.update(o,this.expressionMap.whereEntities)),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(this.expressionMap.queryType==="soft-delete"?yield e.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):this.expressionMap.queryType==="restore"&&(yield e.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata))),t&&(yield e.commitTransaction()),o}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}from(e,t){e=de.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("update"))throw new ih;return this.expressionMap.returning=e,this}orderBy(e,t="ASC",n){return e?typeof e=="object"?this.expressionMap.orderBys=e:n?this.expressionMap.orderBys={[e]:{order:t,nulls:n}}:this.expressionMap.orderBys={[e]:t}:this.expressionMap.orderBys={},this}addOrderBy(e,t="ASC",n){return n?this.expressionMap.orderBys[e]={order:t,nulls:n}:this.expressionMap.orderBys[e]=t,this}limit(e){return this.expressionMap.limit=e,this}whereEntity(e){if(!this.expressionMap.mainAlias.hasMetadata)throw new Z(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const t=Array.isArray(e)?e:[e];return t.forEach(n=>{const i=this.expressionMap.mainAlias.metadata.getEntityIdMap(n);if(!i)throw new Z("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(i)}),this.expressionMap.whereEntities=t,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}createUpdateExpression(){const e=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!e)throw new Z(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!e.deleteDateColumn)throw new W2(e);const t=[];switch(this.expressionMap.queryType){case"soft-delete":t.push(this.escape(e.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":t.push(this.escape(e.deleteDateColumn.databaseName)+" = NULL");break;default:throw new Z('The queryType must be "soft-delete" or "restore"')}if(e.versionColumn&&t.push(this.escape(e.versionColumn.databaseName)+" = "+this.escape(e.versionColumn.databaseName)+" + 1"),e.updateDateColumn&&t.push(this.escape(e.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),t.length<=0)throw new Id;const n=this.createWhereExpression(),i=this.createReturningExpression("update");return i===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")}${n}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")} OUTPUT ${i}${n}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")}${n} RETURNING ${i}`}createOrderByExpression(){const e=this.expressionMap.orderBys;return Object.keys(e).length>0?" ORDER BY "+Object.keys(e).map(t=>typeof e[t]=="string"?this.replacePropertyNames(t)+" "+e[t]:this.replacePropertyNames(t)+" "+e[t].order+" "+e[t].nulls).join(", "):""}createLimitExpression(){const e=this.expressionMap.limit;if(e){if(Be.isMySQLFamily(this.connection.driver))return" LIMIT "+e;throw new xT}return""}}class i3 extends pn{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createUpdateExpression(),e+=this.createOrderByExpression(),e+=this.createLimitExpression(),this.replacePropertyNamesForTheWholeQuery(e.trim())}execute(){return v(this,null,function*(){const e=this.obtainQueryRunner();let t=!1;try{this.expressionMap.useTransaction===!0&&e.isTransactionActive===!1&&(yield e.startTransaction(),t=!0),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield e.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet));let n=null,i=null;const s=new Gp(e,this.expressionMap),a=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const f of this.expressionMap.returning)a.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(f));this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=s.getUpdationReturningColumns(),a.push(...this.expressionMap.extraReturningColumns.filter(f=>!a.includes(f)))),a.length>0&&this.connection.driver.options.type==="mssql"&&(n=this.connection.driver.buildTableVariableDeclaration("@OutputTable",a),i="SELECT * FROM @OutputTable");const[o,l]=this.getQueryAndParameters(),c=[n,o,i],u=yield e.query(c.filter(f=>f!=null).join(`;

`),l,!0),h=t_.from(u);return this.expressionMap.updateEntity===!0&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(yield s.update(h,this.expressionMap.whereEntities)),this.expressionMap.callListeners===!0&&this.expressionMap.mainAlias.hasMetadata&&(yield e.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet)),t&&(yield e.commitTransaction()),h}catch(n){if(t)try{yield e.rollbackTransaction()}catch(i){}throw n}finally{e!==this.queryRunner&&(yield e.release())}})}set(e){return this.expressionMap.valuesSet=e,this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("update"))throw new ih;return this.expressionMap.returning=e,this}orderBy(e,t="ASC",n){return e?typeof e=="object"?this.expressionMap.orderBys=e:n?this.expressionMap.orderBys={[e]:{order:t,nulls:n}}:this.expressionMap.orderBys={[e]:t}:this.expressionMap.orderBys={},this}addOrderBy(e,t="ASC",n){return n?this.expressionMap.orderBys[e]={order:t,nulls:n}:this.expressionMap.orderBys[e]=t,this}limit(e){return this.expressionMap.limit=e,this}whereEntity(e){if(!this.expressionMap.mainAlias.hasMetadata)throw new Z(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const t=Array.isArray(e)?e:[e];return t.forEach(n=>{const i=this.expressionMap.mainAlias.metadata.getEntityIdMap(n);if(!i)throw new Z("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(i)}),this.expressionMap.whereEntities=t,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}createUpdateExpression(){const e=this.getValueSet(),t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,n={};for(const l in e)e[l]!==void 0&&(n[l]=e[l]);const i=[],s=[];if(t?(this.createPropertyPath(t,n).forEach(l=>{const c=t.findColumnsWithPropertyPath(l);if(c.length<=0)throw new Wr(l,t);c.forEach(u=>{if(!u.isUpdate||s.includes(u))return;s.push(u);let h=u.getEntityValue(n);if(u.referencedColumn&&typeof h=="object"&&!(h instanceof Date)&&h!==null&&!Buffer.isBuffer(h)?h=u.referencedColumn.getEntityValue(h):typeof h!="function"&&(h=this.connection.driver.preparePersistentValue(h,u)),typeof h=="function")i.push(this.escape(u.databaseName)+" = "+h());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&h===null)i.push(this.escape(u.databaseName)+" = NULL");else{this.connection.driver.options.type==="mssql"&&(h=this.connection.driver.parametrizeValue(u,h));const f=this.createParameter(h);let d=null;if((Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1){const y=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u.srid!=null?d=`${y}(${f}, ${u.srid})`:d=`${y}(${f})`}else Be.isPostgresFamily(this.connection.driver)&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?u.srid!=null?d=`ST_SetSRID(ST_GeomFromGeoJSON(${f}), ${u.srid})::${u.type}`:d=`ST_GeomFromGeoJSON(${f})::${u.type}`:this.connection.driver.options.type==="mssql"&&this.connection.driver.spatialTypes.indexOf(u.type)!==-1?d=u.type+"::STGeomFromText("+f+", "+(u.srid||"0")+")":d=f;i.push(this.escape(u.databaseName)+" = "+d)}})}),(i.length>0||Object.keys(n).length===0)&&(t.versionColumn&&s.indexOf(t.versionColumn)===-1&&i.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&s.indexOf(t.updateDateColumn)===-1&&i.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(n).map(l=>{const c=n[l];if(typeof c=="function")i.push(this.escape(l)+" = "+c());else if((this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner")&&c===null)i.push(this.escape(l)+" = NULL");else{const u=this.createParameter(c);i.push(this.escape(l)+" = "+u)}}),i.length<=0)throw new Id;const a=this.createWhereExpression(),o=this.createReturningExpression("update");return o===""?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${i.join(", ")}${a}`:this.connection.driver.options.type==="mssql"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${i.join(", ")} OUTPUT ${o}${a}`:this.connection.driver.options.type==="spanner"?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${i.join(", ")}${a} THEN RETURN ${o}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${i.join(", ")}${a} RETURNING ${o}`}createOrderByExpression(){const e=this.expressionMap.orderBys;return Object.keys(e).length>0?" ORDER BY "+Object.keys(e).map(t=>typeof e[t]=="string"?this.replacePropertyNames(t)+" "+e[t]:this.replacePropertyNames(t)+" "+e[t].order+" "+e[t].nulls).join(", "):""}createLimitExpression(){const e=this.expressionMap.limit;if(e){if(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")return" LIMIT "+e;throw new xT}return""}getValueSet(){if(typeof this.expressionMap.valuesSet=="object")return this.expressionMap.valuesSet;throw new Id}}function n_(){pn.registerQueryBuilderClass("DeleteQueryBuilder",r=>new WB(r)),pn.registerQueryBuilderClass("InsertQueryBuilder",r=>new KB(r)),pn.registerQueryBuilderClass("RelationQueryBuilder",r=>new JB(r)),pn.registerQueryBuilderClass("SelectQueryBuilder",r=>new ml(r)),pn.registerQueryBuilderClass("SoftDeleteQueryBuilder",r=>new r3(r)),pn.registerQueryBuilderClass("UpdateQueryBuilder",r=>new i3(r))}class Ki{static sha1(e){const t=function(I,H){return I<<H|I>>>32-H},n=function(I){let H="",Q,te;for(Q=7;Q>=0;Q--)te=I>>>Q*4&15,H+=te.toString(16);return H};let i,s,a;const o=new Array(80);let l=1732584193,c=4023233417,u=2562383102,h=271733878,f=3285377520,d,m,y,T,b,S;e=encodeURIComponent(e);const N=e.length,C=[];for(s=0;s<N-3;s+=4)a=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),C.push(a);switch(N%4){case 0:s=2147483648;break;case 1:s=e.charCodeAt(N-1)<<24|8388608;break;case 2:s=e.charCodeAt(N-2)<<24|e.charCodeAt(N-1)<<16|32768;break;case 3:s=e.charCodeAt(N-3)<<24|e.charCodeAt(N-2)<<16|e.charCodeAt(N-1)<<8|128;break}for(C.push(s);C.length%16!==14;)C.push(0);for(C.push(N>>>29),C.push(N<<3&4294967295),i=0;i<C.length;i+=16){for(s=0;s<16;s++)o[s]=C[i+s];for(s=16;s<=79;s++)o[s]=t(o[s-3]^o[s-8]^o[s-14]^o[s-16],1);for(d=l,m=c,y=u,T=h,b=f,s=0;s<=19;s++)S=t(d,5)+(m&y|~m&T)+b+o[s]+1518500249&4294967295,b=T,T=y,y=t(m,30),m=d,d=S;for(s=20;s<=39;s++)S=t(d,5)+(m^y^T)+b+o[s]+1859775393&4294967295,b=T,T=y,y=t(m,30),m=d,d=S;for(s=40;s<=59;s++)S=t(d,5)+(m&y|m&T|y&T)+b+o[s]+2400959708&4294967295,b=T,T=y,y=t(m,30),m=d,d=S;for(s=60;s<=79;s++)S=t(d,5)+(m^y^T)+b+o[s]+3395469782&4294967295,b=T,T=y,y=t(m,30),m=d,d=S;l=l+d&4294967295,c=c+m&4294967295,u=u+y&4294967295,h=h+T&4294967295,f=f+b&4294967295}return S=n(l)+n(c)+n(u)+n(h)+n(f),S.toLowerCase()}}class s3{constructor(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}getTableName(e){return typeof e!="string"&&(e=e.name),e.split(".").pop()}tableName(e,t){return t||Rb(e)}closureJunctionTableName(e){return e+"_closure"}columnName(e,t,n){const i=t||e;return n.length?Cf(n.join("_"))+qB(i):i}relationName(e){return e}primaryKeyName(e,t){const n=[...t];n.sort();const a=`${this.getTableName(e).replace(".","_")}_${n.join("_")}`;return"PK_"+Ki.sha1(a).substr(0,27)}uniqueConstraintName(e,t){const n=[...t];n.sort();const a=`${this.getTableName(e).replace(".","_")}_${n.join("_")}`;return"UQ_"+Ki.sha1(a).substr(0,27)}relationConstraintName(e,t,n){const i=[...t];i.sort();let o=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return n&&(o+=`_${n}`),"REL_"+Ki.sha1(o).substr(0,26)}defaultConstraintName(e,t){const s=`${this.getTableName(e).replace(".","_")}_${t}`;return"DF_"+Ki.sha1(s).substr(0,27)}foreignKeyName(e,t,n,i){const s=[...t];s.sort();const l=`${this.getTableName(e).replace(".","_")}_${s.join("_")}`;return"FK_"+Ki.sha1(l).substr(0,27)}indexName(e,t,n){const i=[...t];i.sort();let o=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return n&&(o+=`_${n}`),"IDX_"+Ki.sha1(o).substr(0,26)}checkConstraintName(e,t,n){const a=`${this.getTableName(e).replace(".","_")}_${t}`,o="CHK_"+Ki.sha1(a).substr(0,26);return n?`${o}_ENUM`:o}exclusionConstraintName(e,t){const s=`${this.getTableName(e).replace(".","_")}_${t}`;return"XCL_"+Ki.sha1(s).substr(0,26)}joinColumnName(e,t){return Cf(e+"_"+t)}joinTableName(e,t,n,i){return Rb(e+"_"+n.replace(/\./gi,"_")+"_"+t)}joinTableColumnDuplicationPrefix(e,t){return e+"_"+t}joinTableColumnName(e,t,n){return Cf(e+"_"+(n||t))}joinTableInverseColumnName(e,t,n){return this.joinTableColumnName(e,t,n)}prefixTableName(e,t){return e+t}}class ar{constructor(e){this["@instanceof"]=Symbol.for("TableColumn"),this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=this.zerofill?!0:e.unsigned||!1,this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.generatedIdentity=e.generatedIdentity,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.primaryKeyConstraintName=e.primaryKeyConstraintName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}clone(){return new ar({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,primaryKeyConstraintName:this.primaryKeyConstraintName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,generatedIdentity:this.generatedIdentity,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})}}class mn{constructor(e){this["@instanceof"]=Symbol.for("TableIndex"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isConcurrent=!!e.isConcurrent,this.isFulltext=!!e.isFulltext,this.isNullFiltered=!!e.isNullFiltered,this.parser=e.parser,this.where=e.where?e.where:""}clone(){return new mn({name:this.name,columnNames:[...this.columnNames],isUnique:this.isUnique,isSpatial:this.isSpatial,isConcurrent:this.isConcurrent,isFulltext:this.isFulltext,isNullFiltered:this.isNullFiltered,parser:this.parser,where:this.where})}static create(e){return new mn({name:e.name,columnNames:e.columns.map(t=>t.databaseName),isUnique:e.isUnique,isSpatial:e.isSpatial,isConcurrent:e.isConcurrent,isFulltext:e.isFulltext,isNullFiltered:e.isNullFiltered,parser:e.parser,where:e.where})}}class Mr{constructor(e){this["@instanceof"]=Symbol.for("TableForeignKey"),this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedDatabase=e.referencedDatabase,this.referencedSchema=e.referencedSchema,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}clone(){return new Mr({name:this.name,columnNames:[...this.columnNames],referencedColumnNames:[...this.referencedColumnNames],referencedDatabase:this.referencedDatabase,referencedSchema:this.referencedSchema,referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})}static create(e,t){return new Mr({name:e.name,columnNames:e.columnNames,referencedColumnNames:e.referencedColumnNames,referencedDatabase:e.referencedEntityMetadata.database,referencedSchema:e.referencedEntityMetadata.schema,referencedTableName:e.referencedTablePath,onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable})}}class Oc{static createTableColumnOptions(e,t){return{name:e.databaseName,length:t.getColumnLength(e),width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,generatedIdentity:e.generatedIdentity,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map(n=>n+""):e.enum,enumName:e.enumName,primaryKeyConstraintName:e.primaryKeyConstraintName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}}}class Qn{constructor(e){this["@instanceof"]=Symbol.for("TableUnique"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.deferrable=e.deferrable}clone(){return new Qn({name:this.name,columnNames:[...this.columnNames],deferrable:this.deferrable})}static create(e){return new Qn({name:e.name,columnNames:e.columns.map(t=>t.databaseName),deferrable:e.deferrable})}}class Gr{constructor(e){this["@instanceof"]=Symbol.for("TableCheck"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}clone(){return new Gr({name:this.name,columnNames:this.columnNames?[...this.columnNames]:[],expression:this.expression})}static create(e){return new Gr({name:e.name,expression:e.expression})}}class js{constructor(e){this["@instanceof"]=Symbol.for("TableExclusion"),this.name=e.name,this.expression=e.expression}clone(){return new js({name:this.name,expression:this.expression})}static create(e){return new js({name:e.name,expression:e.expression})}}class hn{constructor(e){this["@instanceof"]=Symbol.for("Table"),this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,this.withoutRowid=!1,e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,e.columns&&(this.columns=e.columns.map(t=>new ar(t))),e.indices&&(this.indices=e.indices.map(t=>new mn(t))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map(t=>new Mr(Tt(Xe({},t),{referencedDatabase:(t==null?void 0:t.referencedDatabase)||e.database,referencedSchema:(t==null?void 0:t.referencedSchema)||e.schema})))),e.uniques&&(this.uniques=e.uniques.map(t=>new Qn(t))),e.checks&&(this.checks=e.checks.map(t=>new Gr(t))),e.exclusions&&(this.exclusions=e.exclusions.map(t=>new js(t))),e.justCreated!==void 0&&(this.justCreated=e.justCreated),e.withoutRowid&&(this.withoutRowid=e.withoutRowid),this.engine=e.engine,this.comment=e.comment)}get primaryColumns(){return this.columns.filter(e=>e.isPrimary)}clone(){return new hn({schema:this.schema,database:this.database,name:this.name,columns:this.columns.map(e=>e.clone()),indices:this.indices.map(e=>e.clone()),foreignKeys:this.foreignKeys.map(e=>e.clone()),uniques:this.uniques.map(e=>e.clone()),checks:this.checks.map(e=>e.clone()),exclusions:this.exclusions.map(e=>e.clone()),justCreated:this.justCreated,withoutRowid:this.withoutRowid,engine:this.engine,comment:this.comment})}addColumn(e){this.columns.push(e)}removeColumn(e){const t=this.columns.find(n=>n.name===e.name);t&&this.columns.splice(this.columns.indexOf(t),1)}addUniqueConstraint(e){if(this.uniques.push(e),e.columnNames.length===1){const t=this.columns.find(n=>n.name===e.columnNames[0]);t&&(t.isUnique=!0)}}removeUniqueConstraint(e){const t=this.uniques.find(n=>n.name===e.name);if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),t.columnNames.length===1)){const n=this.columns.find(i=>i.name===t.columnNames[0]);n&&(n.isUnique=!1)}}addCheckConstraint(e){this.checks.push(e)}removeCheckConstraint(e){const t=this.checks.find(n=>n.name===e.name);t&&this.checks.splice(this.checks.indexOf(t),1)}addExclusionConstraint(e){this.exclusions.push(e)}removeExclusionConstraint(e){const t=this.exclusions.find(n=>n.name===e.name);t&&this.exclusions.splice(this.exclusions.indexOf(t),1)}addForeignKey(e){this.foreignKeys.push(e)}removeForeignKey(e){const t=this.foreignKeys.find(n=>n.name===e.name);t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)}addIndex(e,t=!1){if(this.indices.push(e),e.columnNames.length===1&&e.isUnique&&t){const n=this.columns.find(i=>i.name===e.columnNames[0]);n&&(n.isUnique=!0)}}removeIndex(e,t=!1){const n=this.indices.find(i=>i.name===e.name);if(n&&(this.indices.splice(this.indices.indexOf(n),1),n.columnNames.length===1&&n.isUnique&&t)){const i=this.columns.find(s=>s.name===n.columnNames[0]);i&&(i.isUnique=this.indices.some(s=>s.columnNames.length===1&&s.columnNames[0]===i.name&&!!n.isUnique))}}findColumnByName(e){return this.columns.find(t=>t.name===e)}findColumnIndices(e){return this.indices.filter(t=>!!t.columnNames.find(n=>n===e.name))}findColumnForeignKeys(e){return this.foreignKeys.filter(t=>!!t.columnNames.find(n=>n===e.name))}findColumnUniques(e){return this.uniques.filter(t=>!!t.columnNames.find(n=>n===e.name))}findColumnChecks(e){return this.checks.filter(t=>!!t.columnNames.find(n=>n===e.name))}static create(e,t){const n=e.database===t.database?void 0:e.database,i=e.schema===t.options.schema?void 0:e.schema,s={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,i,n),withoutRowid:e.withoutRowid,engine:e.engine,columns:e.columns.filter(a=>a&&!a.isVirtualProperty).map(a=>Oc.createTableColumnOptions(a,t)),indices:e.indices.filter(a=>a.synchronize===!0).map(a=>mn.create(a)),uniques:e.uniques.map(a=>Qn.create(a)),checks:e.checks.map(a=>Gr.create(a)),exclusions:e.exclusions.map(a=>js.create(a)),comment:e.comment};return new hn(s)}}class $b{constructor(e,t,n,i,s){this.id=e,this.timestamp=t,this.name=n,this.instance=i,this.transaction=s}}class Fr{constructor(e,t,...n){this.value=e,this.type=t,this["@instanceof"]=Symbol.for("MssqlParameter"),this.params=[],this.params=n||[]}}class Af{constructor(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";const{schema:n}=this.connection.driver.options,i=this.connection.driver.database;this.migrationsDatabase=i,this.migrationsSchema=n,this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,n,i)}executeMigration(e){return v(this,null,function*(){return this.withQueryRunner(t=>v(this,null,function*(){yield this.createMigrationsTableIfNotExist(t);const n=this.connection.driver.createSchemaBuilder();return de.isRdbmsSchemaBuilder(n)&&(yield n.createMetadataTableIfNecessary(t)),yield t.beforeMigration(),yield e.instance.up(t),yield t.afterMigration(),yield this.insertExecutedMigration(t,e),e}))})}getAllMigrations(){return v(this,null,function*(){return Promise.resolve(this.getMigrations())})}getExecutedMigrations(){return v(this,null,function*(){return this.withQueryRunner(e=>v(this,null,function*(){return yield this.createMigrationsTableIfNotExist(e),yield this.loadExecutedMigrations(e)}))})}getPendingMigrations(){return v(this,null,function*(){const e=yield this.getAllMigrations(),t=yield this.getExecutedMigrations();return e.filter(n=>!t.find(i=>i.name===n.name))})}insertMigration(e){return this.withQueryRunner(t=>this.insertExecutedMigration(t,e))}deleteMigration(e){return this.withQueryRunner(t=>this.deleteExecutedMigration(t,e))}showMigrations(){return v(this,null,function*(){let e=!1;const t=this.queryRunner||this.connection.createQueryRunner();yield this.createMigrationsTableIfNotExist(t);const n=yield this.loadExecutedMigrations(t),i=this.getMigrations();for(const s of i){const a=n.find(o=>o.name===s.name);a?this.connection.logger.logSchemaBuild(`[X] ${a.id} ${s.name}`):(e=!0,this.connection.logger.logSchemaBuild(`[ ] ${s.name}`))}return this.queryRunner||(yield t.release()),e})}executePendingMigrations(){return v(this,null,function*(){const e=this.queryRunner||this.connection.createQueryRunner();yield this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();de.isRdbmsSchemaBuilder(t)&&(yield t.createMetadataTableIfNecessary(e));const n=yield this.loadExecutedMigrations(e),i=this.getLatestTimestampMigration(n),s=this.getMigrations(),a=[],o=s.filter(u=>!n.find(f=>f.name===u.name));if(!o.length)return this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner||(yield e.release()),[];if(this.connection.logger.logSchemaBuild(`${n.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${s.length} migrations were found in the source code.`),i&&this.connection.logger.logSchemaBuild(`${i.name} is the last executed migration. It was executed on ${new Date(i.timestamp).toString()}.`),this.connection.logger.logSchemaBuild(`${o.length} migrations are new migrations must be executed.`),this.transaction==="all"){const u=o.filter(h=>{var f;return((f=h.instance)==null?void 0:f.transaction)!==void 0});if(u.length>0){const h=new aq(u);throw this.connection.logger.logMigration(`Migrations failed, error: ${h.message}`),h}}const l={each:!0,none:!1,all:!1}[this.transaction];for(const u of o)if(u.instance){const h=u.instance.transaction;h===void 0?u.transaction=l:u.transaction=h}let c=!1;this.transaction==="all"&&!e.isTransactionActive&&(yield e.beforeMigration(),yield e.startTransaction(),c=!0);try{for(const u of o){if(this.fake){yield this.insertExecutedMigration(e,u);continue}u.transaction&&!e.isTransactionActive&&(yield e.beforeMigration(),yield e.startTransaction(),c=!0),yield u.instance.up(e).catch(h=>{throw this.connection.logger.logMigration(`Migration "${u.name}" failed, error: ${h==null?void 0:h.message}`),h}).then(()=>v(this,null,function*(){yield this.insertExecutedMigration(e,u),u.transaction&&c&&(yield e.commitTransaction(),yield e.afterMigration())})).then(()=>{a.push(u),this.connection.logger.logSchemaBuild(`Migration ${u.name} has been ${this.fake?"(fake) ":""}executed successfully.`)})}this.transaction==="all"&&c&&(yield e.commitTransaction(),yield e.afterMigration())}catch(u){if(c)try{yield e.rollbackTransaction()}catch(h){}throw u}finally{this.queryRunner||(yield e.release())}return a})}undoLastMigration(){return v(this,null,function*(){const e=this.queryRunner||this.connection.createQueryRunner();yield this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();de.isRdbmsSchemaBuilder(t)&&(yield t.createMetadataTableIfNecessary(e));const n=yield this.loadExecutedMigrations(e),i=this.getLatestExecutedMigration(n);if(!i){this.connection.logger.logSchemaBuild("No migrations were found in the database. Nothing to revert!");return}const a=this.getMigrations().find(l=>l.name===i.name);if(!a)throw new Z(`No migration ${i.name} was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.`);this.connection.logger.logSchemaBuild(`${n.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${i.name} is the last executed migration. It was executed on ${new Date(i.timestamp).toString()}.`),this.connection.logger.logSchemaBuild("Now reverting it...");let o=!1;this.transaction!=="none"&&!e.isTransactionActive&&(yield e.startTransaction(),o=!0);try{this.fake||(yield e.beforeMigration(),yield a.instance.down(e),yield e.afterMigration()),yield this.deleteExecutedMigration(e,a),this.connection.logger.logSchemaBuild(`Migration ${a.name} has been ${this.fake?"(fake) ":""}reverted successfully.`),o&&(yield e.commitTransaction())}catch(l){if(o)try{yield e.rollbackTransaction()}catch(c){}throw l}finally{this.queryRunner||(yield e.release())}})}createMigrationsTableIfNotExist(e){return v(this,null,function*(){if(this.connection.driver.options.type==="mongodb")return;(yield e.hasTable(this.migrationsTable))||(yield e.createTable(new hn({database:this.migrationsDatabase,schema:this.migrationsSchema,name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]})))})}loadExecutedMigrations(e){return v(this,null,function*(){return this.connection.driver.options.type==="mongodb"?e.cursor(this.migrationsTableName,{}).sort({_id:-1}).toArray():(yield this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()).map(n=>new $b(parseInt(n.id),parseInt(n.timestamp),n.name))})}getMigrations(){const e=this.connection.migrations.map(t=>{const n=t.name||t.constructor.name,i=parseInt(n.substr(-13),10);if(!i||isNaN(i))throw new Z(`${n} migration name is wrong. Migration class name should have a JavaScript timestamp appended.`);return new $b(void 0,i,n,t)});return this.checkForDuplicateMigrations(e),e.sort((t,n)=>t.timestamp-n.timestamp)}checkForDuplicateMigrations(e){const t=e.map(i=>i.name),n=Array.from(new Set(t.filter((i,s)=>t.indexOf(i)<s)));if(n.length>0)throw Error(`Duplicate migrations: ${n.join(", ")}`)}getLatestTimestampMigration(e){const t=e.map(n=>n).sort((n,i)=>(n.timestamp-i.timestamp)*-1);return t.length>0?t[0]:void 0}getLatestExecutedMigration(e){return e.length>0?e[0]:void 0}insertExecutedMigration(e,t){return v(this,null,function*(){const n={};this.connection.driver.options.type==="mssql"?(n.timestamp=new Fr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new Fr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver.options.type==="mongodb"?yield e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(n):yield e.manager.createQueryBuilder().insert().into(this.migrationsTable).values(n).execute()})}deleteExecutedMigration(e,t){return v(this,null,function*(){const n={};if(this.connection.driver.options.type==="mssql"?(n.timestamp=new Fr(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new Fr(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver.options.type==="mongodb")yield e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(n);else{const i=e.manager.createQueryBuilder();yield i.delete().from(this.migrationsTable).where(`${i.escape("timestamp")} = :timestamp`).andWhere(`${i.escape("name")} = :name`).setParameters(n).execute()}})}withQueryRunner(e){return v(this,null,function*(){const t=this.queryRunner||this.connection.createQueryRunner();try{return yield e(t)}finally{this.queryRunner||(yield t.release())}})}}function fc(r,e,t){const n=[],i={};return function s(a){i[a]=!0,n.push(a),r[a].forEach(function(o){if(!i[o])s(o);else if(n.indexOf(o)>=0)throw n.push(o),new Z(`Dependency Cycle Found: ${n.join(" -> ")}`)}),n.pop(),(!e||r[a].length===0)&&t.indexOf(a)===-1&&t.push(a)}}class a3{constructor(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}addNode(e,t){this.hasNode(e)||(arguments.length===2?this.nodes[e]=t:this.nodes[e]=e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])}removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach(function(t){Object.keys(t).forEach(function(n){const i=t[n].indexOf(e);i>=0&&t[n].splice(i,1)})}))}hasNode(e){return this.nodes.hasOwnProperty(e)}getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new Z(`Node does not exist: ${e}`)}setNodeData(e,t){if(this.hasNode(e))this.nodes[e]=t;else throw new Z(`Node does not exist: ${e}`)}addDependency(e,t){if(!this.hasNode(e))throw new Z(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new Z(`Node does not exist: ${t}`);return this.outgoingEdges[e].indexOf(t)===-1&&this.outgoingEdges[e].push(t),this.incomingEdges[t].indexOf(e)===-1&&this.incomingEdges[t].push(e),!0}removeDependency(e,t){let n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t),n>=0&&this.outgoingEdges[e].splice(n,1)),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e),n>=0&&this.incomingEdges[t].splice(n,1))}dependenciesOf(e,t){if(this.hasNode(e)){const n=[];fc(this.outgoingEdges,t,n)(e);const s=n.indexOf(e);return s>=0&&n.splice(s,1),n}else throw new Z(`Node does not exist: ${e}`)}dependantsOf(e,t){if(this.hasNode(e)){const n=[];fc(this.incomingEdges,t,n)(e);const s=n.indexOf(e);return s>=0&&n.splice(s,1),n}else throw new Z(`Node does not exist: ${e}`)}overallOrder(e){const t=this,n=[],i=Object.keys(this.nodes);if(i.length===0)return n;{const s=fc(this.outgoingEdges,!1,[]);i.forEach(function(o){s(o)});const a=fc(this.outgoingEdges,e,n);return i.filter(function(o){return t.incomingEdges[o].length===0}).forEach(function(o){a(o)}),n}}}class o3{validateMany(e,t){e.forEach(n=>this.validate(n,e,t)),this.validateDependencies(e),this.validateEagerRelations(e)}validate(e,t,n){if(!e.primaryColumns.length&&!e.isJunction)throw new Q2(e);if(e.primaryColumns.length>1&&!e.primaryColumns.every((a,o,l)=>a.primaryKeyConstraintName===l[0].primaryKeyConstraintName))throw new Z(`Entity ${e.name} has multiple primary columns with different constraint names. Constraint names should be the equal.`);if(e.inheritancePattern==="STI"||e.tableType==="entity-child"){if(!e.discriminatorColumn)throw new Z(`Entity ${e.name} using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?`);if(typeof e.discriminatorValue=="undefined")throw new Z(`Entity ${e.name} has an undefined discriminator value. Discriminator value should be defined.`);const s=t.find(a=>a!==e&&(a.inheritancePattern==="STI"||a.tableType==="entity-child")&&a.tableName===e.tableName&&a.discriminatorValue===e.discriminatorValue&&a.inheritanceTree.some(o=>e.inheritanceTree.indexOf(o)!==-1));if(s)throw new Z(`Entities ${e.name} and ${s.name} have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.`)}if(e.relationCounts.forEach(s=>{if(s.relation.isManyToOne||s.relation.isOneToOne)throw new Z("Relation count can not be implemented on ManyToOne or OneToOne relations.")}),n.options.type!=="mongodb"&&e.columns.filter(s=>!s.isVirtualProperty).forEach(s=>{const a=n.normalizeType(s);if(!n.supportedDataTypes.includes(a))throw new Z2(s,a,n.options.type);if(s.length&&!n.withLengthColumnTypes.includes(a))throw new Z(`Column ${s.propertyName} of Entity ${e.name} does not support length property.`);if(s.type==="enum"&&!s.enum&&!s.enumName)throw new Z(`Column "${s.propertyName}" of Entity "${e.name}" is defined as enum, but missing "enum" or "enumName" properties.`)}),(Be.isMySQLFamily(n)||n.options.type==="aurora-mysql")&&e.columns.filter(a=>a.isGenerated&&a.generationStrategy!=="uuid").length>1)throw new Z(`Error in ${e.name} entity. There can be only one auto-increment column in MySql table.`);if(Be.isMySQLFamily(n)&&t.filter(a=>a.database).length===0&&!n.database)throw new sq("database");if(n.options.type==="mssql"&&e.columns.filter(a=>a.charset).length>1)throw new Z("Character set specifying is not supported in Sql Server");if(n.options.type==="postgres"){const s=e.columns.find(a=>a.asExpression&&(!a.generatedType||a.generatedType==="VIRTUAL"));if(s)throw new Z(`Column "${s.propertyName}" of Entity "${e.name}" is defined as VIRTUAL, but Postgres supports only STORED generated columns.`)}const i=e.create(void 0,{fromDeserializer:!0});e.relations.forEach(s=>{if(s.isManyToMany||s.isOneToMany){if(s.persistenceEnabled===!1)return;const a=s.getEntityValue(i);if(Array.isArray(a))throw new eq(s)}}),e.relations.forEach(s=>{if(n.supportedOnDeleteTypes&&s.onDelete&&!n.supportedOnDeleteTypes.includes(s.onDelete))throw new Z(`OnDeleteType "${s.onDelete}" is not supported for ${n.options.type}!`);if(n.supportedOnUpdateTypes&&s.onUpdate&&!n.supportedOnUpdateTypes.includes(s.onUpdate))throw new Z(`OnUpdateType "${s.onUpdate}" is not valid for ${n.options.type}!`)}),e.relations.forEach(s=>{if(s.isCascadeRemove&&s.inverseRelation&&s.inverseRelation.isCascadeRemove)throw new Z(`Relation ${e.name}#${s.propertyName} and ${s.inverseRelation.entityMetadata.name}#${s.inverseRelation.propertyName} both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.`)})}validateDependencies(e){const t=new a3;e.forEach(n=>{t.addNode(n.name)}),e.forEach(n=>{n.relationsWithJoinColumns.filter(i=>!i.isNullable).forEach(i=>{t.addDependency(n.name,i.inverseEntityMetadata.name)})});try{t.overallOrder()}catch(n){throw new H2(n.toString().replace("Error: Dependency Cycle Found: ",""))}}validateEagerRelations(e){e.forEach(t=>{t.eagerRelations.forEach(n=>{if(n.inverseRelation&&n.inverseRelation.isEager)throw new Z(`Circular eager relations are disallowed. ${t.targetName}#${n.propertyPath} contains "eager: true", and its inverse side ${n.inverseEntityMetadata.targetName}#${n.inverseRelation.propertyPath} contains "eager: true" as well. Remove "eager: true" from one side of the relation.`)})})}}class l3{}class c3{}class u3{}class r_{}class h3{}class f3{}class d3{}class Db{}class p3{}class m3{}class y3{}class Is{static createRelationMaps(e,t,n,i){return i.map(s=>{var f;const a=t.treeParentRelation.joinColumns[0],o=(f=a.referencedColumn)!=null?f:t.primaryColumns[0],l=a.givenDatabaseName||a.databaseName,c=o.givenDatabaseName||o.databaseName,u=s[n+"_"+c],h=s[n+"_"+l];return{id:e.connection.driver.prepareHydratedValue(u,o),parentId:e.connection.driver.prepareHydratedValue(h,a)}})}static buildChildrenEntityTree(e,t,n,i,s){var f;const a=e.treeChildrenRelation.propertyName;if(s.depth===0){t[a]=[];return}const l=(f=e.treeParentRelation.joinColumns[0].referencedColumn)!=null?f:e.primaryColumns[0],c=l.getEntityValue(t),u=i.filter(d=>d.parentId===c),h=new Set(u.map(d=>d.id));t[a]=n.filter(d=>h.has(l.getEntityValue(d))),t[a].forEach(d=>{Is.buildChildrenEntityTree(e,d,n,i,Tt(Xe({},s),{depth:s.depth-1}))})}static buildParentEntityTree(e,t,n,i){var h;const s=e.treeParentRelation.propertyName,o=(h=e.treeParentRelation.joinColumns[0].referencedColumn)!=null?h:e.primaryColumns[0],l=o.getEntityValue(t),c=i.find(f=>f.id===l),u=n.find(f=>c?o.getEntityValue(f)===c.parentId:!1);u&&(t[s]=u,Is.buildParentEntityTree(e,t[s],n,i))}}function Lb(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function qb(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Lb(Object(t),!0).forEach(function(n){g3(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Lb(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function g3(r,e,t){return e=b3(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function b3(r){var e=E3(r,"string");return typeof e=="symbol"?e:String(e)}function E3(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const w3=i_({});function i_(r){return e.withOptions=t=>i_(qb(qb({},r),t)),e;function e(t,...n){const i=typeof t=="string"?[t]:t.raw,{alignValues:s=!1,escapeSpecialCharacters:a=Array.isArray(t),trimWhitespace:o=!0}=r;let l="";for(let h=0;h<i.length;h++){let f=i[h];if(a&&(f=f.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),l+=f,h<n.length){const d=s?v3(n[h],l):n[h];l+=d}}const c=l.split(`
`);let u=null;for(const h of c){const f=h.match(/^(\s+)\S+/);if(f){const d=f[1].length;u?u=Math.min(u,d):u=d}}if(u!==null){const h=u;l=c.map(f=>f[0]===" "||f[0]==="	"?f.slice(h):f).join(`
`)}return o&&(l=l.trim()),a&&(l=l.replace(/\\n/g,`
`)),l}}function v3(r,e){if(typeof r!="string"||!r.includes(`
`))return r;const n=e.slice(e.lastIndexOf(`
`)+1).match(/^(\s+)/);if(n){const i=n[1];return r.replace(/\n/g,`
${i}`)}return r}function ch({driver:r,strings:e,expressions:t}){let n="";const i=[];let s=0;for(const[a,o]of t.entries()){if(n+=e[a],o===null){n+="NULL";continue}if(typeof o=="function"){const l=o();if(typeof l=="string"){n+=l;continue}if(Array.isArray(l)){if(l.length===0)throw new Error(`Expression ${a} in this sql tagged template is a function which returned an empty array. Empty arrays cannot safely be expanded into parameter lists.`);const c=l.map(()=>r.createParameter(`param_${s+1}`,s++));n+=c.join(", "),i.push(...l);continue}throw new Error(`Expression ${a} in this sql tagged template is a function which returned a value of type "${l===null?"null":typeof l}". Only array and string types are supported as function return values in sql tagged template expressions.`)}n+=r.createParameter(`param_${s+1}`,s++),i.push(o)}return n+=e[e.length-1],n=w3(n),{query:n,parameters:i}}class s_{get metadata(){return this.manager.connection.getMetadata(this.target)}constructor(e,t,n){this.target=e,this.manager=t,this.queryRunner=n}createQueryBuilder(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)}hasId(e){return this.manager.hasId(this.metadata.target,e)}getId(e){return this.manager.getId(this.metadata.target,e)}create(e){return this.manager.create(this.metadata.target,e)}merge(e,...t){return this.manager.merge(this.metadata.target,e,...t)}preload(e){return this.manager.preload(this.metadata.target,e)}save(e,t){return this.manager.save(this.metadata.target,e,t)}remove(e,t){return this.manager.remove(this.metadata.target,e,t)}softRemove(e,t){return this.manager.softRemove(this.metadata.target,e,t)}recover(e,t){return this.manager.recover(this.metadata.target,e,t)}insert(e){return this.manager.insert(this.metadata.target,e)}update(e,t){return this.manager.update(this.metadata.target,e,t)}updateAll(e){return this.manager.updateAll(this.metadata.target,e)}upsert(e,t){return this.manager.upsert(this.metadata.target,e,t)}delete(e){return this.manager.delete(this.metadata.target,e)}deleteAll(){return this.manager.deleteAll(this.metadata.target)}softDelete(e){return this.manager.softDelete(this.metadata.target,e)}restore(e){return this.manager.restore(this.metadata.target,e)}exist(e){return this.manager.exists(this.metadata.target,e)}exists(e){return this.manager.exists(this.metadata.target,e)}existsBy(e){return this.manager.existsBy(this.metadata.target,e)}count(e){return this.manager.count(this.metadata.target,e)}countBy(e){return this.manager.countBy(this.metadata.target,e)}sum(e,t){return this.manager.sum(this.metadata.target,e,t)}average(e,t){return this.manager.average(this.metadata.target,e,t)}minimum(e,t){return this.manager.minimum(this.metadata.target,e,t)}maximum(e,t){return this.manager.maximum(this.metadata.target,e,t)}find(e){return v(this,null,function*(){return this.manager.find(this.metadata.target,e)})}findBy(e){return v(this,null,function*(){return this.manager.findBy(this.metadata.target,e)})}findAndCount(e){return this.manager.findAndCount(this.metadata.target,e)}findAndCountBy(e){return this.manager.findAndCountBy(this.metadata.target,e)}findByIds(e){return v(this,null,function*(){return this.manager.findByIds(this.metadata.target,e)})}findOne(e){return v(this,null,function*(){return this.manager.findOne(this.metadata.target,e)})}findOneBy(e){return v(this,null,function*(){return this.manager.findOneBy(this.metadata.target,e)})}findOneById(e){return v(this,null,function*(){return this.manager.findOneById(this.metadata.target,e)})}findOneOrFail(e){return v(this,null,function*(){return this.manager.findOneOrFail(this.metadata.target,e)})}findOneByOrFail(e){return v(this,null,function*(){return this.manager.findOneByOrFail(this.metadata.target,e)})}query(e,t){return this.manager.query(e,t)}sql(e,...t){return v(this,null,function*(){const{query:n,parameters:i}=ch({driver:this.manager.connection.driver,strings:e,expressions:t});return yield this.query(n,i)})}clear(){return this.manager.clear(this.metadata.target)}increment(e,t,n){return this.manager.increment(this.metadata.target,e,t,n)}decrement(e,t,n){return this.manager.decrement(this.metadata.target,e,t,n)}extend(e){const t=this.constructor,{target:n,manager:i,queryRunner:s}=this,a=class extends t{constructor(o,l,c){super(o,l,c)}};for(const o in e)a.prototype[o]=e[o];return new a(n,i,s)}}class T3 extends s_{findTrees(e){return v(this,null,function*(){const t=yield this.findRoots(e);return yield Promise.all(t.map(n=>this.findDescendantsTree(n,e))),t})}findRoots(e){const t=o=>this.manager.connection.driver.escape(o),n=o=>this.manager.connection.driver.escape(o),i=this.metadata.treeParentRelation.joinColumns[0],s=i.givenDatabaseName||i.databaseName,a=this.createQueryBuilder("treeEntity");return jn.applyOptionsToTreeQueryBuilder(a,e),a.where(`${t("treeEntity")}.${n(s)} IS NULL`).getMany()}findDescendants(e,t){const n=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);return jn.applyOptionsToTreeQueryBuilder(n,t),n.getMany()}findDescendantsTree(e,t){return v(this,null,function*(){const n=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);jn.applyOptionsToTreeQueryBuilder(n,t);const i=yield n.getRawAndEntities(),s=Is.createRelationMaps(this.manager,this.metadata,"treeEntity",i.raw);return Is.buildChildrenEntityTree(this.metadata,e,i.entities,s,Xe({depth:-1},t)),e})}countDescendants(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()}createDescendantsQueryBuilder(e,t,n){const i=s=>this.manager.connection.driver.escape(s);if(this.metadata.treeType==="closure-table"){const s=this.metadata.closureJunctionTable.descendantColumns.map(l=>i(t)+"."+i(l.propertyPath)+" = "+i(e)+"."+i(l.referencedColumn.propertyPath)).join(" AND "),a={},o=this.metadata.closureJunctionTable.ancestorColumns.map(l=>(a[l.referencedColumn.propertyName]=l.referencedColumn.getEntityValue(n),i(t)+"."+i(l.propertyPath)+" = :"+l.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,s).where(o).setParameters(a)}else if(this.metadata.treeType==="nested-set"){const s=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath,a={},o=this.metadata.treeParentRelation.joinColumns.map(l=>{const c=l.referencedColumn.propertyPath.replace(".","_");return a[c]=l.referencedColumn.getEntityValue(n),"joined."+l.referencedColumn.propertyPath+" = :"+c}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",s).where(o,a)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(s=>{const a=s.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(n));return Be.isSQLiteFamily(this.manager.connection.driver)?`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE ${a.getQuery()} || '%'`:`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE NULLIF(CONCAT(${a.getQuery()}, '%'), '%')`});throw new Z("Supported only in tree entities")}findAncestors(e,t){const n=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);return jn.applyOptionsToTreeQueryBuilder(n,t),n.getMany()}findAncestorsTree(e,t){return v(this,null,function*(){const n=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);jn.applyOptionsToTreeQueryBuilder(n,t);const i=yield n.getRawAndEntities(),s=Is.createRelationMaps(this.manager,this.metadata,"treeEntity",i.raw);return Is.buildParentEntityTree(this.metadata,e,i.entities,s),e})}countAncestors(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()}createAncestorsQueryBuilder(e,t,n){if(this.metadata.treeType==="closure-table"){const i=this.metadata.closureJunctionTable.ancestorColumns.map(o=>t+"."+o.propertyPath+" = "+e+"."+o.referencedColumn.propertyPath).join(" AND "),s={},a=this.metadata.closureJunctionTable.descendantColumns.map(o=>(s[o.referencedColumn.propertyName]=o.referencedColumn.getEntityValue(n),t+"."+o.propertyPath+" = :"+o.referencedColumn.propertyName)).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(a).setParameters(s)}else if(this.metadata.treeType==="nested-set"){const i="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath,s={},a=this.metadata.treeParentRelation.joinColumns.map(o=>{const l=o.referencedColumn.propertyPath.replace(".","_");return s[l]=o.referencedColumn.getEntityValue(n),"joined."+o.referencedColumn.propertyPath+" = :"+l}).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(a,s)}else if(this.metadata.treeType==="materialized-path")return this.createQueryBuilder(e).where(i=>{const s=i.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(n));return Be.isSQLiteFamily(this.manager.connection.driver)?`${s.getQuery()} LIKE ${e}.${this.metadata.materializedPathColumn.propertyPath} || '%'`:`${s.getQuery()} LIKE CONCAT(${e}.${this.metadata.materializedPathColumn.propertyPath}, '%')`});throw new Z("Supported only in tree entities")}}class _3{transform(e,t,n,i=!1){return this.groupAndTransform(e,t,n,i),e}groupAndTransform(e,t,n,i=!1){n.nonVirtualColumns.forEach(s=>{const a=s.getEntityValue(t);a!==void 0&&s.setEntityValue(e,a)}),n.relations.length&&n.relations.forEach(s=>{let a=s.getEntityValue(e);const o=s.getEntityValue(t,i);if(o!==void 0)if(s.isOneToMany||s.isManyToMany){if(!Array.isArray(o))return;a||(a=[],s.setEntityValue(e,a)),o.forEach(l=>{let c=a.find(h=>s.inverseEntityMetadata.compareEntities(l,h));const u=s.inverseEntityMetadata.findInheritanceMetadata(l);c||(c=u.create(void 0,{fromDeserializer:!0}),a.push(c)),this.groupAndTransform(c,l,u,i)})}else{if(!_t.isObject(o)){_t.isObject(a)||s.setEntityValue(e,o);return}const l=s.inverseEntityMetadata.findInheritanceMetadata(o);a||(a=l.create(void 0,{fromDeserializer:!0}),s.setEntityValue(e,a)),this.groupAndTransform(a,o,l,i)}})}}class S3{constructor(e,t,n,i){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=n,this.relation=i}get target(){return this.metadata.target}get id(){return this.metadata.getEntityIdMixedMap(this.plainEntity)}}class C3{constructor(){this.loadMapItems=[]}get mainLoadMapItem(){return this.loadMapItems.find(e=>!e.relation&&!e.parentLoadMapItem)}addLoadMap(e){this.loadMapItems.find(n=>n.target===e.target&&n.id===e.id)||this.loadMapItems.push(e)}fillEntities(e,t){t.forEach(n=>{const i=this.loadMapItems.find(s=>s.target===e&&s.metadata.compareEntities(n,s.plainEntity));i&&(i.entity=n)})}groupByTargetIds(){const e=[];return this.loadMapItems.forEach(t=>{let n=e.find(i=>i.target===t.target);n||(n={target:t.target,ids:[]},e.push(n)),n.ids.push(t.id)}),e}}class N3{constructor(e){this.manager=e}transform(e,t){return v(this,null,function*(){if(!t.hasAllPrimaryKeys(e))return Promise.reject("Given object does not have a primary column, cannot transform it to database entity.");const n=new C3,i=(s,a,o,l)=>{const c=new S3(s,a,o,l);n.addLoadMap(c),a.extractRelationValuesFromEntity(s,t.relations).filter(u=>u!=null).forEach(([u,h,f])=>i(h,f,c,u))};return i(e,t),yield Promise.all(n.groupByTargetIds().map(s=>this.manager.findByIds(s.target,s.ids).then(a=>n.fillEntities(s.target,a)))),n.loadMapItems.forEach(s=>{!s.relation||!s.entity||!s.parentLoadMapItem||!s.parentLoadMapItem.entity||(s.relation.isManyToMany||s.relation.isOneToMany?(s.parentLoadMapItem.entity[s.relation.propertyName]||(s.parentLoadMapItem.entity[s.relation.propertyName]=[]),s.parentLoadMapItem.entity[s.relation.propertyName].push(s.entity)):s.parentLoadMapItem.entity[s.relation.propertyName]=s.entity)}),n.mainLoadMapItem?n.mainLoadMapItem.entity:void 0})}}class A3{get repository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new nf(this.constructor);return this.manager.getRepository(e)}get treeRepository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new nf(this.constructor);return this.manager.getTreeRepository(e)}createQueryBuilder(e){const t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new nf(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)}createQueryBuilderFor(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)}getRepositoryFor(e){return this.manager.getRepository(e)}getTreeRepositoryFor(e){return this.manager.getTreeRepository(e)}getCustomRepositoryTarget(e){const t=xr().entityRepositories.find(n=>n.target===(typeof e=="function"?e:e.constructor));if(!t)throw new AT(e);return t.entity}}class kb{constructor(e){this.subjects=[...e],this.metadatas=this.getUniqueMetadatas(this.subjects)}sort(e){if(!this.metadatas.length)return this.subjects;const t=[];if(e==="delete"){const o=this.subjects.filter(l=>!l.entity&&!l.databaseEntity);t.push(...o),this.removeAlreadySorted(o)}const n=this.getNonNullableDependencies();let i=this.toposort(n);e==="insert"&&(i=i.reverse()),i.forEach(o=>{const l=this.subjects.filter(c=>c.metadata.targetName===o||c.metadata.inheritanceTree.some(u=>u.name===o));t.push(...l),this.removeAlreadySorted(l)});const s=this.getDependencies();let a=this.toposort(s);return e==="insert"&&(a=a.reverse()),a.forEach(o=>{const l=this.subjects.filter(c=>c.metadata.targetName===o);t.push(...l),this.removeAlreadySorted(l)}),t.push(...this.subjects),t}removeAlreadySorted(e){e.forEach(t=>{this.subjects.splice(this.subjects.indexOf(t),1)})}getUniqueMetadatas(e){const t=[];return e.forEach(n=>{t.indexOf(n.metadata)===-1&&t.push(n.metadata)}),t}getNonNullableDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(n=>{n.isNullable||e.push([t.targetName,n.inverseEntityMetadata.targetName])}),e),[])}getDependencies(){return this.metadatas.reduce((e,t)=>(t.relationsWithJoinColumns.forEach(n=>{n.inverseEntityMetadata!==t&&e.push([t.targetName,n.inverseEntityMetadata.targetName])}),e),[])}toposort(e){function t(c){const u=[];for(let h=0,f=c.length;h<f;h++){const d=c[h];u.indexOf(d[0])<0&&u.push(d[0]),u.indexOf(d[1])<0&&u.push(d[1])}return u}const n=t(e);let i=n.length,s=i;const a=new Array(i),o=new Set;for(;s--;)o.has(s)||l(n[s],s,[]);function l(c,u,h){if(h.indexOf(c)>=0)throw new Z("Cyclic dependency: "+JSON.stringify(c));if(!~n.indexOf(c))throw new Z("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(c));if(o.has(u))return;o.add(u);const f=e.filter(function(d){return d[0]===c});if(u=f.length){const d=h.concat(c);do{const m=f[--u][1];l(m,n.indexOf(m),d)}while(u)}a[--i]=c}return a}}var a_={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Ni,function(){var t=1e3,n=6e4,i=36e5,s="millisecond",a="second",o="minute",l="hour",c="day",u="week",h="month",f="quarter",d="year",m="date",y="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,S={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function($){var B=["th","st","nd","rd"],K=$%100;return"["+$+(B[(K-20)%10]||B[K]||B[0])+"]"}},N=function($,B,K){var ae=String($);return!ae||ae.length>=B?$:""+Array(B+1-ae.length).join(K)+$},C={s:N,z:function($){var B=-$.utcOffset(),K=Math.abs(B),ae=Math.floor(K/60),ue=K%60;return(B<=0?"+":"-")+N(ae,2,"0")+":"+N(ue,2,"0")},m:function $(B,K){if(B.date()<K.date())return-$(K,B);var ae=12*(K.year()-B.year())+(K.month()-B.month()),ue=B.clone().add(ae,h),L=K-ue<0,Se=B.clone().add(ae+(L?-1:1),h);return+(-(ae+(K-ue)/(L?ue-Se:Se-ue))||0)},a:function($){return $<0?Math.ceil($)||0:Math.floor($)},p:function($){return{M:h,y:d,w:u,d:c,D:m,h:l,m:o,s:a,ms:s,Q:f}[$]||String($||"").toLowerCase().replace(/s$/,"")},u:function($){return $===void 0}},I="en",H={};H[I]=S;var Q="$isDayjsObject",te=function($){return $ instanceof A||!(!$||!$[Q])},V=function $(B,K,ae){var ue;if(!B)return I;if(typeof B=="string"){var L=B.toLowerCase();H[L]&&(ue=L),K&&(H[L]=K,ue=L);var Se=B.split("-");if(!ue&&Se.length>1)return $(Se[0])}else{var Ae=B.name;H[Ae]=B,ue=Ae}return!ae&&ue&&(I=ue),ue||!ae&&I},J=function($,B){if(te($))return $.clone();var K=typeof B=="object"?B:{};return K.date=$,K.args=arguments,new A(K)},E=C;E.l=V,E.i=te,E.w=function($,B){return J($,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var A=function(){function $(K){this.$L=V(K.locale,null,!0),this.parse(K),this.$x=this.$x||K.x||{},this[Q]=!0}var B=$.prototype;return B.parse=function(K){this.$d=function(ae){var ue=ae.date,L=ae.utc;if(ue===null)return new Date(NaN);if(E.u(ue))return new Date;if(ue instanceof Date)return new Date(ue);if(typeof ue=="string"&&!/Z$/i.test(ue)){var Se=ue.match(T);if(Se){var Ae=Se[2]-1||0,ve=(Se[7]||"0").substring(0,3);return L?new Date(Date.UTC(Se[1],Ae,Se[3]||1,Se[4]||0,Se[5]||0,Se[6]||0,ve)):new Date(Se[1],Ae,Se[3]||1,Se[4]||0,Se[5]||0,Se[6]||0,ve)}}return new Date(ue)}(K),this.init()},B.init=function(){var K=this.$d;this.$y=K.getFullYear(),this.$M=K.getMonth(),this.$D=K.getDate(),this.$W=K.getDay(),this.$H=K.getHours(),this.$m=K.getMinutes(),this.$s=K.getSeconds(),this.$ms=K.getMilliseconds()},B.$utils=function(){return E},B.isValid=function(){return this.$d.toString()!==y},B.isSame=function(K,ae){var ue=J(K);return this.startOf(ae)<=ue&&ue<=this.endOf(ae)},B.isAfter=function(K,ae){return J(K)<this.startOf(ae)},B.isBefore=function(K,ae){return this.endOf(ae)<J(K)},B.$g=function(K,ae,ue){return E.u(K)?this[ae]:this.set(ue,K)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(K,ae){var ue=this,L=!!E.u(ae)||ae,Se=E.p(K),Ae=function(z,Te){var j=E.w(ue.$u?Date.UTC(ue.$y,Te,z):new Date(ue.$y,Te,z),ue);return L?j:j.endOf(c)},ve=function(z,Te){return E.w(ue.toDate()[z].apply(ue.toDate("s"),(L?[0,0,0,0]:[23,59,59,999]).slice(Te)),ue)},Ye=this.$W,mt=this.$M,et=this.$D,ut="set"+(this.$u?"UTC":"");switch(Se){case d:return L?Ae(1,0):Ae(31,11);case h:return L?Ae(1,mt):Ae(0,mt+1);case u:var Ee=this.$locale().weekStart||0,$e=(Ye<Ee?Ye+7:Ye)-Ee;return Ae(L?et-$e:et+(6-$e),mt);case c:case m:return ve(ut+"Hours",0);case l:return ve(ut+"Minutes",1);case o:return ve(ut+"Seconds",2);case a:return ve(ut+"Milliseconds",3);default:return this.clone()}},B.endOf=function(K){return this.startOf(K,!1)},B.$set=function(K,ae){var ue,L=E.p(K),Se="set"+(this.$u?"UTC":""),Ae=(ue={},ue[c]=Se+"Date",ue[m]=Se+"Date",ue[h]=Se+"Month",ue[d]=Se+"FullYear",ue[l]=Se+"Hours",ue[o]=Se+"Minutes",ue[a]=Se+"Seconds",ue[s]=Se+"Milliseconds",ue)[L],ve=L===c?this.$D+(ae-this.$W):ae;if(L===h||L===d){var Ye=this.clone().set(m,1);Ye.$d[Ae](ve),Ye.init(),this.$d=Ye.set(m,Math.min(this.$D,Ye.daysInMonth())).$d}else Ae&&this.$d[Ae](ve);return this.init(),this},B.set=function(K,ae){return this.clone().$set(K,ae)},B.get=function(K){return this[E.p(K)]()},B.add=function(K,ae){var ue,L=this;K=Number(K);var Se=E.p(ae),Ae=function(mt){var et=J(L);return E.w(et.date(et.date()+Math.round(mt*K)),L)};if(Se===h)return this.set(h,this.$M+K);if(Se===d)return this.set(d,this.$y+K);if(Se===c)return Ae(1);if(Se===u)return Ae(7);var ve=(ue={},ue[o]=n,ue[l]=i,ue[a]=t,ue)[Se]||1,Ye=this.$d.getTime()+K*ve;return E.w(Ye,this)},B.subtract=function(K,ae){return this.add(-1*K,ae)},B.format=function(K){var ae=this,ue=this.$locale();if(!this.isValid())return ue.invalidDate||y;var L=K||"YYYY-MM-DDTHH:mm:ssZ",Se=E.z(this),Ae=this.$H,ve=this.$m,Ye=this.$M,mt=ue.weekdays,et=ue.months,ut=ue.meridiem,Ee=function(Te,j,G,M){return Te&&(Te[j]||Te(ae,L))||G[j].slice(0,M)},$e=function(Te){return E.s(Ae%12||12,Te,"0")},z=ut||function(Te,j,G){var M=Te<12?"AM":"PM";return G?M.toLowerCase():M};return L.replace(b,function(Te,j){return j||function(G){switch(G){case"YY":return String(ae.$y).slice(-2);case"YYYY":return E.s(ae.$y,4,"0");case"M":return Ye+1;case"MM":return E.s(Ye+1,2,"0");case"MMM":return Ee(ue.monthsShort,Ye,et,3);case"MMMM":return Ee(et,Ye);case"D":return ae.$D;case"DD":return E.s(ae.$D,2,"0");case"d":return String(ae.$W);case"dd":return Ee(ue.weekdaysMin,ae.$W,mt,2);case"ddd":return Ee(ue.weekdaysShort,ae.$W,mt,3);case"dddd":return mt[ae.$W];case"H":return String(Ae);case"HH":return E.s(Ae,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return z(Ae,ve,!0);case"A":return z(Ae,ve,!1);case"m":return String(ve);case"mm":return E.s(ve,2,"0");case"s":return String(ae.$s);case"ss":return E.s(ae.$s,2,"0");case"SSS":return E.s(ae.$ms,3,"0");case"Z":return Se}return null}(Te)||Se.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(K,ae,ue){var L,Se=this,Ae=E.p(ae),ve=J(K),Ye=(ve.utcOffset()-this.utcOffset())*n,mt=this-ve,et=function(){return E.m(Se,ve)};switch(Ae){case d:L=et()/12;break;case h:L=et();break;case f:L=et()/3;break;case u:L=(mt-Ye)/6048e5;break;case c:L=(mt-Ye)/864e5;break;case l:L=mt/i;break;case o:L=mt/n;break;case a:L=mt/t;break;default:L=mt}return ue?L:E.a(L)},B.daysInMonth=function(){return this.endOf(h).$D},B.$locale=function(){return H[this.$L]},B.locale=function(K,ae){if(!K)return this.$L;var ue=this.clone(),L=V(K,ae,!0);return L&&(ue.$L=L),ue},B.clone=function(){return E.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},$}(),x=A.prototype;return J.prototype=x,[["$ms",s],["$s",a],["$m",o],["$H",l],["$W",c],["$M",h],["$y",d],["$D",m]].forEach(function($){x[$[1]]=function(B){return this.$g(B,$[0],$[1])}}),J.extend=function($,B){return $.$i||($(B,A,J),$.$i=!0),J},J.locale=V,J.isDayjs=te,J.unix=function($){return J(1e3*$)},J.en=H[I],J.Ls=H,J.p={},J})})(a_);var x3=a_.exports;const R3=th(x3);class dt{static normalizeHydratedDate(e){return e&&(typeof e=="string"?new Date(e):e)}static mixedDateToDateString(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e}static mixedDateToDate(e,t=!1,n=!0){let i=typeof e=="string"?R3(e).toDate():e;return t&&(i=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds())),n||i.setUTCMilliseconds(0),i}static mixedDateToTimeString(e,t=!1){return e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e}static mixedTimeToDate(e){if(typeof e=="string"){const[t,n,i]=e.split(":"),s=new Date;return t&&s.setHours(parseInt(t)),n&&s.setMinutes(parseInt(n)),i&&s.setSeconds(parseInt(i)),s}return e}static mixedTimeToString(e,t=!1){return e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e,typeof e=="string"?e.split(":").map(n=>n.length===1?"0"+n:n).join(":"):e}static mixedDateToDatetimeString(e,t){if(typeof e=="string"&&(e=new Date(e)),e instanceof Date){let n=this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(n+=`.${this.formatMilliseconds(e.getMilliseconds())}`),e=n}return e}static mixedDateToUtcDatetimeString(e){return typeof e=="string"&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear(),4)+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e}static simpleArrayToString(e){return Array.isArray(e)?e.map(t=>String(t)).join(","):e}static stringToSimpleArray(e){return typeof e=="string"?e.length>0?e.split(","):[]:e}static simpleJsonToString(e){return JSON.stringify(e)}static stringToSimpleJson(e){return typeof e=="string"?JSON.parse(e):e}static simpleEnumToString(e){return""+e}static stringToSimpleEnum(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e}static formatZerolessValue(e,t=2){return`${"0".repeat(t)}${e}`.slice(-t)}static formatMilliseconds(e){return e<10?"00"+e:e<100?"0"+e:String(e)}}class M3{compute(e){e.forEach(t=>{this.computeDiffColumns(t),this.computeDiffRelationalColumns(e,t)})}computeDiffColumns(e){e.entity&&e.metadata.columns.forEach(t=>{if(t.isVirtual||t.isDiscriminator)return;const n=e.changeMaps.find(s=>s.column===t);n&&e.changeMaps.splice(e.changeMaps.indexOf(n),1);const i=t.getEntityValue(e.entity);if(i!==void 0){if(e.databaseEntity){const s=t.type!=="json"&&t.type!=="jsonb";let a=t.getEntityValue(e.databaseEntity,s);if(t.relationMetadata){const l=t.relationMetadata.getEntityValue(e.entity);if(l!=null)return}let o=i;if(i!==null&&a!==null){switch(t.type){case"date":o=t.isArray?i.map(l=>dt.mixedDateToDateString(l)):dt.mixedDateToDateString(i),a=t.isArray?a.map(l=>dt.mixedDateToDateString(l)):dt.mixedDateToDateString(a);break;case"time":case"time with time zone":case"time without time zone":case"timetz":o=t.isArray?i.map(l=>dt.mixedDateToTimeString(l)):dt.mixedDateToTimeString(i),a=t.isArray?a.map(l=>dt.mixedDateToTimeString(l)):dt.mixedDateToTimeString(a);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":o=t.isArray?i.map(l=>dt.mixedDateToUtcDatetimeString(l)):dt.mixedDateToUtcDatetimeString(i),a=t.isArray?a.map(l=>dt.mixedDateToUtcDatetimeString(l)):dt.mixedDateToUtcDatetimeString(a);break;case"json":case"jsonb":if(ke.deepCompare(i,a))return;break;case"simple-array":o=dt.simpleArrayToString(i),a=dt.simpleArrayToString(a);break;case"simple-enum":o=dt.simpleEnumToString(i),a=dt.simpleEnumToString(a);break;case"simple-json":o=dt.simpleJsonToString(i),a=dt.simpleJsonToString(a);break}t.transformer&&(o=An.transformTo(t.transformer,i))}if(t.isArray){if(ke.deepCompare(o,a))return}else if(Buffer.isBuffer(o)&&Buffer.isBuffer(a)){if(o.equals(a))return}else if(o===a)return}e.diffColumns.includes(t)||e.diffColumns.push(t),e.changeMaps.push({column:t,value:i})}})}computeDiffRelationalColumns(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach(n=>{let i=n.getEntityValue(t.entity);if(i===void 0)return;if(t.databaseEntity){let o=i;o!==null&&_t.isObject(o)&&(o=n.getRelationIdMap(o));const l=n.getEntityValue(t.databaseEntity);if(ke.compareIds(o,l))return;t.diffRelations.push(n)}const s=e.find(o=>o.mustBeInserted&&o.entity===i);s&&(i=s);const a=t.changeMaps.find(o=>o.relation===n);a?a.value=i:t.changeMaps.push({relation:n,value:i})})}}class Bb extends Z{constructor(){super("Nested sets do not support multiple root entities.")}}class xf{constructor(e){this.queryRunner=e}insert(e){return v(this,null,function*(){const t=c=>this.queryRunner.connection.driver.escape(c),n=this.getTableName(e.metadata.tablePath),i=t(e.metadata.nestedSetLeftColumn.databaseName),s=t(e.metadata.nestedSetRightColumn.databaseName);let a=e.metadata.treeParentRelation.getEntityValue(e.entity);!a&&e.parentSubject&&e.parentSubject.entity&&(a=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const o=e.metadata.getEntityIdMap(a);let l;if(o&&(l=yield this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(o).getRawOne().then(c=>{const u=c?c.right:void 0;return typeof u=="string"?parseInt(u):u})),l!==void 0)yield this.queryRunner.query(`UPDATE ${n} SET ${i} = CASE WHEN ${i} > ${l} THEN ${i} + 2 ELSE ${i} END,${s} = ${s} + 2 WHERE ${s} >= ${l}`),ke.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(l),e.metadata.nestedSetRightColumn.createValueMap(l+1));else{if(!(yield this.isUniqueRootEntity(e,a)))throw new Bb;ke.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2))}})}update(e){return v(this,null,function*(){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;if(!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find(o=>Object.entries(e.identifier).every(([l,c])=>o[l]===c))),n===void 0||t===void 0)return;const i=e.metadata.treeParentRelation.getEntityValue(n),s=e.metadata.getEntityIdMap(i),a=e.metadata.getEntityIdMap(t);if(!ke.compareIds(s,a)){if(t){const o=m=>this.queryRunner.connection.driver.escape(m),l=this.getTableName(e.metadata.tablePath),c=o(e.metadata.nestedSetLeftColumn.databaseName),u=o(e.metadata.nestedSetRightColumn.databaseName),h=e.metadata.getEntityIdMap(n);let f;h&&(f=(yield this.getNestedSetIds(e.metadata,h))[0]);let d;if(a&&(d=(yield this.getNestedSetIds(e.metadata,a))[0]),f!==void 0&&d!==void 0){const m=d.left>f.left,y=f.right-f.left+1;let T;m?T=d.left-f.right:T=d.right-f.left;const b=`WHEN ${c} >= ${f.left} AND ${c} < ${f.right} THEN ${c} + ${T} `,S=`WHEN ${u} > ${f.left} AND ${u} <= ${f.right} THEN ${u} + ${T} `;m?yield this.queryRunner.query(`UPDATE ${l} SET ${c} = CASE WHEN ${c} > ${f.right} AND ${c} <= ${d.left} THEN ${c} - ${y} `+b+`ELSE ${c} END, ${u} = CASE WHEN ${u} > ${f.right} AND ${u} < ${d.left} THEN ${u} - ${y} `+S+`ELSE ${u} END`):yield this.queryRunner.query(`UPDATE ${l} SET ${c} = CASE WHEN ${c} < ${f.left} AND ${c} > ${d.right} THEN ${c} + ${y} `+b+`ELSE ${c} END, ${u} = CASE WHEN ${u} < ${f.left} AND ${u} >= ${d.right} THEN ${u} + ${y} `+S+`ELSE ${u} END`)}}else if(!(yield this.isUniqueRootEntity(e,t)))throw new Bb}})}remove(e){return v(this,null,function*(){Array.isArray(e)||(e=[e]);const t=e[0].metadata,n=c=>this.queryRunner.connection.driver.escape(c),i=this.getTableName(t.tablePath),s=n(t.nestedSetLeftColumn.databaseName),a=n(t.nestedSetRightColumn.databaseName),o=[];for(const c of e){const u=t.getEntityIdMap(c.entity);u&&o.push(u)}const l=yield this.getNestedSetIds(t,o);for(const c of l){const u=c.right-c.left+1;yield this.queryRunner.query(`UPDATE ${i} SET ${s} = CASE WHEN ${s} > ${c.left} THEN ${s} - ${u} ELSE ${s} END, ${a} = CASE WHEN ${a} > ${c.right} THEN ${a} - ${u} ELSE ${a} END`)}})}getNestedSetIds(e,t){const n={left:`${e.targetName}.${e.nestedSetLeftColumn.propertyPath}`,right:`${e.targetName}.${e.nestedSetRightColumn.propertyPath}`},i=this.queryRunner.manager.createQueryBuilder();return Object.entries(n).forEach(([s,a])=>{i.addSelect(a,s)}),i.from(e.target,e.targetName).whereInIds(t).orderBy(n.right,"DESC").getRawMany().then(s=>{const a=[];for(const o of s){const l={};for(const c of Object.keys(n)){const u=o?o[c]:void 0;l[c]=typeof u=="string"?parseInt(u):u}a.push(l)}return a})}isUniqueRootEntity(e,t){return v(this,null,function*(){const n=c=>this.queryRunner.connection.driver.escape(c),i=this.getTableName(e.metadata.tablePath),s=[],a=e.metadata.treeParentRelation.joinColumns.map(c=>{const u=n(c.databaseName),h=c.getEntityValue(t);if(h==null)return`${u} IS NULL`;s.push(h);const f=this.queryRunner.connection.driver.createParameter("entity_"+c.databaseName,s.length-1);return`${u} = ${f}`}).join(" AND "),o="count",l=yield this.queryRunner.query(`SELECT COUNT(1) AS ${n(o)} FROM ${i} WHERE ${a}`,s,!0);return parseInt(l.records[0][o])===0})}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class Rf{constructor(e){this.queryRunner=e}insert(e){return v(this,null,function*(){const t={};e.metadata.closureJunctionTable.ancestorColumns.forEach(i=>{t[i.databaseName]=e.identifier}),e.metadata.closureJunctionTable.descendantColumns.forEach(i=>{t[i.databaseName]=e.identifier}),yield this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute();let n=e.metadata.treeParentRelation.getEntityValue(e.entity);if(!n&&e.parentSubject&&e.parentSubject.entity&&(n=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n){const i=h=>this.queryRunner.connection.driver.escape(h),s=this.getTableName(e.metadata.closureJunctionTable.tablePath),a=[],o=e.metadata.closureJunctionTable.ancestorColumns.map(h=>i(h.databaseName)),l=e.metadata.closureJunctionTable.descendantColumns.map(h=>i(h.databaseName)),c=e.metadata.primaryColumns.map(h=>(a.push(h.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),this.queryRunner.connection.driver.createParameter("child_entity_"+h.databaseName,a.length-1))),u=e.metadata.closureJunctionTable.descendantColumns.map(h=>{const f=i(h.databaseName),d=h.referencedColumn.getEntityValue(n);if(!d)throw new eb(e.metadata.name);a.push(d);const m=this.queryRunner.connection.driver.createParameter("parent_entity_"+h.referencedColumn.databaseName,a.length-1);return`${f} = ${m}`});yield this.queryRunner.query(`INSERT INTO ${s} (${[...o,...l].join(", ")}) SELECT ${o.join(", ")}, ${c.join(", ")} FROM ${s} WHERE ${u.join(" AND ")}`,a)}})}update(e){return v(this,null,function*(){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;if(!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find(d=>Object.entries(e.identifier).every(([m,y])=>d[m]===y))),n===void 0||t===void 0)return;const i=e.metadata.treeParentRelation.getEntityValue(n),s=e.metadata.getEntityIdMap(i),a=e.metadata.getEntityIdMap(t);if(ke.compareIds(s,a))return;const o=d=>this.queryRunner.connection.driver.escape(d),l=e.metadata.closureJunctionTable,c=l.ancestorColumns.map(d=>o(d.databaseName)),u=l.descendantColumns.map(d=>o(d.databaseName)),h=(d,m)=>{const y=`sub${m}`,T=d.createQueryBuilder().select(u.join(", ")).from(l.tablePath,y);for(const b of l.ancestorColumns)T.andWhere(`${o(y)}.${o(b.databaseName)} = :value_${b.referencedColumn.databaseName}`);return d.createQueryBuilder().select(u.join(", ")).from(`(${T.getQuery()})`,m).setParameters(T.getParameters()).getQuery()},f={};for(const d of e.metadata.primaryColumns)f[`value_${d.databaseName}`]=n[d.databaseName];if(yield this.queryRunner.manager.createQueryBuilder().delete().from(l.tablePath).where(d=>`(${u.join(", ")}) IN (${h(d,"descendant")})`).andWhere(d=>`(${c.join(", ")}) NOT IN (${h(d,"ancestor")})`).setParameters(f).execute(),t){const d=[],m=this.getTableName(l.tablePath),y=o("supertree"),T=o("subtree"),b=[...c.map(C=>`${y}.${C}`),...u.map(C=>`${T}.${C}`)],S=e.metadata.closureJunctionTable.ancestorColumns.map(C=>{const I=o(C.databaseName),H=C.referencedColumn.getEntityValue(n);d.push(H);const Q=this.queryRunner.connection.driver.createParameter("entity_"+C.referencedColumn.databaseName,d.length-1);return`${T}.${I} = ${Q}`}),N=e.metadata.closureJunctionTable.descendantColumns.map(C=>{const I=o(C.databaseName),H=C.referencedColumn.getEntityValue(t);if(!H)throw new eb(e.metadata.name);d.push(H);const Q=this.queryRunner.connection.driver.createParameter("parent_entity_"+C.referencedColumn.databaseName,d.length-1);return`${y}.${I} = ${Q}`});yield this.queryRunner.query(`INSERT INTO ${m} (${[...c,...u].join(", ")}) SELECT ${b.join(", ")} FROM ${m} AS ${y}, ${m} AS ${T} WHERE ${[...S,...N].join(" AND ")}`,d)}})}remove(e){return v(this,null,function*(){if(this.queryRunner.connection.driver.options.type!=="mssql")return;Array.isArray(e)||(e=[e]);const t=l=>this.queryRunner.connection.driver.escape(l),n=e.map(l=>l.identifier),i=e[0].metadata.closureJunctionTable,s=l=>l.map(c=>{const u=n.map(h=>h[c.referencedColumn.databaseName]);return`${t(c.databaseName)} IN (${u.join(", ")})`}).join(" AND "),a=s(i.ancestorColumns),o=s(i.descendantColumns);yield this.queryRunner.manager.createQueryBuilder().delete().from(i.tablePath).where(a).orWhere(o).execute()})}getTableName(e){return e.split(".").map(t=>t===""?t:this.queryRunner.connection.driver.escape(t)).join(".")}}class Kr{constructor(e){this["@instanceof"]=Symbol.for("EntityMetadata"),this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isAlwaysUsingConstructor=!0,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.beforeSoftRemoveListeners=[],this.beforeRecoverListeners=[],this.afterRemoveListeners=[],this.afterSoftRemoveListeners=[],this.afterRecoverListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid,this.dependsOn=this.tableMetadataArgs.dependsOn}create(e,t){const n=!!(t&&t.pojo===!0);let i;return typeof this.target=="function"&&!n?!(t!=null&&t.fromDeserializer)||this.isAlwaysUsingConstructor?i=new this.target:i=Object.create(this.target.prototype):i={},this.connection.options.typename&&(i[this.connection.options.typename]=this.targetName),this.lazyRelations.forEach(s=>this.connection.relationLoader.enableLazyLoad(s,i,e)),i}hasId(e){return e?this.primaryColumns.every(t=>{const n=t.getEntityValue(e);return n!=null&&n!==""}):!1}hasAllPrimaryKeys(e){return this.primaryColumns.every(t=>{const n=t.getEntityValue(e);return n!=null})}ensureEntityIdMap(e){if(_t.isObject(e))return e;if(this.hasMultiplePrimaryKeys)throw new q2(this,e);return this.primaryColumns[0].createValueMap(e)}getEntityIdMap(e){if(e)return Kr.getValueMap(e,this.primaryColumns,{skipNulls:!0})}getEntityIdMixedMap(e){if(!e)return e;const t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t&&this.primaryColumns[0].getEntityValue(t)}compareEntities(e,t){const n=this.getEntityIdMap(e);if(!n)return!1;const i=this.getEntityIdMap(t);return i?ke.compareIds(n,i):!1}findColumnWithPropertyName(e){return this.columns.find(t=>t.propertyName===e)}findColumnWithDatabaseName(e){return this.columns.find(t=>t.databaseName===e)}hasColumnWithPropertyPath(e){return this.columns.some(n=>n.propertyPath===e)||this.hasRelationWithPropertyPath(e)}findColumnWithPropertyPath(e){const t=this.columns.find(i=>i.propertyPath===e);if(t)return t;const n=this.relations.find(i=>i.propertyPath===e);if(n&&n.joinColumns.length===1)return n.joinColumns[0]}findColumnWithPropertyPathStrict(e){return this.columns.find(t=>t.propertyPath===e)}findColumnsWithPropertyPath(e){const t=this.columns.find(i=>i.propertyPath===e);if(t)return[t];const n=this.findRelationWithPropertyPath(e);return n&&n.joinColumns?n.joinColumns:[]}hasRelationWithPropertyPath(e){return this.relations.some(t=>t.propertyPath===e)}findRelationWithPropertyPath(e){return this.relations.find(t=>t.propertyPath===e)}hasEmbeddedWithPropertyPath(e){return this.allEmbeddeds.some(t=>t.propertyPath===e)}findEmbeddedWithPropertyPath(e){return this.allEmbeddeds.find(t=>t.propertyPath===e)}mapPropertyPathsToColumns(e){return e.map(t=>{const n=this.findColumnWithPropertyPath(t);if(n==null)throw new Wr(t,this);return n})}extractRelationValuesFromEntity(e,t){const n=[];return t.forEach(i=>{const s=i.getEntityValue(e);Array.isArray(s)?s.forEach(a=>n.push([i,a,Kr.getInverseEntityMetadata(a,i)])):s&&n.push([i,s,Kr.getInverseEntityMetadata(s,i)])}),n}findInheritanceMetadata(e){if(this.inheritancePattern==="STI"&&this.childEntityMetadatas.length>0){let t;return this.discriminatorColumn&&(t=e[this.discriminatorColumn.propertyName]),this.childEntityMetadatas.find(n=>t===n.discriminatorValue||e.constructor===n.target)||this}return this}static getInverseEntityMetadata(e,t){return t.inverseEntityMetadata.findInheritanceMetadata(e)}static createPropertyPath(e,t,n=""){const i=[];return Object.keys(t).forEach(s=>{const a=n?n+"."+s:s;if(e.hasEmbeddedWithPropertyPath(a)){const o=this.createPropertyPath(e,t[s],a);i.push(...o)}else{const o=n?n+"."+s:s;i.push(o)}}),i}static difference(e,t){return e.filter(n=>!t.find(i=>ke.compareIds(n,i)))}static getValueMap(e,t,n){return t.reduce((i,s)=>{const a=s.getEntityValueMap(e,n);if(!(i===void 0||a===null||a===void 0))return ke.mergeDeep(i,a)},{})}build(){var i;const e=this.connection.namingStrategy,t=this.connection.options.entityPrefix,n=this.connection.options.entitySkipConstructor;this.engine=this.tableMetadataArgs.engine,this.database=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:(i=this.connection.options)!=null&&i.hasOwnProperty("schema")&&(this.schema=this.connection.options.schema),this.givenTableName=this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=this.tableMetadataArgs.synchronize!==!1,this.targetName=typeof this.tableMetadataArgs.target=="function"?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,this.tableMetadataArgs.type==="closure-junction"?this.tableNameWithoutPrefix=e.closureJunctionTableName(this.givenTableName):this.tableMetadataArgs.type==="entity-child"&&this.parentEntityMetadata?this.tableNameWithoutPrefix=e.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=e.tableName(this.targetName,this.givenTableName),this.tableMetadataArgs.type==="junction"&&this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=JT(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=t?e.prefixTableName(t,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid===!0,this.tablePath=this.connection.driver.buildTableName(this.tableName,this.schema,this.database),this.orderBy=typeof this.tableMetadataArgs.orderBy=="function"?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,n!==void 0&&(this.isAlwaysUsingConstructor=!n),this.isJunction=this.tableMetadataArgs.type==="closure-junction"||this.tableMetadataArgs.type==="junction",this.isClosureJunction=this.tableMetadataArgs.type==="closure-junction",this.comment=this.tableMetadataArgs.comment}registerColumn(e){this.ownColumns.indexOf(e)===-1&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce((t,n)=>t.concat(n.columnsFromTree),this.ownColumns),this.primaryColumns=this.columns.filter(t=>t.isPrimary),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach(t=>t.registerColumn(e)))}createPropertiesMap(){const e={};return this.columns.forEach(t=>ke.mergeDeep(e,t.createValueMap(t.propertyPath))),this.relations.forEach(t=>ke.mergeDeep(e,t.createValueMap(t.propertyPath))),e}getInsertionReturningColumns(){return this.columns.filter(e=>e.default!==void 0||e.asExpression!==void 0||e.isGenerated||e.isCreateDate||e.isUpdateDate||e.isDeleteDate||e.isVersion)}}class Fb{constructor(e){this.queryRunner=e}insert(e){return v(this,null,function*(){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const n=e.metadata.getEntityIdMap(t);let i="";n&&(i=yield this.getEntityPath(e,n));const s=e.metadata.treeParentRelation.joinColumns.map(a=>a.referencedColumn.getEntityValue(e.insertedValueSet)).join("_");yield this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[e.metadata.materializedPathColumn.propertyPath]:i+s+"."}).where(e.identifier).execute()})}update(e){return v(this,null,function*(){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find(h=>Object.entries(e.identifier).every(([f,d])=>h[f]===d)));const i=e.metadata.treeParentRelation.getEntityValue(n),s=this.getEntityParentReferencedColumnMap(e,i),a=this.getEntityParentReferencedColumnMap(e,t);if(ke.compareIds(s,a))return;let o="";a&&(o=yield this.getEntityPath(e,a));let l="";s&&(l=(yield this.getEntityPath(e,s))||"");const c=e.metadata.treeParentRelation.joinColumns.map(h=>h.referencedColumn.getEntityValue(n)).join("_"),u=e.metadata.materializedPathColumn.propertyPath;yield this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[u]:()=>`REPLACE(${this.queryRunner.connection.driver.escape(u)}, '${l}${c}.', '${o}${c}.')`}).where(`${u} LIKE :path`,{path:`${l}${c}.%`}).execute()})}getEntityParentReferencedColumnMap(e,t){if(t)return Kr.getValueMap(t,e.metadata.treeParentRelation.joinColumns.map(n=>n.referencedColumn).filter(n=>n!=null),{skipNulls:!0})}getEntityPath(e,t){const n=e.metadata,i=(Array.isArray(t)?t:[t]).map(s=>n.ensureEntityIdMap(s));return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).where(new uu(s=>{for(const a of i)s.orWhere(new uu(o=>o.where(a)))})).getRawOne().then(s=>s?s.path:"")}}class P3{constructor(e,t,n){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=n,this.validate(),this.recompute()}execute(){return v(this,null,function*(){let e;(!this.options||this.options.listeners!==!1)&&(e=this.broadcastBeforeEventsForAll(),e.promises.length>0&&(yield Promise.all(e.promises))),e&&e.count>0&&(this.insertSubjects.forEach(t=>t.recompute()),this.updateSubjects.forEach(t=>t.recompute()),this.removeSubjects.forEach(t=>t.recompute()),this.softRemoveSubjects.forEach(t=>t.recompute()),this.recoverSubjects.forEach(t=>t.recompute()),this.recompute()),this.insertSubjects=new kb(this.insertSubjects).sort("insert"),yield this.executeInsertOperations(),this.updateSubjects=this.allSubjects.filter(t=>t.mustBeUpdated),yield this.executeUpdateOperations(),this.removeSubjects=new kb(this.removeSubjects).sort("delete"),yield this.executeRemoveOperations(),this.softRemoveSubjects=this.allSubjects.filter(t=>t.mustBeSoftRemoved),yield this.executeSoftRemoveOperations(),this.recoverSubjects=this.allSubjects.filter(t=>t.mustBeRecovered),yield this.executeRecoverOperations(),this.updateSpecialColumnsInPersistedEntities(),(!this.options||this.options.listeners!==!1)&&(e=this.broadcastAfterEventsForAll(),e.promises.length>0&&(yield Promise.all(e.promises)))})}validate(){this.allSubjects.forEach(e=>{if(e.mustBeUpdated&&e.mustBeRemoved)throw new nq(e)})}recompute(){new M3().compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter(e=>e.mustBeInserted),this.updateSubjects=this.allSubjects.filter(e=>e.mustBeUpdated),this.removeSubjects=this.allSubjects.filter(e=>e.mustBeRemoved),this.softRemoveSubjects=this.allSubjects.filter(e=>e.mustBeSoftRemoved),this.recoverSubjects=this.allSubjects.filter(e=>e.mustBeRecovered),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0}broadcastBeforeEventsForAll(){const e=new Or;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeInsertEvent(e,t.metadata,t.entity)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastBeforeRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}broadcastAfterEventsForAll(){const e=new Or;return this.insertSubjects.length&&this.insertSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterInsertEvent(e,t.metadata,t.entity,t.identifier)),this.updateSubjects.length&&this.updateSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations)),this.removeSubjects.length&&this.removeSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),this.recoverSubjects.length&&this.recoverSubjects.forEach(t=>this.queryRunner.broadcaster.broadcastAfterRecoverEvent(e,t.metadata,t.entity,t.databaseEntity,t.identifier)),e}executeInsertOperations(){return v(this,null,function*(){const[e,t]=this.groupBulkSubjects(this.insertSubjects,"insert");for(const n of t){const i=e[n],s=[],a=[],o=[];if(this.queryRunner.connection.driver.options.type==="mongodb"?i.forEach(l=>{l.metadata.createDateColumn&&l.entity&&(l.entity[l.metadata.createDateColumn.databaseName]=new Date),l.metadata.updateDateColumn&&l.entity&&(l.entity[l.metadata.updateDateColumn.databaseName]=new Date),l.createValueSetAndPopChangeMap(),a.push(l),s.push(l.entity)}):this.queryRunner.connection.driver.options.type==="oracle"?i.forEach(l=>{o.push(l)}):i.forEach(l=>{l.changeMaps.length===0||l.metadata.treeType||this.queryRunner.connection.driver.options.type==="oracle"||this.queryRunner.connection.driver.options.type==="sap"?o.push(l):(a.push(l),s.push(l.createValueSetAndPopChangeMap()))}),de.isMongoEntityManager(this.queryRunner.manager)){const l=yield this.queryRunner.manager.insert(i[0].metadata.target,s);i.forEach((c,u)=>{c.identifier=l.identifiers[u],c.generatedMap=l.generatedMaps[u],c.insertedValueSet=s[u]})}else{if(s.length>0){const l=yield this.queryRunner.manager.createQueryBuilder().insert().into(i[0].metadata.target).values(s).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute();a.forEach((c,u)=>{c.identifier=l.identifiers[u],c.generatedMap=l.generatedMaps[u],c.insertedValueSet=s[u]})}if(o.length>0)for(const l of o)l.insertedValueSet=l.createValueSetAndPopChangeMap(),l.metadata.treeType==="nested-set"&&(yield new xf(this.queryRunner).insert(l)),yield this.queryRunner.manager.createQueryBuilder().insert().into(l.metadata.target).values(l.insertedValueSet).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1).execute().then(c=>{l.identifier=c.identifiers[0],l.generatedMap=c.generatedMaps[0]}),l.metadata.treeType==="closure-table"?yield new Rf(this.queryRunner).insert(l):l.metadata.treeType==="materialized-path"&&(yield new Fb(this.queryRunner).insert(l))}i.forEach(l=>{l.generatedMap&&l.metadata.columns.forEach(c=>{const u=c.getEntityValue(l.generatedMap);if(u!=null){const h=this.queryRunner.connection.driver.prepareHydratedValue(u,c);c.setEntityValue(l.generatedMap,h)}})})}})}executeUpdateOperations(){return v(this,null,function*(){const e=s=>v(this,null,function*(){if(!s.identifier)throw new hc(s);if(de.isMongoEntityManager(this.queryRunner.manager)){const a=this.cloneMongoSubjectEntity(s);s.metadata.objectIdColumn&&s.metadata.objectIdColumn.propertyName&&delete a[s.metadata.objectIdColumn.propertyName],s.metadata.createDateColumn&&s.metadata.createDateColumn.propertyName&&delete a[s.metadata.createDateColumn.propertyName],s.metadata.updateDateColumn&&s.metadata.updateDateColumn.propertyName&&(a[s.metadata.updateDateColumn.propertyName]=new Date),yield this.queryRunner.manager.update(s.metadata.target,s.identifier,a)}else{const a=s.createValueSetAndPopChangeMap();switch(s.metadata.treeType){case"nested-set":yield new xf(this.queryRunner).update(s);break;case"closure-table":yield new Rf(this.queryRunner).update(s);break;case"materialized-path":yield new Fb(this.queryRunner).update(s);break}const o=this.queryRunner.manager.createQueryBuilder().update(s.metadata.target).set(a).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);s.entity?o.whereEntity(s.identifier):o.where(s.identifier);const c=(yield o.execute()).generatedMaps[0];c&&(s.metadata.columns.forEach(u=>{const h=u.getEntityValue(c);if(h!=null){const f=this.queryRunner.connection.driver.prepareHydratedValue(h,u);u.setEntityValue(c,f)}}),s.generatedMap||(s.generatedMap={}),Object.assign(s.generatedMap,c))}}),t=[],n=[];for(const s of this.updateSubjects)s.metadata.treeType==="nested-set"?t.push(s):n.push(s);const i=()=>v(this,null,function*(){for(const s of t)yield e(s)});yield Promise.all([...n.map(e),i()])})}executeRemoveOperations(){return v(this,null,function*(){const[e,t]=this.groupBulkSubjects(this.removeSubjects,"delete");for(const n of t){const i=e[n],s=i.map(a=>{if(!a.identifier)throw new hc(a);return a.identifier});if(de.isMongoEntityManager(this.queryRunner.manager))yield this.queryRunner.manager.delete(i[0].metadata.target,s);else{switch(i[0].metadata.treeType){case"nested-set":yield new xf(this.queryRunner).remove(i);break;case"closure-table":yield new Rf(this.queryRunner).remove(i);break}yield this.queryRunner.manager.createQueryBuilder().delete().from(i[0].metadata.target).where(s).callListeners(!1).execute()}}})}cloneMongoSubjectEntity(e){const t={};if(e.entity)for(const n of e.metadata.columns)ke.mergeDeep(t,n.getEntityValueMap(e.entity));return t}executeSoftRemoveOperations(){return v(this,null,function*(){yield Promise.all(this.softRemoveSubjects.map(e=>v(this,null,function*(){if(!e.identifier)throw new hc(e);let t;if(de.isMongoEntityManager(this.queryRunner.manager)){const n=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete n[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete n[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(n[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(n[e.metadata.deleteDateColumn.propertyName]=new Date),t=yield this.queryRunner.manager.update(e.metadata.target,e.identifier,n)}else{const n=this.queryRunner.manager.createQueryBuilder().softDelete().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?n.whereEntity(e.identifier):n.where(e.identifier),t=yield n.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(n=>{const i=n.getEntityValue(e.generatedMap);if(i!=null){const s=this.queryRunner.connection.driver.prepareHydratedValue(i,n);n.setEntityValue(e.generatedMap,s)}})})))})}executeRecoverOperations(){return v(this,null,function*(){yield Promise.all(this.recoverSubjects.map(e=>v(this,null,function*(){if(!e.identifier)throw new hc(e);let t;if(de.isMongoEntityManager(this.queryRunner.manager)){const n=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete n[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete n[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(n[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(n[e.metadata.deleteDateColumn.propertyName]=null),t=yield this.queryRunner.manager.update(e.metadata.target,e.identifier,n)}else{const n=this.queryRunner.manager.createQueryBuilder().restore().from(e.metadata.target).updateEntity(!(this.options&&this.options.reload===!1)).callListeners(!1);e.entity?n.whereEntity(e.identifier):n.where(e.identifier),t=yield n.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach(n=>{const i=n.getEntityValue(e.generatedMap);if(i!=null){const s=this.queryRunner.connection.driver.prepareHydratedValue(i,n);n.setEntityValue(e.generatedMap,s)}})})))})}updateSpecialColumnsInPersistedEntities(){this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.softRemoveSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.recoverSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach(e=>{e.entity&&e.metadata.primaryColumns.forEach(t=>{t.setEntityValue(e.entity,void 0)})}),this.allSubjects.forEach(e=>{e.entity&&(e.metadata.relationIds.forEach(t=>{t.setValue(e.entity)}),de.isMongoEntityManager(this.queryRunner.manager)&&e.metadata.objectIdColumn&&e.metadata.objectIdColumn.databaseName&&e.metadata.objectIdColumn.databaseName!==e.metadata.objectIdColumn.propertyName&&delete e.entity[e.metadata.objectIdColumn.databaseName])})}updateSpecialColumnsInInsertedAndUpdatedEntities(e){e.forEach(t=>{t.entity&&(t.metadata.columns.forEach(n=>{t.metadata.childEntityMetadatas.length>0&&t.metadata.childEntityMetadatas.map(i=>i.target).indexOf(n.target)!==-1||n.isVirtual||n.isDeleteDate||(n.isNullable&&n.getEntityValue(t.entity)===void 0&&n.setEntityValue(t.entity,null),t.updatedRelationMaps.length>0&&t.updatedRelationMaps.forEach(i=>{i.relation.joinColumns.forEach(s=>{s.isVirtual!==!0&&s.setEntityValue(t.entity,_t.isObject(i.value)?s.referencedColumn.getEntityValue(i.value):i.value)})}))}),t.generatedMap&&this.queryRunner.manager.merge(t.metadata.target,t.entity,t.generatedMap))})}groupBulkSubjects(e,t){const n={},i=[],s=e.some(o=>o.metadata.getInsertionReturningColumns().length>0),a=t==="delete"||this.queryRunner.connection.driver.isReturningSqlSupported("insert")||s===!1;return e.forEach((o,l)=>{const c=a||o.metadata.isJunction?o.metadata.name:o.metadata.name+"_"+l;n[c]?n[c].push(o):(n[c]=[o],i.push(c))}),[n,i]}}class Pi{constructor(e){this["@instanceof"]=Symbol.for("Subject"),this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,e.canBeInserted!==void 0&&(this.canBeInserted=e.canBeInserted),e.canBeUpdated!==void 0&&(this.canBeUpdated=e.canBeUpdated),e.mustBeRemoved!==void 0&&(this.mustBeRemoved=e.mustBeRemoved),e.canBeSoftRemoved!==void 0&&(this.canBeSoftRemoved=e.canBeSoftRemoved),e.canBeRecovered!==void 0&&(this.canBeRecovered=e.canBeRecovered),e.identifier!==void 0&&(this.identifier=e.identifier),e.changeMaps!==void 0&&this.changeMaps.push(...e.changeMaps),this.recompute()}get mustBeInserted(){return this.canBeInserted&&!this.databaseEntity}get mustBeUpdated(){return this.canBeUpdated&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.some(e=>!e.column||e.column.isUpdate)}get mustBeSoftRemoved(){return this.canBeSoftRemoved&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}get mustBeRecovered(){return this.canBeRecovered&&this.identifier&&(this.databaseEntityLoaded===!1||this.databaseEntityLoaded&&this.databaseEntity)}createValueSetAndPopChangeMap(){const e=[],t=this.changeMaps.reduce((n,i)=>{let s=i.value;de.isSubject(s)&&(s=s.insertedValueSet?s.insertedValueSet:s.entity);let a;if(this.metadata.isJunction&&i.column)a=i.column.createValueMap(i.column.referencedColumn.getEntityValue(s));else if(i.column)a=i.column.createValueMap(s);else if(i.relation)if(_t.isObject(s)&&!Buffer.isBuffer(s)){const o=i.relation.getRelationIdMap(s);if(o===void 0)return e.push(i),this.canBeUpdated=!0,n;a=i.relation.createValueMap(o),this.updatedRelationMaps.push({relation:i.relation,value:o})}else a=i.relation.createValueMap(s),this.updatedRelationMaps.push({relation:i.relation,value:s});return ke.mergeDeep(n,a),n},{});return this.changeMaps=e,t}recompute(){this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach(e=>{if(e.relationMetadata&&e.relationMetadata.inverseEntityMetadata===this.parentSubject.metadata){const t=e.referencedColumn.getEntityValue(this.parentSubject.entity);e.setEntityValue(this.entityWithFulfilledIds,t)}}),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))}}class I3{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){var a;let n=[];if(e.databaseEntity){const o=t.getEntityValue(e.databaseEntity);o&&(n=o.map(l=>t.inverseEntityMetadata.getEntityIdMap(l)))}let i=t.getEntityValue(e.entity);if(i===null&&(i=[]),i===void 0)return;const s=[];i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o),c=this.subjects.find(h=>h.entity===o);if(c&&(l=c.identifier),!l){if(!c)return;c.changeMaps.push({relation:t.inverseRelation,value:e});return}n.find(h=>ke.compareIds(l,h))||(c||(c=new Pi({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:l}),this.subjects.push(c)),c.changeMaps.push({relation:t.inverseRelation,value:e})),s.push(l)}),((a=t.inverseRelation)==null?void 0:a.orphanedRowAction)!=="disable"&&Kr.difference(n,s).forEach(o=>{const l=new Pi({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:o});!t.inverseRelation||t.inverseRelation.orphanedRowAction==="nullify"?(l.canBeUpdated=!0,l.changeMaps=[{relation:t.inverseRelation,value:null}]):t.inverseRelation.orphanedRowAction==="delete"?l.mustBeRemoved=!0:t.inverseRelation.orphanedRowAction==="soft-delete"&&(l.canBeSoftRemoved=!0),this.subjects.push(l)})}}class O3{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.metadata.oneToOneRelations.forEach(t=>{t.isOwning||t.persistenceEnabled===!1||this.buildForSubjectRelation(e,t)})})}buildForSubjectRelation(e,t){let n;e.databaseEntity&&(n=t.getEntityValue(e.databaseEntity));const i=t.getEntityValue(e.entity);if(i===void 0)return;if(i===null){if(n){const l=new Pi({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:n,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(l)}return}let s=t.inverseEntityMetadata.getEntityIdMap(i),a=this.subjects.find(l=>!!l.entity&&l.entity===i);if(a&&(s=a.identifier),!s){if(!a)return;a.changeMaps.push({relation:t.inverseRelation,value:e})}n&&ke.compareIds(s,n)||(a||(a=new Pi({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:s}),this.subjects.push(a)),a.changeMaps.push({relation:t.inverseRelation,value:e}))}}class Ub{constructor(e){this.subjects=e}build(){this.subjects.forEach(e=>{e.entity&&e.metadata.manyToManyRelations.forEach(t=>{t.persistenceEnabled!==!1&&this.buildForSubjectRelation(e,t)})})}buildForAllRemoval(e){e.databaseEntity&&e.metadata.manyToManyRelations.forEach(t=>{if(t.persistenceEnabled===!1)return;t.getEntityValue(e.databaseEntity).forEach(i=>{const s=new Pi({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,i)});this.subjects.push(s)})})}buildForSubjectRelation(e,t){let n=[];if(e.databaseEntity){const o=t.getEntityValue(e.databaseEntity);o&&(n=o.map(l=>t.inverseEntityMetadata.getEntityIdMap(l)))}let i=t.getEntityValue(e.entity);if(i===null&&(i=[]),!Array.isArray(i))return;i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o);const c=this.subjects.find(m=>m.entity===o);if(c&&(l=c.identifier),!l&&!c||n.find(m=>ke.compareIds(m,l)))return;const h=t.isOwning?e:c||o,f=t.isOwning?c||o:e,d=new Pi({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});this.subjects.push(d),t.junctionEntityMetadata.ownerColumns.forEach(m=>{d.changeMaps.push({column:m,value:h})}),t.junctionEntityMetadata.inverseColumns.forEach(m=>{d.changeMaps.push({column:m,value:f})})});const s=[];i.forEach(o=>{let l=t.inverseEntityMetadata.getEntityIdMap(o);const c=this.subjects.find(u=>u.entity===o);c&&(l=c.identifier),l!=null&&s.push(l)}),n.filter(o=>!s.find(l=>ke.compareIds(l,o))).forEach(o=>{const l=new Pi({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,o)});this.subjects.push(l)})}buildJunctionIdentifier(e,t,n){const i=t.isOwning?e.entity:n,s=t.isOwning?n:e.entity,a={};return t.junctionEntityMetadata.ownerColumns.forEach(o=>{ke.mergeDeep(a,o.createValueMap(o.referencedColumn.getEntityValue(i)))}),t.junctionEntityMetadata.inverseColumns.forEach(o=>{ke.mergeDeep(a,o.createValueMap(o.referencedColumn.getEntityValue(s)))}),a}}class $3{constructor(e,t){this.queryRunner=e,this.subjects=t}load(e){return v(this,null,function*(){const t=this.groupByEntityTargets().map(n=>v(this,null,function*(){const i=[],s=[];if(n.subjects.forEach(c=>{c.databaseEntity||!c.identifier||(i.push(c.identifier),s.push(c))}),!i.length)return;const a=[];e==="save"||e==="soft-remove"||e==="recover"?n.subjects.forEach(c=>{c.metadata.relations.forEach(u=>{u.getEntityValue(c.entityWithFulfilledIds)!==void 0&&a.indexOf(u.propertyPath)===-1&&a.push(u.propertyPath)})}):a.push(...n.subjects[0].metadata.manyToManyRelations.map(c=>c.propertyPath));const o={loadEagerRelations:!1,loadRelationIds:{relations:a,disableMixedMap:!0},withDeleted:!0};let l=[];this.queryRunner.connection.driver.options.type==="mongodb"?l=yield this.queryRunner.manager.getRepository(n.target).findByIds(i,o):l=yield this.queryRunner.manager.getRepository(n.target).createQueryBuilder().setFindOptions(o).whereInIds(i).getMany(),l.forEach(c=>{const u=s[0].metadata.getEntityIdMap(c);s.forEach(h=>{h.databaseEntity||ke.compareIds(h.identifier,u)&&(h.databaseEntity=c)})});for(const c of s)c.databaseEntityLoaded=!0}));yield Promise.all(t)})}groupByEntityTargets(){return this.subjects.reduce((e,t)=>{let n=e.find(i=>i.target===t.metadata.target);return n||(n={target:t.metadata.target,subjects:[]},e.push(n)),n.subjects.push(t),e},[])}}class D3{constructor(e){this.allSubjects=e}build(e,t){e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach(([n,i,s])=>{if(i==null||!n.isCascadeInsert&&!n.isCascadeUpdate&&!n.isCascadeSoftRemove&&!n.isCascadeRecover||!_t.isObject(i))return;const a=this.findByPersistEntityLike(s.target,i);if(a){a.canBeInserted===!1&&(a.canBeInserted=n.isCascadeInsert===!0&&t==="save"),a.canBeUpdated===!1&&(a.canBeUpdated=n.isCascadeUpdate===!0&&t==="save"),a.canBeSoftRemoved===!1&&(a.canBeSoftRemoved=n.isCascadeSoftRemove===!0&&t==="soft-remove"),a.canBeRecovered===!1&&(a.canBeRecovered=n.isCascadeRecover===!0&&t==="recover");return}const o=new Pi({metadata:s,parentSubject:e,entity:i,canBeInserted:n.isCascadeInsert===!0&&t==="save",canBeUpdated:n.isCascadeUpdate===!0&&t==="save",canBeSoftRemoved:n.isCascadeSoftRemove===!0&&t==="soft-remove",canBeRecovered:n.isCascadeRecover===!0&&t==="recover"});this.allSubjects.push(o),this.build(o,t)})}findByPersistEntityLike(e,t){return this.allSubjects.find(n=>n.entity?n.entity===t?!0:n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t):!1)}}class dc{constructor(e,t,n,i,s,a){this.connection=e,this.queryRunner=t,this.mode=n,this.target=i,this.entity=s,this.options=a}execute(){return v(this,null,function*(){if(!this.entity||typeof this.entity!="object")return Promise.reject(new V2(this.mode,this.entity));yield Promise.resolve();const e=this.queryRunner||this.connection.createQueryRunner(),t=e.data;this.options&&this.options.data&&(e.data=this.options.data);try{const n=Array.isArray(this.entity)?this.entity:[this.entity],i=this.options&&this.options.chunk&&this.options.chunk>0?ke.chunk(n,this.options.chunk):[n],a=(yield Promise.all(i.map(l=>v(this,null,function*(){const c=[];l.forEach(h=>{const f=this.target?this.target:h.constructor;if(f===Object)throw new k2(this.mode);const d=this.connection.getMetadata(f).findInheritanceMetadata(h);c.push(new Pi({metadata:d,entity:h,canBeInserted:this.mode==="save",canBeUpdated:this.mode==="save",mustBeRemoved:this.mode==="remove",canBeSoftRemoved:this.mode==="soft-remove",canBeRecovered:this.mode==="recover"}))});const u=new D3(c);return c.forEach(h=>{u.build(h,this.mode)}),yield new $3(e,c).load(this.mode),this.mode==="save"||this.mode==="soft-remove"||this.mode==="recover"?(new I3(c).build(),new O3(c).build(),new Ub(c).build()):c.forEach(h=>{h.mustBeRemoved&&new Ub(c).buildForAllRemoval(h)}),new P3(e,c,this.options)})))).filter(l=>l.hasExecutableOperations);if(a.length===0)return;let o=!1;try{e.isTransactionActive||this.connection.driver.transactionSupport!=="none"&&(!this.options||this.options.transaction!==!1)&&(o=!0,yield e.startTransaction());for(const l of a)yield l.execute();o===!0&&(yield e.commitTransaction())}catch(l){if(o)try{yield e.rollbackTransaction()}catch(c){}throw l}}finally{e.data=t,this.queryRunner||(yield e.release())}})}}class o_{constructor(e,t){this["@instanceof"]=Symbol.for("EntityManager"),this.repositories=new Map,this.treeRepositories=[],this.plainObjectToEntityTransformer=new _3,this.connection=e,t&&(this.queryRunner=t,_t.assign(this.queryRunner,{manager:this}))}transaction(e,t){return v(this,null,function*(){const n=typeof e=="string"?e:void 0,i=typeof e=="function"?e:t;if(!i)throw new Z("Transaction method requires callback in second parameter if isolation level is supplied.");if(this.queryRunner&&this.queryRunner.isReleased)throw new RT;const s=this.queryRunner||this.connection.createQueryRunner();try{yield s.startTransaction(n);const a=yield i(s.manager);return yield s.commitTransaction(),a}catch(a){try{yield s.rollbackTransaction()}catch(o){}throw a}finally{this.queryRunner||(yield s.release())}})}query(e,t){return v(this,null,function*(){return this.connection.query(e,t,this.queryRunner)})}sql(e,...t){return v(this,null,function*(){const{query:n,parameters:i}=ch({driver:this.connection.driver,strings:e,expressions:t});return yield this.query(n,i)})}createQueryBuilder(e,t,n){return t?this.connection.createQueryBuilder(e,t,n||this.queryRunner):this.connection.createQueryBuilder(e||n||this.queryRunner)}hasId(e,t){const n=arguments.length===2?e:e.constructor,i=arguments.length===2?t:e;return this.connection.getMetadata(n).hasId(i)}getId(e,t){const n=arguments.length===2?e:e.constructor,i=arguments.length===2?t:e;return this.connection.getMetadata(n).getEntityIdMixedMap(i)}create(e,t){const n=this.connection.getMetadata(e);if(!t)return n.create(this.queryRunner);if(Array.isArray(t))return t.map(s=>this.create(e,s));const i=n.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(i,t,n,!0),i}merge(e,t,...n){const i=this.connection.getMetadata(e);return n.forEach(s=>this.plainObjectToEntityTransformer.transform(t,s,i)),t}preload(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e),s=yield new N3(this.connection.manager).transform(t,n);if(s)return this.merge(e,s,t)})}save(e,t,n){let i=arguments.length>1&&(typeof e=="function"||de.isEntitySchema(e)||typeof e=="string")?e:void 0;const s=i?t:e,a=i?n:t;return de.isEntitySchema(i)&&(i=i.options.name),Array.isArray(s)&&s.length===0?Promise.resolve(s):new dc(this.connection,this.queryRunner,"save",i,s,a).execute().then(()=>s)}remove(e,t,n){const i=arguments.length>1&&(typeof e=="function"||de.isEntitySchema(e)||typeof e=="string")?e:void 0,s=i?t:e,a=i?n:t;return Array.isArray(s)&&s.length===0?Promise.resolve(s):new dc(this.connection,this.queryRunner,"remove",i,s,a).execute().then(()=>s)}softRemove(e,t,n){let i=arguments.length>1&&(typeof e=="function"||de.isEntitySchema(e)||typeof e=="string")?e:void 0;const s=i?t:e,a=i?n:t;return de.isEntitySchema(i)&&(i=i.options.name),Array.isArray(s)&&s.length===0?Promise.resolve(s):new dc(this.connection,this.queryRunner,"soft-remove",i,s,a).execute().then(()=>s)}recover(e,t,n){let i=arguments.length>1&&(typeof e=="function"||de.isEntitySchema(e)||typeof e=="string")?e:void 0;const s=i?t:e,a=i?n:t;return de.isEntitySchema(i)&&(i=i.options.name),Array.isArray(s)&&s.length===0?Promise.resolve(s):new dc(this.connection,this.queryRunner,"recover",i,s,a).execute().then(()=>s)}insert(e,t){return v(this,null,function*(){return this.createQueryBuilder().insert().into(e).values(t).execute()})}upsert(e,t,n){return v(this,null,function*(){const i=this.connection.getMetadata(e);let s;Array.isArray(n)?s={conflictPaths:n}:s=n;let a;Array.isArray(t)?a=t:a=[t];const o=i.mapPropertyPathsToColumns(Array.isArray(s.conflictPaths)?s.conflictPaths:Object.keys(s.conflictPaths)),l=i.columns.filter(c=>!o.includes(c)&&a.some(u=>typeof c.getEntityValue(u)!="undefined"));return this.createQueryBuilder().insert().into(e).values(a).orUpdate([...o,...l].map(c=>c.databaseName),o.map(c=>c.databaseName),{skipUpdateIfNoValuesChanged:s.skipUpdateIfNoValuesChanged,indexPredicate:s.indexPredicate,upsertType:s.upsertType||this.connection.driver.supportedUpsertTypes[0]}).execute()})}update(e,t,n){return ke.isCriteriaNullOrEmpty(t)?Promise.reject(new Z("Empty criteria(s) are not allowed for the update method.")):ke.isPrimitiveCriteria(t)?this.createQueryBuilder().update(e).set(n).whereInIds(t).execute():this.createQueryBuilder().update(e).set(n).where(t).execute()}updateAll(e,t){return this.createQueryBuilder().update(e).set(t).execute()}delete(e,t){return ke.isCriteriaNullOrEmpty(t)?Promise.reject(new Z("Empty criteria(s) are not allowed for the delete method.")):ke.isPrimitiveCriteria(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()}deleteAll(e){return this.createQueryBuilder().delete().from(e).execute()}softDelete(e,t){return ke.isCriteriaNullOrEmpty(t)?Promise.reject(new Z("Empty criteria(s) are not allowed for the softDelete method.")):ke.isPrimitiveCriteria(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()}restore(e,t){return ke.isCriteriaNullOrEmpty(t)?Promise.reject(new Z("Empty criteria(s) are not allowed for the restore method.")):ke.isPrimitiveCriteria(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()}exists(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,jn.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getExists()}existsBy(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getExists()})}count(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,jn.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getCount()}countBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getCount()}sum(e,t,n){return this.callAggregateFun(e,"SUM",t,n)}average(e,t,n){return this.callAggregateFun(e,"AVG",t,n)}minimum(e,t,n){return this.callAggregateFun(e,"MIN",t,n)}maximum(e,t,n){return this.callAggregateFun(e,"MAX",t,n)}callAggregateFun(s,a,o){return v(this,arguments,function*(e,t,n,i={}){const l=this.connection.getMetadata(e),c=l.columns.find(h=>h.propertyPath===n);if(!c)throw new Z(`Column "${n}" was not found in table "${l.name}"`);const u=yield this.createQueryBuilder(e,l.name).setFindOptions({where:i}).select(`${t}(${this.connection.driver.escape(c.databaseName)})`,t).getRawOne();return u[t]===null?null:parseFloat(u[t])})}find(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,jn.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getMany()})}findBy(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getMany()})}findAndCount(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,jn.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getManyAndCount()}findAndCountBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getManyAndCount()}findByIds(e,t){return v(this,null,function*(){if(!t.length)return Promise.resolve([]);const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).andWhereInIds(t).getMany()})}findOne(e,t){return v(this,null,function*(){let i=this.connection.getMetadata(e).name;if(t&&t.join&&(i=t.join.alias),!t.where)throw new Error("You must provide selection conditions in order to find a single row.");return this.createQueryBuilder(e,i).setFindOptions(Tt(Xe({},t),{take:1})).getOne()})}findOneBy(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t,take:1}).getOne()})}findOneById(e,t){return v(this,null,function*(){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({take:1}).whereInIds(n.ensureEntityIdMap(t)).getOne()})}findOneOrFail(e,t){return v(this,null,function*(){return this.findOne(e,t).then(n=>n===null?Promise.reject(new Od(e,t)):Promise.resolve(n))})}findOneByOrFail(e,t){return v(this,null,function*(){return this.findOneBy(e,t).then(n=>n===null?Promise.reject(new Od(e,t)):Promise.resolve(n))})}clear(e){return v(this,null,function*(){const t=this.connection.getMetadata(e),n=this.queryRunner||this.connection.createQueryRunner();try{return yield n.clearTable(t.tablePath)}finally{this.queryRunner||(yield n.release())}})}increment(e,t,n,i){return v(this,null,function*(){const s=this.connection.getMetadata(e),a=s.findColumnWithPropertyPath(n);if(!a)throw new Z(`Column ${n} was not found in ${s.targetName} entity.`);if(isNaN(Number(i)))throw new Z(`Value "${i}" is not a number.`);const o=n.split(".").reduceRight((l,c)=>({[c]:l}),()=>this.connection.driver.escape(a.databaseName)+" + "+i);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()})}decrement(e,t,n,i){return v(this,null,function*(){const s=this.connection.getMetadata(e),a=s.findColumnWithPropertyPath(n);if(!a)throw new Z(`Column ${n} was not found in ${s.targetName} entity.`);if(isNaN(Number(i)))throw new Z(`Value "${i}" is not a number.`);const o=n.split(".").reduceRight((l,c)=>({[c]:l}),()=>this.connection.driver.escape(a.databaseName)+" - "+i);return this.createQueryBuilder(e,"entity").update(e).set(o).where(t).execute()})}getRepository(e){const t=this.repositories.get(e);if(t)return t;if(this.connection.driver.options.type==="mongodb"){const n=new u3(e,this,this.queryRunner);return this.repositories.set(e,n),n}else{const n=new s_(e,this,this.queryRunner);return this.repositories.set(e,n),n}}getTreeRepository(e){if(this.connection.driver.treeSupport===!1)throw new B2(this.connection.driver);const t=this.treeRepositories.find(i=>i.target===e);if(t)return t;const n=new T3(e,this,this.queryRunner);return this.treeRepositories.push(n),n}getMongoRepository(e){return this.connection.getMongoRepository(e)}withRepository(e){const t=e.constructor,o=e,{target:n,manager:i,queryRunner:s}=o,a=Gl(o,["target","manager","queryRunner"]);return Object.assign(new t(e.target,this),Xe({},a))}getCustomRepository(e){const t=xr().entityRepositories.find(s=>s.target===(typeof e=="function"?e:e.constructor));if(!t)throw new AT(e);const n=t.entity?this.connection.getMetadata(t.entity):void 0,i=new t.target(this,n);if(i instanceof A3)i.manager||(i.manager=this);else{if(!n)throw new j2(e);i.manager=this,i.metadata=n}return i}release(){return v(this,null,function*(){if(!this.queryRunner)throw new tq;return this.queryRunner.release()})}}class L3 extends o_{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SqljsEntityManager"),this.driver=e.driver}loadDatabase(e){return v(this,null,function*(){yield this.driver.load(e)})}saveDatabase(e){return v(this,null,function*(){yield this.driver.save(e)})}exportDatabase(){return this.driver.export()}}class q3{create(e,t){return e.driver.options.type==="mongodb"?new c3(e):e.driver.options.type==="sqljs"?new L3(e,t):new o_(e,t)}}class $i{constructor(e){this["@instanceof"]=Symbol.for("View"),this.indices=[],e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}clone(){return new $i({database:this.database,schema:this.schema,name:this.name,expression:this.expression,materialized:this.materialized})}addIndex(e){this.indices.push(e)}removeIndex(e){const t=this.indices.find(n=>n.name===e.name);t&&this.indices.splice(this.indices.indexOf(t),1)}static create(e,t){const n={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,e.schema,e.database),expression:e.expression,materialized:e.tableMetadataArgs.materialized};return new $i(n)}}class Vb{static viewMetadataCmp(e,t){return!e||!t?0:e.dependsOn&&(e.dependsOn.has(t.target)||e.dependsOn.has(t.name))?1:t.dependsOn&&(t.dependsOn.has(e.target)||t.dependsOn.has(e.name))?-1:0}}class uh{constructor(e){this.connection=e,this["@instanceof"]=Symbol.for("RdbmsSchemaBuilder")}build(){return v(this,null,function*(){this.queryRunner=this.connection.createQueryRunner(),this.currentDatabase=this.connection.driver.database,this.currentSchema=this.connection.driver.schema;const e=this.connection.driver.options.type!=="cockroachdb"&&this.connection.driver.options.type!=="spanner"&&this.connection.options.migrationsTransactionMode!=="none";yield this.queryRunner.beforeMigration(),e&&(yield this.queryRunner.startTransaction());try{yield this.createMetadataTableIfNecessary(this.queryRunner);const t=this.entityToSyncMetadatas.map(i=>this.getTablePath(i)),n=this.viewEntityToSyncMetadatas.map(i=>this.getTablePath(i));yield this.queryRunner.getTables(t),yield this.queryRunner.getViews(n),yield this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&(yield this.connection.queryResultCache.synchronize(this.queryRunner)),e&&(yield this.queryRunner.commitTransaction())}catch(t){try{e&&(yield this.queryRunner.rollbackTransaction())}catch(n){}throw t}finally{yield this.queryRunner.afterMigration(),yield this.queryRunner.release()}})}createMetadataTableIfNecessary(e){return v(this,null,function*(){(this.viewEntityToSyncMetadatas.length>0||this.hasGeneratedColumns())&&(yield this.createTypeormMetadataTable(e))})}log(){return v(this,null,function*(){this.queryRunner=this.connection.createQueryRunner();try{const e=this.entityToSyncMetadatas.map(n=>this.getTablePath(n)),t=this.viewEntityToSyncMetadatas.map(n=>this.getTablePath(n));return yield this.queryRunner.getTables(e),yield this.queryRunner.getViews(t),this.queryRunner.enableSqlMemory(),yield this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&(yield this.connection.queryResultCache.synchronize(this.queryRunner)),this.queryRunner.getMemorySql()}finally{this.queryRunner.disableSqlMemory(),yield this.queryRunner.release()}})}get entityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.synchronize&&e.tableType!=="entity-child"&&e.tableType!=="view")}get viewEntityToSyncMetadatas(){return this.connection.entityMetadatas.filter(e=>e.tableType==="view"&&e.synchronize).sort(Vb.viewMetadataCmp)}hasGeneratedColumns(){return this.connection.entityMetadatas.some(e=>e.columns.some(t=>t.generatedType))}executeSchemaSyncOperationsInProperOrder(){return v(this,null,function*(){yield this.dropOldViews(),yield this.dropOldForeignKeys(),yield this.dropOldIndices(),yield this.dropOldChecks(),yield this.dropOldExclusions(),yield this.dropCompositeUniqueConstraints(),yield this.renameColumns(),yield this.changeTableComment(),yield this.createNewTables(),yield this.dropRemovedColumns(),yield this.addNewColumns(),yield this.updatePrimaryKeys(),yield this.updateExistColumns(),yield this.createNewIndices(),yield this.createNewChecks(),yield this.createNewExclusions(),yield this.createCompositeUniqueConstraints(),yield this.createForeignKeys(),yield this.createViews(),yield this.createNewViewIndices()})}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema||this.currentSchema,t.database||this.currentDatabase)}dropOldForeignKeys(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.foreignKeys.filter(i=>{const s=e.foreignKeys.find(a=>i.name===a.name&&this.getTablePath(i)===this.getTablePath(a.referencedEntityMetadata));return!s||s.onDelete&&s.onDelete!==i.onDelete||s.onUpdate&&s.onUpdate!==i.onUpdate});n.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old foreign keys of ${t.name}: ${n.map(i=>i.name).join(", ")}`),yield this.queryRunner.dropForeignKeys(t,n))}})}renameTables(){return v(this,null,function*(){})}renameColumns(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t||e.columns.length!==t.columns.length)continue;const n=e.columns.filter(a=>!a.isVirtualProperty).filter(a=>!t.columns.find(o=>o.name===a.databaseName&&o.type===this.connection.driver.normalizeType(a)&&o.isNullable===a.isNullable&&o.isUnique===this.connection.driver.normalizeIsUnique(a)));if(n.length===0||n.length>1)continue;const i=t.columns.filter(a=>!e.columns.find(o=>!o.isVirtualProperty&&o.databaseName===a.name&&this.connection.driver.normalizeType(o)===a.type&&o.isNullable===a.isNullable&&this.connection.driver.normalizeIsUnique(o)===a.isUnique));if(i.length===0||i.length>1)continue;const s=i[0].clone();s.name=n[0].databaseName,this.connection.logger.logSchemaBuild(`renaming column "${i[0].name}" in "${t.name}" to "${s.name}"`),yield this.queryRunner.renameColumn(t,i[0],s)}})}dropOldIndices(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.indices.filter(i=>{const s=e.indices.find(a=>a.name===i.name);return s?s.synchronize===!1?!1:s.isUnique!==i.isUnique||s.isSpatial!==i.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&s.isFulltext!==i.isFulltext||s.columns.length!==i.columnNames.length?!0:!s.columns.every(a=>i.columnNames.indexOf(a.databaseName)!==-1):!0}).map(i=>v(this,null,function*(){this.connection.logger.logSchemaBuild(`dropping an index: "${i.name}" from table ${t.name}`),yield this.queryRunner.dropIndex(t,i)}));yield Promise.all(n)}if(this.connection.options.type==="postgres"){const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const n=this.queryRunner.loadedViews.find(s=>this.getTablePath(s)===this.getTablePath(t));if(!n)continue;const i=n.indices.filter(s=>{const a=t.indices.find(o=>o.name===s.name);return a?a.synchronize===!1?!1:a.isUnique!==s.isUnique||a.isSpatial!==s.isSpatial||this.connection.driver.isFullTextColumnTypeSupported()&&a.isFulltext!==s.isFulltext||a.columns.length!==s.columnNames.length?!0:!a.columns.every(o=>s.columnNames.indexOf(o.databaseName)!==-1):!0}).map(s=>v(this,null,function*(){this.connection.logger.logSchemaBuild(`dropping an index: "${s.name}" from view ${n.name}`),yield e.dropViewIndex(n,s)}));yield Promise.all(i)}}})}dropOldChecks(){return v(this,null,function*(){if(!(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.checks.filter(i=>!e.checks.find(s=>s.name===i.name));n.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old check constraint: ${n.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),yield this.queryRunner.dropCheckConstraints(t,n))}})}dropCompositeUniqueConstraints(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.uniques.filter(i=>i.columnNames.length>1&&!e.uniques.find(s=>s.name===i.name));n.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old unique constraint: ${n.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),yield this.queryRunner.dropUniqueConstraints(t,n))}})}dropOldExclusions(){return v(this,null,function*(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.exclusions.filter(i=>!e.exclusions.find(s=>s.name===i.name));n.length!==0&&(this.connection.logger.logSchemaBuild(`dropping old exclusion constraint: ${n.map(i=>`"${i.name}"`).join(", ")} from table "${t.name}"`),yield this.queryRunner.dropExclusionConstraints(t,n))}})}changeTableComment(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(n=>this.getTablePath(n)===this.getTablePath(e));if(t&&(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="postgres")){const n=e.comment;yield this.queryRunner.changeTableComment(t,n)}}})}createNewTables(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){if(this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e)))continue;this.connection.logger.logSchemaBuild(`creating a new table: ${this.getTablePath(e)}`);const n=hn.create(e,this.connection.driver);yield this.queryRunner.createTable(n,!1,!1),this.queryRunner.loadedTables.push(n)}})}createViews(){return v(this,null,function*(){for(const e of this.viewEntityToSyncMetadatas){if(this.queryRunner.loadedViews.find(i=>{const s=typeof i.expression=="string"?i.expression.trim():i.expression(this.connection).getQuery(),a=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.getTablePath(i)===this.getTablePath(e)&&s===a}))continue;this.connection.logger.logSchemaBuild(`creating a new view: ${this.getTablePath(e)}`);const n=$i.create(e,this.connection.driver);yield this.queryRunner.createView(n,!0),this.queryRunner.loadedViews.push(n)}})}dropOldViews(){return v(this,null,function*(){const e=[],t=this.viewEntityToSyncMetadatas,n=new Map;for(const a of this.queryRunner.loadedViews){const o=t.find(l=>this.getTablePath(a)===this.getTablePath(l));o&&n.set(a,o)}for(const a of this.queryRunner.loadedViews){const o=n.get(a);if(!o)continue;const l=typeof a.expression=="string"?a.expression.trim():a.expression(this.connection).getQuery(),c=typeof o.expression=="string"?o.expression.trim():o.expression(this.connection).getQuery();l!==c&&(this.connection.logger.logSchemaBuild(`dropping an old view: ${a.name}`),e.push(a))}const i=a=>{const o=n.get(a);let l=[a];if(!o)return l;for(const[c,u]of n.entries())c!==a&&u.dependsOn&&(u.dependsOn.has(o.target)||u.dependsOn.has(o.name))&&(l=l.concat(i(c)));return l},s=new Set(e.map(a=>i(a)).reduce((a,o)=>a.concat(o),[]).sort((a,o)=>Vb.viewMetadataCmp(n.get(a),n.get(o))).reverse());for(const a of s)yield this.queryRunner.dropView(a);this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter(a=>!s.has(a))})}dropRemovedColumns(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=t.columns.filter(i=>!e.columns.find(s=>s.isVirtualProperty||s.databaseName===i.name));n.length!==0&&(this.connection.logger.logSchemaBuild(`columns dropped in ${t.name}: `+n.map(i=>i.name).join(", ")),yield this.queryRunner.dropColumns(t,n))}})}addNewColumns(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===this.getTablePath(e));if(!t)continue;const n=e.columns.filter(a=>!a.isVirtualProperty&&!t.columns.find(o=>o.name===a.databaseName));if(n.length===0)continue;const s=this.metadataColumnsToTableColumnOptions(n).map(a=>new ar(a));s.length!==0&&(this.connection.logger.logSchemaBuild("new columns added: "+n.map(a=>a.databaseName).join(", ")),yield this.queryRunner.addColumns(t,s))}})}updatePrimaryKeys(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t)continue;const n=e.columns.filter(s=>s.isPrimary);if(t.columns.filter(s=>s.isPrimary).length!==n.length&&n.length>1){const s=n.map(a=>new ar(Oc.createTableColumnOptions(a,this.connection.driver)));yield this.queryRunner.updatePrimaryKeys(t,s)}}})}updateExistColumns(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t)continue;const n=this.connection.driver.findChangedColumns(t.columns,e.columns);if(n.length===0)continue;for(const s of n)yield this.dropColumnReferencedForeignKeys(this.getTablePath(e),s.databaseName);for(const s of n)yield this.dropColumnCompositeIndices(this.getTablePath(e),s.databaseName);if(!(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="spanner"))for(const s of n)yield this.dropColumnCompositeUniques(this.getTablePath(e),s.databaseName);const i=n.map(s=>{const a=t.columns.find(c=>c.name===s.databaseName),o=Oc.createTableColumnOptions(s,this.connection.driver),l=new ar(o);return{oldColumn:a,newColumn:l}});i.length!==0&&(this.connection.logger.logSchemaBuild(`columns changed in "${t.name}". updating: `+n.map(s=>s.databaseName).join(", ")),yield this.queryRunner.changeColumns(t,i))}})}createNewIndices(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=e.indices.filter(i=>!t.indices.find(s=>s.name===i.name)&&i.synchronize===!0).map(i=>mn.create(i));n.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${n.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),yield this.queryRunner.createIndices(t,n))}})}createNewViewIndices(){return v(this,null,function*(){if(this.connection.options.type!=="postgres"||!Be.isPostgresFamily(this.connection.driver))return;const e=this.queryRunner;for(const t of this.viewEntityToSyncMetadatas){const n=this.queryRunner.loadedViews.find(s=>{const a=typeof s.expression=="string"?s.expression.trim():s.expression(this.connection).getQuery(),o=typeof t.expression=="string"?t.expression.trim():t.expression(this.connection).getQuery();return this.getTablePath(s)===this.getTablePath(t)&&a===o});if(!n||!n.materialized)continue;const i=t.indices.filter(s=>!n.indices.find(a=>a.name===s.name)&&s.synchronize===!0).map(s=>mn.create(s));i.length!==0&&(this.connection.logger.logSchemaBuild(`adding new indices ${i.map(s=>`"${s.name}"`).join(", ")} in view "${n.name}"`),yield e.createViewIndices(n,i))}})}createNewChecks(){return v(this,null,function*(){if(!(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"))for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=e.checks.filter(i=>!t.checks.find(s=>s.name===i.name)).map(i=>Gr.create(i));n.length!==0&&(this.connection.logger.logSchemaBuild(`adding new check constraints: ${n.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),yield this.queryRunner.createCheckConstraints(t,n))}})}createCompositeUniqueConstraints(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=e.uniques.filter(i=>i.columns.length>1&&!t.uniques.find(s=>s.name===i.name)).map(i=>Qn.create(i));n.length!==0&&(this.connection.logger.logSchemaBuild(`adding new unique constraints: ${n.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),yield this.queryRunner.createUniqueConstraints(t,n))}})}createNewExclusions(){return v(this,null,function*(){if(this.connection.driver.options.type==="postgres")for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(i=>this.getTablePath(i)===this.getTablePath(e));if(!t)continue;const n=e.exclusions.filter(i=>!t.exclusions.find(s=>s.name===i.name)).map(i=>js.create(i));n.length!==0&&(this.connection.logger.logSchemaBuild(`adding new exclusion constraints: ${n.map(i=>`"${i.name}"`).join(", ")} in table "${t.name}"`),yield this.queryRunner.createExclusionConstraints(t,n))}})}createForeignKeys(){return v(this,null,function*(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===this.getTablePath(e));if(!t)continue;const n=e.foreignKeys.filter(s=>!t.foreignKeys.find(a=>a.name===s.name&&this.getTablePath(a)===this.getTablePath(s.referencedEntityMetadata)));if(n.length===0)continue;const i=n.map(s=>Mr.create(s,this.connection.driver));this.connection.logger.logSchemaBuild(`creating a foreign keys: ${n.map(s=>s.name).join(", ")} on table "${t.name}"`),yield this.queryRunner.createForeignKeys(t,i)}})}dropColumnReferencedForeignKeys(e,t){return v(this,null,function*(){const n=this.queryRunner.loadedTables.find(a=>this.getTablePath(a)===e);if(!n)return;const i=[],s=n.foreignKeys.find(a=>a.columnNames.indexOf(t)!==-1);if(s){const a=n.clone();a.foreignKeys=[s],i.push(a),n.removeForeignKey(s)}for(const a of this.queryRunner.loadedTables){const o=a.foreignKeys.filter(l=>this.getTablePath(l)===e&&l.referencedColumnNames.indexOf(t)!==-1);if(o.length>0){const l=a.clone();l.foreignKeys=o,i.push(l),o.forEach(c=>a.removeForeignKey(c))}}if(i.length>0)for(const a of i)this.connection.logger.logSchemaBuild(`dropping related foreign keys of ${a.name}: ${a.foreignKeys.map(o=>o.name).join(", ")}`),yield this.queryRunner.dropForeignKeys(a,a.foreignKeys)})}dropColumnCompositeIndices(e,t){return v(this,null,function*(){const n=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===e);if(!n)return;const i=n.indices.filter(s=>s.columnNames.length>1&&s.columnNames.indexOf(t)!==-1);i.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related indices of "${e}"."${t}": ${i.map(s=>s.name).join(", ")}`),yield this.queryRunner.dropIndices(n,i))})}dropColumnCompositeUniques(e,t){return v(this,null,function*(){const n=this.queryRunner.loadedTables.find(s=>this.getTablePath(s)===e);if(!n)return;const i=n.uniques.filter(s=>s.columnNames.length>1&&s.columnNames.indexOf(t)!==-1);i.length!==0&&(this.connection.logger.logSchemaBuild(`dropping related unique constraints of "${e}"."${t}": ${i.map(s=>s.name).join(", ")}`),yield this.queryRunner.dropUniqueConstraints(n,i))})}metadataColumnsToTableColumnOptions(e){return e.map(t=>Oc.createTableColumnOptions(t,this.connection.driver))}createTypeormMetadataTable(e){return v(this,null,function*(){const t=this.currentSchema,n=this.currentDatabase,i=this.connection.driver.buildTableName(this.connection.metadataTableName,t,n),s=this.connection.driver.options.type==="spanner";yield e.createTable(new hn({database:n,schema:t,name:i,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1,isPrimary:s},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0,isPrimary:s},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0,isPrimary:s},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0,isPrimary:s},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0,isPrimary:s},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0,isPrimary:s}]}),!0)})}}class oo{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime","json"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=Be.buildDriverOptions(this.options).database}connect(){return v(this,null,function*(){this.databaseConnection=yield this.createDatabaseConnection()})}afterConnect(){return Promise.resolve()}disconnect(){return v(this,null,function*(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(n=>n?t(n):e())})})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,n;return(n=(t=this.attachedDatabases)==null?void 0:t[e])==null?void 0:n.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:n})=>e===n))==null?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new uh(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=An.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?dt.mixedDateToDateString(e):t.type==="time"?dt.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?dt.mixedDateToUtcDatetimeString(e):t.type==="json"||t.type==="simple-json"?dt.simpleJsonToString(e):t.type==="simple-array"?dt.simpleArrayToString(e):t.type==="simple-enum"?dt.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?An.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=dt.normalizeHydratedDate(e)):t.type==="date"?e=dt.mixedDateToDateString(e):t.type==="time"?e=dt.mixedTimeToString(e):t.type==="json"||t.type==="simple-json"?e=dt.stringToSimpleJson(e):t.type==="simple-array"?e=dt.stringToSimpleArray(e):t.type==="simple-enum"?e=dt.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=An.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,n){const i=Object.keys(n).map(s=>typeof n[s]=="boolean"?n[s]===!0?1:0:n[s]instanceof Date?dt.mixedDateToUtcDatetimeString(n[s]):n[s]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(s,a,o)=>{if(!t.hasOwnProperty(o))return s;const l=t[o];return a?l.map(c=>(i.push(c),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(i.push(+l),this.createParameter(o,i.length-1)):l instanceof Date?(i.push(dt.mixedDateToUtcDatetimeString(l)),this.createParameter(o,i.length-1)):(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return'"'+e+'"'}buildTableName(e,t,n){return e}parseTableName(e){var s;const t=this.database,n=void 0;if(de.isTable(e)||de.isView(e)){const a=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||a.database||t,schema:e.schema||a.schema||n,tableName:a.tableName}}if(de.isTableForeignKey(e)){const a=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||a.database||t,schema:e.referencedSchema||a.schema||n,tableName:a.tableName}}if(de.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const i=e.split(".");return i.length===3?{database:i[0]||t,schema:i[1]||n,tableName:i[2]}:i.length===2?{database:(s=this.getAttachedDatabasePathRelativeByHandle(i[0]))!=null?s:t,schema:i[0],tableName:i[1]}:{database:t,schema:n,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,n,i){const s=e.generatedColumns.reduce((a,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-i+n+1),l?ke.mergeDeep(a,o.createValueMap(l)):a},{});return Object.keys(s).length>0?s:void 0}findChangedColumns(e,t){return t.filter(n=>{const i=e.find(a=>a.name===n.databaseName);return i?i.name!==n.databaseName||i.type!==this.normalizeType(n)||i.length!==n.length||i.precision!==n.precision||i.scale!==n.scale||this.normalizeDefault(n)!==i.default||i.isPrimary!==n.isPrimary||i.isNullable!==n.isNullable||i.generatedType!==n.generatedType||i.asExpression!==n.asExpression||i.isUnique!==this.normalizeIsUnique(n)||i.enum&&n.enum&&!ke.isArraysEqual(i.enum,n.enum.map(a=>a+""))||n.generationStrategy!=="uuid"&&i.isGenerated!==n.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){return v(this,null,function*(){throw new Z("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")})}loadDependencies(){}}class Zr{constructor(){this.records=[]}}class gi{constructor(e){this.queryRunner=e}broadcast(e,...t){return v(this,null,function*(){const n=new Or,i=this[`broadcast${e}Event`];typeof i=="function"&&i.call(this,n,...t),yield n.wait()})}broadcastBeforeInsertEvent(e,t,n){n&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach(i=>{if(i.isAllowed(n)){const s=i.execute(n);s instanceof Promise&&e.promises.push(s),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(i=>{if(this.isAllowedSubscriber(i,t.target)&&i.beforeInsert){const s=i.beforeInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t});s instanceof Promise&&e.promises.push(s),e.count++}})}broadcastBeforeUpdateEvent(e,t,n,i,s,a){n&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach(o=>{if(o.isAllowed(n)){const l=o.execute(n);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.beforeUpdate){const l=o.beforeUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,updatedColumns:s||[],updatedRelations:a||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastBeforeRemoveEvent(e,t,n,i,s){n&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.beforeRemove){const o=a.beforeRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeSoftRemoveEvent(e,t,n,i,s){n&&t.beforeSoftRemoveListeners.length&&t.beforeSoftRemoveListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.beforeSoftRemove){const o=a.beforeSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastBeforeRecoverEvent(e,t,n,i,s){n&&t.beforeRecoverListeners.length&&t.beforeRecoverListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.beforeRecover){const o=a.beforeRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterInsertEvent(e,t,n,i){n&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach(s=>{if(s.isAllowed(n)){const a=s.execute(n);a instanceof Promise&&e.promises.push(a),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterInsert){const a=s.afterInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,entityId:t.getEntityIdMixedMap(i)});a instanceof Promise&&e.promises.push(a),e.count++}})}broadcastBeforeQueryEvent(e,t,n){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(i=>{if(i.beforeQuery){const s=i.beforeQuery({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,query:t,parameters:n});s instanceof Promise&&e.promises.push(s),e.count++}})}broadcastAfterQueryEvent(e,t,n,i,s,a,o){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(l=>{if(l.afterQuery){const c=l.afterQuery({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,query:t,parameters:n,success:i,executionTime:s,rawResults:a,error:o});c instanceof Promise&&e.promises.push(c),e.count++}})}broadcastBeforeTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionStart){const n=t.beforeTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastAfterTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionStart){const n=t.afterTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastBeforeTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionCommit){const n=t.beforeTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastAfterTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionCommit){const n=t.afterTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastBeforeTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.beforeTransactionRollback){const n=t.beforeTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastAfterTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(t=>{if(t.afterTransactionRollback){const n=t.afterTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}})}broadcastAfterUpdateEvent(e,t,n,i,s,a){n&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach(o=>{if(o.isAllowed(n)){const l=o.execute(n);l instanceof Promise&&e.promises.push(l),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(o=>{if(this.isAllowedSubscriber(o,t.target)&&o.afterUpdate){const l=o.afterUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,updatedColumns:s||[],updatedRelations:a||[]});l instanceof Promise&&e.promises.push(l),e.count++}})}broadcastAfterRemoveEvent(e,t,n,i,s){n&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.afterRemove){const o=a.afterRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterSoftRemoveEvent(e,t,n,i,s){n&&t.afterSoftRemoveListeners.length&&t.afterSoftRemoveListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.afterSoftRemove){const o=a.afterSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastAfterRecoverEvent(e,t,n,i,s){n&&t.afterRecoverListeners.length&&t.afterRecoverListeners.forEach(a=>{if(a.isAllowed(n)){const o=a.execute(n);o instanceof Promise&&e.promises.push(o),e.count++}}),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach(a=>{if(this.isAllowedSubscriber(a,t.target)&&a.afterRecover){const o=a.afterRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:i,entityId:t.getEntityIdMixedMap(i!=null?i:s)});o instanceof Promise&&e.promises.push(o),e.count++}})}broadcastLoadEventsForAll(e,t,n){return this.broadcastLoadEvent(e,t,n)}broadcastLoadEvent(e,t,n){const i=this.queryRunner.connection.subscribers.filter(s=>this.isAllowedSubscriber(s,t.target)&&s.afterLoad);if(t.relations.length||t.afterLoadListeners.length||i.length){const s=n.filter(a=>!(a instanceof Promise));t.relations.length&&t.relations.forEach(a=>{s.forEach(o=>{if(a.isLazy&&!o.hasOwnProperty(a.propertyName))return;const l=a.getEntityValue(o);_t.isObject(l)&&this.broadcastLoadEvent(e,a.inverseEntityMetadata,Array.isArray(l)?l:[l])})}),t.afterLoadListeners.length&&t.afterLoadListeners.forEach(a=>{s.forEach(o=>{if(a.isAllowed(o)){const l=a.execute(o);l instanceof Promise&&e.promises.push(l),e.count++}})}),i.forEach(a=>{s.forEach(o=>{const l=a.afterLoad(o,{entity:o,metadata:t,connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});l instanceof Promise&&e.promises.push(l),e.count++})})}}isAllowedSubscriber(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)}}class Y{constructor(e,t){this.query=e,this.parameters=t,this["@instanceof"]=Symbol.for("Query")}}class pc{constructor(){this.upQueries=[],this.downQueries=[]}}class hh{constructor(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new pc,this.transactionDepth=0,this.cachedTablePaths={}}sql(e,...t){return v(this,null,function*(){const{query:n,parameters:i}=ch({driver:this.connection.driver,strings:e,expressions:t});return yield this.query(n,i)})}beforeMigration(){return v(this,null,function*(){})}afterMigration(){return v(this,null,function*(){})}getTable(e){return v(this,null,function*(){return this.loadedTables=yield this.loadTables([e]),this.loadedTables.length>0?this.loadedTables[0]:void 0})}getTables(e){return v(this,null,function*(){return e?(this.loadedTables=yield this.loadTables(e),this.loadedTables):yield this.loadTables(e)})}getView(e){return v(this,null,function*(){return this.loadedViews=yield this.loadViews([e]),this.loadedViews.length>0?this.loadedViews[0]:void 0})}getViews(e){return v(this,null,function*(){return this.loadedViews=yield this.loadViews(e),this.loadedViews})}enableSqlMemory(){this.sqlInMemory=new pc,this.sqlMemoryMode=!0}disableSqlMemory(){this.sqlInMemory=new pc,this.sqlMemoryMode=!1}clearSqlMemory(){this.sqlInMemory=new pc}getMemorySql(){return this.sqlInMemory}executeMemoryUpSql(){return v(this,null,function*(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)yield this.query(e,t)})}executeMemoryDownSql(){return v(this,null,function*(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())yield this.query(e,t)})}getReplicationMode(){return this.mode}getCachedView(e){return v(this,null,function*(){const t=this.loadedViews.find(i=>i.name===e);if(t)return t;const n=yield this.loadViews([e]);if(n.length>0)return this.loadedViews.push(n[0]),n[0];throw new Z(`View "${e}" does not exist.`)})}getCachedTable(e){return v(this,null,function*(){if(e in this.cachedTablePaths){const n=this.cachedTablePaths[e],i=this.loadedTables.find(s=>this.getTablePath(s)===n);if(i)return i}const t=yield this.loadTables([e]);if(t.length>0){const n=this.getTablePath(t[0]),i=this.loadedTables.find(s=>this.getTablePath(s)===n);return i||(this.cachedTablePaths[e]=this.getTablePath(t[0]),this.loadedTables.push(t[0]),t[0])}else throw new Z(`Table "${e}" does not exist.`)})}replaceCachedTable(e,t){const n=this.getTablePath(e),i=this.loadedTables.find(s=>this.getTablePath(s)===n);for(const[s,a]of Object.entries(this.cachedTablePaths))a===n&&(this.cachedTablePaths[s]=this.getTablePath(t));i&&(i.database=t.database,i.schema=t.schema,i.name=t.name,i.columns=t.columns,i.indices=t.indices,i.foreignKeys=t.foreignKeys,i.uniques=t.uniques,i.checks=t.checks,i.justCreated=t.justCreated,i.engine=t.engine,i.comment=t.comment)}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema,t.database)}getTypeormMetadataTableName(){const e=this.connection.driver.options;return this.connection.driver.buildTableName(this.connection.metadataTableName,e.schema,e.database)}selectTypeormMetadataSql({database:e,schema:t,table:n,type:i,name:s}){const a=this.connection.createQueryBuilder(),o=a.select().from(this.getTypeormMetadataTableName(),"t").where(`${a.escape("type")} = :type`,{type:i}).andWhere(`${a.escape("name")} = :name`,{name:s});e&&o.andWhere(`${a.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${a.escape("schema")} = :schema`,{schema:t}),n&&o.andWhere(`${a.escape("table")} = :table`,{table:n});const[l,c]=o.getQueryAndParameters();return new Y(l,c)}insertTypeormMetadataSql({database:e,schema:t,table:n,type:i,name:s,value:a}){const[o,l]=this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({database:e,schema:t,table:n,type:i,name:s,value:a}).getQueryAndParameters();return new Y(o,l)}deleteTypeormMetadataSql({database:e,schema:t,table:n,type:i,name:s}){const a=this.connection.createQueryBuilder(),o=a.delete().from(this.getTypeormMetadataTableName()).where(`${a.escape("type")} = :type`,{type:i}).andWhere(`${a.escape("name")} = :name`,{name:s});e&&o.andWhere(`${a.escape("database")} = :database`,{database:e}),t&&o.andWhere(`${a.escape("schema")} = :schema`,{schema:t}),n&&o.andWhere(`${a.escape("table")} = :table`,{table:n});const[l,c]=o.getQueryAndParameters();return new Y(l,c)}isColumnChanged(e,t,n,i,s=!0){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||n&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||i&&e.comment!==t.comment||s&&this.isEnumChanged(e,t)}isEnumChanged(e,t){return!ke.isArraysEqual(e.enum||[],t.enum||[])}isDefaultColumnLength(e,t,n){if(this.connection.hasMetadata(e.name)){const s=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(s&&this.connection.driver.getColumnLength(s))return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length?this.connection.driver.dataTypeDefaults[t.type].length.toString()===n.toString():!1}isDefaultColumnPrecision(e,t,n){if(this.connection.hasMetadata(e.name)){const s=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(s&&s.precision!==null&&s.precision!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].precision!==null&&this.connection.driver.dataTypeDefaults[t.type].precision!==void 0?this.connection.driver.dataTypeDefaults[t.type].precision===n:!1}isDefaultColumnScale(e,t,n){if(this.connection.hasMetadata(e.name)){const s=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(s&&s.scale!==null&&s.scale!==void 0)return!1}return this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].scale!==null&&this.connection.driver.dataTypeDefaults[t.type].scale!==void 0?this.connection.driver.dataTypeDefaults[t.type].scale===n:!1}executeQueries(e,t){return v(this,null,function*(){if(de.isQuery(e)&&(e=[e]),de.isQuery(t)&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:n,parameters:i}of e)yield this.query(n,i)})}generateIndexName(e,t){return this.connection.namingStrategy.indexName(e,t.columnNames,t.where)}}var wt;(function(r){r.VIEW="VIEW",r.MATERIALIZED_VIEW="MATERIALIZED_VIEW",r.GENERATED_COLUMN="GENERATED_COLUMN"})(wt||(wt={}));class Js extends hh{constructor(){super(),this.transactionPromise=null}connect(){return Promise.resolve(this.driver.databaseConnection)}release(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()}startTransaction(e){return v(this,null,function*(){if(this.driver.transactionSupport==="none")throw new Z(`Transactions aren't supported by ${this.connection.driver.options.type}.`);if(this.isTransactionActive&&this.driver.transactionSupport==="simple")throw new F2;if(e&&e!=="READ UNCOMMITTED"&&e!=="SERIALIZABLE")throw new Z("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(e&&(e==="READ UNCOMMITTED"?yield this.query("PRAGMA read_uncommitted = true"):yield this.query("PRAGMA read_uncommitted = false")),yield this.query("BEGIN TRANSACTION")):yield this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?yield this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?yield this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}stream(e,t,n,i){throw new Z("Stream is not supported by sqlite driver.")}getDatabases(){return v(this,null,function*(){return Promise.resolve([])})}getSchemas(e){return v(this,null,function*(){return Promise.resolve([])})}hasDatabase(e){return v(this,null,function*(){return Promise.resolve(!1)})}getCurrentDatabase(){return v(this,null,function*(){return Promise.resolve(void 0)})}hasSchema(e){return v(this,null,function*(){throw new Z("This driver does not support table schemas")})}getCurrentSchema(){return v(this,null,function*(){return Promise.resolve(void 0)})}hasTable(e){return v(this,null,function*(){const n=`SELECT * FROM "sqlite_master" WHERE "type" = 'table' AND "name" = '${de.isTable(e)?e.name:e}'`;return!!(yield this.query(n)).length})}hasColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e.name:e,i=`PRAGMA table_xinfo(${this.escapePath(n)})`;return!!(yield this.query(i)).find(a=>a.name===t)})}createDatabase(e,t){return v(this,null,function*(){return Promise.resolve()})}dropDatabase(e,t){return v(this,null,function*(){return Promise.resolve()})}createSchema(e,t){return v(this,null,function*(){return Promise.resolve()})}dropSchema(e,t){return v(this,null,function*(){return Promise.resolve()})}createTable(e,t=!1,n=!0,i=!0){return v(this,null,function*(){const s=[],a=[];if(t&&(yield this.hasTable(e)))return Promise.resolve();s.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),i&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),s.push(this.createIndexSql(e,l)),a.push(this.dropIndexSql(l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const c=this.insertTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:l.name,value:l.asExpression}),u=this.deleteTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:l.name});s.push(c),a.push(u)}yield this.executeQueries(s,a)})}dropTable(e,t,n=!0,i=!0){return v(this,null,function*(){if(t&&!(yield this.hasTable(e)))return Promise.resolve();const s=n,a=de.isTable(e)?e:yield this.getCachedTable(e),o=[],l=[];i&&a.indices.forEach(u=>{o.push(this.dropIndexSql(u)),l.push(this.createIndexSql(a,u))}),o.push(this.dropTableSql(a,t)),l.push(this.createTableSql(a,s));const c=a.columns.filter(u=>u.generatedType&&u.asExpression);for(const u of c){const h=this.deleteTypeormMetadataSql({table:a.name,type:wt.GENERATED_COLUMN,name:u.name}),f=this.insertTypeormMetadataSql({table:a.name,type:wt.GENERATED_COLUMN,name:u.name,value:u.asExpression});o.push(h),l.push(f)}yield this.executeQueries(o,l)})}createView(e,t=!1){return v(this,null,function*(){const n=[],i=[];n.push(this.createViewSql(e)),t&&n.push(this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(this.deleteViewDefinitionSql(e)),yield this.executeQueries(n,i)})}dropView(e){return v(this,null,function*(){const t=de.isView(e)?e.name:e,n=yield this.getCachedView(t),i=[],s=[];i.push(this.deleteViewDefinitionSql(n)),i.push(this.dropViewSql(n)),s.push(this.insertViewDefinitionSql(n)),s.push(this.createViewSql(n)),yield this.executeQueries(i,s)})}renameTable(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();i.name=t;const s=new Y(`ALTER TABLE ${this.escapePath(n.name)} RENAME TO ${this.escapePath(t)}`),a=new Y(`ALTER TABLE ${this.escapePath(t)} RENAME TO ${this.escapePath(n.name)}`);yield this.executeQueries(s,a),i.uniques.forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(n,o.columnNames);o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(i,o.columnNames))}),i.foreignKeys.forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(n,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(i,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),i.indices.forEach(o=>{const l=this.connection.namingStrategy.indexName(n,o.columnNames,o.where);o.name===l&&(o.name=this.connection.namingStrategy.indexName(i,o.columnNames,o.where))}),n.name=i.name,yield this.recreateTable(i,n)})}addColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);return this.addColumns(n,[t])})}addColumns(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.addColumn(s)),yield this.recreateTable(i,n)})}renameColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e),s=de.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!s)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);let a;return de.isTableColumn(n)?a=n:(a=s.clone(),a.name=n),this.changeColumn(i,s,a)})}changeColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e),s=de.isTableColumn(t)?t:i.columns.find(a=>a.name===t);if(!s)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);yield this.changeColumns(i,[{oldColumn:s,newColumn:n}])})}changeColumns(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>{s.newColumn.name!==s.oldColumn.name&&(i.findColumnUniques(s.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.uniqueConstraintName(n,o.columnNames);o.columnNames.splice(o.columnNames.indexOf(s.oldColumn.name),1),o.columnNames.push(s.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.uniqueConstraintName(i,o.columnNames))}),i.findColumnForeignKeys(s.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.foreignKeyName(n,o.columnNames,this.getTablePath(o),o.referencedColumnNames);o.columnNames.splice(o.columnNames.indexOf(s.oldColumn.name),1),o.columnNames.push(s.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.foreignKeyName(i,o.columnNames,this.getTablePath(o),o.referencedColumnNames))}),i.findColumnIndices(s.oldColumn).forEach(o=>{const l=this.connection.namingStrategy.indexName(n,o.columnNames,o.where);o.columnNames.splice(o.columnNames.indexOf(s.oldColumn.name),1),o.columnNames.push(s.newColumn.name),o.name===l&&(o.name=this.connection.namingStrategy.indexName(i,o.columnNames,o.where))}));const a=i.columns.find(o=>o.name===s.oldColumn.name);a&&(i.columns[i.columns.indexOf(a)]=s.newColumn)}),yield this.recreateTable(i,n)})}dropColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableColumn(t)?t:n.findColumnByName(t);if(!i)throw new Z(`Column "${t}" was not found in table "${n.name}"`);yield this.dropColumns(n,[i])})}dropColumns(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>{const a=de.isTableColumn(s)?s:n.findColumnByName(s);if(!a)throw new Error(`Column "${s}" was not found in table "${n.name}"`);i.removeColumn(a),i.findColumnUniques(a).forEach(o=>i.removeUniqueConstraint(o)),i.findColumnIndices(a).forEach(o=>i.removeIndex(o)),i.findColumnForeignKeys(a).forEach(o=>i.removeForeignKey(o))}),yield this.recreateTable(i,n)})}createPrimaryKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();i.columns.forEach(s=>{t.find(a=>a===s.name)&&(s.isPrimary=!0)}),yield this.recreateTable(i,n),n.columns.forEach(s=>{t.find(a=>a===s.name)&&(s.isPrimary=!0)})})}updatePrimaryKeys(e,t){return v(this,null,function*(){yield Promise.resolve()})}dropPrimaryKey(e){return v(this,null,function*(){const t=de.isTable(e)?e:yield this.getCachedTable(e),n=t.clone();n.primaryColumns.forEach(i=>{i.isPrimary=!1}),yield this.recreateTable(n,t),t.primaryColumns.forEach(i=>{i.isPrimary=!1})})}createUniqueConstraint(e,t){return v(this,null,function*(){yield this.createUniqueConstraints(e,[t])})}createUniqueConstraints(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.addUniqueConstraint(s)),yield this.recreateTable(i,n)})}dropUniqueConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableUnique(t)?t:n.uniques.find(s=>s.name===t);if(!i)throw new Z(`Supplied unique constraint was not found in table ${n.name}`);yield this.dropUniqueConstraints(n,[i])})}dropUniqueConstraints(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.removeUniqueConstraint(s)),yield this.recreateTable(i,n)})}createCheckConstraint(e,t){return v(this,null,function*(){yield this.createCheckConstraints(e,[t])})}createCheckConstraints(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.addCheckConstraint(s)),yield this.recreateTable(i,n)})}dropCheckConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableCheck(t)?t:n.checks.find(s=>s.name===t);if(!i)throw new Z(`Supplied check constraint was not found in table ${n.name}`);yield this.dropCheckConstraints(n,[i])})}dropCheckConstraints(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.removeCheckConstraint(s)),yield this.recreateTable(i,n)})}createExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("Sqlite does not support exclusion constraints.")})}createExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("Sqlite does not support exclusion constraints.")})}dropExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("Sqlite does not support exclusion constraints.")})}dropExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("Sqlite does not support exclusion constraints.")})}createForeignKey(e,t){return v(this,null,function*(){yield this.createForeignKeys(e,[t])})}createForeignKeys(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.addForeignKey(s)),yield this.recreateTable(i,n)})}dropForeignKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableForeignKey(t)?t:n.foreignKeys.find(s=>s.name===t);if(!i)throw new Z(`Supplied foreign key was not found in table ${n.name}`);yield this.dropForeignKeys(e,[i])})}dropForeignKeys(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone();t.forEach(s=>i.removeForeignKey(s)),yield this.recreateTable(i,n)})}createIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const i=this.createIndexSql(n,t),s=this.dropIndexSql(t);yield this.executeQueries(i,s),n.addIndex(t)})}createIndices(e,t){return v(this,null,function*(){const n=t.map(i=>this.createIndex(e,i));yield Promise.all(n)})}dropIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableIndex(t)?t:n.indices.find(o=>o.name===t);if(!i)throw new Z(`Supplied index ${t} was not found in table ${n.name}`);i.name||(i.name=this.generateIndexName(n,i));const s=this.dropIndexSql(i),a=this.createIndexSql(n,i);yield this.executeQueries(s,a),n.removeIndex(i)})}dropIndices(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropIndex(e,i));yield Promise.all(n)})}clearTable(e){return v(this,null,function*(){yield this.query(`DELETE FROM ${this.escapePath(e)}`)})}clearDatabase(e){return v(this,null,function*(){let t;e&&this.driver.getAttachedDatabaseHandleByRelativePath(e)&&(t=this.driver.getAttachedDatabaseHandleByRelativePath(e)),yield this.query("PRAGMA foreign_keys = OFF");const n=this.isTransactionActive;n||(yield this.startTransaction());try{const i=t?`SELECT 'DROP VIEW "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'view'`:`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`,s=yield this.query(i);yield Promise.all(s.map(l=>this.query(l.query)));const a=t?`SELECT 'DROP TABLE "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`:`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`,o=yield this.query(a);yield Promise.all(o.map(l=>this.query(l.query))),n||(yield this.commitTransaction())}catch(i){try{n||(yield this.rollbackTransaction())}catch(s){}throw i}finally{yield this.query("PRAGMA foreign_keys = ON")}})}loadViews(e){return v(this,null,function*(){if(!(yield this.hasTable(this.getTypeormMetadataTableName())))return[];e||(e=[]);const n=e.map(a=>"'"+a+"'").join(", ");let i=`SELECT "t".* FROM "${this.getTypeormMetadataTableName()}" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = 'view' WHERE "t"."type" = '${wt.VIEW}'`;return n.length>0&&(i+=` AND "t"."name" IN (${n})`),(yield this.query(i)).map(a=>{const o=new $i;return o.name=a.name,o.expression=a.value,o})})}loadTableRecords(e,t){return v(this,null,function*(){let n;const[i,s]=this.splitTablePath(e);return i&&this.driver.getAttachedDatabasePathRelativeByHandle(i)&&(n=this.driver.getAttachedDatabasePathRelativeByHandle(i)),this.query(`SELECT ${n?`'${n}'`:null} as database, ${i?`'${i}'`:null} as schema, * FROM ${i?`"${i}".`:""}${this.escapePath("sqlite_master")} WHERE "type" = '${t}' AND "${t==="table"?"name":"tbl_name"}" IN ('${s}')`)})}loadPragmaRecords(e,t){return v(this,null,function*(){const[,n]=this.splitTablePath(e);return this.query(`PRAGMA ${t}("${n}")`)})}loadTables(e){return v(this,null,function*(){if(e&&e.length===0)return[];let t=[],n;if(e){const i=e.filter(o=>o.split(".").length===1).map(o=>`'${o}'`),s=e.filter(o=>o.split(".").length>1),a=o=>{const l=[...s.map(c=>this.loadTableRecords(c,o))];return i.length&&l.push(this.query(`SELECT * FROM "sqlite_master" WHERE "type" = '${o}' AND "${o==="table"?"name":"tbl_name"}" IN (${i})`)),l};t=(yield Promise.all(a("table"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean),n=(yield Promise.all(a("index"))).reduce((o,l)=>[...o,...l],[]).filter(Boolean)}else{t.push(...yield this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'table'`));const s=t.map(({name:a})=>`'${a}'`).join(", ");n=yield this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'index' AND "tbl_name" IN (${s})`)}return t.length===0?[]:Promise.all(t.map(i=>v(this,null,function*(){const s=i.database&&this.driver.getAttachedDatabaseHandleByRelativePath(i.database)?`${this.driver.getAttachedDatabaseHandleByRelativePath(i.database)}.${i.name}`:i.name,a=i.sql,o=a.includes("WITHOUT ROWID"),l=new hn({name:s,withoutRowid:o}),[c,u,h]=yield Promise.all([this.loadPragmaRecords(s,"table_xinfo"),this.loadPragmaRecords(s,"index_list"),this.loadPragmaRecords(s,"foreign_key_list")]);let f;const d=i.sql,m=d.toUpperCase().indexOf("AUTOINCREMENT");if(m!==-1){f=d.substr(0,m);const E=f.lastIndexOf(","),A=f.lastIndexOf("(");E!==-1?(f=f.substr(E),f=f.substr(0,f.lastIndexOf('"')),f=f.substr(f.indexOf('"')+1)):A!==-1&&(f=f.substr(A),f=f.substr(0,f.lastIndexOf('"')),f=f.substr(f.indexOf('"')+1))}l.columns=yield Promise.all(c.map(E=>v(this,null,function*(){const A=new ar;if(A.name=E.name,A.type=E.type.toLowerCase(),A.default=E.dflt_value!==null&&E.dflt_value!==void 0?E.dflt_value:void 0,A.isNullable=E.notnull===0,A.isPrimary=E.pk>0,A.comment="",A.isGenerated=f===E.name,A.isGenerated&&(A.generationStrategy="increment"),E.hidden===2||E.hidden===3){A.generatedType=E.hidden===2?"VIRTUAL":"STORED";const $=this.selectTypeormMetadataSql({table:l.name,type:wt.GENERATED_COLUMN,name:A.name}),B=yield this.query($.query,$.parameters);B[0]&&B[0].value?A.asExpression=B[0].value:A.asExpression=""}A.type==="varchar"&&(A.enum=ke.parseSqlCheckExpression(a,A.name));const x=A.type.indexOf("(");if(x!==-1){const $=A.type,B=$.substr(0,x);if(this.driver.withLengthColumnTypes.find(K=>K===B)){const K=parseInt($.substring(x+1,$.length-1));K&&(A.length=K.toString(),A.type=B)}if(this.driver.withPrecisionColumnTypes.find(K=>K===B)){const K=new RegExp(`^${B}\\((\\d+),?\\s?(\\d+)?\\)`),ae=$.match(K);ae&&ae[1]&&(A.precision=+ae[1]),this.driver.withScaleColumnTypes.find(ue=>ue===B)&&ae&&ae[2]&&(A.scale=+ae[2]),A.type=B}}return A})));let y;const T=[],b=/CONSTRAINT "([^"]*)" FOREIGN KEY ?\((.*?)\) REFERENCES "([^"]*)"/g;for(;(y=b.exec(a))!==null;)T.push({name:y[1],columns:y[2].substr(1,y[2].length-2).split('", "'),referencedTableName:y[3]});const S=ke.uniq(h,E=>E.id);l.foreignKeys=S.map(E=>{const A=h.filter(K=>K.id===E.id&&K.table===E.table),x=A.map(K=>K.from),$=A.map(K=>K.to),B=T.find(K=>K.referencedTableName===E.table&&K.columns.every(ae=>x.indexOf(ae)!==-1));return new Mr({name:B==null?void 0:B.name,columnNames:x,referencedTableName:E.table,referencedColumnNames:$,onDelete:E.on_delete,onUpdate:E.on_update})});let N;const C=[],I=/CONSTRAINT "([^"]*)" UNIQUE ?\((.*?)\)/g;for(;(N=I.exec(a))!==null;)C.push({name:N[1],columns:N[2].substr(1,N[2].length-2).split('", "')});const H=u.filter(E=>E.origin==="u").map(E=>E.name).filter((E,A,x)=>x.indexOf(E)===A).map(E=>v(this,null,function*(){const A=u.find(K=>K.name===E),$=(yield this.query(`PRAGMA index_info("${A.name}")`)).sort((K,ae)=>parseInt(K.seqno)-parseInt(ae.seqno)).map(K=>K.name);if($.length===1){const K=l.columns.find(ae=>!!$.find(ue=>ue===ae.name));K&&(K.isUnique=!0)}const B=C.find(K=>K.columns.every(ae=>$.indexOf(ae)!==-1));return new Qn({name:B?B.name:this.connection.namingStrategy.uniqueConstraintName(l,$),columnNames:$})}));l.uniques=yield Promise.all(H);let Q;const te=/CONSTRAINT "([^"]*)" CHECK ?(\(.*?\))([,]|[)]$)/g;for(;(Q=te.exec(a))!==null;)l.checks.push(new Gr({name:Q[1],expression:Q[2]}));const V=u.filter(E=>E.origin==="c").map(E=>E.name).filter((E,A,x)=>x.indexOf(E)===A).map(E=>v(this,null,function*(){const A=n.find(L=>L.name===E),x=/WHERE (.*)/.exec(A.sql),$=u.find(L=>L.name===E),K=(yield this.query(`PRAGMA index_info("${$.name}")`)).sort((L,Se)=>parseInt(L.seqno)-parseInt(Se.seqno)).map(L=>L.name),ae=`${i.database?`${i.database}.`:""}${$.name}`,ue=$.unique==="1"||$.unique===1;return new mn({table:l,name:ae,columnNames:K,isUnique:ue,where:x?x[1]:void 0})})),J=yield Promise.all(V);return l.indices=J.filter(E=>!!E),l})))})}createTableSql(e,t,n){const i=e.columns.filter(d=>d.isPrimary),s=i.find(d=>d.isGenerated&&d.generationStrategy==="increment"),a=i.length>1;if(a&&s)throw new Z("Sqlite does not support AUTOINCREMENT on composite primary key");const o=e.columns.map(d=>this.buildCreateColumnSql(d,a)).join(", "),[l]=this.splitTablePath(e.name);let c=`CREATE TABLE ${this.escapePath(e.name)} (${o}`;const[u,h]=this.splitTablePath(e.name),f=n?`${u?`${u}.`:""}${h.replace(/^temporary_/,"")}`:e.name;if(e.columns.filter(d=>d.isUnique).forEach(d=>{e.uniques.some(y=>y.columnNames.length===1&&y.columnNames[0]===d.name)||e.uniques.push(new Qn({name:this.connection.namingStrategy.uniqueConstraintName(e,[d.name]),columnNames:[d.name]}))}),e.uniques.length>0){const d=e.uniques.map(m=>{const y=m.name?m.name:this.connection.namingStrategy.uniqueConstraintName(f,m.columnNames),T=m.columnNames.map(b=>`"${b}"`).join(", ");return`CONSTRAINT "${y}" UNIQUE (${T})`}).join(", ");c+=`, ${d}`}if(e.checks.length>0){const d=e.checks.map(m=>`CONSTRAINT "${m.name?m.name:this.connection.namingStrategy.checkConstraintName(f,m.expression)}" CHECK (${m.expression})`).join(", ");c+=`, ${d}`}if(e.foreignKeys.length>0&&t){const d=e.foreignKeys.filter(m=>{const[y]=this.splitTablePath(m.referencedTableName);return y===l}).map(m=>{const[,y]=this.splitTablePath(m.referencedTableName),T=m.columnNames.map(N=>`"${N}"`).join(", ");m.name||(m.name=this.connection.namingStrategy.foreignKeyName(f,m.columnNames,this.getTablePath(m),m.referencedColumnNames));const b=m.referencedColumnNames.map(N=>`"${N}"`).join(", ");let S=`CONSTRAINT "${m.name}" FOREIGN KEY (${T}) REFERENCES "${y}" (${b})`;return m.onDelete&&(S+=` ON DELETE ${m.onDelete}`),m.onUpdate&&(S+=` ON UPDATE ${m.onUpdate}`),m.deferrable&&(S+=` DEFERRABLE ${m.deferrable}`),S}).join(", ");c+=`, ${d}`}if(i.length>1){const d=i.map(m=>`"${m.name}"`).join(", ");c+=`, PRIMARY KEY (${d})`}return c+=")",e.withoutRowid&&(c+=" WITHOUT ROWID"),new Y(c)}dropTableSql(e,t){const n=de.isTable(e)?e.name:e,i=t?`DROP TABLE IF EXISTS ${this.escapePath(n)}`:`DROP TABLE ${this.escapePath(n)}`;return new Y(i)}createViewSql(e){return typeof e.expression=="string"?new Y(`CREATE VIEW "${e.name}" AS ${e.expression}`):new Y(`CREATE VIEW "${e.name}" AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){const t=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:wt.VIEW,name:e.name,value:t})}dropViewSql(e){const t=de.isView(e)?e.name:e;return new Y(`DROP VIEW "${t}"`)}deleteViewDefinitionSql(e){const t=de.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:wt.VIEW,name:t})}createIndexSql(e,t){const n=t.columnNames.map(a=>`"${a}"`).join(", "),[i,s]=this.splitTablePath(e.name);return new Y(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX ${i?`"${i}".`:""}${this.escapePath(t.name)} ON "${s}" (${n}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e){const t=de.isTableIndex(e)?e.name:e;return new Y(`DROP INDEX ${this.escapePath(t)}`)}buildCreateColumnSql(e,t){let n='"'+e.name+'"';return de.isColumnMetadata(e)?n+=" "+this.driver.normalizeType(e):n+=" "+this.connection.driver.createFullType(e),e.enum&&(n+=' CHECK( "'+e.name+'" IN ('+e.enum.map(i=>"'"+i+"'").join(",")+") )"),e.isPrimary&&!t&&(n+=" PRIMARY KEY"),e.isGenerated===!0&&e.generationStrategy==="increment"&&(n+=" AUTOINCREMENT"),e.collation&&(n+=" COLLATE "+e.collation),e.isNullable!==!0&&(n+=" NOT NULL"),e.asExpression?n+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`:e.default!==void 0&&e.default!==null&&(n+=" DEFAULT ("+e.default+")"),n}recreateTable(e,t,n=!0){return v(this,null,function*(){const i=[],s=[];t.indices.forEach(c=>{i.push(this.dropIndexSql(c)),s.push(this.createIndexSql(t,c))});let[a,o]=this.splitTablePath(e.name);const[,l]=this.splitTablePath(t.name);if(e.name=o=`${a?`${a}.`:""}temporary_${o}`,i.push(this.createTableSql(e,!0,!0)),s.push(this.dropTableSql(e)),n){let c=e.columns.filter(h=>!h.generatedType).map(h=>`"${h.name}"`),u=t.columns.filter(h=>!h.generatedType).map(h=>`"${h.name}"`);u.length<c.length?c=e.columns.filter(h=>{const f=t.columns.find(d=>d.name===h.name);return f&&f.generatedType?!1:!h.generatedType&&f}).map(h=>`"${h.name}"`):u.length>c.length&&(u=t.columns.filter(h=>!h.generatedType&&e.columns.find(f=>f.name===h.name)).map(h=>`"${h.name}"`)),i.push(new Y(`INSERT INTO ${this.escapePath(e.name)}(${c.join(", ")}) SELECT ${u.join(", ")} FROM ${this.escapePath(t.name)}`)),s.push(new Y(`INSERT INTO ${this.escapePath(t.name)}(${u.join(", ")}) SELECT ${c.join(", ")} FROM ${this.escapePath(e.name)}`))}i.push(this.dropTableSql(t)),s.push(this.createTableSql(t,!0)),i.push(new Y(`ALTER TABLE ${this.escapePath(e.name)} RENAME TO ${this.escapePath(l)}`)),s.push(new Y(`ALTER TABLE ${this.escapePath(t.name)} RENAME TO ${this.escapePath(o)}`)),e.name=t.name,e.indices.forEach(c=>{c.name||(c.name=this.connection.namingStrategy.indexName(e,c.columnNames,c.where)),i.push(this.createIndexSql(e,c)),s.push(this.dropIndexSql(c))}),t.columns.filter(c=>{const u=e.columns.find(h=>h.name===c.name);return c.generatedType&&c.asExpression&&(!u||!u.generatedType&&!u.asExpression)}).forEach(c=>{const u=this.deleteTypeormMetadataSql({table:t.name,type:wt.GENERATED_COLUMN,name:c.name}),h=this.insertTypeormMetadataSql({table:t.name,type:wt.GENERATED_COLUMN,name:c.name,value:c.asExpression});i.push(u),s.push(h)}),e.columns.filter(c=>c.generatedType&&c.asExpression&&!t.columns.some(u=>u.name===c.name)).forEach(c=>{const u=this.insertTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:c.name,value:c.asExpression}),h=this.deleteTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:c.name});i.push(u),s.push(h)}),e.columns.filter(c=>c.generatedType&&c.asExpression).forEach(c=>{const u=t.columns.find(y=>y.name===c.name&&y.generatedType&&c.generatedType&&y.asExpression!==c.asExpression);if(!u)return;const h=this.deleteTypeormMetadataSql({table:t.name,type:wt.GENERATED_COLUMN,name:u.name}),f=this.insertTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:c.name,value:c.asExpression});i.push(h),i.push(f);const d=this.insertTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:u.name,value:u.asExpression}),m=this.deleteTypeormMetadataSql({table:t.name,type:wt.GENERATED_COLUMN,name:c.name});s.push(d),s.push(m)}),yield this.executeQueries(i,s),this.replaceCachedTable(t,e)})}splitTablePath(e){return e.indexOf(".")!==-1?e.split("."):[void 0,e]}escapePath(e,t){return(de.isTable(e)||de.isView(e)?e.name:e).replace(/^\.+|\.+$/g,"").split(".").map(i=>t?i:`"${i}"`).join(".")}changeTableComment(e,t){throw new Z("sqlit driver does not support change comment.")}}class k3 extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.connect();this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const s=new Or,a=Date.now();try{const o=yield new Promise((f,d)=>{i.executeSql(e,t,m=>f(m),m=>d(m))}),l=this.driver.options.maxQueryExecutionTime,u=Date.now()-a;this.broadcaster.broadcastAfterQueryEvent(s,e,t,!0,u,o,void 0),l&&u>l&&this.driver.connection.logger.logQuerySlow(u,e,t,this);const h=new Zr;if(e.substr(0,11)==="INSERT INTO")h.raw=o.insertId;else{const f=[];for(let d=0;d<o.rows.length;d++)f.push(o.rows.item(d));h.records=f,h.raw=f}return n?h:h.raw}catch(o){throw this.driver.connection.logger.logQueryError(o,e,t,this),this.broadcaster.broadcastAfterQueryEvent(s,e,t,!1,void 0,void 0,o),new zr(e,t,o)}finally{yield s.wait()}})}startTransaction(){return v(this,null,function*(){throw new Z("Transactions are not supported by the Cordova driver")})}commitTransaction(){return v(this,null,function*(){throw new Z("Transactions are not supported by the Cordova driver")})}rollbackTransaction(){return v(this,null,function*(){throw new Z("Transactions are not supported by the Cordova driver")})}clearDatabase(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF");try{const t=yield this.query(`SELECT 'DROP VIEW "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'view'`),i=yield this.query(`SELECT 'DROP TABLE "' || name || '";' as query FROM "sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`);yield Promise.all(t.map(s=>this.query(s.query))),yield Promise.all(i.map(s=>this.query(s.query)))}finally{yield this.query("PRAGMA foreign_keys = ON")}})}parametrize(e,t=0){return Object.keys(e).map((n,i)=>`"${n}"=?`)}}class B3 extends oo{constructor(e){super(e),this.transactionSupport="none",this.database=this.options.database,this.loadDependencies()}disconnect(){return v(this,null,function*(){return this.queryRunner=void 0,new Promise((e,t)=>{this.databaseConnection.close(e,t)})})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new k3(this)),this.queryRunner}createDatabaseConnection(){return v(this,null,function*(){const e=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{}),t=yield new Promise((n,i)=>{this.sqlite.openDatabase(e,s=>n(s),s=>i(s))});return yield new Promise((n,i)=>{t.executeSql("PRAGMA foreign_keys = ON",[],()=>n(),s=>i(s))}),t})}loadDependencies(){try{const e=this.options.driver||window.sqlitePlugin;this.sqlite=e}catch(e){throw new io("Cordova-SQLite","cordova-sqlite-storage")}}}class F3 extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.connect();this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const s=new Or,a=Date.now();return new Promise((o,l)=>v(this,null,function*(){try{i.executeSql(e,t,c=>v(this,null,function*(){const u=this.driver.options.maxQueryExecutionTime,f=Date.now()-a;this.broadcaster.broadcastAfterQueryEvent(s,e,t,!0,f,c,void 0),u&&f>u&&this.driver.connection.logger.logQuerySlow(f,e,t,this),s.promises.length>0&&(yield Promise.all(s.promises));const d=new Zr;if(c!=null&&c.hasOwnProperty("rowsAffected")&&(d.affected=c.rowsAffected),c!=null&&c.hasOwnProperty("rows")){const m=[];for(let y=0;y<c.rows.length;y++)m.push(c.rows.item(y));d.raw=m,d.records=m}e.substr(0,11)==="INSERT INTO"&&(d.raw=c.insertId),o(n?d:d.raw)}),c=>{this.driver.connection.logger.logQueryError(c,e,t,this),this.broadcaster.broadcastAfterQueryEvent(s,e,t,!1,void 0,void 0,c),l(new zr(e,t,c))})}catch(c){l(c)}finally{yield s.wait()}}))})}parametrize(e,t=0){return Object.keys(e).map((n,i)=>`"${n}"=?`)}}class U3{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.supportedUpsertTypes=["on-conflict-do-update"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=this.options.database,this.loadDependencies()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new F3(this)),this.queryRunner}connect(){return v(this,null,function*(){this.databaseConnection=yield this.createDatabaseConnection()})}afterConnect(){return Promise.resolve()}disconnect(){return v(this,null,function*(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close(e,t)})})}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,n;return(n=(t=this.attachedDatabases)==null?void 0:t[e])==null?void 0:n.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return(t=Object.values(this.attachedDatabases).find(({attachHandle:n})=>e===n))==null?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new uh(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=An.transformTo(t.transformer,e)),e==null?e:t.type===Boolean||t.type==="boolean"?e===!0?1:0:t.type==="date"?dt.mixedDateToDateString(e):t.type==="time"?dt.mixedDateToTimeString(e):t.type==="datetime"||t.type===Date?dt.mixedDateToUtcDatetimeString(e):t.type==="simple-array"?dt.simpleArrayToString(e):t.type==="simple-json"?dt.simpleJsonToString(e):t.type==="simple-enum"?dt.simpleEnumToString(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?An.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?(e&&typeof e=="string"&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=dt.normalizeHydratedDate(e)):t.type==="date"?e=dt.mixedDateToDateString(e):t.type==="time"?e=dt.mixedTimeToString(e):t.type==="simple-array"?e=dt.stringToSimpleArray(e):t.type==="simple-json"?e=dt.stringToSimpleJson(e):t.type==="simple-enum"?e=dt.stringToSimpleEnum(e,t):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=An.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,n){const i=Object.keys(n).map(s=>typeof n[s]=="boolean"?n[s]===!0?1:0:n[s]instanceof Date?dt.mixedDateToUtcDatetimeString(n[s]):n[s]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(s,a,o)=>{if(!t.hasOwnProperty(o))return s;const l=t[o];return a?l.map(c=>(i.push(c),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():typeof l=="number"?String(l):typeof l=="boolean"?(i.push(+l),this.createParameter(o,i.length-1)):l instanceof Date?(i.push(dt.mixedDateToUtcDatetimeString(l)),this.createParameter(o,i.length-1)):(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return'"'+e+'"'}buildTableName(e,t,n){return e}parseTableName(e){var s;const t=this.database,n=void 0;if(de.isTable(e)||de.isView(e)){const a=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||a.database||t,schema:e.schema||a.schema||n,tableName:a.tableName}}if(de.isTableForeignKey(e)){const a=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||a.database||t,schema:e.referencedSchema||a.schema||n,tableName:a.tableName}}if(de.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const i=e.split(".");return i.length===3?{database:i[0]||t,schema:i[1]||n,tableName:i[2]}:i.length===2?{database:(s=this.getAttachedDatabasePathRelativeByHandle(i[0]))!=null?s:t,schema:i[0],tableName:i[1]}:{database:t,schema:n,tableName:e}}normalizeType(e){return e.type===Number||e.type==="int"?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"varchar":e.type||""}normalizeDefault(e){const t=e.default;if(typeof t=="number")return""+t;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!=null)return`${t}`}normalizeIsUnique(e){return e.entityMetadata.uniques.some(t=>t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+="("+e.precision+","+e.scale+")":e.precision!==null&&e.precision!==void 0&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,n,i){const s=e.generatedColumns.reduce((a,o)=>{let l;return o.generationStrategy==="increment"&&t&&(l=t-i+n+1),l?ke.mergeDeep(a,o.createValueMap(l)):a},{});return Object.keys(s).length>0?s:void 0}findChangedColumns(e,t){return t.filter(n=>{const i=e.find(a=>a.name===n.databaseName);return i?i.name!==n.databaseName||i.type!==this.normalizeType(n)||i.length!==n.length||i.precision!==n.precision||i.scale!==n.scale||this.normalizeDefault(n)!==i.default||i.isPrimary!==n.isPrimary||i.isNullable!==n.isNullable||i.generatedType!==n.generatedType||i.asExpression!==n.asExpression||i.isUnique!==this.normalizeIsUnique(n)||i.enum&&n.enum&&!ke.isArraysEqual(i.enum,n.enum.map(a=>a+""))||n.generationStrategy!=="uuid"&&i.isGenerated!==n.isGenerated:!1})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){return new Promise((e,t)=>{const n=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{});this.sqlite.openDatabase(n,i=>{const s=i;s.executeSql("PRAGMA foreign_keys = ON",[],a=>{e(s)},a=>{t(a)})},i=>{t(i)})})}loadDependencies(){try{const e=this.options.driver||require("react-native-sqlite-storage");this.sqlite=e}catch(e){throw new io("React-Native","react-native-sqlite-storage")}}}class V3 extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=this.driver.connection,s=yield this.connect();return new Promise((a,o)=>{const l=e.substr(0,11)==="INSERT INTO";i.logger.logQuery(e,t,this);const c=(h,f)=>{const d=this.driver.options.maxQueryExecutionTime,y=Date.now()-u;d&&y>d&&i.logger.logQuerySlow(y,e,t,this),h&&(i.logger.logQueryError(h,e,t,this),o(new zr(e,t,h)));const T=new Zr;T.raw=f,!l&&Array.isArray(f)&&(T.records=f),a(n?T:T.raw)},u=Date.now();l?s.execSQL(e,t,c):s.all(e,t,c)})})}parametrize(e,t=0){return Object.keys(e).map((n,i)=>`"${n}"=?`)}}class j3 extends oo{constructor(e){super(e),this.connection=e,this.options=e.options,this.database=this.options.database,this.driver=this.options.driver,this.loadDependencies()}disconnect(){return v(this,null,function*(){return new Promise((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close().then(e).catch(t)})})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new V3(this)),this.queryRunner}normalizeType(e){return e.type===Buffer?"blob":super.normalizeType(e)}createDatabaseConnection(){return new Promise((e,t)=>{const n=Object.assign({},{readOnly:this.options.readOnly,key:this.options.key,multithreading:this.options.multithreading,migrate:this.options.migrate,iosFlags:this.options.iosFlags,androidFlags:this.options.androidFlags},this.options.extra||{});new this.sqlite(this.options.database,n,(i,s)=>{if(i)return t(i);s.resultType(this.sqlite.RESULTSASOBJECT),s.execSQL("PRAGMA foreign_keys = ON",[],(a,o)=>{if(a)return t(a);e(s)})})})}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new io("Nativescript","nativescript-sqlite")}}class hu extends Js{constructor(e){super(),this.isDirty=!1,this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}flush(){return v(this,null,function*(){this.isDirty&&(yield this.driver.autoSave(),this.isDirty=!1)})}release(){return v(this,null,function*(){return yield this.flush(),_h(hu.prototype,this,"release").call(this)})}commitTransaction(){return v(this,null,function*(){yield _h(hu.prototype,this,"commitTransaction").call(this),this.isTransactionActive||(yield this.flush())})}query(i){return v(this,arguments,function*(e,t=[],n=!1){if(this.isReleased)throw new zn;const s=e.trim().split(" ",1)[0],a=this.driver.databaseConnection;this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const o=new Or,l=Date.now();let c;try{c=a.prepare(e),t&&(t=t.map(y=>typeof y!="undefined"?y:null),c.bind(t));const u=this.driver.options.maxQueryExecutionTime,f=Date.now()-l;u&&f>u&&this.driver.connection.logger.logQuerySlow(f,e,t,this);const d=[];for(;c.step();)d.push(c.getAsObject());this.broadcaster.broadcastAfterQueryEvent(o,e,t,!0,f,d,void 0);const m=new Zr;return m.affected=a.getRowsModified(),m.records=d,m.raw=d,c.free(),s!=="SELECT"&&(this.isDirty=!0),n?m:m.raw}catch(u){throw c&&c.free(),this.driver.connection.logger.logQueryError(u,e,t,this),this.broadcaster.broadcastAfterQueryEvent(o,e,t,!1,void 0,void 0,u),new zr(e,t,u)}finally{yield o.wait()}})}}class W3 extends oo{constructor(e){if(super(e),this.options.autoSave&&!this.options.location&&!this.options.autoSaveCallback)throw new Y2("location or autoSaveCallback");this.loadDependencies()}connect(){return v(this,null,function*(){this.databaseConnection=yield this.createDatabaseConnection()})}disconnect(){return v(this,null,function*(){this.queryRunner=void 0,this.databaseConnection.close()})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new hu(this)),this.queryRunner}load(e,t=!0){return v(this,null,function*(){if(typeof e=="string")if(Kt.type==="node")if(Kt.fileExist(e)){const n=Kt.readFileSync(e);return this.createDatabaseConnectionWithImport(n)}else{if(t)throw new Z(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else{let n=null;if(this.options.useLocalForage)if(window.localforage)n=yield window.localforage.getItem(e);else throw new Z("localforage is not defined - please import localforage.js into your site");else n=Kt.getGlobalVariable().localStorage.getItem(e);if(n!=null)return this.createDatabaseConnectionWithImport(JSON.parse(n));if(t)throw new Z(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}else return this.createDatabaseConnectionWithImport(e)})}save(e){return v(this,null,function*(){if(!e&&!this.options.location)throw new Z("No location is set, specify a location parameter or add the location option to your configuration");let t="";if(e?t=e:this.options.location&&(t=this.options.location),Kt.type==="node")try{const n=Buffer.from(this.databaseConnection.export());yield Kt.writeFile(t,n)}catch(n){throw new Z(`Could not save database, error: ${n}`)}else{const n=this.databaseConnection.export(),i=[].slice.call(n);if(this.options.useLocalForage)if(window.localforage)yield window.localforage.setItem(t,JSON.stringify(i));else throw new Z("localforage is not defined - please import localforage.js into your site");else Kt.getGlobalVariable().localStorage.setItem(t,JSON.stringify(i))}})}autoSave(){return v(this,null,function*(){var e;this.options.autoSave&&!((e=this.queryRunner)!=null&&e.isTransactionActive)&&(this.options.autoSaveCallback?yield this.options.autoSaveCallback(this.export()):yield this.save())})}export(){return this.databaseConnection.export()}createGeneratedMap(e,t){const n=e.generatedColumns.reduce((i,s)=>{if(s.isPrimary&&s.generationStrategy==="increment"){const a="SELECT last_insert_rowid()";try{const o=this.databaseConnection.exec(a);return this.connection.logger.logQuery(a),ke.mergeDeep(i,s.createValueMap(o[0].values[0][0]))}catch(o){this.connection.logger.logQueryError(o,a,[])}}return i},{});return Object.keys(n).length>0?n:void 0}createDatabaseConnection(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)}createDatabaseConnectionWithImport(e){return v(this,null,function*(){const n=typeof this.sqlite.Database=="function"?this.sqlite:yield this.sqlite(this.options.sqlJsConfig);return e&&e.length>0?this.databaseConnection=new n.Database(e):this.databaseConnection=new n.Database,this.databaseConnection.exec("PRAGMA foreign_keys = ON"),this.databaseConnection})}loadDependencies(){if(Kt.type==="browser"){const e=this.options.driver||window.SQL;this.sqlite=e}else try{const e=this.options.driver||Kt.load("sql.js");this.sqlite=e}catch(e){throw new io("sql.js","sql.js")}}}class H3 extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.connect(),s=new Or;this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const a=Date.now(),o=yield i.prepareAsync(e);try{const l=yield o.executeAsync(t),c=this.driver.options.maxQueryExecutionTime,h=Date.now()-a;this.broadcaster.broadcastAfterQueryEvent(s,e,t,!0,h,l,void 0),yield s.wait(),c&&h>c&&this.driver.connection.logger.logQuerySlow(h,e,t,this);const f=new Zr;return f.affected=l.changes,f.records=yield l.getAllAsync(),f.raw=e.startsWith("INSERT INTO")?l.lastInsertRowId:f.records,n?f:f.raw}catch(l){throw this.driver.connection.logger.logQueryError(l,e,t,this),this.broadcaster.broadcastAfterQueryEvent(s,e,t,!1,0,void 0,l),yield s.wait(),new zr(e,t,l)}finally{yield s.wait(),yield o.finalizeAsync()}})}}class Q3 extends oo{constructor(e){super(e),this.sqlite=this.options.driver}disconnect(){return v(this,null,function*(){this.queryRunner=void 0,yield this.databaseConnection.closeAsync(),this.databaseConnection=void 0})}createQueryRunner(){return this.queryRunner||(this.queryRunner=new H3(this)),this.queryRunner}createDatabaseConnection(){return v(this,null,function*(){return this.databaseConnection=yield this.sqlite.openDatabaseAsync(this.options.database),yield this.databaseConnection.runAsync("PRAGMA foreign_keys = ON"),this.databaseConnection})}}class z3 extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}startTransaction(){return v(this,null,function*(){this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}this.transactionDepth+=1,yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive&&typeof this.transaction=="undefined")throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive&&typeof this.transaction=="undefined")throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}beforeMigration(){return v(this,null,function*(){const e=yield this.connect();return new Promise((t,n)=>{e.exec([{sql:"PRAGMA foreign_keys = OFF",args:[]}],!1,i=>i?n(i):t())})})}afterMigration(){return v(this,null,function*(){const e=yield this.connect();return new Promise((t,n)=>{e.exec([{sql:"PRAGMA foreign_keys = ON",args:[]}],!1,i=>i?n(i):t())})})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;return new Promise((i,s)=>v(this,null,function*(){const a=yield this.connect(),o=new Or;this.driver.connection.logger.logQuery(e,t,this),this.broadcaster.broadcastBeforeQueryEvent(o,e,t);const l=Date.now();a.transaction(c=>v(this,null,function*(){typeof this.transaction=="undefined"&&(yield this.startTransaction(),this.transaction=c),this.transaction.executeSql(e,t,(u,h)=>v(this,null,function*(){const f=this.driver.options.maxQueryExecutionTime,m=Date.now()-l;this.broadcaster.broadcastAfterQueryEvent(o,e,t,!0,m,h,void 0),yield o.wait(),f&&m>f&&this.driver.connection.logger.logQuerySlow(m,e,t,this);const y=new Zr;if(h!=null&&h.hasOwnProperty("rowsAffected")&&(y.affected=h.rowsAffected),h!=null&&h.hasOwnProperty("rows")){const T=[];for(let b=0;b<h.rows.length;b++)T.push(h.rows.item(b));y.raw=T,y.records=T}e.startsWith("INSERT INTO")&&(y.raw=h.insertId),i(n?y:y.raw)}),(u,h)=>v(this,null,function*(){this.driver.connection.logger.logQueryError(h,e,t,this),this.broadcaster.broadcastAfterQueryEvent(o,e,t,!1,void 0,void 0,h),yield o.wait(),s(new zr(e,t,h))}))}),c=>v(this,null,function*(){yield this.rollbackTransaction(),s(c)}),()=>{this.isTransactionActive=!1,this.transaction=void 0})}))})}}class G3 extends oo{constructor(e){super(e),this.database=this.options.database,this.sqlite=this.options.driver}disconnect(){return v(this,null,function*(){return new Promise((e,t)=>{try{this.queryRunner=void 0,this.databaseConnection._db.close(),this.databaseConnection=void 0,e()}catch(n){t(n)}})})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new z3(this)),this.queryRunner}createDatabaseConnection(){return new Promise((e,t)=>{try{const n=this.sqlite.openDatabase(this.options.database);n.transaction(i=>{i.executeSql("PRAGMA foreign_keys = ON",[],(s,a)=>{e(n)},(s,a)=>{t({transaction:s,error:a})})},i=>{t(i)})}catch(n){t(n)}})}}class K3{constructor(e){this.connection=e}create(){return this.isLegacyDriver?new G3(this.connection):new Q3(this.connection)}get isLegacyDriver(){return!("openDatabaseAsync"in this.connection.options.driver)}}class Y3 extends hh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.client=t,this.broadcaster=new gi(this)}connect(){return v(this,null,function*(){return{}})}release(){return this.isReleased=!0,this.databaseConnection&&this.databaseConnection.release(),Promise.resolve()}startTransaction(e){return v(this,null,function*(){this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?yield this.client.startTransaction():yield this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?yield this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?yield this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.client.query(e,t),s=new Zr;return s.raw=i,i!=null&&i.hasOwnProperty("records")&&Array.isArray(i.records)&&(s.records=i.records),i!=null&&i.hasOwnProperty("numberOfRecordsUpdated")&&(s.affected=i.numberOfRecordsUpdated),n?s:s.raw})}stream(e,t,n,i){if(this.isReleased)throw new zn;return new Promise((s,a)=>v(this,null,function*(){try{const l=(yield this.connect()).query(e,t);n&&l.on("end",n),i&&l.on("error",i),s(l)}catch(o){a(o)}}))}getDatabases(){return v(this,null,function*(){return Promise.resolve([])})}getSchemas(e){return v(this,null,function*(){throw new Z("MySql driver does not support table schemas")})}hasDatabase(e){return v(this,null,function*(){return!!(yield this.query(`SELECT * FROM \`INFORMATION_SCHEMA\`.\`SCHEMATA\` WHERE \`SCHEMA_NAME\` = '${e}'`)).length})}getCurrentDatabase(){return v(this,null,function*(){return(yield this.query("SELECT DATABASE() AS `db_name`"))[0].db_name})}hasSchema(e){return v(this,null,function*(){throw new Z("MySql driver does not support table schemas")})}getCurrentSchema(){return v(this,null,function*(){return(yield this.query("SELECT SCHEMA() AS `schema_name`"))[0].schema_name})}hasTable(e){return v(this,null,function*(){const t=this.driver.parseTableName(e),n=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${t.database}' AND \`TABLE_NAME\` = '${t.tableName}'`;return!!(yield this.query(n)).length})}hasColumn(e,t){return v(this,null,function*(){const n=this.driver.parseTableName(e),i=de.isTableColumn(t)?t.name:t,s=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${n.database}' AND \`TABLE_NAME\` = '${n.tableName}' AND \`COLUMN_NAME\` = '${i}'`;return!!(yield this.query(s)).length})}createDatabase(e,t){return v(this,null,function*(){const n=t?`CREATE DATABASE IF NOT EXISTS \`${e}\``:`CREATE DATABASE \`${e}\``,i=`DROP DATABASE \`${e}\``;yield this.executeQueries(new Y(n),new Y(i))})}dropDatabase(e,t){return v(this,null,function*(){const n=t?`DROP DATABASE IF EXISTS \`${e}\``:`DROP DATABASE \`${e}\``,i=`CREATE DATABASE \`${e}\``;yield this.executeQueries(new Y(n),new Y(i))})}createSchema(e,t){return v(this,null,function*(){throw new Z("Schema create queries are not supported by MySql driver.")})}dropSchema(e,t){return v(this,null,function*(){throw new Z("Schema drop queries are not supported by MySql driver.")})}createTable(e,t=!1,n=!0){return v(this,null,function*(){if(t&&(yield this.hasTable(e)))return Promise.resolve();const i=[],s=[];return i.push(this.createTableSql(e,n)),s.push(this.dropTableSql(e)),e.indices.forEach(a=>s.push(this.dropIndexSql(e,a))),n&&e.foreignKeys.forEach(a=>s.push(this.dropForeignKeySql(e,a))),this.executeQueries(i,s)})}dropTable(e,t,n=!0){return v(this,null,function*(){if(t&&!(yield this.hasTable(e)))return Promise.resolve();const i=n,s=this.getTablePath(e),a=yield this.getCachedTable(s),o=[],l=[];n&&a.foreignKeys.forEach(c=>o.push(this.dropForeignKeySql(a,c))),a.indices.forEach(c=>o.push(this.dropIndexSql(a,c))),o.push(this.dropTableSql(a)),l.push(this.createTableSql(a,i)),yield this.executeQueries(o,l)})}createView(e,t=!1){return v(this,null,function*(){const n=[],i=[];n.push(this.createViewSql(e)),t&&n.push(yield this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(yield this.deleteViewDefinitionSql(e)),yield this.executeQueries(n,i)})}dropView(e){return v(this,null,function*(){const t=de.isView(e)?e.name:e,n=yield this.getCachedView(t),i=[],s=[];i.push(yield this.deleteViewDefinitionSql(n)),i.push(this.dropViewSql(n)),s.push(yield this.insertViewDefinitionSql(n)),s.push(this.createViewSql(n)),yield this.executeQueries(i,s)})}renameTable(e,t){return v(this,null,function*(){const n=[],i=[],s=de.isTable(e)?e:yield this.getCachedTable(e),a=s.clone(),{database:o}=this.driver.parseTableName(s);a.name=o?`${o}.${t}`:t,n.push(new Y(`RENAME TABLE ${this.escapePath(s)} TO ${this.escapePath(a)}`)),i.push(new Y(`RENAME TABLE ${this.escapePath(a)} TO ${this.escapePath(s)}`)),a.indices.forEach(l=>{const c=l.columnNames.map(f=>`\`${f}\``).join(", "),u=this.connection.namingStrategy.indexName(a,l.columnNames,l.where);let h="";l.isUnique&&(h+="UNIQUE "),l.isSpatial&&(h+="SPATIAL "),l.isFulltext&&(h+="FULLTEXT "),n.push(new Y(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${l.name}\`, ADD ${h}INDEX \`${u}\` (${c})`)),i.push(new Y(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${u}\`, ADD ${h}INDEX \`${l.name}\` (${c})`)),l.name=u}),a.foreignKeys.forEach(l=>{const c=l.columnNames.map(m=>`\`${m}\``).join(", "),u=l.referencedColumnNames.map(m=>`\`${m}\``).join(","),h=this.connection.namingStrategy.foreignKeyName(a,l.columnNames);let f=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${l.name}\`, ADD CONSTRAINT \`${h}\` FOREIGN KEY (${c}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${u})`;l.onDelete&&(f+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(f+=` ON UPDATE ${l.onUpdate}`);let d=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${h}\`, ADD CONSTRAINT \`${l.name}\` FOREIGN KEY (${c}) REFERENCES ${this.escapePath(this.getTablePath(l))}(${u})`;l.onDelete&&(d+=` ON DELETE ${l.onDelete}`),l.onUpdate&&(d+=` ON UPDATE ${l.onUpdate}`),n.push(new Y(f)),i.push(new Y(d)),l.name=h}),yield this.executeQueries(n,i),s.name=a.name,this.replaceCachedTable(s,a)})}addColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone(),s=[],a=[],o=i.primaryColumns.length>0;if(s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(t,o,!1)}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN \`${t.name}\``)),t.isPrimary&&o){const c=i.columns.find(f=>f.isGenerated&&f.generationStrategy==="increment");if(c){const f=c.clone();f.isGenerated=!1,f.generationStrategy=void 0,s.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(f,!0)}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(t,!0)}`))}const u=i.primaryColumns;let h=u.map(f=>`\`${f.name}\``).join(", ");if(s.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${h})`)),u.push(t),h=u.map(f=>`\`${f.name}\``).join(", "),s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${h})`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),c){const f=c.clone();f.isGenerated=!1,f.generationStrategy=void 0,s.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(t,!0)}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(f,!0)}`))}}const l=i.indices.find(c=>c.columnNames.length===1&&c.columnNames[0]===t.name);if(l)s.push(this.createIndexSql(n,l)),a.push(this.dropIndexSql(n,l));else if(t.isUnique){const c=new mn({name:this.connection.namingStrategy.indexName(n,[t.name]),columnNames:[t.name],isUnique:!0});i.indices.push(c),i.uniques.push(new Qn({name:c.name,columnNames:c.columnNames})),s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD UNIQUE INDEX \`${c.name}\` (\`${t.name}\`)`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP INDEX \`${c.name}\``))}yield this.executeQueries(s,a),i.addColumn(t),this.replaceCachedTable(n,i)})}addColumns(e,t){return v(this,null,function*(){for(const n of t)yield this.addColumn(e,n)})}renameColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e),s=de.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!s)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);let a;de.isTableColumn(n)?a=n:(a=s.clone(),a.name=n),yield this.changeColumn(i,s,a)})}changeColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e);let s=i.clone();const a=[],o=[],l=de.isTableColumn(t)?t:i.columns.find(c=>c.name===t);if(!l)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);if(n.isGenerated!==l.isGenerated&&n.generationStrategy!=="uuid"||l.type!==n.type||l.length!==n.length||l.generatedType!==n.generatedType)yield this.dropColumn(i,l),yield this.addColumn(i,n),s=i.clone();else{if(n.name!==l.name){a.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${l.name}\` \`${n.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${n.name}\` \`${l.name}\` ${this.buildCreateColumnSql(l,!0,!0)}`)),s.findColumnIndices(l).forEach(u=>{u.columnNames.splice(u.columnNames.indexOf(l.name),1),u.columnNames.push(n.name);const h=u.columnNames.map(m=>`\`${m}\``).join(", "),f=this.connection.namingStrategy.indexName(s,u.columnNames,u.where);let d="";u.isUnique&&(d+="UNIQUE "),u.isSpatial&&(d+="SPATIAL "),u.isFulltext&&(d+="FULLTEXT "),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${u.name}\`, ADD ${d}INDEX \`${f}\` (${h})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${f}\`, ADD ${d}INDEX \`${u.name}\` (${h})`)),u.name=f}),s.findColumnForeignKeys(l).forEach(u=>{u.columnNames.splice(u.columnNames.indexOf(l.name),1),u.columnNames.push(n.name);const h=u.columnNames.map(T=>`\`${T}\``).join(", "),f=u.referencedColumnNames.map(T=>`\`${T}\``).join(","),d=this.connection.namingStrategy.foreignKeyName(s,u.columnNames);let m=`ALTER TABLE ${this.escapePath(i)} DROP FOREIGN KEY \`${u.name}\`, ADD CONSTRAINT \`${d}\` FOREIGN KEY (${h}) REFERENCES ${this.escapePath(this.getTablePath(u))}(${f})`;u.onDelete&&(m+=` ON DELETE ${u.onDelete}`),u.onUpdate&&(m+=` ON UPDATE ${u.onUpdate}`);let y=`ALTER TABLE ${this.escapePath(i)} DROP FOREIGN KEY \`${d}\`, ADD CONSTRAINT \`${u.name}\` FOREIGN KEY (${h}) REFERENCES ${this.escapePath(this.getTablePath(u))}(${f})`;u.onDelete&&(y+=` ON DELETE ${u.onDelete}`),u.onUpdate&&(y+=` ON UPDATE ${u.onUpdate}`),a.push(new Y(m)),o.push(new Y(y)),u.name=d});const c=s.columns.find(u=>u.name===l.name);s.columns[s.columns.indexOf(c)].name=n.name,l.name=n.name}if(this.isColumnChanged(l,n,!0)&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(n,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${n.name}\` ${this.buildCreateColumnSql(l,!0)}`))),n.isPrimary!==l.isPrimary){const c=s.columns.find(h=>h.isGenerated&&h.generationStrategy==="increment");if(c){const h=c.clone();h.isGenerated=!1,h.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(c,!0)}`))}const u=s.primaryColumns;if(u.length>0){const h=u.map(f=>`\`${f.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${h})`))}if(n.isPrimary===!0){u.push(n);const h=s.columns.find(d=>d.name===n.name);h.isPrimary=!0;const f=u.map(d=>`\`${d.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${f})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}else{const h=u.find(d=>d.name===n.name);u.splice(u.indexOf(h),1);const f=s.columns.find(d=>d.name===n.name);if(f.isPrimary=!1,u.length>0){const d=u.map(m=>`\`${m.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${d})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}}if(c){const h=c.clone();h.isGenerated=!1,h.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(c,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(h,!0)}`))}}if(n.isUnique!==l.isUnique)if(n.isUnique===!0){const c=new mn({name:this.connection.namingStrategy.indexName(i,[n.name]),columnNames:[n.name],isUnique:!0});s.indices.push(c),s.uniques.push(new Qn({name:c.name,columnNames:c.columnNames})),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD UNIQUE INDEX \`${c.name}\` (\`${n.name}\`)`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${c.name}\``))}else{const c=s.indices.find(h=>h.columnNames.length===1&&h.isUnique===!0&&!!h.columnNames.find(f=>f===n.name));s.indices.splice(s.indices.indexOf(c),1);const u=s.uniques.find(h=>h.name===c.name);s.uniques.splice(s.uniques.indexOf(u),1),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP INDEX \`${c.name}\``)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD UNIQUE INDEX \`${c.name}\` (\`${n.name}\`)`))}}yield this.executeQueries(a,o),this.replaceCachedTable(i,s)})}changeColumns(e,t){return v(this,null,function*(){for(const{oldColumn:n,newColumn:i}of t)yield this.changeColumn(e,n,i)})}dropColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableColumn(t)?t:n.findColumnByName(t);if(!i)throw new Z(`Column "${t}" was not found in table "${n.name}"`);const s=n.clone(),a=[],o=[];if(i.isPrimary){const c=s.columns.find(f=>f.isGenerated&&f.generationStrategy==="increment");if(c){const f=c.clone();f.isGenerated=!1,f.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(f,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(c,!0)}`))}const u=s.primaryColumns.map(f=>`\`${f.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(s)} DROP PRIMARY KEY`)),o.push(new Y(`ALTER TABLE ${this.escapePath(s)} ADD PRIMARY KEY (${u})`));const h=s.findColumnByName(i.name);if(h.isPrimary=!1,s.primaryColumns.length>0){const f=s.primaryColumns.map(d=>`\`${d.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(s)} ADD PRIMARY KEY (${f})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(s)} DROP PRIMARY KEY`))}if(c&&c.name!==i.name){const f=c.clone();f.isGenerated=!1,f.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(c,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${c.name}\` ${this.buildCreateColumnSql(f,!0)}`))}}const l=s.indices.find(c=>c.columnNames.length===1&&c.columnNames[0]===i.name);if(l)s.indices.splice(s.indices.indexOf(l),1),a.push(this.dropIndexSql(n,l)),o.push(this.createIndexSql(n,l));else if(i.isUnique){const c=this.connection.namingStrategy.uniqueConstraintName(n,[i.name]),u=s.uniques.find(d=>d.name===c);u&&s.uniques.splice(s.uniques.indexOf(u),1);const h=this.connection.namingStrategy.indexName(n,[i.name]),f=s.indices.find(d=>d.name===h);f&&s.indices.splice(s.indices.indexOf(f),1),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP INDEX \`${h}\``)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD UNIQUE INDEX \`${h}\` (\`${i.name}\`)`))}a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN \`${i.name}\``)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(i,!0)}`)),yield this.executeQueries(a,o),s.removeColumn(i),this.replaceCachedTable(n,s)})}dropColumns(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropColumn(e,n)})}createPrimaryKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone(),s=this.createPrimaryKeySql(n,t),a=this.dropPrimaryKeySql(n);yield this.executeQueries(s,a),i.columns.forEach(o=>{t.find(l=>l===o.name)&&(o.isPrimary=!0)}),this.replaceCachedTable(n,i)})}updatePrimaryKeys(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone(),s=t.map(f=>f.name),a=[],o=[],l=i.columns.find(f=>f.isGenerated&&f.generationStrategy==="increment");if(l){const f=l.clone();f.isGenerated=!1,f.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${l.name}\` ${this.buildCreateColumnSql(f,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(l,!0)}`))}const c=i.primaryColumns;if(c.length>0){const f=c.map(d=>`\`${d.name}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${f})`))}i.columns.filter(f=>s.indexOf(f.name)!==-1).forEach(f=>f.isPrimary=!0);const u=s.map(f=>`\`${f}\``).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${u})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`));const h=l||t.find(f=>f.isGenerated&&f.generationStrategy==="increment");if(h){const f=h.clone();f.isGenerated=!1,f.generationStrategy=void 0,a.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${f.name}\` ${this.buildCreateColumnSql(h,!0)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${h.name}\` ${this.buildCreateColumnSql(f,!0)}`));const d=i.columns.find(m=>m.name===h.name);d.isGenerated=!0,d.generationStrategy="increment"}yield this.executeQueries(a,o),this.replaceCachedTable(n,i)})}dropPrimaryKey(e){return v(this,null,function*(){const t=de.isTable(e)?e:yield this.getCachedTable(e),n=this.dropPrimaryKeySql(t),i=this.createPrimaryKeySql(t,t.primaryColumns.map(s=>s.name));yield this.executeQueries(n,i),t.primaryColumns.forEach(s=>{s.isPrimary=!1})})}createUniqueConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support unique constraints. Use unique index instead.")})}createUniqueConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support unique constraints. Use unique index instead.")})}dropUniqueConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support unique constraints. Use unique index instead.")})}dropUniqueConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support unique constraints. Use unique index instead.")})}createCheckConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support check constraints.")})}createCheckConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support check constraints.")})}dropCheckConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support check constraints.")})}dropCheckConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support check constraints.")})}createExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support exclusion constraints.")})}createExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support exclusion constraints.")})}dropExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("MySql does not support exclusion constraints.")})}dropExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("MySql does not support exclusion constraints.")})}createForeignKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames));const i=this.createForeignKeySql(n,t),s=this.dropForeignKeySql(n,t);yield this.executeQueries(i,s),n.addForeignKey(t)})}createForeignKeys(e,t){return v(this,null,function*(){const n=t.map(i=>this.createForeignKey(e,i));yield Promise.all(n)})}dropForeignKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableForeignKey(t)?t:n.foreignKeys.find(o=>o.name===t);if(!i)throw new Z(`Supplied foreign key was not found in table ${n.name}`);const s=this.dropForeignKeySql(n,i),a=this.createForeignKeySql(n,i);yield this.executeQueries(s,a),n.removeForeignKey(i)})}dropForeignKeys(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropForeignKey(e,i));yield Promise.all(n)})}createIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const i=this.createIndexSql(n,t),s=this.dropIndexSql(n,t);yield this.executeQueries(i,s),n.addIndex(t,!0)})}createIndices(e,t){return v(this,null,function*(){const n=t.map(i=>this.createIndex(e,i));yield Promise.all(n)})}dropIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableIndex(t)?t:n.indices.find(o=>o.name===t);if(!i)throw new Z(`Supplied index ${t} was not found in table ${n.name}`);i.name||(i.name=this.generateIndexName(n,i));const s=this.dropIndexSql(n,i),a=this.createIndexSql(n,i);yield this.executeQueries(s,a),n.removeIndex(i,!0)})}dropIndices(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropIndex(e,i));yield Promise.all(n)})}clearTable(e){return v(this,null,function*(){yield this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)})}clearDatabase(e){return v(this,null,function*(){const t=e||this.driver.database;if(t){if(!(yield this.hasDatabase(t)))return Promise.resolve()}else throw new Z("Can not clear database. No database is specified");const n=this.isTransactionActive;n||(yield this.startTransaction());try{const i=`SELECT concat('DROP VIEW IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`VIEWS\` WHERE \`TABLE_SCHEMA\` = '${t}'`,s=yield this.query(i);yield Promise.all(s.map(u=>this.query(u.query)));const a="SET FOREIGN_KEY_CHECKS = 0;",o=`SELECT concat('DROP TABLE IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_SCHEMA\` = '${t}'`,l="SET FOREIGN_KEY_CHECKS = 1;";yield this.query(a);const c=yield this.query(o);yield Promise.all(c.map(u=>this.query(u.query))),yield this.query(l),n||(yield this.commitTransaction())}catch(i){try{n||(yield this.rollbackTransaction())}catch(s){}throw i}})}loadViews(e){return v(this,null,function*(){if(!(yield this.hasTable(this.getTypeormMetadataTableName())))return[];e||(e=[]);const n=yield this.getCurrentDatabase(),i=e.map(o=>{let{database:l,tableName:c}=this.driver.parseTableName(o);return l||(l=n),`(\`t\`.\`schema\` = '${l}' AND \`t\`.\`name\` = '${c}')`}).join(" OR "),s=`SELECT \`t\`.*, \`v\`.\`check_option\` FROM ${this.escapePath(this.getTypeormMetadataTableName())} \`t\` INNER JOIN \`information_schema\`.\`views\` \`v\` ON \`v\`.\`table_schema\` = \`t\`.\`schema\` AND \`v\`.\`table_name\` = \`t\`.\`name\` WHERE \`t\`.\`type\` = '${wt.VIEW}' ${i?`AND (${i})`:""}`;return(yield this.query(s)).map(o=>{const l=new $i,c=o.schema===n?void 0:o.schema;return l.database=o.schema,l.name=this.driver.buildTableName(o.name,void 0,c),l.expression=o.value,l})})}loadTables(e){return v(this,null,function*(){if(e&&e.length===0)return[];const t=[],n=yield this.getCurrentDatabase();if(!e)t.push(...yield this.query("SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES`"));else{const S="SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES` WHERE "+e.map(N=>{let[C,I]=N.split(".");return I||(I=C,C=this.driver.database||n),`(\`TABLE_SCHEMA\` = '${C}' AND \`TABLE_NAME\` = '${I}')`}).join(" OR ");t.push(...yield this.query(S))}if(t.length===0)return[];const i=t.map(({TABLE_NAME:b,TABLE_SCHEMA:S})=>`(\`TABLE_SCHEMA\` = '${S}' AND \`TABLE_NAME\` = '${b}')`).join(" OR "),s="SELECT * FROM `INFORMATION_SCHEMA`.`COLUMNS` WHERE "+i,a=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` WHERE \`CONSTRAINT_NAME\` = 'PRIMARY' AND (${i})`,o="SELECT `SCHEMA_NAME`, `DEFAULT_CHARACTER_SET_NAME` as `CHARSET`, `DEFAULT_COLLATION_NAME` AS `COLLATION` FROM `INFORMATION_SCHEMA`.`SCHEMATA`",c=`SELECT \`s\`.* FROM \`INFORMATION_SCHEMA\`.\`STATISTICS\` \`s\` LEFT JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`rc\` ON \`s\`.\`INDEX_NAME\` = \`rc\`.\`CONSTRAINT_NAME\` WHERE (${t.map(({TABLE_NAME:b,TABLE_SCHEMA:S})=>`(\`s\`.\`TABLE_SCHEMA\` = '${S}' AND \`s\`.\`TABLE_NAME\` = '${b}')`).join(" OR ")}) AND \`s\`.\`INDEX_NAME\` != 'PRIMARY' AND \`rc\`.\`CONSTRAINT_NAME\` IS NULL`,h="SELECT `kcu`.`TABLE_SCHEMA`, `kcu`.`TABLE_NAME`, `kcu`.`CONSTRAINT_NAME`, `kcu`.`COLUMN_NAME`, `kcu`.`REFERENCED_TABLE_SCHEMA`, `kcu`.`REFERENCED_TABLE_NAME`, `kcu`.`REFERENCED_COLUMN_NAME`, `rc`.`DELETE_RULE` `ON_DELETE`, `rc`.`UPDATE_RULE` `ON_UPDATE` FROM `INFORMATION_SCHEMA`.`KEY_COLUMN_USAGE` `kcu` INNER JOIN `INFORMATION_SCHEMA`.`REFERENTIAL_CONSTRAINTS` `rc` ON `rc`.`constraint_name` = `kcu`.`constraint_name` WHERE "+t.map(({TABLE_NAME:b,TABLE_SCHEMA:S})=>`(\`kcu\`.\`TABLE_SCHEMA\` = '${S}' AND \`kcu\`.\`TABLE_NAME\` = '${b}')`).join(" OR "),[f,d,m,y,T]=yield Promise.all([this.query(s),this.query(a),this.query(o),this.query(c),this.query(h)]);return t.map(b=>{const S=new hn,N=m.find(V=>V.SCHEMA_NAME===b.TABLE_SCHEMA),C=N.COLLATION,I=N.CHARSET,H=b.TABLE_SCHEMA===n?void 0:b.TABLE_SCHEMA;S.database=b.TABLE_SCHEMA,S.name=this.driver.buildTableName(b.TABLE_NAME,void 0,H),S.columns=f.filter(V=>V.TABLE_NAME===b.TABLE_NAME&&V.TABLE_SCHEMA===b.TABLE_SCHEMA).map(V=>{const J=y.filter(B=>B.TABLE_NAME===b.TABLE_NAME&&B.TABLE_SCHEMA===b.TABLE_SCHEMA&&B.COLUMN_NAME===V.COLUMN_NAME&&parseInt(B.NON_UNIQUE,10)===0),E=this.connection.entityMetadatas.find(B=>this.getTablePath(S)===this.getTablePath(B)),A=J.length>0&&E&&E.indices.some(B=>J.some(K=>B.name===K.INDEX_NAME&&B.synchronize===!1)),x=J.every(B=>y.some(K=>K.INDEX_NAME===B.INDEX_NAME&&K.COLUMN_NAME!==V.COLUMN_NAME)),$=new ar;if($.name=V.COLUMN_NAME,$.type=V.DATA_TYPE.toLowerCase(),$.zerofill=V.COLUMN_TYPE.includes("zerofill"),$.unsigned=$.zerofill||V.COLUMN_TYPE.includes("unsigned"),this.driver.unsignedColumnTypes.includes($.type)){const B=V.COLUMN_TYPE.substring(V.COLUMN_TYPE.indexOf("(")+1,V.COLUMN_TYPE.indexOf(")"));$.width=B&&!this.isDefaultColumnWidth(S,$,parseInt(B))?parseInt(B):void 0}if(V.COLUMN_DEFAULT===null||V.COLUMN_DEFAULT===void 0?$.default=void 0:$.default=V.COLUMN_DEFAULT==="CURRENT_TIMESTAMP"?V.COLUMN_DEFAULT:`'${V.COLUMN_DEFAULT}'`,V.EXTRA.indexOf("on update")!==-1&&($.onUpdate=V.EXTRA.substring(V.EXTRA.indexOf("on update")+10)),V.GENERATION_EXPRESSION&&($.asExpression=V.GENERATION_EXPRESSION,$.generatedType=V.EXTRA.indexOf("VIRTUAL")!==-1?"VIRTUAL":"STORED"),$.isUnique=J.length>0&&!A&&!x,$.isNullable=V.IS_NULLABLE==="YES",$.isPrimary=d.some(B=>B.TABLE_NAME===V.TABLE_NAME&&B.TABLE_SCHEMA===V.TABLE_SCHEMA&&B.COLUMN_NAME===V.COLUMN_NAME),$.zerofill=V.COLUMN_TYPE.indexOf("zerofill")!==-1,$.isGenerated=V.EXTRA.indexOf("auto_increment")!==-1,$.isGenerated&&($.generationStrategy="increment"),$.comment=typeof V.COLUMN_COMMENT=="string"&&V.COLUMN_COMMENT.length===0?void 0:V.COLUMN_COMMENT,V.CHARACTER_SET_NAME&&($.charset=V.CHARACTER_SET_NAME===I?void 0:V.CHARACTER_SET_NAME),V.COLLATION_NAME&&($.collation=V.COLLATION_NAME===C?void 0:V.COLLATION_NAME),this.driver.withLengthColumnTypes.indexOf($.type)!==-1&&V.CHARACTER_MAXIMUM_LENGTH){const B=V.CHARACTER_MAXIMUM_LENGTH.toString();$.length=this.isDefaultColumnLength(S,$,B)?"":B}if(($.type==="decimal"||$.type==="double"||$.type==="float")&&(V.NUMERIC_PRECISION!==null&&!this.isDefaultColumnPrecision(S,$,V.NUMERIC_PRECISION)&&($.precision=parseInt(V.NUMERIC_PRECISION)),V.NUMERIC_SCALE!==null&&!this.isDefaultColumnScale(S,$,V.NUMERIC_SCALE)&&($.scale=parseInt(V.NUMERIC_SCALE))),$.type==="enum"||$.type==="simple-enum"||$.type==="set"){const B=V.COLUMN_TYPE,K=B.substring(B.indexOf("(")+1,B.lastIndexOf(")")).split(",");$.enum=K.map(ae=>ae.substring(1,ae.length-1)),$.length=""}return($.type==="datetime"||$.type==="time"||$.type==="timestamp")&&V.DATETIME_PRECISION!==null&&V.DATETIME_PRECISION!==void 0&&!this.isDefaultColumnPrecision(S,$,parseInt(V.DATETIME_PRECISION))&&($.precision=parseInt(V.DATETIME_PRECISION)),$});const Q=ke.uniq(T.filter(V=>V.TABLE_NAME===b.TABLE_NAME&&V.TABLE_SCHEMA===b.TABLE_SCHEMA),V=>V.CONSTRAINT_NAME);S.foreignKeys=Q.map(V=>{const J=T.filter(x=>x.CONSTRAINT_NAME===V.CONSTRAINT_NAME),E=V.REFERENCED_TABLE_SCHEMA===n?void 0:V.REFERENCED_TABLE_SCHEMA,A=this.driver.buildTableName(V.REFERENCED_TABLE_NAME,void 0,E);return new Mr({name:V.CONSTRAINT_NAME,columnNames:J.map(x=>x.COLUMN_NAME),referencedDatabase:V.REFERENCED_TABLE_SCHEMA,referencedTableName:A,referencedColumnNames:J.map(x=>x.REFERENCED_COLUMN_NAME),onDelete:V.ON_DELETE,onUpdate:V.ON_UPDATE})});const te=ke.uniq(y.filter(V=>V.TABLE_NAME===b.TABLE_NAME&&V.TABLE_SCHEMA===b.TABLE_SCHEMA),V=>V.INDEX_NAME);return S.indices=te.map(V=>{const J=y.filter(A=>A.TABLE_SCHEMA===V.TABLE_SCHEMA&&A.TABLE_NAME===V.TABLE_NAME&&A.INDEX_NAME===V.INDEX_NAME),E=parseInt(V.NON_UNIQUE,10);return new mn({table:S,name:V.INDEX_NAME,columnNames:J.map(A=>A.COLUMN_NAME),isUnique:E===0,isSpatial:V.INDEX_TYPE==="SPATIAL",isFulltext:V.INDEX_TYPE==="FULLTEXT"})}),S})})}createTableSql(e,t){const n=e.columns.map(s=>this.buildCreateColumnSql(s,!0)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter(s=>s.isUnique).forEach(s=>{const a=e.indices.some(l=>l.columnNames.length===1&&!!l.isUnique&&l.columnNames.indexOf(s.name)!==-1),o=e.uniques.some(l=>l.columnNames.length===1&&l.columnNames.indexOf(s.name)!==-1);!a&&!o&&e.indices.push(new mn({name:this.connection.namingStrategy.uniqueConstraintName(e,[s.name]),columnNames:[s.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(s=>{e.indices.some(o=>o.name===s.name)||e.indices.push(new mn({name:s.name,columnNames:s.columnNames,isUnique:!0}))}),e.indices.length>0){const s=e.indices.map(a=>{const o=a.columnNames.map(c=>`\`${c}\``).join(", ");a.name||(a.name=this.connection.namingStrategy.indexName(e,a.columnNames,a.where));let l="";return a.isUnique&&(l+="UNIQUE "),a.isSpatial&&(l+="SPATIAL "),a.isFulltext&&(l+="FULLTEXT "),`${l}INDEX \`${a.name}\` (${o})`}).join(", ");i+=`, ${s}`}if(e.foreignKeys.length>0&&t){const s=e.foreignKeys.map(a=>{const o=a.columnNames.map(u=>`\`${u}\``).join(", ");a.name||(a.name=this.connection.namingStrategy.foreignKeyName(e,a.columnNames));const l=a.referencedColumnNames.map(u=>`\`${u}\``).join(", ");let c=`CONSTRAINT \`${a.name}\` FOREIGN KEY (${o}) REFERENCES ${this.escapePath(this.getTablePath(a))} (${l})`;return a.onDelete&&(c+=` ON DELETE ${a.onDelete}`),a.onUpdate&&(c+=` ON UPDATE ${a.onUpdate}`),c}).join(", ");i+=`, ${s}`}if(e.primaryColumns.length>0){const s=e.primaryColumns.map(a=>`\`${a.name}\``).join(", ");i+=`, PRIMARY KEY (${s})`}return i+=`) ENGINE=${e.engine||"InnoDB"}`,new Y(i)}dropTableSql(e){return new Y(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){return typeof e.expression=="string"?new Y(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression}`):new Y(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){return v(this,null,function*(){const t=yield this.getCurrentDatabase(),n=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:wt.VIEW,schema:t,name:e.name,value:n})})}dropViewSql(e){return new Y(`DROP VIEW ${this.escapePath(e)}`)}deleteViewDefinitionSql(e){return v(this,null,function*(){const t=yield this.getCurrentDatabase(),n=de.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:wt.VIEW,schema:t,name:n})})}createIndexSql(e,t){const n=t.columnNames.map(s=>`\`${s}\``).join(", ");let i="";return t.isUnique&&(i+="UNIQUE "),t.isSpatial&&(i+="SPATIAL "),t.isFulltext&&(i+="FULLTEXT "),new Y(`CREATE ${i}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${n})`)}dropIndexSql(e,t){const n=de.isTableIndex(t)?t.name:t;return new Y(`DROP INDEX \`${n}\` ON ${this.escapePath(e)}`)}createPrimaryKeySql(e,t){const n=t.map(i=>`\`${i}\``).join(", ");return new Y(`ALTER TABLE ${this.escapePath(e)} ADD PRIMARY KEY (${n})`)}dropPrimaryKeySql(e){return new Y(`ALTER TABLE ${this.escapePath(e)} DROP PRIMARY KEY`)}createForeignKeySql(e,t){const n=t.columnNames.map(a=>`\`${a}\``).join(", "),i=t.referencedColumnNames.map(a=>`\`${a}\``).join(",");let s=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${i})`;return t.onDelete&&(s+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(s+=` ON UPDATE ${t.onUpdate}`),new Y(s)}dropForeignKeySql(e,t){const n=de.isTableForeignKey(t)?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP FOREIGN KEY \`${n}\``)}escapeComment(e){return!e||e.length===0?"''":(e=e.replace(/\\/g,"\\\\").replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{database:t,tableName:n}=this.driver.parseTableName(e);return t&&t!==this.driver.database?`\`${t}\`.\`${n}\``:`\`${n}\``}buildCreateColumnSql(e,t,n=!1){let i="";return n?i=this.connection.driver.createFullType(e):i=`\`${e.name}\` ${this.connection.driver.createFullType(e)}`,e.asExpression&&(i+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`),e.zerofill?i+=" ZEROFILL":e.unsigned&&(i+=" UNSIGNED"),e.enum&&(i+=` (${e.enum.map(s=>"'"+s+"'").join(", ")})`),e.charset&&(i+=` CHARACTER SET "${e.charset}"`),e.collation&&(i+=` COLLATE "${e.collation}"`),e.isNullable||(i+=" NOT NULL"),e.isNullable&&(i+=" NULL"),e.isPrimary&&!t&&(i+=" PRIMARY KEY"),e.isGenerated&&e.generationStrategy==="increment"&&(i+=" AUTO_INCREMENT"),e.comment&&(i+=` COMMENT ${this.escapeComment(e.comment)}`),e.default!==void 0&&e.default!==null&&(i+=` DEFAULT ${e.default}`),e.onUpdate&&(i+=` ON UPDATE ${e.onUpdate}`),i}isDefaultColumnWidth(e,t,n){if(this.connection.hasMetadata(e.name)){const a=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(a&&a.width)return!1}const i=this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].width;if(i){const a=["int","tinyint","smallint","mediumint"].indexOf(t.type)!==-1;return t.unsigned&&a?i-1===n:i===n}return!1}changeTableComment(e,t){throw new Z("aurora-mysql driver does not support change table comment.")}}class J3{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["bit","int","integer","tinyint","smallint","mediumint","bigint","float","double","double precision","real","decimal","dec","numeric","fixed","bool","boolean","date","datetime","timestamp","time","year","char","nchar","national char","varchar","nvarchar","national varchar","blob","text","tinyblob","tinytext","mediumblob","mediumtext","longblob","longtext","enum","set","binary","varbinary","json","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.supportedUpsertTypes=["on-duplicate-key-update"],this.spatialTypes=["geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.withLengthColumnTypes=["char","varchar","nvarchar","binary","varbinary"],this.unsignedColumnTypes=["tinyint","smallint","mediumint","int","integer","bigint"],this.withPrecisionColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real","time","datetime","timestamp"],this.withScaleColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real"],this.mappedDataTypes={createDate:"datetime",createDatePrecision:6,createDateDefault:"CURRENT_TIMESTAMP(6)",updateDate:"datetime",updateDatePrecision:6,updateDateDefault:"CURRENT_TIMESTAMP(6)",deleteDate:"datetime",deleteDatePrecision:6,deleteDateNullable:!0,version:"int",treeLevel:"int",migrationId:"int",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.dataTypeDefaults={varchar:{length:255},nvarchar:{length:255},"national varchar":{length:255},char:{length:1},binary:{length:1},varbinary:{length:255},decimal:{precision:10,scale:0},dec:{precision:10,scale:0},numeric:{precision:10,scale:0},fixed:{precision:10,scale:0},float:{precision:12},double:{precision:22},time:{precision:0},datetime:{precision:0},timestamp:{precision:0},bit:{width:1},int:{width:11},integer:{width:11},tinyint:{width:4},smallint:{width:6},mediumint:{width:9},bigint:{width:20}},this.maxAliasLength=63,this.cteCapabilities={enabled:!1},this.connection=e,this.options=e.options,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,n)=>this.connection.logger.logQuery(t,n),this.options.serviceConfigOptions,this.options.formatOptions),this.database=Be.buildDriverOptions(this.options).database}connect(){return v(this,null,function*(){if(!this.database){const e=this.createQueryRunner("master");this.database=yield e.getCurrentDatabase(),yield e.release()}})}afterConnect(){return Promise.resolve()}disconnect(){return v(this,null,function*(){})}createSchemaBuilder(){return new uh(this.connection)}createQueryRunner(e){return new Y3(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,n)=>this.connection.logger.logQuery(t,n),this.options.serviceConfigOptions,this.options.formatOptions))}escapeQueryWithParameters(e,t,n){const i=Object.keys(n).map(s=>n[s]);return!t||!Object.keys(t).length?[e,i]:(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(s,a,o)=>{if(!t.hasOwnProperty(o))return s;const l=t[o];return a?l.map(c=>(i.push(c),this.createParameter(o,i.length-1))).join(", "):typeof l=="function"?l():(i.push(l),this.createParameter(o,i.length-1))}),[e,i])}escape(e){return"`"+e+"`"}buildTableName(e,t,n){const i=[e];return n&&i.unshift(n),i.join(".")}parseTableName(e){const t=this.database,n=void 0;if(de.isTable(e)||de.isView(e)){const s=this.parseTableName(e.name);return{database:e.database||s.database||t,schema:e.schema||s.schema||n,tableName:s.tableName}}if(de.isTableForeignKey(e)){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||t,schema:e.referencedSchema||s.schema||n,tableName:s.tableName}}if(de.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const i=e.split(".");return{database:(i.length>1?i[0]:void 0)||t,schema:n,tableName:i.length>1?i[1]:i[0]}}preparePersistentValue(e,t){return t.transformer&&(e=An.transformTo(t.transformer,e)),!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.preparePersistentValue(e,t):e==null?e:t.type===Boolean?e===!0?1:0:t.type==="date"?dt.mixedDateToDateString(e):t.type==="time"?dt.mixedDateToTimeString(e):t.type==="json"?JSON.stringify(e):t.type==="timestamp"||t.type==="datetime"||t.type===Date?dt.mixedDateToDate(e):t.type==="simple-array"||t.type==="set"?dt.simpleArrayToString(e):t.type==="simple-json"?dt.simpleJsonToString(e):t.type==="enum"||t.type==="simple-enum"?""+e:e}prepareHydratedValue(e,t){return e==null?t.transformer?An.transformFrom(t.transformer,e):e:!this.options.formatOptions||this.options.formatOptions.castParameters!==!1?this.client.prepareHydratedValue(e,t):(t.type===Boolean||t.type==="bool"||t.type==="boolean"?e=!!e:t.type==="datetime"||t.type===Date?e=dt.normalizeHydratedDate(e):t.type==="date"?e=dt.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type==="time"?e=dt.mixedTimeToString(e):t.type==="simple-array"||t.type==="set"?e=dt.stringToSimpleArray(e):t.type==="simple-json"?e=dt.stringToSimpleJson(e):(t.type==="enum"||t.type==="simple-enum")&&t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0?e=parseInt(e):t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=An.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number||e.type==="integer"?"int":e.type===String?"varchar":e.type===Date?"datetime":e.type===Buffer?"blob":e.type===Boolean?"tinyint":e.type==="uuid"?"varchar":e.type==="simple-array"||e.type==="simple-json"?"text":e.type==="simple-enum"?"enum":e.type==="double precision"||e.type==="real"?"double":e.type==="dec"||e.type==="numeric"||e.type==="fixed"?"decimal":e.type==="bool"||e.type==="boolean"?"tinyint":e.type==="nvarchar"||e.type==="national varchar"?"varchar":e.type==="nchar"||e.type==="national char"?"char":e.type||""}normalizeDefault(e){const t=e.default;if(t!==null){if((e.type==="enum"||e.type==="simple-enum")&&t!==void 0)return`'${t}'`;if(e.type==="set"&&t!==void 0)return`'${dt.simpleArrayToString(t)}'`;if(typeof t=="number")return`${t}`;if(typeof t=="boolean")return t?"1":"0";if(typeof t=="function")return t();if(typeof t=="string")return`'${t}'`;if(t!==void 0)return`${t}`}}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"varchar":case"nvarchar":case"national varchar":return"255";case"varbinary":return"255";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t+=" array"),t}obtainMasterConnection(){return new Promise((e,t)=>{this.poolCluster?this.poolCluster.getConnection("MASTER",(n,i)=>{n?t(n):e(this.prepareDbConnection(i))}):this.pool?this.pool.getConnection((n,i)=>{n?t(n):e(this.prepareDbConnection(i))}):t(new Z("Connection is not established with mysql database"))})}obtainSlaveConnection(){return this.poolCluster?new Promise((e,t)=>{this.poolCluster.getConnection("SLAVE*",(n,i)=>{n?t(n):e(this.prepareDbConnection(i))})}):this.obtainMasterConnection()}createGeneratedMap(e,t,n){const i=e.generatedColumns.reduce((s,a)=>{let o;return a.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+n),ke.mergeDeep(s,a.createValueMap(o))},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(n=>{const i=e.find(a=>a.name===n.databaseName);if(!i)return!1;let s=n.length;return!s&&n.generationStrategy==="uuid"&&(s=this.getColumnLength(n)),i.name!==n.databaseName||i.type!==this.normalizeType(n)||i.length!==s||i.width!==n.width||i.precision!==n.precision||i.scale!==n.scale||i.zerofill!==n.zerofill||i.unsigned!==n.unsigned||i.asExpression!==n.asExpression||i.generatedType!==n.generatedType||i.comment!==this.escapeComment(n.comment)||!this.compareDefaultValues(this.normalizeDefault(n),i.default)||i.enum&&n.enum&&!ke.isArraysEqual(i.enum,n.enum.map(a=>a+""))||i.onUpdate!==n.onUpdate||i.isPrimary!==n.isPrimary||i.isNullable!==n.isNullable||i.isUnique!==this.normalizeIsUnique(n)||n.generationStrategy!=="uuid"&&i.isGenerated!==n.isGenerated})}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!0}createParameter(e,t){return"?"}loadDependencies(){const e=this.options.driver||Kt.load("typeorm-aurora-data-api-driver");this.DataApiDriver=e,this.DataApiDriver=this.DataApiDriver.default||this.DataApiDriver}createConnectionOptions(e,t){return t=Object.assign({},t,Be.buildDriverOptions(t)),Object.assign({},{resourceArn:e.resourceArn,secretArn:e.secretArn,database:e.database,region:e.region,type:e.type},{host:t.host,user:t.username,password:t.password,database:t.database,port:t.port,ssl:e.ssl},e.extra||{})}createPool(e){return v(this,null,function*(){return{}})}prepareDbConnection(e){const{logger:t}=this.connection;return e.listeners("error").length===0&&e.on("error",n=>t.log("warn",`MySQL connection raised an error. ${n}`)),e}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class X3 extends hh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new gi(this)}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const n=i=>this.releasePostgresConnection(i);return this.releaseCallback=i=>{this.databaseConnection.removeListener("error",n),t(i)},this.databaseConnection.on("error",n),this.databaseConnection}):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const n=i=>this.releasePostgresConnection(i);return this.releaseCallback=i=>{this.databaseConnection.removeListener("error",n),t(i)},this.databaseConnection.on("error",n),this.databaseConnection}),this.databaseConnectionPromise)}releasePostgresConnection(e){return v(this,null,function*(){if(this.isReleased)return;this.isReleased=!0,this.releaseCallback&&(this.releaseCallback(e),this.releaseCallback=void 0);const t=this.driver.connectedQueryRunners.indexOf(this);t!==-1&&this.driver.connectedQueryRunners.splice(t,1)})}release(){return this.releasePostgresConnection()}startTransaction(e){return v(this,null,function*(){this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?(yield this.query("START TRANSACTION"),e&&(yield this.query("SET TRANSACTION ISOLATION LEVEL "+e))):yield this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?yield this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?yield this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.connect();this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const s=new Or;try{const a=Date.now(),o=yield i.query(e,t),l=this.driver.options.maxQueryExecutionTime,u=Date.now()-a;this.broadcaster.broadcastAfterQueryEvent(s,e,t,!0,u,o,void 0),l&&u>l&&this.driver.connection.logger.logQuerySlow(u,e,t,this);const h=new Zr;if(o){switch(o.hasOwnProperty("rows")&&(h.records=o.rows),o.hasOwnProperty("rowCount")&&(h.affected=o.rowCount),o.command){case"DELETE":case"UPDATE":h.raw=[o.rows,o.rowCount];break;default:h.raw=o.rows}if(!n)return h.raw}return h}catch(a){throw this.driver.connection.logger.logQueryError(a,e,t,this),this.broadcaster.broadcastAfterQueryEvent(s,e,t,!1,void 0,void 0,a),new zr(e,t,a)}finally{yield s.wait()}})}stream(e,t,n,i){return v(this,null,function*(){const s=this.driver.loadStreamDependency();if(this.isReleased)throw new zn;const a=yield this.connect();this.driver.connection.logger.logQuery(e,t,this);const o=a.query(new s(e,t));return n&&o.on("end",n),i&&o.on("error",i),o})}getDatabases(){return v(this,null,function*(){return Promise.resolve([])})}getSchemas(e){return v(this,null,function*(){return Promise.resolve([])})}hasDatabase(e){return v(this,null,function*(){return!!(yield this.query(`SELECT * FROM pg_database WHERE datname='${e}';`)).length})}getCurrentDatabase(){return v(this,null,function*(){return(yield this.query("SELECT * FROM current_database()"))[0].current_database})}hasSchema(e){return v(this,null,function*(){return!!(yield this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length})}getCurrentSchema(){return v(this,null,function*(){return(yield this.query("SELECT * FROM current_schema()"))[0].current_schema})}hasTable(e){return v(this,null,function*(){const t=this.driver.parseTableName(e);t.schema||(t.schema=yield this.getCurrentSchema());const n=`SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '${t.schema}' AND "table_name" = '${t.tableName}'`;return!!(yield this.query(n)).length})}hasColumn(e,t){return v(this,null,function*(){const n=this.driver.parseTableName(e);n.schema||(n.schema=yield this.getCurrentSchema());const i=`SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '${n.schema}' AND "table_name" = '${n.tableName}' AND "column_name" = '${t}'`;return!!(yield this.query(i)).length})}createDatabase(e,t){return v(this,null,function*(){if(t&&(yield this.hasDatabase(e)))return Promise.resolve();const n=`CREATE DATABASE "${e}"`,i=`DROP DATABASE "${e}"`;yield this.executeQueries(new Y(n),new Y(i))})}dropDatabase(e,t){return v(this,null,function*(){const n=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,i=`CREATE DATABASE "${e}"`;yield this.executeQueries(new Y(n),new Y(i))})}createSchema(e,t){return v(this,null,function*(){const n=e.indexOf(".")===-1?e:e.split(".")[1],i=t?`CREATE SCHEMA IF NOT EXISTS "${n}"`:`CREATE SCHEMA "${n}"`,s=`DROP SCHEMA "${n}" CASCADE`;yield this.executeQueries(new Y(i),new Y(s))})}dropSchema(e,t,n){return v(this,null,function*(){const i=e.indexOf(".")===-1?e:e.split(".")[1],s=t?`DROP SCHEMA IF EXISTS "${i}" ${n?"CASCADE":""}`:`DROP SCHEMA "${i}" ${n?"CASCADE":""}`,a=`CREATE SCHEMA "${i}"`;yield this.executeQueries(new Y(s),new Y(a))})}createTable(e,t=!1,n=!0,i=!0){return v(this,null,function*(){if(t&&(yield this.hasTable(e)))return Promise.resolve();const s=[],a=[],o=e.columns.filter(u=>u.type==="enum"||u.type==="simple-enum"),l=[];for(const u of o){const h=yield this.hasEnumType(e,u),f=this.buildEnumName(e,u);!h&&l.indexOf(f)===-1&&(l.push(f),s.push(this.createEnumTypeSql(e,u,f)),a.push(this.dropEnumTypeSql(e,u,f)))}const c=e.columns.filter(u=>u.generatedType==="STORED"&&u.asExpression);for(const u of c){const h=(yield this.getTableNameWithSchema(e.name)).split("."),f=h[1],d=h[0],m=this.insertTypeormMetadataSql({database:this.driver.database,schema:d,table:f,type:wt.GENERATED_COLUMN,name:u.name,value:u.asExpression}),y=this.deleteTypeormMetadataSql({database:this.driver.database,schema:d,table:f,type:wt.GENERATED_COLUMN,name:u.name});s.push(m),a.push(y)}s.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach(u=>a.push(this.dropForeignKeySql(e,u))),i&&e.indices.forEach(u=>{u.name||(u.name=this.connection.namingStrategy.indexName(e,u.columnNames,u.where)),s.push(this.createIndexSql(e,u)),a.push(this.dropIndexSql(e,u))}),e.comment&&(s.push(new Y("COMMENT ON TABLE "+this.escapePath(e)+" IS '"+e.comment+"'")),a.push(new Y("COMMENT ON TABLE "+this.escapePath(e)+" IS NULL"))),yield this.executeQueries(s,a)})}dropTable(e,t,n=!0,i=!0){return v(this,null,function*(){if(t&&!(yield this.hasTable(e)))return Promise.resolve();const s=n,a=this.getTablePath(e),o=yield this.getCachedTable(a),l=[],c=[];i&&o.indices.forEach(h=>{l.push(this.dropIndexSql(o,h)),c.push(this.createIndexSql(o,h))}),n&&o.foreignKeys.forEach(h=>l.push(this.dropForeignKeySql(o,h))),l.push(this.dropTableSql(o)),c.push(this.createTableSql(o,s));const u=o.columns.filter(h=>h.generatedType&&h.asExpression);for(const h of u){const f=(yield this.getTableNameWithSchema(o.name)).split("."),d=f[1],m=f[0],y=this.deleteTypeormMetadataSql({database:this.driver.database,schema:m,table:d,type:wt.GENERATED_COLUMN,name:h.name}),T=this.insertTypeormMetadataSql({database:this.driver.database,schema:m,table:d,type:wt.GENERATED_COLUMN,name:h.name,value:h.asExpression});l.push(y),c.push(T)}yield this.executeQueries(l,c)})}createView(e,t=!1){return v(this,null,function*(){const n=[],i=[];n.push(this.createViewSql(e)),t&&n.push(yield this.insertViewDefinitionSql(e)),i.push(this.dropViewSql(e)),t&&i.push(yield this.deleteViewDefinitionSql(e)),yield this.executeQueries(n,i)})}dropView(e){return v(this,null,function*(){const t=de.isView(e)?e.name:e,n=yield this.getCachedView(t),i=[],s=[];i.push(yield this.deleteViewDefinitionSql(n)),i.push(this.dropViewSql(n)),s.push(yield this.insertViewDefinitionSql(n)),s.push(this.createViewSql(n)),yield this.executeQueries(i,s)})}renameTable(e,t){return v(this,null,function*(){const n=[],i=[],s=de.isTable(e)?e:yield this.getCachedTable(e),a=s.clone(),{schema:o,tableName:l}=this.driver.parseTableName(s);if(a.name=o?`${o}.${t}`:t,n.push(new Y(`ALTER TABLE ${this.escapePath(s)} RENAME TO "${t}"`)),i.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME TO "${l}"`)),a.primaryColumns.length>0&&!a.primaryColumns[0].primaryKeyConstraintName){const u=a.primaryColumns.map(d=>d.name),h=this.connection.namingStrategy.primaryKeyName(s,u),f=this.connection.namingStrategy.primaryKeyName(a,u);n.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${h}" TO "${f}"`)),i.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${h}"`))}a.columns.map(u=>{if(u.isGenerated&&u.generationStrategy==="increment"){const h=this.buildSequencePath(s,u.name),f=this.buildSequenceName(s,u.name),d=this.buildSequencePath(a,u.name),m=this.buildSequenceName(a,u.name),y=`ALTER SEQUENCE ${this.escapePath(h)} RENAME TO "${m}"`,T=`ALTER SEQUENCE ${this.escapePath(d)} RENAME TO "${f}"`;n.push(new Y(y)),i.push(new Y(T))}}),a.uniques.forEach(u=>{const h=this.connection.namingStrategy.uniqueConstraintName(s,u.columnNames);if(u.name!==h)return;const f=this.connection.namingStrategy.uniqueConstraintName(a,u.columnNames);n.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${u.name}" TO "${f}"`)),i.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${u.name}"`)),u.name=f}),a.indices.forEach(u=>{const h=this.connection.namingStrategy.indexName(s,u.columnNames,u.where);if(u.name!==h)return;const{schema:f}=this.driver.parseTableName(a),d=this.connection.namingStrategy.indexName(a,u.columnNames,u.where),m=f?`ALTER INDEX "${f}"."${u.name}" RENAME TO "${d}"`:`ALTER INDEX "${u.name}" RENAME TO "${d}"`,y=f?`ALTER INDEX "${f}"."${d}" RENAME TO "${u.name}"`:`ALTER INDEX "${d}" RENAME TO "${u.name}"`;n.push(new Y(m)),i.push(new Y(y)),u.name=d}),a.foreignKeys.forEach(u=>{const h=this.connection.namingStrategy.foreignKeyName(s,u.columnNames,this.getTablePath(u),u.referencedColumnNames);if(u.name!==h)return;const f=this.connection.namingStrategy.foreignKeyName(a,u.columnNames,this.getTablePath(u),u.referencedColumnNames);n.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${u.name}" TO "${f}"`)),i.push(new Y(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${f}" TO "${u.name}"`)),u.name=f});const c=a.columns.filter(u=>u.type==="enum"||u.type==="simple-enum");for(const u of c){if(u.enumName)continue;const h=yield this.getUserDefinedTypeName(s,u);n.push(new Y(`ALTER TYPE "${h.schema}"."${h.name}" RENAME TO ${this.buildEnumName(a,u,!1)}`)),i.push(new Y(`ALTER TYPE ${this.buildEnumName(a,u)} RENAME TO "${h.name}"`))}yield this.executeQueries(n,i)})}addColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone(),s=[],a=[];if((t.type==="enum"||t.type==="simple-enum")&&((yield this.hasEnumType(n,t))||(s.push(this.createEnumTypeSql(n,t)),a.push(this.dropEnumTypeSql(n,t)))),s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(n,t)}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN "${t.name}"`)),t.isPrimary){const l=i.primaryColumns;if(l.length>0){const h=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,l.map(d=>d.name)),f=l.map(d=>`"${d.name}"`).join(", ");s.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${h}"`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${h}" PRIMARY KEY (${f})`))}l.push(t);const c=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,l.map(h=>h.name)),u=l.map(h=>`"${h.name}"`).join(", ");s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${c}" PRIMARY KEY (${u})`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${c}"`))}const o=i.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o&&(s.push(this.createIndexSql(n,o)),a.push(this.dropIndexSql(n,o))),t.isUnique){const l=new Qn({name:this.connection.namingStrategy.uniqueConstraintName(n,[t.name]),columnNames:[t.name]});i.uniques.push(l),s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${l.name}" UNIQUE ("${t.name}")`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${l.name}"`))}if(t.generatedType==="STORED"&&t.asExpression){const l=(yield this.getTableNameWithSchema(n.name)).split("."),c=l[1],u=l[0],h=this.insertTypeormMetadataSql({database:this.driver.database,schema:u,table:c,type:wt.GENERATED_COLUMN,name:t.name,value:t.asExpression}),f=this.deleteTypeormMetadataSql({database:this.driver.database,schema:u,table:c,type:wt.GENERATED_COLUMN,name:t.name});s.push(h),a.push(f)}t.comment&&(s.push(new Y(`COMMENT ON COLUMN ${this.escapePath(n)}."${t.name}" IS ${this.escapeComment(t.comment)}`)),a.push(new Y(`COMMENT ON COLUMN ${this.escapePath(n)}."${t.name}" IS ${this.escapeComment(t.comment)}`))),yield this.executeQueries(s,a),i.addColumn(t),this.replaceCachedTable(n,i)})}addColumns(e,t){return v(this,null,function*(){for(const n of t)yield this.addColumn(e,n)})}renameColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e),s=de.isTableColumn(t)?t:i.columns.find(o=>o.name===t);if(!s)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);let a;return de.isTableColumn(n)?a=n:(a=s.clone(),a.name=n),this.changeColumn(i,s,a)})}changeColumn(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e);let s=i.clone();const a=[],o=[];let l=!1;const c=de.isTableColumn(t)?t:i.columns.find(u=>u.name===t);if(!c)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);if(c.type!==n.type||c.length!==n.length||n.isArray!==c.isArray||!c.generatedType&&n.generatedType==="STORED"||c.asExpression!==n.asExpression&&n.generatedType==="STORED")yield this.dropColumn(i,c),yield this.addColumn(i,n),s=i.clone();else{if(c.name!==n.name){if(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${c.name}" TO "${n.name}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${n.name}" TO "${c.name}"`)),c.type==="enum"||c.type==="simple-enum"){const h=yield this.getUserDefinedTypeName(i,c);a.push(new Y(`ALTER TYPE "${h.schema}"."${h.name}" RENAME TO ${this.buildEnumName(i,n,!1)}`)),o.push(new Y(`ALTER TYPE ${this.buildEnumName(i,n)} RENAME TO "${h.name}"`))}if(c.isPrimary===!0&&!c.primaryKeyConstraintName){const f=s.primaryColumns.map(y=>y.name),d=this.connection.namingStrategy.primaryKeyName(s,f);f.splice(f.indexOf(c.name),1),f.push(n.name);const m=this.connection.namingStrategy.primaryKeyName(s,f);a.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${d}" TO "${m}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${m}" TO "${d}"`))}if(c.isGenerated===!0&&n.generationStrategy==="increment"){const h=this.buildSequencePath(i,c.name),f=this.buildSequenceName(i,c.name),d=this.buildSequencePath(i,n.name),m=this.buildSequenceName(i,n.name),y=`ALTER SEQUENCE ${this.escapePath(h)} RENAME TO "${m}"`,T=`ALTER SEQUENCE ${this.escapePath(d)} RENAME TO "${f}"`;a.push(new Y(y)),o.push(new Y(T))}s.findColumnUniques(c).forEach(h=>{const f=this.connection.namingStrategy.uniqueConstraintName(s,h.columnNames);if(h.name!==f)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(n.name);const d=this.connection.namingStrategy.uniqueConstraintName(s,h.columnNames);a.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${h.name}" TO "${d}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${d}" TO "${h.name}"`)),h.name=d}),s.findColumnIndices(c).forEach(h=>{const f=this.connection.namingStrategy.indexName(s,h.columnNames,h.where);if(h.name!==f)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(n.name);const{schema:d}=this.driver.parseTableName(i),m=this.connection.namingStrategy.indexName(s,h.columnNames,h.where),y=d?`ALTER INDEX "${d}"."${h.name}" RENAME TO "${m}"`:`ALTER INDEX "${h.name}" RENAME TO "${m}"`,T=d?`ALTER INDEX "${d}"."${m}" RENAME TO "${h.name}"`:`ALTER INDEX "${m}" RENAME TO "${h.name}"`;a.push(new Y(y)),o.push(new Y(T)),h.name=m}),s.findColumnForeignKeys(c).forEach(h=>{const f=this.connection.namingStrategy.foreignKeyName(s,h.columnNames,this.getTablePath(h),h.referencedColumnNames);if(h.name!==f)return;h.columnNames.splice(h.columnNames.indexOf(c.name),1),h.columnNames.push(n.name);const d=this.connection.namingStrategy.foreignKeyName(s,h.columnNames,this.getTablePath(h),h.referencedColumnNames);a.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${h.name}" TO "${d}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME CONSTRAINT "${d}" TO "${h.name}"`)),h.name=d});const u=s.columns.find(h=>h.name===c.name);s.columns[s.columns.indexOf(u)].name=n.name,c.name=n.name}if((n.precision!==c.precision||n.scale!==c.scale)&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(c)}`))),(n.type==="enum"||n.type==="simple-enum")&&(c.type==="enum"||c.type==="simple-enum")&&(!ke.isArraysEqual(n.enum,c.enum)||n.enumName!==c.enumName)){const u=n.isArray?"[]":"",h=this.buildEnumName(i,n),f=this.buildEnumName(i,c),d=this.buildEnumName(i,c,!1),m=this.buildEnumName(i,c,!0,!1,!0),y=this.buildEnumName(i,c,!1,!1,!0);a.push(new Y(`ALTER TYPE ${f} RENAME TO ${y}`)),o.push(new Y(`ALTER TYPE ${m} RENAME TO ${d}`)),a.push(this.createEnumTypeSql(i,n,h)),o.push(this.dropEnumTypeSql(i,n,h)),c.default!==null&&c.default!==void 0&&(l=!0,a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" SET DEFAULT ${c.default}`)));const T=`${h}${u} USING "${n.name}"::"text"::${h}${u}`,b=`${m}${u} USING "${n.name}"::"text"::${m}${u}`;a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${T}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${b}`)),n.default!==null&&n.default!==void 0&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${n.default}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`))),a.push(this.dropEnumTypeSql(i,c,m)),o.push(this.createEnumTypeSql(i,c,m))}if(c.isNullable!==n.isNullable&&(n.isNullable?(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" DROP NOT NULL`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" SET NOT NULL`))):(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" SET NOT NULL`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" DROP NOT NULL`)))),c.comment!==n.comment&&(a.push(new Y(`COMMENT ON COLUMN ${this.escapePath(i)}."${c.name}" IS ${this.escapeComment(n.comment)}`)),o.push(new Y(`COMMENT ON COLUMN ${this.escapePath(i)}."${n.name}" IS ${this.escapeComment(c.comment)}`))),n.isPrimary!==c.isPrimary){const u=s.primaryColumns;if(u.length>0){const h=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(s,u.map(d=>d.name)),f=u.map(d=>`"${d.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${h}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${h}" PRIMARY KEY (${f})`))}if(n.isPrimary===!0){u.push(n);const h=s.columns.find(m=>m.name===n.name);h.isPrimary=!0;const f=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(s,u.map(m=>m.name)),d=u.map(m=>`"${m.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${f}" PRIMARY KEY (${d})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${f}"`))}else{const h=u.find(d=>d.name===n.name);u.splice(u.indexOf(h),1);const f=s.columns.find(d=>d.name===n.name);if(f.isPrimary=!1,u.length>0){const d=u[0].primaryKeyConstraintName?u[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(s,u.map(y=>y.name)),m=u.map(y=>`"${y.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${d}" PRIMARY KEY (${m})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${d}"`))}}}if(n.isUnique!==c.isUnique)if(n.isUnique===!0){const u=new Qn({name:this.connection.namingStrategy.uniqueConstraintName(i,[n.name]),columnNames:[n.name]});s.uniques.push(u),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${u.name}" UNIQUE ("${n.name}")`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${u.name}"`))}else{const u=s.uniques.find(h=>h.columnNames.length===1&&!!h.columnNames.find(f=>f===n.name));s.uniques.splice(s.uniques.indexOf(u),1),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${u.name}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${u.name}" UNIQUE ("${n.name}")`))}if(c.isGenerated!==n.isGenerated&&(c.isGenerated&&(c.generationStrategy==="uuid"?(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${c.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):c.generationStrategy==="increment"&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,n))}')`)),a.push(new Y(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,n))}`)),o.push(new Y(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,n))} OWNED BY ${this.escapePath(i)}."${n.name}"`)))),n.generationStrategy==="uuid"?n.isGenerated===!0?(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${this.driver.uuidGenerator}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):n.generationStrategy==="increment"&&(n.isGenerated===!0?(a.push(new Y(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,n))} OWNED BY ${this.escapePath(i)}."${n.name}"`)),o.push(new Y(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,n))}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,n))}')`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(i,n))}')`)),a.push(new Y(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(i,n))}`)),o.push(new Y(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(i,n))} OWNED BY ${this.escapePath(i)}."${n.name}"`))))),n.default!==c.default&&!l&&(n.default!==null&&n.default!==void 0?(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${n.default}`)),c.default!==null&&c.default!==void 0?o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${c.default}`)):o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):c.default!==null&&c.default!==void 0&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" SET DEFAULT ${c.default}`)))),((n.spatialFeatureType||"").toLowerCase()!==(c.spatialFeatureType||"").toLowerCase()||n.srid!==c.srid)&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(c)}`))),n.collation!==c.collation){a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${n.type} COLLATE "${n.collation}"`));const u=c.collation?`"${c.collation}"`:'pg_catalog."default"';o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${n.type} COLLATE ${u}`))}if(n.generatedType!==c.generatedType&&(!n.generatedType||n.generatedType==="VIRTUAL")){const u=(yield this.getTableNameWithSchema(i.name)).split("."),h=u[1],f=u[0];a.push(new Y(`ALTER TABLE ${this.escapePath(i)} RENAME COLUMN "${c.name}" TO "TEMP_OLD_${c.name}"`)),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD ${this.buildCreateColumnSql(i,n)}`)),a.push(new Y(`UPDATE ${this.escapePath(i)} SET "${n.name}" = "TEMP_OLD_${c.name}"`)),a.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP COLUMN "TEMP_OLD_${c.name}"`)),a.push(this.deleteTypeormMetadataSql({database:this.driver.database,schema:f,table:h,type:wt.GENERATED_COLUMN,name:c.name})),o.push(this.insertTypeormMetadataSql({database:this.driver.database,schema:f,table:h,type:wt.GENERATED_COLUMN,name:c.name,value:c.asExpression})),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ADD ${this.buildCreateColumnSql(i,c)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} DROP COLUMN "${n.name}"`))}}yield this.executeQueries(a,o),this.replaceCachedTable(i,s)})}changeColumns(e,t){return v(this,null,function*(){for(const{oldColumn:n,newColumn:i}of t)yield this.changeColumn(e,n,i)})}dropColumn(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableColumn(t)?t:n.findColumnByName(t);if(!i)throw new Z(`Column "${t}" was not found in table "${n.name}"`);const s=n.clone(),a=[],o=[];if(i.isPrimary){const h=i.primaryKeyConstraintName?i.primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(s,s.primaryColumns.map(m=>m.name)),f=s.primaryColumns.map(m=>`"${m.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(s)} DROP CONSTRAINT "${h}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(s)} ADD CONSTRAINT "${h}" PRIMARY KEY (${f})`));const d=s.findColumnByName(i.name);if(d.isPrimary=!1,s.primaryColumns.length>0){const m=s.primaryColumns[0].primaryKeyConstraintName?s.primaryColumns[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(s,s.primaryColumns.map(T=>T.name)),y=s.primaryColumns.map(T=>`"${T.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(s)} ADD CONSTRAINT "${m}" PRIMARY KEY (${y})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(s)} DROP CONSTRAINT "${m}"`))}}const l=s.indices.find(h=>h.columnNames.length===1&&h.columnNames[0]===i.name);l&&(s.indices.splice(s.indices.indexOf(l),1),a.push(this.dropIndexSql(n,l)),o.push(this.createIndexSql(n,l)));const c=s.checks.find(h=>!!h.columnNames&&h.columnNames.length===1&&h.columnNames[0]===i.name);c&&(s.checks.splice(s.checks.indexOf(c),1),a.push(this.dropCheckConstraintSql(n,c)),o.push(this.createCheckConstraintSql(n,c)));const u=s.uniques.find(h=>h.columnNames.length===1&&h.columnNames[0]===i.name);if(u&&(s.uniques.splice(s.uniques.indexOf(u),1),a.push(this.dropUniqueConstraintSql(n,u)),o.push(this.createUniqueConstraintSql(n,u))),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN "${i.name}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(n,i)}`)),(i.type==="enum"||i.type==="simple-enum")&&(yield this.hasEnumType(n,i))){const f=yield this.getUserDefinedTypeName(n,i),d=`"${f.schema}"."${f.name}"`;a.push(this.dropEnumTypeSql(n,i,d)),o.push(this.createEnumTypeSql(n,i,d))}if(i.generatedType==="STORED"){const h=(yield this.getTableNameWithSchema(n.name)).split("."),f=h[1],d=h[0],m=this.deleteTypeormMetadataSql({database:this.driver.database,schema:d,table:f,type:wt.GENERATED_COLUMN,name:i.name}),y=this.insertTypeormMetadataSql({database:this.driver.database,schema:d,table:f,type:wt.GENERATED_COLUMN,name:i.name,value:i.asExpression});a.push(m),o.push(y)}yield this.executeQueries(a,o),s.removeColumn(i),this.replaceCachedTable(n,s)})}dropColumns(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropColumn(e,n)})}createPrimaryKey(e,t,n){return v(this,null,function*(){const i=de.isTable(e)?e:yield this.getCachedTable(e),s=i.clone(),a=this.createPrimaryKeySql(i,t,n);s.columns.forEach(l=>{t.find(c=>c===l.name)&&(l.isPrimary=!0)});const o=this.dropPrimaryKeySql(s);yield this.executeQueries(a,o),this.replaceCachedTable(i,s)})}updatePrimaryKeys(e,t){return v(this,null,function*(){var h;const n=de.isTable(e)?e:yield this.getCachedTable(e),i=n.clone(),s=t.map(f=>f.name),a=[],o=[],l=i.primaryColumns;if(l.length>0){const f=l[0].primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,l.map(m=>m.name)),d=l.map(m=>`"${m.name}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${f}"`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${f}" PRIMARY KEY (${d})`))}i.columns.filter(f=>s.indexOf(f.name)!==-1).forEach(f=>f.isPrimary=!0);const c=(h=l[0])!=null&&h.primaryKeyConstraintName?l[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,s),u=s.map(f=>`"${f}"`).join(", ");a.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${c}" PRIMARY KEY (${u})`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${c}"`)),yield this.executeQueries(a,o),this.replaceCachedTable(n,i)})}dropPrimaryKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=this.dropPrimaryKeySql(n),s=this.createPrimaryKeySql(n,n.primaryColumns.map(a=>a.name),t);yield this.executeQueries(i,s),n.primaryColumns.forEach(a=>{a.isPrimary=!1})})}createUniqueConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(n,t.columnNames));const i=this.createUniqueConstraintSql(n,t),s=this.dropUniqueConstraintSql(n,t);yield this.executeQueries(i,s),n.addUniqueConstraint(t)})}createUniqueConstraints(e,t){return v(this,null,function*(){for(const n of t)yield this.createUniqueConstraint(e,n)})}dropUniqueConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableUnique(t)?t:n.uniques.find(o=>o.name===t);if(!i)throw new Z(`Supplied unique constraint was not found in table ${n.name}`);const s=this.dropUniqueConstraintSql(n,i),a=this.createUniqueConstraintSql(n,i);yield this.executeQueries(s,a),n.removeUniqueConstraint(i)})}dropUniqueConstraints(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropUniqueConstraint(e,n)})}createCheckConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n,t.expression));const i=this.createCheckConstraintSql(n,t),s=this.dropCheckConstraintSql(n,t);yield this.executeQueries(i,s),n.addCheckConstraint(t)})}createCheckConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.createCheckConstraint(e,i));yield Promise.all(n)})}dropCheckConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableCheck(t)?t:n.checks.find(o=>o.name===t);if(!i)throw new Z(`Supplied check constraint was not found in table ${n.name}`);const s=this.dropCheckConstraintSql(n,i),a=this.createCheckConstraintSql(n,i);yield this.executeQueries(s,a),n.removeCheckConstraint(i)})}dropCheckConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropCheckConstraint(e,i));yield Promise.all(n)})}createExclusionConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(n,t.expression));const i=this.createExclusionConstraintSql(n,t),s=this.dropExclusionConstraintSql(n,t);yield this.executeQueries(i,s),n.addExclusionConstraint(t)})}createExclusionConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.createExclusionConstraint(e,i));yield Promise.all(n)})}dropExclusionConstraint(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableExclusion(t)?t:n.exclusions.find(o=>o.name===t);if(!i)throw new Z(`Supplied exclusion constraint was not found in table ${n.name}`);const s=this.dropExclusionConstraintSql(n,i),a=this.createExclusionConstraintSql(n,i);yield this.executeQueries(s,a),n.removeExclusionConstraint(i)})}dropExclusionConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropExclusionConstraint(e,i));yield Promise.all(n)})}createForeignKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const i=this.createForeignKeySql(n,t),s=this.dropForeignKeySql(n,t);yield this.executeQueries(i,s),n.addForeignKey(t)})}createForeignKeys(e,t){return v(this,null,function*(){for(const n of t)yield this.createForeignKey(e,n)})}dropForeignKey(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableForeignKey(t)?t:n.foreignKeys.find(o=>o.name===t);if(!i)throw new Z(`Supplied foreign key was not found in table ${n.name}`);i.name||(i.name=this.connection.namingStrategy.foreignKeyName(n,i.columnNames,this.getTablePath(i),i.referencedColumnNames));const s=this.dropForeignKeySql(n,i),a=this.createForeignKeySql(n,i);yield this.executeQueries(s,a),n.removeForeignKey(i)})}dropForeignKeys(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropForeignKey(e,n)})}createIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const i=this.createIndexSql(n,t),s=this.dropIndexSql(n,t);yield this.executeQueries(i,s),n.addIndex(t)})}createViewIndex(e,t){return v(this,null,function*(){const n=de.isView(e)?e:yield this.getCachedView(e);t.name||(t.name=this.generateIndexName(n,t));const i=this.createViewIndexSql(n,t),s=this.dropIndexSql(n,t);yield this.executeQueries(i,s),n.addIndex(t)})}createIndices(e,t){return v(this,null,function*(){for(const n of t)yield this.createIndex(e,n)})}createViewIndices(e,t){return v(this,null,function*(){for(const n of t)yield this.createViewIndex(e,n)})}dropIndex(e,t){return v(this,null,function*(){const n=de.isTable(e)?e:yield this.getCachedTable(e),i=de.isTableIndex(t)?t:n.indices.find(o=>o.name===t);if(!i)throw new Z(`Supplied index ${t} was not found in table ${n.name}`);i.name||(i.name=this.generateIndexName(n,i));const s=this.dropIndexSql(n,i),a=this.createIndexSql(n,i);yield this.executeQueries(s,a),n.removeIndex(i)})}dropViewIndex(e,t){return v(this,null,function*(){const n=de.isView(e)?e:yield this.getCachedView(e),i=de.isTableIndex(t)?t:n.indices.find(o=>o.name===t);if(!i)throw new Z(`Supplied index ${t} was not found in view ${n.name}`);i.name||(i.name=this.generateIndexName(n,i));const s=this.dropIndexSql(n,i),a=this.createViewIndexSql(n,i);yield this.executeQueries(s,a),n.removeIndex(i)})}dropIndices(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropIndex(e,n)})}clearTable(e){return v(this,null,function*(){yield this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)})}clearDatabase(){return v(this,null,function*(){const e=[];this.connection.entityMetadatas.filter(i=>i.schema).forEach(i=>{!!e.find(a=>a===i.schema)||e.push(i.schema)}),e.push(this.driver.options.schema||"current_schema()");const t=e.map(i=>i==="current_schema()"?i:"'"+i+"'").join(", "),n=this.isTransactionActive;n||(yield this.startTransaction());try{const i=`SELECT 'DROP VIEW IF EXISTS "' || schemaname || '"."' || viewname || '" CASCADE;' as "query" FROM "pg_views" WHERE "schemaname" IN (${t}) AND "viewname" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')`,s=yield this.query(i);if(yield Promise.all(s.map(l=>this.query(l.query))),Be.isReleaseVersionOrGreater(this.driver,"9.3")){const l=`SELECT 'DROP MATERIALIZED VIEW IF EXISTS "' || schemaname || '"."' || matviewname || '" CASCADE;' as "query" FROM "pg_matviews" WHERE "schemaname" IN (${t})`,c=yield this.query(l);yield Promise.all(c.map(u=>this.query(u.query)))}const a=`SELECT 'DROP TABLE IF EXISTS "' || schemaname || '"."' || tablename || '" CASCADE;' as "query" FROM "pg_tables" WHERE "schemaname" IN (${t}) AND "tablename" NOT IN ('spatial_ref_sys')`,o=yield this.query(a);yield Promise.all(o.map(l=>this.query(l.query))),yield this.dropEnumTypes(t),n||(yield this.commitTransaction())}catch(i){try{n||(yield this.rollbackTransaction())}catch(s){}throw i}})}loadViews(e){return v(this,null,function*(){if(!(yield this.hasTable(this.getTypeormMetadataTableName())))return[];e||(e=[]);const n=yield this.getCurrentDatabase(),i=yield this.getCurrentSchema(),s=e.length===0?"1=1":e.map(h=>this.driver.parseTableName(h)).map(({schema:h,tableName:f})=>(h||(h=this.driver.options.schema||i),`("t"."schema" = '${h}' AND "t"."name" = '${f}')`)).join(" OR "),o=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('m') AND "cnst"."contype" IS NULL AND (${e.length===0?"1=1":e.map(h=>this.driver.parseTableName(h)).map(({schema:h,tableName:f})=>(h||(h=this.driver.options.schema||i),`("ns"."nspname" = '${h}' AND "t"."relname" = '${f}')`)).join(" OR ")})`,l=`SELECT "t".* FROM ${this.escapePath(this.getTypeormMetadataTableName())} "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN ('${wt.VIEW}', '${wt.MATERIALIZED_VIEW}') ${s?`AND (${s})`:""}`,c=yield this.query(l),u=yield this.query(o);return c.map(h=>{const f=ke.uniq(u.filter(y=>y.table_name===h.name&&y.table_schema===h.schema),y=>y.constraint_name),d=new $i,m=h.schema===i&&!this.driver.options.schema?void 0:h.schema;return d.database=n,d.schema=h.schema,d.name=this.driver.buildTableName(h.name,m),d.expression=h.value,d.materialized=h.type===wt.MATERIALIZED_VIEW,d.indices=f.map(y=>{const T=u.filter(b=>b.table_schema===y.table_schema&&b.table_name===y.table_name&&b.constraint_name===y.constraint_name);return new mn({view:d,name:y.constraint_name,columnNames:T.map(b=>b.column_name),isUnique:y.is_unique==="TRUE",where:y.condition,isFulltext:!1})}),d})})}loadTables(e){return v(this,null,function*(){if(e&&e.length===0)return[];const t=yield this.getCurrentSchema(),n=yield this.getCurrentDatabase(),i=[];if(!e)i.push(...yield this.query(`SELECT "table_schema", "table_name", obj_description(('"' || "table_schema" || '"."' || "table_name" || '"')::regclass, 'pg_class') AS table_comment FROM "information_schema"."tables"`));else{const N=`SELECT "table_schema", "table_name", obj_description(('"' || "table_schema" || '"."' || "table_name" || '"')::regclass, 'pg_class') AS table_comment FROM "information_schema"."tables" WHERE `+e.map(C=>this.driver.parseTableName(C)).map(({schema:C,tableName:I})=>`("table_schema" = '${C||t}' AND "table_name" = '${I}')`).join(" OR ");i.push(...yield this.query(N))}if(i.length===0)return[];const a=`SELECT columns.*, pg_catalog.col_description(('"' || table_catalog || '"."' || table_schema || '"."' || table_name || '"')::regclass::oid, ordinal_position) AS description, ('"' || "udt_schema" || '"."' || "udt_name" || '"')::"regtype"::text AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE `+i.map(({table_schema:S,table_name:N})=>`("table_schema" = '${S}' AND "table_name" = '${N}')`).join(" OR "),o=i.map(({table_schema:S,table_name:N})=>`("ns"."nspname" = '${S}' AND "t"."relname" = '${N}')`).join(" OR "),l=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN 'p' THEN 'PRIMARY' WHEN 'u' THEN 'UNIQUE' WHEN 'c' THEN 'CHECK' WHEN 'x' THEN 'EXCLUDE' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN ('r', 'p') AND (${o})`,c=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name", "am"."amname" AS "index_type" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" INNER JOIN "pg_am" "am" ON "i"."relam" = "am"."oid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('r', 'p') AND "cnst"."contype" IS NULL AND (${o})`,u=i.map(({table_schema:S,table_name:N})=>`("ns"."nspname" = '${S}' AND "cl"."relname" = '${N}')`).join(" OR "),f=(yield this.hasSupportForPartitionedTables())?` AND "cl"."relispartition" = 'f'`:"",d=`SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN 'INITIALLY DEFERRED' ELSE 'INITIALLY IMMEDIATE' END as condeferred, CASE "con1"."confdeltype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confdeltype", CASE "con1"."confupdtype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = 'f' AND (${u}) ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" ${f}INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"`,[m,y,T,b]=yield Promise.all([this.query(a),this.query(l),this.query(c),this.query(d)]);return Promise.all(i.map(S=>v(this,null,function*(){const N=new hn,C=(E,A)=>E[A]===t&&(!this.driver.options.schema||this.driver.options.schema===t)?void 0:E[A],I=C(S,"table_schema");N.database=n,N.schema=S.table_schema,N.comment=S.table_comment,N.name=this.driver.buildTableName(S.table_name,I),N.columns=yield Promise.all(m.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema).map(E=>v(this,null,function*(){const A=y.filter(ae=>ae.table_name===E.table_name&&ae.table_schema===E.table_schema&&ae.column_name===E.column_name),x=new ar;if(x.name=E.column_name,x.type=E.regtype.toLowerCase(),x.type==="vector"||x.type==="halfvec"){const ae=E.format_type.match(/^(?:vector|halfvec)\((\d+)\)$/);ae&&ae[1]&&(x.length=ae[1])}if(x.type==="numeric"||x.type==="numeric[]"||x.type==="decimal"||x.type==="float"){let ae=E.numeric_precision,ue=E.numeric_scale;if(E.data_type==="ARRAY"){const L=E.format_type.match(/^numeric\(([0-9]+),([0-9]+)\)\[\]$/);L&&(ae=+L[1],ue=+L[2])}ae!==null&&!this.isDefaultColumnPrecision(N,x,ae)?x.precision=ae:ue!==null&&!this.isDefaultColumnScale(N,x,ue)&&(x.precision=void 0),ue!==null&&!this.isDefaultColumnScale(N,x,ue)?x.scale=ue:ae!==null&&!this.isDefaultColumnPrecision(N,x,ae)&&(x.scale=void 0)}if((x.type==="interval"||x.type==="time without time zone"||x.type==="time with time zone"||x.type==="timestamp without time zone"||x.type==="timestamp with time zone")&&(x.precision=this.isDefaultColumnPrecision(N,x,E.datetime_precision)?void 0:E.datetime_precision),E.data_type==="USER-DEFINED"||E.data_type==="ARRAY"){const{name:ae}=yield this.getUserDefinedTypeName(N,x),L=this.buildEnumName(N,x,!1,!0)!==ae?ae:void 0,Se=`SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${S.table_schema}' AND "t"."typname" = '${L||ae}'`,Ae=yield this.query(Se);if(Ae.length&&(x.type="enum",x.enum=Ae.map(ve=>ve.value),x.enumName=L),E.data_type==="ARRAY"){x.isArray=!0;const ve=x.type.replace("[]","");x.type=this.connection.driver.normalizeType({type:ve})}}if(x.type==="geometry"||x.type==="geography"){const ae=`SELECT * FROM (SELECT "f_table_schema" "table_schema", "f_table_name" "table_name", "f_${x.type}_column" "column_name", "srid", "type" FROM "${x.type}_columns") AS _ WHERE "column_name" = '${E.column_name}' AND "table_schema" = '${E.table_schema}' AND "table_name" = '${E.table_name}'`,ue=yield this.query(ae);ue.length>0&&(x.spatialFeatureType=ue[0].type,x.srid=ue[0].srid)}if(this.driver.withLengthColumnTypes.indexOf(x.type)!==-1){let ae;if(x.isArray){const ue=/\((\d+)\)/.exec(E.format_type);ae=ue?ue[1]:void 0}else E.character_maximum_length&&(ae=E.character_maximum_length.toString());ae&&(x.length=this.isDefaultColumnLength(N,x,ae)?"":ae)}x.isNullable=E.is_nullable==="YES";const $=A.find(ae=>ae.constraint_type==="PRIMARY");if($){x.isPrimary=!0;const ue=y.filter(Se=>Se.table_name===E.table_name&&Se.table_schema===E.table_schema&&Se.column_name!==E.column_name&&Se.constraint_type==="PRIMARY").map(Se=>Se.column_name);ue.push(E.column_name);const L=this.connection.namingStrategy.primaryKeyName(N,ue);$.constraint_name!==L&&(x.primaryKeyConstraintName=$.constraint_name)}const B=A.filter(ae=>ae.constraint_type==="UNIQUE"),K=B.every(ae=>y.some(ue=>ue.constraint_type==="UNIQUE"&&ue.constraint_name===ae.constraint_name&&ue.column_name!==E.column_name));if(x.isUnique=B.length>0&&!K,E.is_identity==="YES")x.isGenerated=!0,x.generationStrategy="identity",x.generatedIdentity=E.identity_generation;else if(E.column_default!==null&&E.column_default!==void 0){const ae=`nextval('${this.buildSequenceName(N,E.column_name)}'::regclass)`,ue=`nextval('${this.buildSequencePath(N,E.column_name)}'::regclass)`,L=E.column_default.replace(/"/g,"");L===ae||L===ue?(x.isGenerated=!0,x.generationStrategy="increment"):E.column_default==="gen_random_uuid()"||/^uuid_generate_v\d\(\)/.test(E.column_default)?x.type==="uuid"?(x.isGenerated=!0,x.generationStrategy="uuid"):x.default=E.column_default:E.column_default==="now()"||E.column_default.indexOf("'now'::text")!==-1?x.default=E.column_default:(x.default=E.column_default.replace(/::[\w\s.[\]\-"]+/g,""),x.default=x.default.replace(/^(-?\d+)$/,"'$1'"))}if(E.is_generated==="ALWAYS"&&E.generation_expression){x.generatedType="STORED";const ae=this.selectTypeormMetadataSql({database:n,schema:S.table_schema,table:S.table_name,type:wt.GENERATED_COLUMN,name:x.name}),ue=yield this.query(ae.query,ae.parameters);ue[0]&&ue[0].value?x.asExpression=ue[0].value:x.asExpression=""}return x.comment=E.description?E.description:void 0,E.character_set_name&&(x.charset=E.character_set_name),E.collation_name&&(x.collation=E.collation_name),x})));const H=ke.uniq(y.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema&&E.constraint_type==="UNIQUE"),E=>E.constraint_name);N.uniques=H.map(E=>{const A=y.filter(x=>x.constraint_name===E.constraint_name);return new Qn({name:E.constraint_name,columnNames:A.map(x=>x.column_name),deferrable:E.deferrable?E.deferred:void 0})});const Q=ke.uniq(y.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema&&E.constraint_type==="CHECK"),E=>E.constraint_name);N.checks=Q.map(E=>{const A=y.filter(x=>x.constraint_name===E.constraint_name);return new Gr({name:E.constraint_name,columnNames:A.map(x=>x.column_name),expression:E.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})});const te=ke.uniq(y.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema&&E.constraint_type==="EXCLUDE"),E=>E.constraint_name);N.exclusions=te.map(E=>new js({name:E.constraint_name,expression:E.expression.substring(8)}));const V=ke.uniq(b.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema),E=>E.constraint_name);N.foreignKeys=V.map(E=>{const A=b.filter(B=>B.constraint_name===E.constraint_name),x=C(E,"referenced_table_schema"),$=this.driver.buildTableName(E.referenced_table_name,x);return new Mr({name:E.constraint_name,columnNames:A.map(B=>B.column_name),referencedSchema:E.referenced_table_schema,referencedTableName:$,referencedColumnNames:A.map(B=>B.referenced_column_name),onDelete:E.on_delete,onUpdate:E.on_update,deferrable:E.deferrable?E.deferred:void 0})});const J=ke.uniq(T.filter(E=>E.table_name===S.table_name&&E.table_schema===S.table_schema),E=>E.constraint_name);return N.indices=J.map(E=>{const A=T.filter(x=>x.table_schema===E.table_schema&&x.table_name===E.table_name&&x.constraint_name===E.constraint_name);return new mn({table:N,name:E.constraint_name,columnNames:A.map(x=>x.column_name),isUnique:E.is_unique==="TRUE",where:E.condition,isSpatial:E.index_type==="gist",isFulltext:!1})}),N})))})}createTableSql(e,t){const n=e.columns.map(a=>this.buildCreateColumnSql(e,a)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter(a=>a.isUnique).forEach(a=>{e.uniques.some(l=>l.columnNames.length===1&&l.columnNames[0]===a.name)||e.uniques.push(new Qn({name:this.connection.namingStrategy.uniqueConstraintName(e,[a.name]),columnNames:[a.name]}))}),e.uniques.length>0){const a=e.uniques.map(o=>{const l=o.name?o.name:this.connection.namingStrategy.uniqueConstraintName(e,o.columnNames),c=o.columnNames.map(h=>`"${h}"`).join(", ");let u=`CONSTRAINT "${l}" UNIQUE (${c})`;return o.deferrable&&(u+=` DEFERRABLE ${o.deferrable}`),u}).join(", ");i+=`, ${a}`}if(e.checks.length>0){const a=e.checks.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}" CHECK (${o.expression})`).join(", ");i+=`, ${a}`}if(e.exclusions.length>0){const a=e.exclusions.map(o=>`CONSTRAINT "${o.name?o.name:this.connection.namingStrategy.exclusionConstraintName(e,o.expression)}" EXCLUDE ${o.expression}`).join(", ");i+=`, ${a}`}if(e.foreignKeys.length>0&&t){const a=e.foreignKeys.map(o=>{const l=o.columnNames.map(h=>`"${h}"`).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const c=o.referencedColumnNames.map(h=>`"${h}"`).join(", ");let u=`CONSTRAINT "${o.name}" FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${c})`;return o.onDelete&&(u+=` ON DELETE ${o.onDelete}`),o.onUpdate&&(u+=` ON UPDATE ${o.onUpdate}`),o.deferrable&&(u+=` DEFERRABLE ${o.deferrable}`),u}).join(", ");i+=`, ${a}`}const s=e.columns.filter(a=>a.isPrimary);if(s.length>0){const a=s[0].primaryKeyConstraintName?s[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(e,s.map(l=>l.name)),o=s.map(l=>`"${l.name}"`).join(", ");i+=`, CONSTRAINT "${a}" PRIMARY KEY (${o})`}return i+=")",e.columns.filter(a=>a.comment).forEach(a=>i+=`; COMMENT ON COLUMN ${this.escapePath(e)}."${a.name}" IS ${this.escapeComment(a.comment)}`),new Y(i)}getVersion(){return v(this,null,function*(){return(yield this.query("SELECT version()"))[0].version.replace(/^PostgreSQL ([\d.]+).*$/,"$1")})}dropTableSql(e){return new Y(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e);return typeof e.expression=="string"?new Y(`CREATE ${t}VIEW ${n} AS ${e.expression}`):new Y(`CREATE ${t}VIEW ${n} AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){return v(this,null,function*(){const t=yield this.getCurrentSchema();let{schema:n,tableName:i}=this.driver.parseTableName(e);n||(n=t);const s=e.materialized?wt.MATERIALIZED_VIEW:wt.VIEW,a=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:s,schema:n,name:i,value:a})})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new Y(`DROP ${t}VIEW ${this.escapePath(e)}`)}deleteViewDefinitionSql(e){return v(this,null,function*(){const t=yield this.getCurrentSchema();let{schema:n,tableName:i}=this.driver.parseTableName(e);n||(n=t);const s=e.materialized?wt.MATERIALIZED_VIEW:wt.VIEW;return this.deleteTypeormMetadataSql({type:s,schema:n,name:i})})}dropEnumTypes(e){return v(this,null,function*(){const t=`SELECT 'DROP TYPE IF EXISTS "' || n.nspname || '"."' || t.typname || '" CASCADE;' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN (${e}) GROUP BY "n"."nspname", "t"."typname"`,n=yield this.query(t);yield Promise.all(n.map(i=>this.query(i.query)))})}hasEnumType(e,t){return v(this,null,function*(){let{schema:n}=this.driver.parseTableName(e);n||(n=yield this.getCurrentSchema());const i=this.buildEnumName(e,t,!1,!0),s=`SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${n}' AND "t"."typname" = '${i}'`;return!!(yield this.query(s)).length})}createEnumTypeSql(e,t,n){n||(n=this.buildEnumName(e,t));const i=t.enum.map(s=>`'${s.replaceAll("'","''")}'`).join(", ");return new Y(`CREATE TYPE ${n} AS ENUM(${i})`)}dropEnumTypeSql(e,t,n){return n||(n=this.buildEnumName(e,t)),new Y(`DROP TYPE ${n}`)}createIndexSql(e,t){const n=t.columnNames.map(i=>`"${i}"`).join(", ");return new Y(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX${t.isConcurrent?" CONCURRENTLY":""} "${t.name}" ON ${this.escapePath(e)} ${t.isSpatial?"USING GiST ":""}(${n}) ${t.where?"WHERE "+t.where:""}`)}createViewIndexSql(e,t){const n=t.columnNames.map(i=>`"${i}"`).join(", ");return new Y(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} (${n}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e,t){const n=de.isTableIndex(t)?t.name:t,i=de.isTableIndex(t)?t.isConcurrent:!1,{schema:s}=this.driver.parseTableName(e);return s?new Y(`DROP INDEX ${i?"CONCURRENTLY ":""}"${s}"."${n}"`):new Y(`DROP INDEX ${i?"CONCURRENTLY ":""}"${n}"`)}createPrimaryKeySql(e,t,n){const i=n||this.connection.namingStrategy.primaryKeyName(e,t),s=t.map(a=>`"${a}"`).join(", ");return new Y(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${i}" PRIMARY KEY (${s})`)}dropPrimaryKeySql(e){if(!e.primaryColumns.length)throw new Z(`Table ${e} has no primary keys.`);const t=e.primaryColumns.map(s=>s.name),n=e.primaryColumns[0].primaryKeyConstraintName,i=n||this.connection.namingStrategy.primaryKeyName(e,t);return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${i}"`)}createUniqueConstraintSql(e,t){const n=t.columnNames.map(s=>'"'+s+'"').join(", ");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" UNIQUE (${n})`;return t.deferrable&&(i+=` DEFERRABLE ${t.deferrable}`),new Y(i)}dropUniqueConstraintSql(e,t){const n=de.isTableUnique(t)?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createCheckConstraintSql(e,t){return new Y(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const n=de.isTableCheck(t)?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createExclusionConstraintSql(e,t){return new Y(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" EXCLUDE ${t.expression}`)}dropExclusionConstraintSql(e,t){const n=de.isTableExclusion(t)?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createForeignKeySql(e,t){const n=t.columnNames.map(a=>'"'+a+'"').join(", "),i=t.referencedColumnNames.map(a=>'"'+a+'"').join(",");let s=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${i})`;return t.onDelete&&(s+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(s+=` ON UPDATE ${t.onUpdate}`),t.deferrable&&(s+=` DEFERRABLE ${t.deferrable}`),new Y(s)}dropForeignKeySql(e,t){const n=de.isTableForeignKey(t)?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}buildSequenceName(e,t){const{tableName:n}=this.driver.parseTableName(e),i=de.isTableColumn(t)?t.name:t;let s=`${n}_${i}_seq`;return s.length>this.connection.driver.maxAliasLength&&(s=`${n.substring(0,29)}_${i.substring(0,Math.max(29,63-e.name.length-5))}_seq`),s}buildSequencePath(e,t){const{schema:n}=this.driver.parseTableName(e);return n?`${n}.${this.buildSequenceName(e,t)}`:this.buildSequenceName(e,t)}buildEnumName(e,t,n=!0,i,s){const{schema:a,tableName:o}=this.driver.parseTableName(e);let l=t.enumName?t.enumName:`${o}_${t.name.toLowerCase()}_enum`;return a&&n&&(l=`${a}.${l}`),s&&(l=l+"_old"),l.split(".").map(c=>i?c:`"${c}"`).join(".")}getUserDefinedTypeName(e,t){return v(this,null,function*(){let{schema:n,tableName:i}=this.driver.parseTableName(e);n||(n=yield this.getCurrentSchema());const s=yield this.query(`SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = '${n}' AND "table_name" = '${i}' AND "column_name"='${t.name}'`);let a=s[0].udt_name;return a.indexOf("_")===0&&(a=a.substr(1,a.length)),{schema:s[0].udt_schema,name:a}})}escapeComment(e){return!e||e.length===0?"NULL":(e=e.replace(/'/g,"''").replace(/\u0000/g,""),`'${e}'`)}escapePath(e){const{schema:t,tableName:n}=this.driver.parseTableName(e);return t&&t!==this.driver.searchSchema?`"${t}"."${n}"`:`"${n}"`}getTableNameWithSchema(e){return v(this,null,function*(){const t=de.isTable(e)?e.name:e;return t.indexOf(".")===-1?`${(yield this.query("SELECT current_schema()"))[0].current_schema}.${t}`:`${t.split(".")[0]}.${t.split(".")[1]}`})}buildCreateColumnSql(e,t){let n='"'+t.name+'"';if(t.isGenerated===!0&&t.generationStrategy!=="uuid")if(t.generationStrategy==="identity"){const i=t.generatedIdentity||"BY DEFAULT";n+=` ${t.type} GENERATED ${i} AS IDENTITY`}else(t.type==="integer"||t.type==="int"||t.type==="int4")&&(n+=" SERIAL"),(t.type==="smallint"||t.type==="int2")&&(n+=" SMALLSERIAL"),(t.type==="bigint"||t.type==="int8")&&(n+=" BIGSERIAL");return t.type==="enum"||t.type==="simple-enum"?(n+=" "+this.buildEnumName(e,t),t.isArray&&(n+=" array")):(!t.isGenerated||t.type==="uuid")&&(n+=" "+this.connection.driver.createFullType(t)),t.generatedType==="STORED"&&t.asExpression&&(n+=` GENERATED ALWAYS AS (${t.asExpression}) STORED`),t.charset&&(n+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(n+=' COLLATE "'+t.collation+'"'),t.isNullable!==!0&&(n+=" NOT NULL"),t.default!==void 0&&t.default!==null&&(n+=" DEFAULT "+t.default),t.isGenerated&&t.generationStrategy==="uuid"&&!t.default&&(n+=` DEFAULT ${this.driver.uuidGenerator}`),n}hasSupportForPartitionedTables(){return v(this,null,function*(){return!!(yield this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")).length})}changeTableComment(e,t){return v(this,null,function*(){const n=[],i=[],s=de.isTable(e)?e:yield this.getCachedTable(e);t=this.escapeComment(t);const a=this.escapeComment(s.comment);if(t===a)return;const o=s.clone();n.push(new Y(`COMMENT ON TABLE ${this.escapePath(o)} IS ${t}`)),i.push(new Y(`COMMENT ON TABLE ${this.escapePath(s)} IS ${a}`)),yield this.executeQueries(n,i),s.comment=o.comment,this.replaceCachedTable(s,o)})}}class Z3 extends X3{constructor(e,t){super(e,t)}}class eF extends Z3{constructor(e,t,n){super(e,n),this.client=t}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):this.databaseConnectionPromise?this.databaseConnectionPromise:(this.mode==="slave"&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then(([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)),this.databaseConnectionPromise)}startTransaction(e){return v(this,null,function*(){this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}this.transactionDepth===0?yield this.client.startTransaction():yield this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?yield this.query(`RELEASE SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?yield this.query(`ROLLBACK TO SAVEPOINT typeorm_${this.transactionDepth-1}`):(yield this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.client.query(e,t),s=new Zr;return s.raw=i,i!=null&&i.hasOwnProperty("records")&&Array.isArray(i.records)&&(s.records=i.records),i!=null&&i.hasOwnProperty("numberOfRecordsUpdated")&&(s.affected=i.numberOfRecordsUpdated),n?s:s.raw})}changeTableComment(e,t){throw new Z("aurora-postgres driver does not support change comment.")}}class tF extends r_{}class nF extends tF{constructor(e){super(),this.transactionSupport="nested",this.connection=e,this.options=e.options,this.isReplicated=!1,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,n)=>this.connection.logger.logQuery(t,n),this.options.serviceConfigOptions,this.options.formatOptions),this.database=Be.buildDriverOptions(this.options).database}connect(){return v(this,null,function*(){})}disconnect(){return v(this,null,function*(){})}createQueryRunner(e){return new eF(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(t,n)=>this.connection.logger.logQuery(t,n),this.options.serviceConfigOptions,this.options.formatOptions),e)}preparePersistentValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.preparePersistentValue(e,t):(t.transformer&&(e=An.transformTo(t.transformer,e)),this.client.preparePersistentValue(e,t))}prepareHydratedValue(e,t){return this.options.formatOptions&&this.options.formatOptions.castParameters===!1?super.prepareHydratedValue(e,t):(t.transformer&&(e=An.transformFrom(t.transformer,e)),this.client.prepareHydratedValue(e,t))}loadDependencies(){const e=this.options.driver||Kt.load("typeorm-aurora-data-api-driver"),{pg:t}=e;this.DataApiDriver=t}executeQuery(e,t){return this.connection.query(t)}afterConnect(){return v(this,null,function*(){const e=yield this.checkMetadataForExtensions();return e.hasExtensions&&(yield this.enableExtensions(e,this.connection)),Promise.resolve()})}}class rF extends Js{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new gi(this)}beforeMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = OFF")})}afterMigration(){return v(this,null,function*(){yield this.query("PRAGMA foreign_keys = ON")})}executeSet(e){return v(this,null,function*(){if(this.isReleased)throw new zn;return(yield this.connect()).executeSet(e,!1)})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;const i=yield this.connect();this.driver.connection.logger.logQuery(e,t,this);const s=e.substring(0,e.indexOf(" ")!==-1?e.indexOf(" "):void 0);try{let a;["BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(s)!==-1?a=yield i.execute(e,!1):["INSERT","UPDATE","DELETE"].indexOf(s)!==-1?a=yield i.run(e,t,!1):a=yield i.query(e,t||[]);const o=new Zr;return a!=null&&a.hasOwnProperty("values")&&(o.raw=a.values,o.records=a.values),a!=null&&a.hasOwnProperty("changes")&&(o.affected=a.changes.changes,o.raw=a.changes.lastId||a.changes.changes),n?o:o.raw}catch(a){throw this.driver.connection.logger.logQueryError(a,e,t,this),new zr(e,t,a)}})}parametrize(e){return Object.keys(e).map(t=>`"${t}"=?`)}}class iF extends oo{constructor(e){super(e),this.database=this.options.database,this.driver=this.options.driver,this.sqlite=this.options.driver}connect(){return v(this,null,function*(){this.databaseConnection=this.createDatabaseConnection(),yield this.databaseConnection})}disconnect(){return v(this,null,function*(){return this.queryRunner=void 0,(yield this.databaseConnection).close().then(()=>{this.databaseConnection=void 0})})}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new rF(this)),this.queryRunner}createDatabaseConnection(){return v(this,null,function*(){const e=this.options.mode||"no-encryption",t=e!=="no-encryption",n=typeof this.options.version=="undefined"?1:this.options.version,i=yield this.sqlite.createConnection(this.options.database,t,e,n);return yield i.open(),yield i.execute("PRAGMA foreign_keys = ON"),this.options.journalMode&&["DELETE","TRUNCATE","PERSIST","MEMORY","WAL","OFF"].indexOf(this.options.journalMode)!==-1&&(yield i.execute(`PRAGMA journal_mode = ${this.options.journalMode}`)),i})}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new io("Capacitor","@capacitor-community/sqlite")}}class sF extends hh{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new gi(this)}connect(){return v(this,null,function*(){if(this.session)return Promise.resolve(this.session);const[e]=yield this.driver.instanceDatabase.createSession({});return this.session=e,this.sessionTransaction=yield e.transaction(),this.session})}release(){return v(this,null,function*(){return this.isReleased=!0,this.session&&(yield this.session.delete()),this.session=void 0,Promise.resolve()})}startTransaction(e){return v(this,null,function*(){this.isTransactionActive=!0;try{yield this.broadcaster.broadcast("BeforeTransactionStart")}catch(t){throw this.isTransactionActive=!1,t}yield this.connect(),yield this.sessionTransaction.begin(),this.connection.logger.logQuery("START TRANSACTION"),yield this.broadcaster.broadcast("AfterTransactionStart")})}commitTransaction(){return v(this,null,function*(){if(!this.isTransactionActive||!this.sessionTransaction)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionCommit"),yield this.sessionTransaction.commit(),this.connection.logger.logQuery("COMMIT"),this.isTransactionActive=!1,yield this.broadcaster.broadcast("AfterTransactionCommit")})}rollbackTransaction(){return v(this,null,function*(){if(!this.isTransactionActive||!this.sessionTransaction)throw new Ir;yield this.broadcaster.broadcast("BeforeTransactionRollback"),yield this.sessionTransaction.rollback(),this.connection.logger.logQuery("ROLLBACK"),this.isTransactionActive=!1,yield this.broadcaster.broadcast("AfterTransactionRollback")})}query(e,t,n=!1){return v(this,null,function*(){if(this.isReleased)throw new zn;yield this.connect(),this.driver.connection.logger.logQuery(e,t,this),yield this.broadcaster.broadcast("BeforeQuery",e,t);const i=new Or;try{const s=Date.now();let a;const o=e.startsWith("SELECT"),l=o&&!this.isTransactionActive?this.driver.instanceDatabase:this.sessionTransaction;!this.isTransactionActive&&!o&&(yield this.sessionTransaction.begin());try{a=yield l.run({sql:e,params:t?t.reduce((d,m,y)=>(d["param"+y]=m,d),{}):void 0,json:!0}),!this.isTransactionActive&&!o&&(yield this.sessionTransaction.commit())}catch(d){try{!this.isTransactionActive&&!o&&(yield this.sessionTransaction.rollback())}catch(m){}throw d}const c=this.driver.options.maxQueryExecutionTime,h=Date.now()-s;this.broadcaster.broadcastAfterQueryEvent(i,e,t,!0,h,a,void 0),c&&h>c&&this.driver.connection.logger.logQuerySlow(h,e,t,this);const f=new Zr;return f.raw=a,f.records=a?a[0]:[],a&&a[1]&&a[1].rowCountExact&&(f.affected=parseInt(a[1].rowCountExact)),n?f:f.records}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),this.broadcaster.broadcastAfterQueryEvent(i,e,t,!1,void 0,void 0,s),new zr(e,t,s)}finally{yield i.wait()}})}updateDDL(e,t){return v(this,null,function*(){if(this.isReleased)throw new zn;this.driver.connection.logger.logQuery(e,t,this);try{const n=Date.now(),[i]=yield this.driver.instanceDatabase.updateSchema(e);yield i.promise();const s=this.driver.options.maxQueryExecutionTime,o=Date.now()-n;s&&o>s&&this.driver.connection.logger.logQuerySlow(o,e,t,this)}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new zr(e,t,n)}})}stream(e,t,n,i){return v(this,null,function*(){if(this.isReleased)throw new zn;try{this.driver.connection.logger.logQuery(e,t,this);const s={sql:e,params:t?t.reduce((o,l,c)=>(o["param"+c]=l,o),{}):void 0,json:!0},a=this.driver.instanceDatabase.runStream(s);return n&&a.on("end",n),i&&a.on("error",i),a}catch(s){throw this.driver.connection.logger.logQueryError(s,e,t,this),new zr(e,t,s)}})}getDatabases(){return v(this,null,function*(){return Promise.resolve([])})}getSchemas(e){return v(this,null,function*(){return Promise.resolve([])})}hasDatabase(e){return v(this,null,function*(){throw new Z("Check database queries are not supported by Spanner driver.")})}getCurrentDatabase(){return v(this,null,function*(){throw new Z("Check database queries are not supported by Spanner driver.")})}hasSchema(e){return v(this,null,function*(){return!!(yield this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length})}getCurrentSchema(){return v(this,null,function*(){throw new Z("Check schema queries are not supported by Spanner driver.")})}hasTable(e){return v(this,null,function*(){const n=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` = '${e instanceof hn?e.name:e}'`;return!!(yield this.query(n)).length})}hasColumn(e,t){return v(this,null,function*(){const i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` = '${e instanceof hn?e.name:e}' AND \`COLUMN_NAME\` = '${t}'`;return!!(yield this.query(i)).length})}createDatabase(e,t){return v(this,null,function*(){if(t&&(yield this.hasDatabase(e)))return Promise.resolve();const n=`CREATE DATABASE "${e}"`,i=`DROP DATABASE "${e}"`;yield this.executeQueries(new Y(n),new Y(i))})}dropDatabase(e,t){return v(this,null,function*(){const n=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,i=`CREATE DATABASE "${e}"`;yield this.executeQueries(new Y(n),new Y(i))})}createSchema(e,t){return v(this,null,function*(){return Promise.resolve()})}dropSchema(e,t,n){return v(this,null,function*(){return Promise.resolve()})}createTable(e,t=!1,n=!0,i=!0){return v(this,null,function*(){if(t&&(yield this.hasTable(e)))return Promise.resolve();const s=[],a=[];s.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach(l=>a.push(this.dropForeignKeySql(e,l))),i&&e.indices.forEach(l=>{l.name||(l.name=this.connection.namingStrategy.indexName(e,l.columnNames,l.where)),s.push(this.createIndexSql(e,l)),a.push(this.dropIndexSql(e,l))});const o=e.columns.filter(l=>l.generatedType&&l.asExpression);for(const l of o){const c=this.insertTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:l.name,value:l.asExpression}),u=this.deleteTypeormMetadataSql({table:e.name,type:wt.GENERATED_COLUMN,name:l.name});s.push(c),a.push(u)}yield this.executeQueries(s,a)})}dropTable(e,t,n=!0,i=!0){return v(this,null,function*(){if(t&&!(yield this.hasTable(e)))return Promise.resolve();const s=n,a=this.getTablePath(e),o=yield this.getCachedTable(a),l=[],c=[];i&&o.indices.forEach(h=>{l.push(this.dropIndexSql(o,h)),c.push(this.createIndexSql(o,h))}),n&&o.foreignKeys.forEach(h=>l.push(this.dropForeignKeySql(o,h))),l.push(this.dropTableSql(o)),c.push(this.createTableSql(o,s));const u=o.columns.filter(h=>h.generatedType&&h.asExpression);for(const h of u){const f=this.deleteTypeormMetadataSql({table:o.name,type:wt.GENERATED_COLUMN,name:h.name}),d=this.insertTypeormMetadataSql({table:o.name,type:wt.GENERATED_COLUMN,name:h.name,value:h.asExpression});l.push(f),c.push(d)}yield this.executeQueries(l,c)})}createView(e){return v(this,null,function*(){const t=[],n=[];t.push(this.createViewSql(e)),t.push(yield this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(yield this.deleteViewDefinitionSql(e)),yield this.executeQueries(t,n)})}dropView(e){return v(this,null,function*(){const t=e instanceof $i?e.name:e,n=yield this.getCachedView(t),i=[],s=[];i.push(yield this.deleteViewDefinitionSql(n)),i.push(this.dropViewSql(n)),s.push(yield this.insertViewDefinitionSql(n)),s.push(this.createViewSql(n)),yield this.executeQueries(i,s)})}renameTable(e,t){return v(this,null,function*(){throw new Z("Rename table queries are not supported by Spanner driver.")})}addColumn(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e),i=n.clone(),s=[],a=[];s.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(t)}`)),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN ${this.driver.escape(t.name)}`));const o=i.indices.find(l=>l.columnNames.length===1&&l.columnNames[0]===t.name);if(o)s.push(this.createIndexSql(n,o)),a.push(this.dropIndexSql(n,o));else if(t.isUnique){const l=new mn({name:this.connection.namingStrategy.indexName(n,[t.name]),columnNames:[t.name],isUnique:!0});i.indices.push(l),i.uniques.push(new Qn({name:l.name,columnNames:l.columnNames})),s.push(this.createIndexSql(n,l)),a.push(this.dropIndexSql(n,l))}if(t.generatedType&&t.asExpression){const l=this.insertTypeormMetadataSql({table:n.name,type:wt.GENERATED_COLUMN,name:t.name,value:t.asExpression}),c=this.deleteTypeormMetadataSql({table:n.name,type:wt.GENERATED_COLUMN,name:t.name});s.push(l),a.push(c)}yield this.executeQueries(s,a),i.addColumn(t),this.replaceCachedTable(n,i)})}addColumns(e,t){return v(this,null,function*(){for(const n of t)yield this.addColumn(e,n)})}renameColumn(e,t,n){return v(this,null,function*(){const i=e instanceof hn?e:yield this.getCachedTable(e),s=t instanceof ar?t:i.columns.find(o=>o.name===t);if(!s)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);let a;return n instanceof ar?a=n:(a=s.clone(),a.name=n),this.changeColumn(i,s,a)})}changeColumn(e,t,n){return v(this,null,function*(){const i=e instanceof hn?e:yield this.getCachedTable(e);let s=i.clone();const a=[],o=[],l=t instanceof ar?t:i.columns.find(c=>c.name===t);if(!l)throw new Z(`Column "${t}" was not found in the "${i.name}" table.`);if(l.name!==n.name||l.type!==n.type||l.length!==n.length||l.isArray!==n.isArray||l.generatedType!==n.generatedType||l.asExpression!==n.asExpression)yield this.dropColumn(i,l),yield this.addColumn(i,n),s=i.clone();else if((n.precision!==l.precision||n.scale!==l.scale)&&(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(l)}`))),l.isNullable!==n.isNullable&&(n.isNullable?(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" DROP NOT NULL`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" SET NOT NULL`))):(a.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" SET NOT NULL`)),o.push(new Y(`ALTER TABLE ${this.escapePath(i)} ALTER COLUMN "${l.name}" DROP NOT NULL`)))),n.isUnique!==l.isUnique)if(n.isUnique===!0){const c=new mn({name:this.connection.namingStrategy.indexName(i,[n.name]),columnNames:[n.name],isUnique:!0});s.indices.push(c),s.uniques.push(new Qn({name:c.name,columnNames:c.columnNames})),a.push(this.createIndexSql(i,c)),o.push(this.dropIndexSql(i,c))}else{const c=s.indices.find(h=>h.columnNames.length===1&&h.isUnique===!0&&!!h.columnNames.find(f=>f===n.name));s.indices.splice(s.indices.indexOf(c),1);const u=s.uniques.find(h=>h.name===c.name);s.uniques.splice(s.uniques.indexOf(u),1),a.push(this.dropIndexSql(i,c)),o.push(this.createIndexSql(i,c))}yield this.executeQueries(a,o),this.replaceCachedTable(i,s)})}changeColumns(e,t){return v(this,null,function*(){for(const{oldColumn:n,newColumn:i}of t)yield this.changeColumn(e,n,i)})}dropColumn(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e),i=t instanceof ar?t:n.findColumnByName(t);if(!i)throw new Z(`Column "${t}" was not found in table "${n.name}"`);const s=n.clone(),a=[],o=[],l=s.indices.find(u=>u.columnNames.length===1&&u.columnNames[0]===i.name);l&&(s.indices.splice(s.indices.indexOf(l),1),a.push(this.dropIndexSql(n,l)),o.push(this.createIndexSql(n,l)));const c=s.checks.find(u=>!!u.columnNames&&u.columnNames.length===1&&u.columnNames[0]===i.name);if(c&&(s.checks.splice(s.checks.indexOf(c),1),a.push(this.dropCheckConstraintSql(n,c)),o.push(this.createCheckConstraintSql(n,c))),a.push(new Y(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN ${this.driver.escape(i.name)}`)),o.push(new Y(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(i)}`)),i.generatedType&&i.asExpression){const u=this.deleteTypeormMetadataSql({table:n.name,type:wt.GENERATED_COLUMN,name:i.name}),h=this.insertTypeormMetadataSql({table:n.name,type:wt.GENERATED_COLUMN,name:i.name,value:i.asExpression});a.push(u),o.push(h)}yield this.executeQueries(a,o),s.removeColumn(i),this.replaceCachedTable(n,s)})}dropColumns(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropColumn(e,n)})}createPrimaryKey(e,t){return v(this,null,function*(){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")})}updatePrimaryKeys(e,t){return v(this,null,function*(){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")})}dropPrimaryKey(e){return v(this,null,function*(){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")})}createUniqueConstraint(e,t){return v(this,null,function*(){throw new Z("Spanner does not support unique constraints. Use unique index instead.")})}createUniqueConstraints(e,t){return v(this,null,function*(){throw new Z("Spanner does not support unique constraints. Use unique index instead.")})}dropUniqueConstraint(e,t){return v(this,null,function*(){throw new Z("Spanner does not support unique constraints. Use unique index instead.")})}dropUniqueConstraints(e,t){return v(this,null,function*(){throw new Z("Spanner does not support unique constraints. Use unique index instead.")})}createCheckConstraint(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n,t.expression));const i=this.createCheckConstraintSql(n,t),s=this.dropCheckConstraintSql(n,t);yield this.executeQueries(i,s),n.addCheckConstraint(t)})}createCheckConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.createCheckConstraint(e,i));yield Promise.all(n)})}dropCheckConstraint(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e),i=t instanceof Gr?t:n.checks.find(o=>o.name===t);if(!i)throw new Z(`Supplied check constraint was not found in table ${n.name}`);const s=this.dropCheckConstraintSql(n,i),a=this.createCheckConstraintSql(n,i);yield this.executeQueries(s,a),n.removeCheckConstraint(i)})}dropCheckConstraints(e,t){return v(this,null,function*(){const n=t.map(i=>this.dropCheckConstraint(e,i));yield Promise.all(n)})}createExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("Spanner does not support exclusion constraints.")})}createExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("Spanner does not support exclusion constraints.")})}dropExclusionConstraint(e,t){return v(this,null,function*(){throw new Z("Spanner does not support exclusion constraints.")})}dropExclusionConstraints(e,t){return v(this,null,function*(){throw new Z("Spanner does not support exclusion constraints.")})}createForeignKey(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const i=this.createForeignKeySql(n,t),s=this.dropForeignKeySql(n,t);yield this.executeQueries(i,s),n.addForeignKey(t)})}createForeignKeys(e,t){return v(this,null,function*(){for(const n of t)yield this.createForeignKey(e,n)})}dropForeignKey(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e),i=t instanceof Mr?t:n.foreignKeys.find(o=>o.name===t);if(!i)throw new Z(`Supplied foreign key was not found in table ${n.name}`);const s=this.dropForeignKeySql(n,i),a=this.createForeignKeySql(n,i);yield this.executeQueries(s,a),n.removeForeignKey(i)})}dropForeignKeys(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropForeignKey(e,n)})}createIndex(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const i=this.createIndexSql(n,t),s=this.dropIndexSql(n,t);yield this.executeQueries(i,s),n.addIndex(t)})}createIndices(e,t){return v(this,null,function*(){for(const n of t)yield this.createIndex(e,n)})}dropIndex(e,t){return v(this,null,function*(){const n=e instanceof hn?e:yield this.getCachedTable(e),i=t instanceof mn?t:n.indices.find(o=>o.name===t);if(!i)throw new Z(`Supplied index ${t} was not found in table ${n.name}`);i.name||(i.name=this.generateIndexName(n,i));const s=this.dropIndexSql(n,i),a=this.createIndexSql(n,i);yield this.executeQueries(s,a),n.removeIndex(i)})}dropIndices(e,t){return v(this,null,function*(){for(const n of[...t])yield this.dropIndex(e,n)})}clearTable(e){return v(this,null,function*(){yield this.query(`DELETE FROM ${this.escapePath(e)} WHERE true`)})}clearDatabase(){return v(this,null,function*(){const t=yield this.query("SELECT concat('DROP INDEX `', INDEX_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`INDEXES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `INDEX_TYPE` = 'INDEX' AND `SPANNER_IS_MANAGED` = false"),i=yield this.query("SELECT concat('ALTER TABLE `', TABLE_NAME, '`', ' DROP CONSTRAINT `', CONSTRAINT_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLE_CONSTRAINTS` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `CONSTRAINT_TYPE` = 'FOREIGN KEY'"),a=yield this.query("SELECT concat('DROP TABLE `', TABLE_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'");if(!t.length&&!i.length&&!a.length)return;const o=this.isTransactionActive;o||(yield this.startTransaction());try{for(const l of t)yield this.updateDDL(l.query);for(const l of i)yield this.updateDDL(l.query);for(const l of a)yield this.updateDDL(l.query);yield this.commitTransaction()}catch(l){try{o||(yield this.rollbackTransaction())}catch(c){}throw l}})}executeMemoryUpSql(){return v(this,null,function*(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)this.isDMLQuery(e)?yield this.query(e,t):yield this.updateDDL(e,t)})}executeMemoryDownSql(){return v(this,null,function*(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())this.isDMLQuery(e)?yield this.query(e,t):yield this.updateDDL(e,t)})}loadViews(e){return v(this,null,function*(){return Promise.resolve([])})}loadTables(e){return v(this,null,function*(){if(e&&e.length===0)return[];const t=[];if(!e||!e.length)t.push(...yield this.query("SELECT `TABLE_NAME` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'"));else{const m=`SELECT \`TABLE_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` IN (${e.map(y=>`'${y}'`).join(", ")})`;t.push(...yield this.query(m))}if(!t.length)return[];const n=t.map(m=>`'${m.TABLE_NAME}'`).join(", "),i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` IN (${n})`,s=`SELECT \`KCU\`.\`TABLE_NAME\`, \`KCU\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'PRIMARY KEY' AND \`TC\`.\`TABLE_NAME\` IN (${n})`,a=`SELECT \`I\`.\`TABLE_NAME\`, \`I\`.\`INDEX_NAME\`, \`I\`.\`IS_UNIQUE\`, \`I\`.\`IS_NULL_FILTERED\`, \`IC\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`INDEXES\` \`I\` INNER JOIN \`INFORMATION_SCHEMA\`.\`INDEX_COLUMNS\` \`IC\` ON \`IC\`.\`INDEX_NAME\` = \`I\`.\`INDEX_NAME\` AND \`IC\`.\`TABLE_NAME\` = \`I\`.\`TABLE_NAME\` WHERE \`I\`.\`TABLE_CATALOG\` = '' AND \`I\`.\`TABLE_SCHEMA\` = '' AND \`I\`.\`TABLE_NAME\` IN (${n}) AND \`I\`.\`INDEX_TYPE\` = 'INDEX' AND \`I\`.\`SPANNER_IS_MANAGED\` = false`,o=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`CC\`.\`CHECK_CLAUSE\`, \`CCU\`.\`COLUMN_NAME\`FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CHECK_CONSTRAINTS\` \`CC\` ON \`CC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'CHECK' AND \`TC\`.\`TABLE_NAME\` IN (${n}) AND \`TC\`.\`CONSTRAINT_NAME\` NOT LIKE 'CK_IS_NOT_NULL%'`,l=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`KCU\`.\`COLUMN_NAME\`, \`CTU\`.\`TABLE_NAME\` AS \`REFERENCED_TABLE_NAME\`, \`CCU\`.\`COLUMN_NAME\` AS \`REFERENCED_COLUMN_NAME\`, \`RC\`.\`UPDATE_RULE\`, \`RC\`.\`DELETE_RULE\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_TABLE_USAGE\` \`CTU\` ON \`CTU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`RC\` ON \`RC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'FOREIGN KEY' AND \`TC\`.\`TABLE_NAME\` IN (${n})`,[c,u,h,f,d]=yield Promise.all([this.query(i),this.query(s),this.query(a),this.query(o),this.query(l)]);return Promise.all(t.map(m=>v(this,null,function*(){const y=new hn;y.name=this.driver.buildTableName(m.TABLE_NAME),y.columns=yield Promise.all(c.filter(N=>N.TABLE_NAME===m.TABLE_NAME).map(N=>v(this,null,function*(){const C=h.filter(J=>J.TABLE_NAME===m.TABLE_NAME&&J.COLUMN_NAME===N.COLUMN_NAME&&J.IS_UNIQUE===!0),I=this.connection.entityMetadatas.find(J=>this.getTablePath(y)===this.getTablePath(J)),H=C.length>0&&I&&I.indices.some(J=>C.some(E=>J.name===E.INDEX_NAME&&J.synchronize===!1)),Q=C.every(J=>h.some(E=>E.INDEX_NAME===J.INDEX_NAME&&E.COLUMN_NAME!==N.COLUMN_NAME)),te=new ar;te.name=N.COLUMN_NAME;let V=N.SPANNER_TYPE.toLowerCase();if(V.indexOf("array")!==-1&&(te.isArray=!0,V=V.substring(V.indexOf("<")+1,V.indexOf(">"))),V.indexOf("(")!==-1?te.type=V.substring(0,V.indexOf("(")):te.type=V,this.driver.withLengthColumnTypes.indexOf(te.type)!==-1&&(te.length=V.substring(V.indexOf("(")+1,V.indexOf(")"))),N.IS_GENERATED==="ALWAYS"){te.asExpression=N.GENERATION_EXPRESSION,te.generatedType="STORED";const J=this.selectTypeormMetadataSql({table:m.TABLE_NAME,type:wt.GENERATED_COLUMN,name:te.name}),E=yield this.query(J.query,J.parameters);E[0]&&E[0].value?te.asExpression=E[0].value:te.asExpression=""}return te.isUnique=C.length>0&&!H&&!Q,te.isNullable=N.IS_NULLABLE==="YES",te.isPrimary=u.some(J=>J.TABLE_NAME===N.TABLE_NAME&&J.COLUMN_NAME===N.COLUMN_NAME),te})));const T=d.filter(N=>N.TABLE_NAME===m.TABLE_NAME);y.foreignKeys=ke.uniq(T,N=>N.CONSTRAINT_NAME).map(N=>{const C=T.filter(I=>I.CONSTRAINT_NAME===N.CONSTRAINT_NAME);return new Mr({name:N.CONSTRAINT_NAME,columnNames:ke.uniq(C.map(I=>I.COLUMN_NAME)),referencedDatabase:N.REFERENCED_TABLE_SCHEMA,referencedTableName:N.REFERENCED_TABLE_NAME,referencedColumnNames:ke.uniq(C.map(I=>I.REFERENCED_COLUMN_NAME)),onDelete:N.DELETE_RULE,onUpdate:N.UPDATE_RULE})});const b=h.filter(N=>N.TABLE_NAME===m.TABLE_NAME);y.indices=ke.uniq(b,N=>N.INDEX_NAME).map(N=>{const C=b.filter(I=>I.INDEX_NAME===N.INDEX_NAME);return new mn({table:y,name:N.INDEX_NAME,columnNames:C.map(I=>I.COLUMN_NAME),isUnique:N.IS_UNIQUE,isNullFiltered:N.IS_NULL_FILTERED})});const S=f.filter(N=>N.TABLE_NAME===m.TABLE_NAME);return y.checks=ke.uniq(S,N=>N.CONSTRAINT_NAME).map(N=>{const C=S.filter(I=>I.CONSTRAINT_NAME===N.CONSTRAINT_NAME);return new Gr({name:N.CONSTRAINT_NAME,columnNames:C.map(I=>I.COLUMN_NAME),expression:N.CHECK_CLAUSE})}),y})))})}createTableSql(e,t){const n=e.columns.map(a=>this.buildCreateColumnSql(a)).join(", ");let i=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter(a=>a.isUnique).forEach(a=>{const o=e.indices.some(c=>c.columnNames.length===1&&!!c.isUnique&&c.columnNames.indexOf(a.name)!==-1),l=e.uniques.some(c=>c.columnNames.length===1&&c.columnNames.indexOf(a.name)!==-1);!o&&!l&&e.indices.push(new mn({name:this.connection.namingStrategy.uniqueConstraintName(e,[a.name]),columnNames:[a.name],isUnique:!0}))}),e.uniques.length>0&&e.uniques.forEach(a=>{e.indices.some(l=>l.name===a.name)||e.indices.push(new mn({name:a.name,columnNames:a.columnNames,isUnique:!0}))}),e.checks.length>0){const a=e.checks.map(o=>`CONSTRAINT \`${o.name?o.name:this.connection.namingStrategy.checkConstraintName(e,o.expression)}\` CHECK (${o.expression})`).join(", ");i+=`, ${a}`}if(e.foreignKeys.length>0&&t){const a=e.foreignKeys.map(o=>{const l=o.columnNames.map(u=>`\`${u}\``).join(", ");o.name||(o.name=this.connection.namingStrategy.foreignKeyName(e,o.columnNames,this.getTablePath(o),o.referencedColumnNames));const c=o.referencedColumnNames.map(u=>`\`${u}\``).join(", ");return`CONSTRAINT \`${o.name}\` FOREIGN KEY (${l}) REFERENCES ${this.escapePath(this.getTablePath(o))} (${c})`}).join(", ");i+=`, ${a}`}i+=")";const s=e.columns.filter(a=>a.isPrimary);if(s.length>0){const a=s.map(o=>this.driver.escape(o.name)).join(", ");i+=` PRIMARY KEY (${a})`}return new Y(i)}dropTableSql(e){return new Y(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e),i=typeof e.expression=="string"?e.expression:e.expression(this.connection).getQuery();return new Y(`CREATE ${t}VIEW ${n} SQL SECURITY INVOKER AS ${i}`)}insertViewDefinitionSql(e){return v(this,null,function*(){const{schema:t,tableName:n}=this.driver.parseTableName(e),i=e.materialized?wt.MATERIALIZED_VIEW:wt.VIEW,s=typeof e.expression=="string"?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:i,schema:t,name:n,value:s})})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new Y(`DROP ${t}VIEW ${this.escapePath(e)}`)}deleteViewDefinitionSql(e){return v(this,null,function*(){const{schema:t,tableName:n}=this.driver.parseTableName(e),i=e.materialized?wt.MATERIALIZED_VIEW:wt.VIEW;return this.deleteTypeormMetadataSql({type:i,schema:t,name:n})})}createIndexSql(e,t){const n=t.columnNames.map(s=>this.driver.escape(s)).join(", ");let i="";return t.isUnique&&(i+="UNIQUE "),t.isNullFiltered&&(i+="NULL_FILTERED "),new Y(`CREATE ${i}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${n})`)}dropIndexSql(e,t){const n=t instanceof mn?t.name:t;return new Y(`DROP INDEX \`${n}\``)}createCheckConstraintSql(e,t){return new Y(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const n=t instanceof Gr?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${n}\``)}createForeignKeySql(e,t){const n=t.columnNames.map(a=>this.driver.escape(a)).join(", "),i=t.referencedColumnNames.map(a=>this.driver.escape(a)).join(","),s=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${i})`;return new Y(s)}dropForeignKeySql(e,t){const n=t instanceof Mr?t.name:t;return new Y(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${n}\``)}escapePath(e){const{tableName:t}=this.driver.parseTableName(e);return`\`${t}\``}buildCreateColumnSql(e){let t=`${this.driver.escape(e.name)} ${this.connection.driver.createFullType(e)}`;return e.generatedType==="STORED"&&e.asExpression?t+=` AS (${e.asExpression}) STORED`:e.isNullable||(t+=" NOT NULL"),t}executeQueries(e,t){return v(this,null,function*(){if(e instanceof Y&&(e=[e]),t instanceof Y&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),this.sqlMemoryMode===!0)return Promise.resolve();for(const{query:n,parameters:i}of e)this.isDMLQuery(n)?yield this.query(n,i):yield this.updateDDL(n,i)})}isDMLQuery(e){return e.startsWith("INSERT")||e.startsWith("UPDATE")||e.startsWith("DELETE")}changeTableComment(e,t){throw new Z("spanner driver does not support change table comment.")}}class aF{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="none",this.supportedDataTypes=["bool","int64","float64","numeric","string","json","bytes","date","timestamp","array"],this.supportedUpsertTypes=[],this.spatialTypes=[],this.withLengthColumnTypes=["string","bytes"],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"timestamp",createDateDefault:"",updateDate:"timestamp",updateDateDefault:"",deleteDate:"timestamp",deleteDateNullable:!0,version:"int64",treeLevel:"int64",migrationId:"int64",migrationName:"string",migrationTimestamp:"int64",cacheId:"string",cacheIdentifier:"string",cacheTime:"int64",cacheDuration:"int64",cacheQuery:"string",cacheResult:"string",metadataType:"string",metadataDatabase:"string",metadataSchema:"string",metadataTable:"string",metadataName:"string",metadataValue:"string"},this.parametersPrefix="@param",this.dataTypeDefaults={},this.maxAliasLength=63,this.cteCapabilities={enabled:!0},this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}connect(){return v(this,null,function*(){this.instance=this.spanner.instance(this.options.instanceId),this.instanceDatabase=this.instance.database(this.options.databaseId)})}afterConnect(){return Promise.resolve()}disconnect(){return v(this,null,function*(){this.instanceDatabase.close()})}createSchemaBuilder(){return new uh(this.connection)}createQueryRunner(e){return new sF(this,e)}escapeQueryWithParameters(e,t,n){const i=Object.keys(n).map(a=>n[a]);if(!t||!Object.keys(t).length)return[e,i];const s=new Map;return e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,o,l)=>{if(!t.hasOwnProperty(l))return a;if(s.has(l))return this.parametersPrefix+s.get(l);const c=t[l];return c===null?a:o?c.map(u=>(i.push(u),this.createParameter(l,i.length-1))).join(", "):c instanceof Function?c():(i.push(c),s.set(l,i.length-1),this.createParameter(l,i.length-1))}),e=e.replace(/([ ]+)?=([ ]+)?:(\.\.\.)?([A-Za-z0-9_.]+)/g,(a,o,l,c,u)=>t.hasOwnProperty(u)&&t[u]===null?" IS NULL":a),[e,i]}escape(e){return`\`${e}\``}buildTableName(e,t,n){const i=[e];return n&&i.unshift(n),i.join(".")}parseTableName(e){const t=this.database,n=void 0;if(e instanceof hn||e instanceof $i){const s=this.parseTableName(e.name);return{database:e.database||s.database||t,schema:e.schema||s.schema||n,tableName:s.tableName}}if(e instanceof Mr){const s=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||s.database||t,schema:e.referencedSchema||s.schema||n,tableName:s.tableName}}if(e instanceof Kr)return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const i=e.split(".");return{database:(i.length>1?i[0]:void 0)||t,schema:n,tableName:i.length>1?i[1]:i[0]}}preparePersistentValue(e,t){return t.transformer&&(e=An.transformTo(t.transformer,e)),e==null?e:t.type==="numeric"?(this.options.driver||Kt.load("spanner")).Spanner.numeric(e.toString()):t.type==="date"?dt.mixedDateToDateString(e):t.type==="json"?e:t.type==="timestamp"||t.type===Date?dt.mixedDateToDate(e):e}prepareHydratedValue(e,t){return e==null?t.transformer?An.transformFrom(t.transformer,e):e:(t.type===Boolean||t.type==="bool"?e=!!e:t.type==="timestamp"||t.type===Date?e=new Date(e):t.type==="numeric"?e=e.value:t.type==="date"?e=dt.mixedDateToDateString(e):t.type==="json"?e=typeof e=="string"?JSON.parse(e):e:t.type===Number&&(e=isNaN(+e)?e:parseInt(e)),t.transformer&&(e=An.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number?"int64":e.type===String||e.type==="uuid"?"string":e.type===Date?"timestamp":e.type===Buffer?"bytes":e.type===Boolean?"bool":e.type||""}normalizeDefault(e){return e.default===""?`"${e.default}"`:`${e.default}`}normalizeIsUnique(e){return e.entityMetadata.indices.some(t=>t.isUnique&&t.columns.length===1&&t.columns[0]===e)}getColumnLength(e){if(e.length)return e.length.toString();if(e.generationStrategy==="uuid")return"36";switch(e.type){case String:case"string":case"bytes":return"max";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:e.precision!==null&&e.precision!==void 0&&e.scale!==null&&e.scale!==void 0?t+=`(${e.precision},${e.scale})`:e.precision!==null&&e.precision!==void 0&&(t+=`(${e.precision})`),e.isArray&&(t=`array<${t}>`),t}obtainMasterConnection(){return this.instanceDatabase}obtainSlaveConnection(){return this.instanceDatabase}createGeneratedMap(e,t,n){if(!t)return;if(t.insertId===void 0)return Object.keys(t).reduce((s,a)=>{const o=e.findColumnWithDatabaseName(a);return o&&ke.mergeDeep(s,o.createValueMap(t[a])),s},{});const i=e.generatedColumns.reduce((s,a)=>{let o;return a.generationStrategy==="increment"&&t.insertId&&(o=t.insertId+n),ke.mergeDeep(s,a.createValueMap(o))},{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter(n=>{const i=e.find(a=>a.name===n.databaseName);return i?i.name!==n.databaseName||i.type!==this.normalizeType(n)||i.length!==this.getColumnLength(n)||i.asExpression!==n.asExpression||i.generatedType!==n.generatedType||i.isPrimary!==n.isPrimary||!this.compareNullableValues(n,i)||i.isUnique!==this.normalizeIsUnique(n):!1})}isReturningSqlSupported(){return!0}isUUIDGenerationSupported(){return!0}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return this.parametersPrefix+t}loadDependencies(){try{const e=this.options.driver||Kt.load("spanner");if(this.options.credentials){this.spanner=new e.Spanner({projectId:this.options.projectId,credentials:this.options.credentials});return}this.spanner=new e.Spanner({projectId:this.options.projectId})}catch(e){throw new io("Spanner","@google-cloud/spanner")}}compareNullableValues(e,t){return e.generatedType?!0:e.isNullable===t.isNullable}compareDefaultValues(e,t){return typeof e=="string"&&typeof t=="string"&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}normalizeDatetimeFunction(e){if(!e)return e;if(e.toUpperCase().indexOf("CURRENT_TIMESTAMP")!==-1||e.toUpperCase().indexOf("NOW")!==-1){const n=e.match(/\(\d+\)/);return n?`CURRENT_TIMESTAMP${n[0]}`:"CURRENT_TIMESTAMP"}else return e}escapeComment(e){return e&&(e=e.replace(/\u0000/g,""),e)}}class oF{create(e){const{type:t}=e.options;switch(t){case"mysql":return new Db(e);case"postgres":return new r_(e);case"cockroachdb":return new h3(e);case"sap":return new d3(e);case"mariadb":return new Db(e);case"sqlite":return new m3(e);case"better-sqlite3":return new y3(e);case"cordova":return new B3(e);case"nativescript":return new j3(e);case"react-native":return new U3(e);case"sqljs":return new W3(e);case"oracle":return new p3(e);case"mssql":return new f3(e);case"mongodb":return new l3(e);case"expo":return new K3(e).create();case"aurora-mysql":return new J3(e);case"aurora-postgres":return new nF(e);case"capacitor":return new iF(e);case"spanner":return new aF(e);default:throw new z2(t,["aurora-mysql","aurora-postgres","better-sqlite3","capacitor","cockroachdb","cordova","expo","mariadb","mongodb","mssql","mysql","nativescript","oracle","postgres","react-native","sap","sqlite","sqljs","spanner"])}}}function Mf(r,e,t=[".js",".cjs",".ts"]){return[]}const lF=new class{constructor(){this.instances=[]}get(r){let e=this.instances.find(t=>t.type===r);return e||(e={type:r,object:new r},this.instances.push(e)),e.object}};function jb(r){return lF.get(r)}class Tr{constructor(e){this["@instanceof"]=Symbol.for("ColumnMetadata"),this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isVirtualProperty=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),e.args.options.default===null&&(this.isNullable=!0),e.args.options.nullable!==void 0&&(this.isNullable=e.args.options.nullable),e.args.options.select!==void 0&&(this.isSelect=e.args.options.select),e.args.options.insert!==void 0&&(this.isInsert=e.args.options.insert),e.args.options.update!==void 0&&(this.isUpdate=e.args.options.update),e.args.options.readonly!==void 0&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),e.args.options.default!==void 0&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),e.args.options.generatedIdentity&&(this.generatedIdentity=e.args.options.generatedIdentity),e.args.options.scale!==null&&e.args.options.scale!==void 0&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),e.args.options.precision!==null&&(this.precision=e.args.options.precision),e.args.options.enum&&(_t.isObject(e.args.options.enum)&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter(t=>isNaN(+t)&&typeof e.args.options.enum[t]!="function").map(t=>e.args.options.enum[t]):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.primaryKeyConstraintName&&(this.primaryKeyConstraintName=e.args.options.primaryKeyConstraintName),e.args.options.foreignKeyConstraintName&&(this.foreignKeyConstraintName=e.args.options.foreignKeyConstraintName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtualProperty=e.args.mode==="virtual-property",this.isVirtual=e.args.mode==="virtual",this.isTreeLevel=e.args.mode==="treeLevel",this.isCreateDate=e.args.mode==="createDate",this.isUpdateDate=e.args.mode==="updateDate",this.isDeleteDate=e.args.mode==="deleteDate",this.isVersion=e.args.mode==="version",this.isObjectId=e.args.mode==="objectId"),this.isVirtualProperty&&(this.isInsert=!1,this.isUpdate=!1),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),e.args.options.srid!==void 0&&(this.srid=e.args.options.srid),e.args.options.query&&(this.query=e.args.options.query),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.createDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.updateDateDefault),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),this.precision===void 0&&e.args.options.precision===void 0&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}createValueMap(e,t=!1){if(this.embeddedMetadata){const n=[...this.embeddedMetadata.parentPropertyNames],i=(s,a)=>{const o=s.shift();return o?(a[o]={},i(s,a[o]),a):((this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),a[t?this.databaseName:this.propertyName]=e,a)};return i(n,{})}else return(this.generationStrategy==="increment"||this.generationStrategy==="rowid")&&this.type==="bigint"&&e!==null&&(e=String(e)),{[t?this.databaseName:this.propertyName]:e}}getEntityValueMap(e,t){var i;if(this.embeddedMetadata){const s=[...this.embeddedMetadata.parentPropertyNames],a=this.embeddedMetadata.isArray,o=(c,u)=>{if(u===void 0)return{};const h=c.shift();if(h){const f=o(c,u[h]);return Object.keys(f).length>0?{[h]:f}:{}}return a&&Array.isArray(u)?u.map(f=>({[this.propertyName]:f[this.propertyName]})):u[this.propertyName]!==void 0?{[this.propertyName]:u[this.propertyName]}:{}},l=o(s,e);return Object.keys(l).length>0?l:void 0}else if(this.relationMetadata&&!((i=Object.getOwnPropertyDescriptor(e,this.relationMetadata.propertyName))!=null&&i.get)&&e[this.relationMetadata.propertyName]&&_t.isObject(e[this.relationMetadata.propertyName])){if(this.relationMetadata.joinColumns.length>1){const s=this.relationMetadata.joinColumns.reduce((a,o)=>{const l=o.referencedColumn.getEntityValueMap(e[this.relationMetadata.propertyName]);return l===void 0?a:ke.mergeDeep(a,l)},{});if(Object.keys(s).length>0)return{[this.propertyName]:s}}else{const s=this.relationMetadata.joinColumns[0].referencedColumn.getEntityValue(e[this.relationMetadata.propertyName]);if(s)return{[this.propertyName]:s}}return}else return e[this.propertyName]!==void 0?{[this.propertyName]:e[this.propertyName]}:void 0}getEntityValue(e,t=!1){if(e==null)return;let n;if(this.embeddedMetadata){const i=[...this.embeddedMetadata.parentPropertyNames],s=this.embeddedMetadata.isArray,a=(l,c)=>{const u=l.shift();return u&&c?a(l,c[u]):c},o=a(i,e);if(o)if(this.relationMetadata&&this.referencedColumn){const l=this.relationMetadata.getEntityValue(o);l&&_t.isObject(l)&&!de.isFindOperator(l)&&!Buffer.isBuffer(l)?n=this.referencedColumn.getEntityValue(l):o[this.propertyName]&&_t.isObject(o[this.propertyName])&&!de.isFindOperator(o[this.propertyName])&&!Buffer.isBuffer(o[this.propertyName])&&!(o[this.propertyName]instanceof Date)?n=this.referencedColumn.getEntityValue(o[this.propertyName]):n=o[this.propertyName]}else this.referencedColumn?n=this.referencedColumn.getEntityValue(o[this.propertyName]):s&&Array.isArray(o)?n=o.map(l=>l[this.propertyName]):n=o[this.propertyName]}else if(this.relationMetadata&&this.referencedColumn){const i=this.relationMetadata.getEntityValue(e);i&&_t.isObject(i)&&!de.isFindOperator(i)&&typeof i!="function"&&!Buffer.isBuffer(i)?n=this.referencedColumn.getEntityValue(i):e[this.propertyName]&&_t.isObject(e[this.propertyName])&&!de.isFindOperator(e[this.propertyName])&&typeof e[this.propertyName]!="function"&&!Buffer.isBuffer(e[this.propertyName])&&!(e[this.propertyName]instanceof Date)?n=this.referencedColumn.getEntityValue(e[this.propertyName]):n=e[this.propertyName]}else this.referencedColumn?n=this.referencedColumn.getEntityValue(e[this.propertyName]):n=e[this.propertyName];return t&&this.transformer&&(n=An.transformTo(this.transformer,n)),n}setEntityValue(e,t){if(this.embeddedMetadata){const n=(i,s)=>{const a=i.shift();return a?(s[a.propertyName]||(s[a.propertyName]=a.create()),n(i,s[a.propertyName]),s):(s[this.propertyName]=t,s)};return n([...this.embeddedMetadata.embeddedMetadataTree],e)}else!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t}compareEntityValue(e,t){const n=this.getEntityValue(e);return typeof(n==null?void 0:n.equals)=="function"?n.equals(t):n===t}build(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this}buildPropertyPath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e}buildDatabasePath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e}buildDatabaseName(e){let t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver.options.type==="mongodb"&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)}}class Ur{constructor(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.isNullFiltered=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,e.args.synchronize!==null&&e.args.synchronize!==void 0&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.isNullFiltered=!!e.args.nullFiltered,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.isConcurrent=e.args.concurrent,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}build(e){if(this.synchronize===!1)return this.name=this.givenName,this;const t={};if(this.givenColumnNames){let n=[];if(Array.isArray(this.givenColumnNames))n=this.givenColumnNames.map(i=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+i:i.trim()),n.forEach(i=>t[i]=1);else{const i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(n=i.map(s=>String(s)),n.forEach(s=>t[s]=1)):(n=Object.keys(i).map(s=>String(s)),Object.keys(i).forEach(s=>t[s]=i[s]))}this.columns=n.map(i=>{const s=this.entityMetadata.columns.find(c=>c.propertyPath===i);if(s)return[s];const a=this.entityMetadata.relations.find(c=>c.isWithJoinColumn&&c.propertyName===i);if(a)return a.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new Z(`Index ${o}contains column that is missing in the entity (${l}): `+i)}).reduce((i,s)=>i.concat(s))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((n,i)=>{const s=this.entityMetadata.columns.find(a=>a.propertyPath===i);return s&&(n[s.databasePath]=t[i]),n},{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tableName,this.columns.map(n=>n.databaseName),this.where),this}}class Wb{constructor(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;const t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("insert")!==-1,this.isCascadeUpdate=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("update")!==-1,this.isCascadeRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("remove")!==-1,this.isCascadeSoftRemove=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("soft-remove")!==-1,this.isCascadeRecover=t.options.cascade===!0||Array.isArray(t.options.cascade)&&t.options.cascade.indexOf("recover")!==-1,this.isNullable=!(t.options.nullable===!1||this.isPrimary),this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=t.options.createForeignKeyConstraints!==!1,this.isEager=t.options.eager||!1,this.persistenceEnabled=t.options.persistence!==!1,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,typeof t.type=="function"?this.type=typeof t.type=="function"?t.type():t.type:de.isEntitySchema(t.type)?this.type=t.type.options.name:_t.isObject(t.type)&&typeof t.type.name=="string"?this.type=t.type.name:this.type=t.type,this.isOneToOne=this.relationType==="one-to-one",this.isOneToMany=this.relationType==="one-to-many",this.isManyToOne=this.relationType==="many-to-one",this.isManyToMany=this.relationType==="many-to-many",this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}getRelationIdMap(e){const n=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(i=>i.referencedColumn);return Kr.getValueMap(e,n)}ensureRelationIdMap(e){if(_t.isObject(e))return e;const n=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map(i=>i.referencedColumn);if(n.length>1)throw new Z("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return n[0].createValueMap(e)}getEntityValue(e,t=!1){if(e!=null)if(this.embeddedMetadata){const n=[...this.embeddedMetadata.parentPropertyNames],i=(a,o)=>{const l=a.shift();return l?o[l]?i(a,o[l]):void 0:o},s=i(n,e);return this.isLazy?s["__"+this.propertyName+"__"]!==void 0?s["__"+this.propertyName+"__"]:t===!0?s[this.propertyName]:void 0:s?s[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}else return this.isLazy?e["__"+this.propertyName+"__"]!==void 0?e["__"+this.propertyName+"__"]:t===!0?e[this.propertyName]:void 0:e[this.propertyName]}setEntityValue(e,t){const n=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){const i=(s,a)=>{const o=s.shift();return o?(a[o.propertyName]||(a[o.propertyName]=o.create()),i(s,a[o.propertyName]),a):(a[n]=t,a)};return i([...this.embeddedMetadata.embeddedMetadataTree],e)}else e[n]=t}createValueMap(e){if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],n=(i,s)=>{const a=i.shift();return a?(s[a]={},n(i,s[a]),s):(s[this.propertyName]=e,s)};return n(t,{})}else return{[this.propertyName]:e}}build(){this.propertyPath=this.buildPropertyPath()}registerForeignKeys(...e){this.foreignKeys.push(...e)}registerJoinColumns(e=[],t=[]){this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner}registerJunctionEntityMetadata(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)}buildInverseSidePropertyPath(){if(this.givenInverseSidePropertyFactory){const e=this.inverseEntityMetadata.propertiesMap;if(typeof this.givenInverseSidePropertyFactory=="function")return this.givenInverseSidePropertyFactory(e);if(typeof this.givenInverseSidePropertyFactory=="string")return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""}buildPropertyPath(){return!this.embeddedMetadata||!this.embeddedMetadata.parentPropertyNames.length?this.propertyName:this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName}}class cF{constructor(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isAlwaysUsingConstructor=!0,this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}create(e){return typeof this.type!="function"?{}:e!=null&&e.fromDeserializer||!this.isAlwaysUsingConstructor?Object.create(this.type.prototype):new this.type}build(e){return this.embeddeds.forEach(t=>t.build(e)),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),e.options.entitySkipConstructor&&(this.isAlwaysUsingConstructor=!e.options.entitySkipConstructor),this}buildPartialPrefix(){if(this.customPrefix===void 0||this.customPrefix===!0)return[this.propertyName];if(this.customPrefix===""||this.customPrefix===!1)return[];if(typeof this.customPrefix=="string")return[this.customPrefix];throw new Z(`Invalid prefix option given for ${this.entityMetadata.targetName}#${this.propertyName}`)}buildPrefix(e){if(e.driver.options.type==="mongodb")return this.propertyName;const t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push(...this.buildPartialPrefix()),t.join("_")}buildParentPropertyNames(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]}buildParentPrefixes(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()}buildEmbeddedMetadataTree(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]}buildColumnsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildColumnsFromTree()),this.columns)}buildRelationsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationsFromTree()),this.relations)}buildListenersFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildListenersFromTree()),this.listeners)}buildIndicesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildIndicesFromTree()),this.indices)}buildUniquesFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildUniquesFromTree()),this.uniques)}buildRelationIdsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationIdsFromTree()),this.relationIds)}buildRelationCountsFromTree(){return this.embeddeds.reduce((e,t)=>e.concat(t.buildRelationCountsFromTree()),this.relationCounts)}}class Hb{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}setValue(e){const t=this.relation.getEntityValue(e);if(Array.isArray(t))e[this.propertyName]=t.map(n=>this.relation.inverseEntityMetadata.getEntityIdMixedMap(n)).filter(n=>n!=null);else{const n=this.relation.inverseEntityMetadata.getEntityIdMixedMap(t);n!==void 0&&(e[this.propertyName]=n)}}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Z(`Cannot find relation ${e}. Wrong relation specified for @RelationId decorator.`);this.relation=t}}class Qb{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}build(){const e=typeof this.relationNameOrFactory=="function"?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Z(`Cannot find relation ${e}. Wrong relation specified for @RelationCount decorator.`);this.relation=t}}class dn{}dn.AFTER_LOAD="after-load";dn.BEFORE_INSERT="before-insert";dn.AFTER_INSERT="after-insert";dn.BEFORE_UPDATE="before-update";dn.AFTER_UPDATE="after-update";dn.BEFORE_REMOVE="before-remove";dn.AFTER_REMOVE="after-remove";dn.BEFORE_SOFT_REMOVE="before-soft-remove";dn.AFTER_SOFT_REMOVE="after-soft-remove";dn.BEFORE_RECOVER="before-recover";dn.AFTER_RECOVER="after-recover";class Qa{constructor(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,this.givenName=e.name,e.namingStrategy&&this.build(e.namingStrategy)}build(e){this.columnNames=this.columns.map(t=>t.databaseName),this.referencedColumnNames=this.referencedColumns.map(t=>t.databaseName),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=this.givenName?this.givenName:e.foreignKeyName(this.entityMetadata.tableName,this.columnNames,this.referencedEntityMetadata.tableName,this.referencedColumnNames)}}class uF{constructor(e){this.connection=e}build(e,t){var c,u;const n=this.collectReferencedColumns(e,t),i=this.collectInverseReferencedColumns(e,t),s=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),a=new Kr({connection:this.connection,args:{target:"",name:s,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema,synchronize:t.synchronize}});a.build();const o=n.map(h=>{const f=t.joinColumns?t.joinColumns.find(m=>(!m.referencedColumnName||m.referencedColumnName===h.propertyName)&&!!m.name):void 0,d=f&&f.name?f.name:this.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,h.propertyName,h.databaseName);return new Tr({connection:this.connection,entityMetadata:a,referencedColumn:h,args:{target:"",mode:"virtual",propertyName:d,options:{name:d,length:!h.length&&(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(h)!=="uuid"&&(h.generationStrategy==="uuid"||h.type==="uuid")?"36":h.length,width:h.width,type:h.type,precision:h.precision,scale:h.scale,charset:h.charset,collation:h.collation,zerofill:h.zerofill,unsigned:h.zerofill?!0:h.unsigned,enum:h.enum,enumName:h.enumName,foreignKeyConstraintName:f==null?void 0:f.foreignKeyConstraintName,nullable:!1,primary:!0}}})}),l=i.map(h=>{const f=t.inverseJoinColumns?t.inverseJoinColumns.find(m=>(!m.referencedColumnName||m.referencedColumnName===h.propertyName)&&!!m.name):void 0,d=f&&f.name?f.name:this.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,h.propertyName,h.databaseName);return new Tr({connection:this.connection,entityMetadata:a,referencedColumn:h,args:{target:"",mode:"virtual",propertyName:d,options:{length:!h.length&&(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(h)!=="uuid"&&(h.generationStrategy==="uuid"||h.type==="uuid")?"36":h.length,width:h.width,type:h.type,precision:h.precision,scale:h.scale,charset:h.charset,collation:h.collation,zerofill:h.zerofill,unsigned:h.zerofill?!0:h.unsigned,enum:h.enum,enumName:h.enumName,foreignKeyConstraintName:f==null?void 0:f.foreignKeyConstraintName,name:d,nullable:!1,primary:!0}}})});return this.changeDuplicatedColumnNames(o,l),a.ownerColumns=o,a.inverseColumns=l,a.ownColumns=[...o,...l],a.ownColumns.forEach(h=>h.relationMetadata=e),a.foreignKeys=e.createForeignKeyConstraints?[new Qa({entityMetadata:a,referencedEntityMetadata:e.entityMetadata,columns:o,referencedColumns:n,name:(c=o[0])==null?void 0:c.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.onDelete||"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.onUpdate||"CASCADE"}),new Qa({entityMetadata:a,referencedEntityMetadata:e.inverseEntityMetadata,columns:l,referencedColumns:i,name:(u=l[0])==null?void 0:u.foreignKeyConstraintName,onDelete:this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:this.connection.driver.options.type==="oracle"||this.connection.driver.options.type==="spanner"?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],a.ownIndices=[new Ur({entityMetadata:a,columns:o,args:{target:a.target,synchronize:!0}}),new Ur({entityMetadata:a,columns:l,args:{target:a.target,synchronize:!0}})],a}collectReferencedColumns(e,t){const n=t.joinColumns?t.joinColumns.find(i=>!!i.referencedColumnName):!1;return!t.joinColumns||t.joinColumns&&!n?e.entityMetadata.columns.filter(i=>i.isPrimary):t.joinColumns.map(i=>{const s=e.entityMetadata.columns.find(a=>a.propertyName===i.referencedColumnName);if(!s)throw new Z(`Referenced column ${i.referencedColumnName} was not found in entity ${e.entityMetadata.name}`);return s})}collectInverseReferencedColumns(e,t){const n=!!t.inverseJoinColumns,i=n?t.inverseJoinColumns.find(s=>!!s.referencedColumnName):!1;return!n||n&&!i?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map(s=>{const a=e.inverseEntityMetadata.ownColumns.find(o=>o.propertyName===s.referencedColumnName);if(!a)throw new Z(`Referenced column ${s.referencedColumnName} was not found in entity ${e.inverseEntityMetadata.name}`);return a})}changeDuplicatedColumnNames(e,t){e.forEach(n=>{t.forEach(i=>{if(n.givenDatabaseName===i.givenDatabaseName){const s=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(n.propertyName,1);n.propertyName=s,n.givenDatabaseName=s;const a=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(i.propertyName,2);i.propertyName=a,i.givenDatabaseName=a}})})}}class hF{constructor(e){this.connection=e}build(e){const t=new Kr({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return t.build(),e.primaryColumns.forEach(n=>{t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,closureType:"ancestor",referencedColumn:n,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(n):n.propertyName+"_ancestor",options:{primary:!0,length:n.length,type:n.type,unsigned:n.unsigned,width:n.width,precision:n.precision,scale:n.scale,zerofill:n.zerofill,charset:n.charset,collation:n.collation}}})),t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,closureType:"descendant",referencedColumn:n,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(n):n.propertyName+"_descendant",options:{primary:!0,length:n.length,type:n.type,unsigned:n.unsigned,width:n.width,precision:n.precision,scale:n.scale,zerofill:n.zerofill,charset:n.charset,collation:n.collation}}}))}),t.ownIndices=[new Ur({entityMetadata:t,columns:[t.ownColumns[0]],args:{target:t.target,synchronize:!0}}),new Ur({entityMetadata:t,columns:[t.ownColumns[1]],args:{target:t.target,synchronize:!0}})],e.treeLevelColumn&&t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),t.foreignKeys=[new Qa({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"}),new Qa({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver.options.type==="mssql"?"NO ACTION":"CASCADE"})],t}}class $c{constructor(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns,this.deferrable=e.args.deferrable)}build(e){const t={};if(this.givenColumnNames){let n=[];if(Array.isArray(this.givenColumnNames))n=this.givenColumnNames.map(i=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+i:i.trim()),n.forEach(i=>t[i]=1);else{const i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(n=i.map(s=>String(s)),n.forEach(s=>t[s]=1)):(n=Object.keys(i).map(s=>String(s)),Object.keys(i).forEach(s=>t[s]=i[s]))}this.columns=n.map(i=>{const s=this.entityMetadata.columns.find(c=>c.propertyPath===i);if(s)return[s];const a=this.entityMetadata.relations.find(c=>c.isWithJoinColumn&&c.propertyName===i);if(a)return a.joinColumns;const o=this.givenName?'"'+this.givenName+'" ':"",l=this.entityMetadata.targetName;throw new Z(`Unique constraint ${o}contains column that is missing in the entity (${l}): `+i)}).reduce((i,s)=>i.concat(s))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce((n,i)=>{const s=this.entityMetadata.columns.find(a=>a.propertyPath===i);return s&&(n[s.databasePath]=t[i]),n},{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tableName,this.columns.map(n=>n.databaseName)),this}}class fF{constructor(e){this.connection=e}build(e,t){var o;const n=this.collectReferencedColumns(e,t),i=this.collectColumns(e,t,n);if(!n.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:i,uniqueConstraint:void 0};const s=new Qa({name:(o=e[0])==null?void 0:o.foreignKeyConstraintName,entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:i,referencedColumns:n,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(i.every(l=>l.isPrimary)||!t.isOneToOne)return{foreignKey:s,columns:i,uniqueConstraint:void 0};const a=new $c({entityMetadata:t.entityMetadata,columns:s.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tableName,s.columns.map(l=>l.databaseName)),target:t.entityMetadata.target}});return a.build(this.connection.namingStrategy),{foreignKey:s,columns:i,uniqueConstraint:a}}collectReferencedColumns(e,t){const n=e.find(a=>!!a.referencedColumnName),i=e.length===0&&t.isManyToOne,s=e.length>0&&!n;return i||s?t.inverseEntityMetadata.primaryColumns:e.map(a=>{const o=t.inverseEntityMetadata.ownColumns.find(l=>l.propertyName===a.referencedColumnName);if(!o)throw new Z(`Referenced column ${a.referencedColumnName} was not found in entity ${t.inverseEntityMetadata.name}`);return o})}collectColumns(e,t,n){return n.map(i=>{const s=e.find(c=>(!c.referencedColumnName||c.referencedColumnName===i.propertyName)&&!!c.name),a=s?s.name:this.connection.namingStrategy.joinColumnName(t.propertyName,i.propertyName);let l=(t.embeddedMetadata?t.embeddedMetadata.columns:t.entityMetadata.ownColumns).find(c=>c.databaseNameWithoutPrefixes===a);return l?l.referencedColumn&&(l=ke.cloneObject(l)):(l=new Tr({connection:this.connection,entityMetadata:t.entityMetadata,embeddedMetadata:t.embeddedMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:a,type:i.type,length:!i.length&&(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql")&&this.connection.driver.normalizeType(i)!=="uuid"&&(i.generationStrategy==="uuid"||i.type==="uuid")?"36":i.length,width:i.width,charset:i.charset,collation:i.collation,precision:i.precision,scale:i.scale,zerofill:i.zerofill,unsigned:i.unsigned,comment:i.comment,enum:i.enum,enumName:i.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(l)),l.referencedColumn=i,l.type=i.type,l.relationMetadata=t,l.build(this.connection),l})}}class zb{constructor(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}isAllowed(e){return this.entityMetadata.target===e.constructor||typeof this.entityMetadata.target=="function"&&e.constructor.prototype instanceof this.entityMetadata.target}execute(e){if(!this.embeddedMetadata){const t=e[this.propertyName];if(!t)throw new Error(`Entity listener method "${this.propertyName}" does not exist in entity "${e.constructor.name}".`);if(typeof t!="function")throw new Error(`Entity listener method "${this.propertyName}" in entity "${e.constructor.name}" must be a function but got "${typeof t}".`);return t.call(e)}this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))}callEntityEmbeddedMethod(e,t){const n=t.shift();!n||!e[n]||(t.length===0?Array.isArray(e[n])?e[n].map(i=>i[this.propertyName]()):e[n][this.propertyName]():e[n]&&this.callEntityEmbeddedMethod(e[n],t))}}class dF{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tableName,this.expression),this}}class pF{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tableName,this.expression),this}}class Gb{constructor(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new uF(e),this.closureJunctionEntityMetadataBuilder=new hF(e),this.relationJoinColumnBuilder=new fF(e)}build(e){const i=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter(s=>s.type==="regular"||s.type==="closure"||s.type==="entity-child"||s.type==="view").map(s=>this.createEntityMetadata(s));return i.forEach(s=>this.computeParentEntityMetadata(i,s)),i.forEach(s=>{s.childEntityMetadatas=i.filter(a=>typeof s.target=="function"&&typeof a.target=="function"&&Mc.isInherited(a.target,s.target))}),i.filter(s=>s.tableType!=="entity-child").forEach(s=>s.build()),i.filter(s=>s.tableType==="entity-child").forEach(s=>s.build()),i.filter(s=>s.tableType!=="entity-child").forEach(s=>this.computeEntityMetadataStep1(i,s)),i.filter(s=>s.tableType==="entity-child").forEach(s=>this.computeEntityMetadataStep1(i,s)),i.forEach(s=>this.computeEntityMetadataStep2(s)),i.forEach(s=>this.computeInverseProperties(s,i)),i.filter(s=>s.tableType!=="entity-child").forEach(s=>{s.relations.filter(a=>a.isOneToOne||a.isManyToOne).forEach(a=>{const o=this.metadataArgsStorage.filterJoinColumns(a.target,a.propertyName),{foreignKey:l,columns:c,uniqueConstraint:u}=this.relationJoinColumnBuilder.build(o,a);if(l&&(a.registerForeignKeys(l),s.foreignKeys.push(l)),c&&a.registerJoinColumns(c),u)if(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="mssql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const h=new Ur({entityMetadata:u.entityMetadata,columns:u.columns,args:{target:u.target,name:u.name,unique:!0,synchronize:!0}});this.connection.driver.options.type==="mssql"&&(h.where=h.columns.map(f=>`${this.connection.driver.escape(f.databaseName)} IS NOT NULL`).join(" AND ")),this.connection.driver.options.type==="spanner"&&(h.isNullFiltered=!0),a.embeddedMetadata?a.embeddedMetadata.indices.push(h):a.entityMetadata.ownIndices.push(h),this.computeEntityMetadataStep2(s)}else a.embeddedMetadata?a.embeddedMetadata.uniques.push(u):a.entityMetadata.ownUniques.push(u),this.computeEntityMetadataStep2(s);if(l&&this.connection.driver.options.type==="cockroachdb"){const h=new Ur({entityMetadata:a.entityMetadata,columns:l.columns,args:{target:a.entityMetadata.target,synchronize:!0}});a.embeddedMetadata?a.embeddedMetadata.indices.push(h):a.entityMetadata.ownIndices.push(h),this.computeEntityMetadataStep2(s)}}),s.relations.filter(a=>a.isManyToMany).forEach(a=>{const o=this.metadataArgsStorage.findJoinTable(a.target,a.propertyName);if(!o)return;const l=this.junctionEntityMetadataBuilder.build(a,o);a.registerForeignKeys(...l.foreignKeys),a.registerJoinColumns(l.ownIndices[0].columns,l.ownIndices[1].columns),a.registerJunctionEntityMetadata(l),this.computeEntityMetadataStep2(l),this.computeInverseProperties(l,i),i.push(l)})}),i.forEach(s=>{s.relationsWithJoinColumns=s.relations.filter(a=>a.isWithJoinColumn),s.hasNonNullableRelations=s.relationsWithJoinColumns.some(a=>!a.isNullable||a.isPrimary)}),i.filter(s=>s.treeType==="closure-table").forEach(s=>{const a=this.closureJunctionEntityMetadataBuilder.build(s);s.closureJunctionTable=a,this.computeEntityMetadataStep2(a),this.computeInverseProperties(a,i),i.push(a)}),i.filter(s=>s.inheritancePattern==="STI"&&s.discriminatorColumn).forEach(s=>this.createKeysForTableInheritance(s)),i.forEach(s=>{s.indices.forEach(a=>a.build(this.connection.namingStrategy))}),i.forEach(s=>{s.uniques.forEach(a=>a.build(this.connection.namingStrategy))}),i.forEach(s=>{s.checks.forEach(a=>a.build(this.connection.namingStrategy))}),i.forEach(s=>{s.exclusions.forEach(a=>a.build(this.connection.namingStrategy))}),i.forEach(s=>this.createForeignKeys(s,i)),i.filter(s=>typeof s.target=="function").forEach(s=>{s.relations.filter(a=>a.isLazy).forEach(a=>{this.connection.relationLoader.enableLazyLoad(a,s.target.prototype)})}),i.forEach(s=>{s.columns.forEach(a=>{const o=this.metadataArgsStorage.findGenerated(a.target,a.propertyName);o&&(a.isGenerated=!0,a.generationStrategy=o.strategy,o.strategy==="uuid"?a.type="uuid":o.strategy==="rowid"?a.type="int":a.type=a.type||Number,a.build(this.connection),this.computeEntityMetadataStep2(s))})}),i}createEntityMetadata(e){const t=typeof e.target=="function"?Mc.getInheritanceTree(e.target):[e.target],n=this.metadataArgsStorage.findInheritanceType(e.target),i=this.metadataArgsStorage.findTree(e.target);let s;return(n&&n.pattern==="STI"||e.type==="entity-child")&&(s=this.metadataArgsStorage.filterSingleTableChildren(e.target).map(a=>a.target).filter(a=>typeof a=="function"),t.push(...s)),new Kr({connection:this.connection,args:e,inheritanceTree:t,tableTree:i,inheritancePattern:n?n.pattern:void 0})}computeParentEntityMetadata(e,t){t.tableType==="entity-child"&&(t.parentEntityMetadata=e.find(n=>n.inheritanceTree.indexOf(t.target)!==-1&&n.inheritancePattern==="STI"))}computeEntityMetadataStep1(e,t){const n=this.metadataArgsStorage.findInheritanceType(t.target),i=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(typeof i!="undefined"?t.discriminatorValue=i.value:t.discriminatorValue=t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map(a=>(t.inheritancePattern==="STI"&&(a.columns=a.columns.map(o=>(o.isNullable=!0,o))),a)),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map(a=>{if(t.tableType==="entity-child")return t.parentEntityMetadata.ownColumns.find(c=>c.propertyName===a.propertyName);if(t.tableType==="regular"&&a.target!==t.target){const c=this.metadataArgsStorage.columns.find(u=>u.propertyName===a.propertyName&&u.target===t.target);c&&c.options.default&&(a.options.default=c.options.default)}const o=new Tr({connection:this.connection,entityMetadata:t,args:a});return e.find(c=>c.tableType==="entity-child"&&c.target===a.target)&&(o.isNullable=!0),o}),n&&n.column){const a=n.column&&n.column.name?n.column.name:"type";let o=t.ownColumns.find(l=>l.propertyName===a);o?o.isDiscriminator=!0:(o=new Tr({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:a,options:n.column||{name:a,type:"varchar",nullable:!1}}}),o.isVirtual=!0,o.isDiscriminator=!0,t.ownColumns.push(o))}if(t.tableType==="entity-child"){const a=t.parentEntityMetadata.ownColumns.find(o=>o.isDiscriminator);a&&!t.ownColumns.find(o=>o===a)&&t.ownColumns.push(a),t.inheritancePattern=t.parentEntityMetadata.inheritancePattern,!t.treeType&&t.parentEntityMetadata.treeType&&(t.treeType=t.parentEntityMetadata.treeType,t.treeOptions=t.parentEntityMetadata.treeOptions,t.treeParentRelation=t.parentEntityMetadata.treeParentRelation,t.treeLevelColumn=t.parentEntityMetadata.treeLevelColumn)}const{namingStrategy:s}=this.connection;if(t.treeType==="materialized-path")t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:s.materializedPathColumnName,type:String,nullable:!0,default:""}}}));else if(t.treeType==="nested-set"){const{left:a,right:o}=s.nestedSetColumnNames;t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:a,options:{name:a,type:Number,nullable:!1,default:1}}})),t.ownColumns.push(new Tr({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:o,options:{name:o,type:Number,nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map(a=>{if(t.tableType==="entity-child"){const o=t.parentEntityMetadata.ownRelations.find(c=>c.propertyName===a.propertyName),l=typeof a.type=="function"?a.type():a.type;if(o.type!==l){const c=Object.create(o);return c.type=l,c}return o}return new Wb({entityMetadata:t,args:a})}),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map(a=>t.tableType==="entity-child"?t.parentEntityMetadata.relationIds.find(o=>o.propertyName===a.propertyName):new Hb({entityMetadata:t,args:a})),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map(a=>t.tableType==="entity-child"?t.parentEntityMetadata.relationCounts.find(o=>o.propertyName===a.propertyName):new Qb({entityMetadata:t,args:a})),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map(a=>new zb({entityMetadata:t,args:a})),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map(a=>new dF({entityMetadata:t,args:a})),this.connection.driver.options.type==="postgres"&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map(a=>new pF({entityMetadata:t,args:a}))),this.connection.driver.options.type==="cockroachdb"){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>!o.unique).map(o=>new Ur({entityMetadata:t,args:o}));const a=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter(o=>o.unique).map(o=>new $c({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns}}));t.ownUniques.push(...a)}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map(a=>new Ur({entityMetadata:t,args:a}));if(Be.isMySQLFamily(this.connection.driver)||this.connection.driver.options.type==="aurora-mysql"||this.connection.driver.options.type==="sap"||this.connection.driver.options.type==="spanner"){const a=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new Ur({entityMetadata:t,args:{target:o.target,name:o.name,columns:o.columns,unique:!0,synchronize:!0}}));t.ownIndices.push(...a)}else{const a=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map(o=>new $c({entityMetadata:t,args:o}));t.ownUniques.push(...a)}}createEmbeddedsRecursively(e,t){return t.map(n=>{const i=new cF({entityMetadata:e,args:n}),s=typeof i.type=="function"?Mc.getInheritanceTree(i.type):[i.type];return i.columns=this.metadataArgsStorage.filterColumns(s).map(a=>new Tr({connection:this.connection,entityMetadata:e,embeddedMetadata:i,args:a})),i.relations=this.metadataArgsStorage.filterRelations(s).map(a=>new Wb({entityMetadata:e,embeddedMetadata:i,args:a})),i.listeners=this.metadataArgsStorage.filterListeners(s).map(a=>new zb({entityMetadata:e,embeddedMetadata:i,args:a})),i.indices=this.metadataArgsStorage.filterIndices(s).map(a=>new Ur({entityMetadata:e,embeddedMetadata:i,args:a})),i.uniques=this.metadataArgsStorage.filterUniques(s).map(a=>new $c({entityMetadata:e,embeddedMetadata:i,args:a})),i.relationIds=this.metadataArgsStorage.filterRelationIds(s).map(a=>new Hb({entityMetadata:e,args:a})),i.relationCounts=this.metadataArgsStorage.filterRelationCounts(s).map(a=>new Qb({entityMetadata:e,args:a})),i.embeddeds=this.createEmbeddedsRecursively(e,this.metadataArgsStorage.filterEmbeddeds(s)),i.embeddeds.forEach(a=>a.parentEmbeddedMetadata=i),e.allEmbeddeds.push(i),i})}computeEntityMetadataStep2(e){e.embeddeds.forEach(t=>t.build(this.connection)),e.embeddeds.forEach(t=>{t.columnsFromTree.forEach(n=>n.build(this.connection)),t.relationsFromTree.forEach(n=>n.build())}),e.ownColumns.forEach(t=>t.build(this.connection)),e.ownRelations.forEach(t=>t.build()),e.relations=e.embeddeds.reduce((t,n)=>t.concat(n.relationsFromTree),e.ownRelations),e.eagerRelations=e.relations.filter(t=>t.isEager),e.lazyRelations=e.relations.filter(t=>t.isLazy),e.oneToOneRelations=e.relations.filter(t=>t.isOneToOne),e.oneToManyRelations=e.relations.filter(t=>t.isOneToMany),e.manyToOneRelations=e.relations.filter(t=>t.isManyToOne),e.manyToManyRelations=e.relations.filter(t=>t.isManyToMany),e.ownerOneToOneRelations=e.relations.filter(t=>t.isOneToOneOwner),e.ownerManyToManyRelations=e.relations.filter(t=>t.isManyToManyOwner),e.treeParentRelation=e.relations.find(t=>t.isTreeParent),e.treeChildrenRelation=e.relations.find(t=>t.isTreeChildren),e.columns=e.embeddeds.reduce((t,n)=>t.concat(n.columnsFromTree),e.ownColumns),e.listeners=e.embeddeds.reduce((t,n)=>t.concat(n.listenersFromTree),e.ownListeners),e.afterLoadListeners=e.listeners.filter(t=>t.type===dn.AFTER_LOAD),e.afterInsertListeners=e.listeners.filter(t=>t.type===dn.AFTER_INSERT),e.afterUpdateListeners=e.listeners.filter(t=>t.type===dn.AFTER_UPDATE),e.afterRemoveListeners=e.listeners.filter(t=>t.type===dn.AFTER_REMOVE),e.afterSoftRemoveListeners=e.listeners.filter(t=>t.type===dn.AFTER_SOFT_REMOVE),e.afterRecoverListeners=e.listeners.filter(t=>t.type===dn.AFTER_RECOVER),e.beforeInsertListeners=e.listeners.filter(t=>t.type===dn.BEFORE_INSERT),e.beforeUpdateListeners=e.listeners.filter(t=>t.type===dn.BEFORE_UPDATE),e.beforeRemoveListeners=e.listeners.filter(t=>t.type===dn.BEFORE_REMOVE),e.beforeSoftRemoveListeners=e.listeners.filter(t=>t.type===dn.BEFORE_SOFT_REMOVE),e.beforeRecoverListeners=e.listeners.filter(t=>t.type===dn.BEFORE_RECOVER),e.indices=e.embeddeds.reduce((t,n)=>t.concat(n.indicesFromTree),e.ownIndices),e.uniques=e.embeddeds.reduce((t,n)=>t.concat(n.uniquesFromTree),e.ownUniques),e.primaryColumns=e.columns.filter(t=>t.isPrimary),e.nonVirtualColumns=e.columns.filter(t=>!t.isVirtual),e.ancestorColumns=e.columns.filter(t=>t.closureType==="ancestor"),e.descendantColumns=e.columns.filter(t=>t.closureType==="descendant"),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter(t=>t.isGenerated||t.isObjectId),e.hasUUIDGeneratedColumns=e.columns.filter(t=>t.isGenerated||t.generationStrategy==="uuid").length>0,e.createDateColumn=e.columns.find(t=>t.isCreateDate),e.updateDateColumn=e.columns.find(t=>t.isUpdateDate),e.deleteDateColumn=e.columns.find(t=>t.isDeleteDate),e.versionColumn=e.columns.find(t=>t.isVersion),e.discriminatorColumn=e.columns.find(t=>t.isDiscriminator),e.treeLevelColumn=e.columns.find(t=>t.isTreeLevel),e.nestedSetLeftColumn=e.columns.find(t=>t.isNestedSetLeft),e.nestedSetRightColumn=e.columns.find(t=>t.isNestedSetRight),e.materializedPathColumn=e.columns.find(t=>t.isMaterializedPath),e.objectIdColumn=e.columns.find(t=>t.isObjectId),e.foreignKeys.forEach(t=>t.build(this.connection.namingStrategy)),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach(t=>t.build()),e.relationCounts.forEach(t=>t.build()),e.embeddeds.forEach(t=>{t.relationIdsFromTree.forEach(n=>n.build()),t.relationCountsFromTree.forEach(n=>n.build())})}computeInverseProperties(e,t){e.relations.forEach(n=>{const i=t.find(s=>s.target===n.type||typeof n.type=="string"&&(s.targetName===n.type||s.givenTableName===n.type));if(!i)throw new Z("Entity metadata for "+e.name+"#"+n.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");n.inverseEntityMetadata=i,n.inverseSidePropertyPath=n.buildInverseSidePropertyPath(),n.inverseRelation=i.relations.find(s=>s.propertyPath===n.inverseSidePropertyPath)})}createKeysForTableInheritance(e){e.indices.some(({givenColumnNames:n})=>{var i;return!!n&&Array.isArray(n)&&n.length===1&&n[0]===((i=e.discriminatorColumn)==null?void 0:i.databaseName)})||e.indices.push(new Ur({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))}createForeignKeys(e,t){this.metadataArgsStorage.filterForeignKeys(e.inheritanceTree).forEach(n=>{var h,f;const i=typeof n.type=="function"?n.type():n.type,s=t.find(d=>typeof i=="string"?d.targetName===i||d.givenTableName===i:de.isEntitySchema(i)?d.target===i.options.name||d.target===i.options.target:d.target===i);if(!s)throw new Z("Entity metadata for "+e.name+(n.propertyName?"#"+n.propertyName:"")+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");const a=(h=n.columnNames)!=null?h:[],o=(f=n.referencedColumnNames)!=null?f:[],l=[],c=[];n.propertyName&&(a.push(n.propertyName),n.inverseSide&&(typeof n.inverseSide=="function"?o.push(n.inverseSide(s.propertiesMap)):o.push(n.inverseSide))),o.length||c.push(...s.primaryColumns);const u=(d,m)=>{const y=m.columns.find(S=>S.propertyName===d||S.databaseName===d);if(y)return y;const T=n.name?'"'+n.name+'" ':"",b=m.targetName;throw new Z(`Foreign key constraint ${T}contains column that is missing in the entity (${b}): ${d}`)};l.push(...a.map(d=>u(d,e))),c.push(...o.map(d=>u(d,s))),e.foreignKeys.push(new Qa(Xe({entityMetadata:e,referencedEntityMetadata:s,namingStrategy:this.connection.namingStrategy,columns:l,referencedColumns:c},n)))})}}class fu extends Z{static createEntitySchemaIsRequiredException(e){return new fu(`EntitySchema is required for ${e} embedded field`)}static createTargetIsRequired(e){return new fu(`Target field is required for ${e} embedded EntitySchema`)}constructor(e){super(e)}}class mF{transform(e){const t=new CT;return e.forEach(n=>{var l;const i=n.options,s={target:i.target||i.name,name:i.tableName,database:i.database,schema:i.schema,type:i.type||"regular",orderBy:i.orderBy,synchronize:i.synchronize,withoutRowid:!!i.withoutRowid,expression:i.expression};t.tables.push(s);const{inheritance:a}=i;a&&t.inheritances.push({target:i.target,pattern:(l=a.pattern)!=null?l:"STI",column:a.column?typeof a.column=="string"?{name:a.column}:a.column:void 0});const{discriminatorValue:o}=i;o&&t.discriminatorValues.push({target:i.target||i.name,value:o}),this.transformColumnsRecursive(i,t)}),t}transformColumnsRecursive(e,t){Object.keys(e.columns).forEach(n=>{const s=e.columns[n];let a="regular";s.createDate&&(a="createDate"),s.updateDate&&(a="updateDate"),s.deleteDate&&(a="deleteDate"),s.version&&(a="version"),s.treeChildrenCount&&(a="treeChildrenCount"),s.treeLevel&&(a="treeLevel"),s.objectId&&(a="objectId"),s.virtualProperty&&(a="virtual-property");const o={target:e.target||e.name,mode:a,propertyName:n,options:{type:s.type,name:s.objectId?"_id":s.name,primaryKeyConstraintName:s.primaryKeyConstraintName,length:s.length,width:s.width,nullable:s.nullable,readonly:s.readonly,update:s.update,select:s.select,insert:s.insert,primary:s.primary,unique:s.unique,comment:s.comment,default:s.default,onUpdate:s.onUpdate,precision:s.precision,scale:s.scale,zerofill:s.zerofill,unsigned:s.unsigned,charset:s.charset,collation:s.collation,enum:s.enum,enumName:s.enumName,asExpression:s.asExpression,generatedType:s.generatedType,hstoreType:s.hstoreType,array:s.array,transformer:s.transformer,spatialFeatureType:s.spatialFeatureType,srid:s.srid,query:s.query}};if(t.columns.push(o),s.generated){const l={target:e.target||e.name,propertyName:n,strategy:typeof s.generated=="string"?s.generated:"increment"};t.generations.push(l)}if(s.unique&&t.uniques.push({target:e.target||e.name,columns:[n]}),s.foreignKey){const l=s.foreignKey,c={target:e.target||e.name,type:l.target,propertyName:n,inverseSide:l.inverseSide,name:l.name,onDelete:l.onDelete,onUpdate:l.onUpdate,deferrable:l.deferrable};t.foreignKeys.push(c)}}),e.relations&&Object.keys(e.relations).forEach(n=>{const i=e.relations[n],s={target:e.target||e.name,propertyName:n,relationType:i.type,isLazy:i.lazy||!1,type:i.target,inverseSideProperty:i.inverseSide,isTreeParent:i.treeParent,isTreeChildren:i.treeChildren,options:{eager:i.eager||!1,cascade:i.cascade,nullable:i.nullable,onDelete:i.onDelete,onUpdate:i.onUpdate,deferrable:i.deferrable,createForeignKeyConstraints:i.createForeignKeyConstraints,persistence:i.persistence,orphanedRowAction:i.orphanedRowAction}};if(t.relations.push(s),i.joinColumn)if(typeof i.joinColumn=="boolean"){const a={target:e.target||e.name,propertyName:n};t.joinColumns.push(a)}else{const a=Array.isArray(i.joinColumn)?i.joinColumn:[i.joinColumn];for(const o of a){const l={target:e.target||e.name,propertyName:n,name:o.name,referencedColumnName:o.referencedColumnName,foreignKeyConstraintName:o.foreignKeyConstraintName};t.joinColumns.push(l)}}if(i.joinTable)if(typeof i.joinTable=="boolean"){const a={target:e.target||e.name,propertyName:n};t.joinTables.push(a)}else{const a={target:e.target||e.name,propertyName:n,name:i.joinTable.name,database:i.joinTable.database,schema:i.joinTable.schema,joinColumns:i.joinTable.joinColumn?[i.joinTable.joinColumn]:i.joinTable.joinColumns,inverseJoinColumns:i.joinTable.inverseJoinColumn?[i.joinTable.inverseJoinColumn]:i.joinTable.inverseJoinColumns};t.joinTables.push(a)}}),e.relationIds&&Object.keys(e.relationIds).forEach(n=>{const i=e.relationIds[n],s={propertyName:n,relation:i.relationName,target:e.target||e.name,alias:i.alias,queryBuilderFactory:i.queryBuilderFactory};t.relationIds.push(s)}),e.indices&&e.indices.forEach(n=>{const i={target:e.target||e.name,name:n.name,unique:n.unique===!0,spatial:n.spatial===!0,fulltext:n.fulltext===!0,nullFiltered:n.nullFiltered===!0,parser:n.parser,synchronize:n.synchronize!==!1,where:n.where,sparse:n.sparse,columns:n.columns};t.indices.push(i)}),e.foreignKeys&&e.foreignKeys.forEach(n=>{const i={target:e.target||e.name,type:n.target,columnNames:n.columnNames,referencedColumnNames:n.referencedColumnNames,name:n.name,onDelete:n.onDelete,onUpdate:n.onUpdate,deferrable:n.deferrable};t.foreignKeys.push(i)}),e.uniques&&e.uniques.forEach(n=>{const i={target:e.target||e.name,name:n.name,columns:n.columns,deferrable:n.deferrable};t.uniques.push(i)}),e.checks&&e.checks.forEach(n=>{const i={target:e.target||e.name,name:n.name,expression:n.expression};t.checks.push(i)}),e.exclusions&&e.exclusions.forEach(n=>{const i={target:e.target||e.name,name:n.name,expression:n.expression};t.exclusions.push(i)}),e.embeddeds&&Object.keys(e.embeddeds).forEach(n=>{const i=e.embeddeds[n];if(!i.schema)throw fu.createEntitySchemaIsRequiredException(n);const s=i.schema.options;t.embeddeds.push({target:e.target||e.name,propertyName:n,isArray:i.array===!0,prefix:i.prefix!==void 0?i.prefix:void 0,type:()=>(s==null?void 0:s.target)||s.name}),this.transformColumnsRecursive(s,t)})}}class yF{constructor(e){this.connection=e}buildMigrations(e){return v(this,null,function*(){const[t]=ke.splitClassesAndStrings(e);return[...t,...yield Mf(this.connection.logger)].map(i=>jb(i))})}buildSubscribers(e){return v(this,null,function*(){const[t]=ke.splitClassesAndStrings(e||[]),n=[...t,...yield Mf(this.connection.logger)];return xr().filterSubscribers(n).map(i=>jb(i.target))})}buildEntityMetadatas(e){return v(this,null,function*(){const[t]=ke.splitClassesAndStrings(e||[]),n=t.filter(c=>!de.isEntitySchema(c)),i=t.filter(c=>de.isEntitySchema(c)),s=[...n,...yield Mf(this.connection.logger)];s.forEach(c=>{de.isEntitySchema(c)&&i.push(c)});const a=new Gb(this.connection,xr()).build(s),o=new mF().transform(i),l=new Gb(this.connection,o).build();return[...a,...l]})}}class fh{constructor(e){this.options=e}logQuery(e,t,n){this.isLogEnabledFor("query")&&this.writeLog("query",{type:"query",prefix:"query",message:e,format:"sql",parameters:t},n)}logQueryError(e,t,n,i){this.isLogEnabledFor("query-error")&&this.writeLog("warn",[{type:"query-error",prefix:"query failed",message:t,format:"sql",parameters:n},{type:"query-error",prefix:"error",message:e}],i)}logQuerySlow(e,t,n,i){this.isLogEnabledFor("query-slow")&&this.writeLog("warn",[{type:"query-slow",prefix:"query is slow",message:t,format:"sql",parameters:n,additionalInfo:{time:e}},{type:"query-slow",prefix:"execution time",message:e}],i)}logSchemaBuild(e,t){this.isLogEnabledFor("schema-build")&&this.writeLog("schema",{type:"schema-build",message:e},t)}logMigration(e,t){this.isLogEnabledFor("migration")&&this.writeLog("log",{type:"migration",message:e},t)}log(e,t,n){switch(e){case"log":if(!this.isLogEnabledFor("log"))return;this.writeLog("log",{type:"log",message:t},n);break;case"info":if(!this.isLogEnabledFor("info"))return;this.writeLog("info",{type:"info",prefix:"info",message:t},n);break;case"warn":if(!this.isLogEnabledFor("warn"))return;this.writeLog("warn",{type:"warn",message:t},n);break}}isLogEnabledFor(e){switch(e){case"query":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("query")!==-1;case"error":case"query-error":return this.options==="all"||this.options===!0||Array.isArray(this.options)&&this.options.indexOf("error")!==-1;case"query-slow":return!0;case"schema":case"schema-build":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("schema")!==-1;case"migration":return!0;case"log":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("log")!==-1;case"info":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("info")!==-1;case"warn":return this.options==="all"||Array.isArray(this.options)&&this.options.indexOf("warn")!==-1;default:return!1}}prepareLogMessages(e,t,n){var s;t=Xe({addColonToPrefix:!0,appendParameterAsComment:!0,highlightSql:!0,formatSql:!1},t);const i=Array.isArray(e)?e:[e];for(let a of i){if(typeof a!="object"&&(a={message:a}),a.format==="sql"){let o=String(a.message);t.formatSql&&(o=Kt.formatSql(o,(s=n==null?void 0:n.connection)==null?void 0:s.options.type)),t.appendParameterAsComment&&a.parameters&&a.parameters.length&&(o+=` -- PARAMETERS: ${this.stringifyParams(a.parameters)}`),t.highlightSql&&(o=Kt.highlightSql(o)),a.message=o}t.addColonToPrefix&&a.prefix&&(a.prefix+=":")}return i}stringifyParams(e){try{return JSON.stringify(e)}catch(t){return e}}}class gF extends fh{writeLog(e,t,n){var s;const i=this.prepareLogMessages(t,{highlightSql:!1});for(const a of i)switch((s=a.type)!=null?s:e){case"log":case"schema-build":case"migration":break;case"info":case"query":a.prefix;break;case"warn":case"query-slow":a.prefix;break;case"error":case"query-error":a.prefix;break}}}class Kb extends fh{writeLog(e,t,n){var s;const i=this.prepareLogMessages(t);for(const a of i)switch((s=a.type)!=null?s:e){case"log":case"schema-build":case"migration":Kt.log(String(a.message));break;case"info":case"query":a.prefix?Kt.logInfo(a.prefix,a.message):Kt.log(String(a.message));break;case"warn":case"query-slow":a.prefix&&Kt.logWarn(a.prefix,a.message);break;case"error":case"query-error":a.prefix&&Kt.logError(a.prefix,String(a.message));break}}}class bF{logQuery(){throw new Error("This logger is not applicable in a browser context")}logQueryError(){throw new Error("This logger is not applicable in a browser context")}logQuerySlow(){throw new Error("This logger is not applicable in a browser context")}logSchemaBuild(){throw new Error("This logger is not applicable in a browser context")}logMigration(){throw new Error("This logger is not applicable in a browser context")}log(){throw new Error("This logger is not applicable in a browser context")}}class EF extends bF{}var Ld={exports:{}},Pf,Yb;function wF(){if(Yb)return Pf;Yb=1;var r=1e3,e=r*60,t=e*60,n=t*24,i=n*7,s=n*365.25;Pf=function(u,h){h=h||{};var f=typeof u;if(f==="string"&&u.length>0)return a(u);if(f==="number"&&isFinite(u))return h.long?l(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(h){var f=parseFloat(h[1]),d=(h[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return f*s;case"weeks":case"week":case"w":return f*i;case"days":case"day":case"d":return f*n;case"hours":case"hour":case"hrs":case"hr":case"h":return f*t;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function o(u){var h=Math.abs(u);return h>=n?Math.round(u/n)+"d":h>=t?Math.round(u/t)+"h":h>=e?Math.round(u/e)+"m":h>=r?Math.round(u/r)+"s":u+"ms"}function l(u){var h=Math.abs(u);return h>=n?c(u,h,n,"day"):h>=t?c(u,h,t,"hour"):h>=e?c(u,h,e,"minute"):h>=r?c(u,h,r,"second"):u+" ms"}function c(u,h,f,d){var m=h>=f*1.5;return Math.round(u/f)+" "+d+(m?"s":"")}return Pf}function vF(r){t.debug=t,t.default=t,t.coerce=l,t.disable=a,t.enable=i,t.enabled=o,t.humanize=wF(),t.destroy=c,Object.keys(r).forEach(u=>{t[u]=r[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let h=0;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(u){let h,f=null,d,m;function y(...T){if(!y.enabled)return;const b=y,S=Number(new Date),N=S-(h||S);b.diff=N,b.prev=h,b.curr=S,h=S,T[0]=t.coerce(T[0]),typeof T[0]!="string"&&T.unshift("%O");let C=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,(H,Q)=>{if(H==="%%")return"%";C++;const te=t.formatters[Q];if(typeof te=="function"){const V=T[C];H=te.call(b,V),T.splice(C,1),C--}return H}),t.formatArgs.call(b,T),(b.log||t.log).apply(b,T)}return y.namespace=u,y.useColors=t.useColors(),y.color=t.selectColor(u),y.extend=n,y.destroy=t.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(d!==t.namespaces&&(d=t.namespaces,m=t.enabled(u)),m),set:T=>{f=T}}),typeof t.init=="function"&&t.init(y),y}function n(u,h){const f=t(this.namespace+(typeof h=="undefined"?":":h)+u);return f.log=this.log,f}function i(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];const h=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of h)f[0]==="-"?t.skips.push(f.slice(1)):t.names.push(f)}function s(u,h){let f=0,d=0,m=-1,y=0;for(;f<u.length;)if(d<h.length&&(h[d]===u[f]||h[d]==="*"))h[d]==="*"?(m=d,y=f,d++):(f++,d++);else if(m!==-1)d=m+1,y++,f=y;else return!1;for(;d<h.length&&h[d]==="*";)d++;return d===h.length}function a(){const u=[...t.names,...t.skips.map(h=>"-"+h)].join(",");return t.enable(""),u}function o(u){for(const h of t.skips)if(s(u,h))return!1;for(const h of t.names)if(s(u,h))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){}return t.enable(t.load()),t}var TF=vF;(function(r,e){var t={};e.formatArgs=i,e.save=s,e.load=a,e.useColors=n,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0)}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;c.splice(1,0,u,"color: inherit");let h=0,f=0;c[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(h++,d==="%c"&&(f=h))}),c.splice(f,0,u)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch(u){}}function a(){let c;try{c=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch(u){}return!c&&typeof process!="undefined"&&"env"in process&&(c=t.DEBUG),c}function o(){try{return localStorage}catch(c){}}r.exports=TF(e);const{formatters:l}=r.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Ld,Ld.exports);var Ti=Ld.exports;class _F extends fh{constructor(){super(...arguments),this.logger={log:Ti.debug("typeorm:log"),info:Ti.debug("typeorm:info"),warn:Ti.debug("typeorm:warn"),error:Ti.debug("typeorm:error"),query:Ti.debug("typeorm:query:log"),"query-error":Ti.debug("typeorm:query:error"),"query-slow":Ti.debug("typeorm:query:slow"),"schema-build":Ti.debug("typeorm:schema"),migration:Ti.debug("typeorm:migration")}}isLogEnabledFor(e){switch(e){case"query":return this.logger.query.enabled;case"query-error":return this.logger["query-error"].enabled;case"query-slow":return!0;case"schema":case"schema-build":return this.logger["schema-build"].enabled;case"migration":return this.logger.migration.enabled;case"log":return this.logger.log.enabled;case"info":return this.logger.info.enabled;case"warn":return this.logger.warn.enabled;default:return!1}}writeLog(e,t,n){var s;const i=this.prepareLogMessages(t,{appendParameterAsComment:!1});for(const a of i){const o=(s=a.type)!=null?s:e;o in this.logger&&(a.prefix?this.logger[o](a.prefix,a.message):this.logger[o](a.message),a.parameters&&a.parameters.length&&this.logger[o]("parameters:",a.parameters))}}}class SF extends fh{writeLog(e,t,n){var s;const i=this.prepareLogMessages(t,{highlightSql:!0,formatSql:!0},n);for(const a of i)switch((s=a.type)!=null?s:e){case"log":case"schema-build":case"migration":Kt.log(String(a.message));break;case"info":case"query":a.prefix?Kt.logInfo(a.prefix,a.message):Kt.log(String(a.message));break;case"warn":case"query-slow":a.prefix&&Kt.logWarn(a.prefix,a.message);break;case"error":case"query-error":a.prefix&&Kt.logError(a.prefix,String(a.message));break}}}class Jb{create(e,t){if(_t.isObject(e))return e;if(e)switch(e){case"simple-console":return new gF(t);case"file":return new EF(t);case"advanced-console":return new Kb(t);case"formatted-console":return new SF(t);case"debug":return new _F}return new Kb(t)}}class CF{constructor(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}connect(){return v(this,null,function*(){const e=this.connection.options.cache;if(this.clientType==="redis"){const t=Xe({},e==null?void 0:e.options);let n=this.redis.createClient(t);typeof n.connect=="function"&&(t.legacyMode=!0,n=this.redis.createClient(t)),this.client=n,typeof this.connection.options.cache=="object"&&this.connection.options.cache.ignoreErrors&&this.client.on("error",s=>{this.connection.logger.log("warn",s)}),typeof this.client.connect=="function"&&(yield this.client.connect()),this.detectRedisVersion()}else if(this.clientType==="ioredis")e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if(this.clientType==="ioredis/cluster")if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else if(e&&e.options&&e.options.startupNodes)this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options);else throw new Z(`options.startupNodes required for ${this.clientType}.`)})}disconnect(){return v(this,null,function*(){if(this.isRedis5OrHigher()){yield this.client.quit(),this.client=void 0;return}return new Promise((e,t)=>{this.client.quit((n,i)=>{if(n)return t(n);e(),this.client=void 0})})})}synchronize(e){return v(this,null,function*(){})}getFromCache(e,t){const n=e.identifier||e.query;return n?this.isRedis5OrHigher()?this.client.get(n).then(i=>i?JSON.parse(i):void 0):new Promise((i,s)=>{this.client.get(n,(a,o)=>{if(a)return s(a);i(o?JSON.parse(o):void 0)})}):Promise.resolve(void 0)}isExpired(e){return e.time+e.duration<Date.now()}storeInCache(e,t,n){return v(this,null,function*(){const i=e.identifier||e.query;if(!i)return;const s=JSON.stringify(e),a=e.duration;if(this.isRedis5OrHigher()){yield this.client.set(i,s,{PX:a});return}return new Promise((o,l)=>{this.client.set(i,s,"PX",a,(c,u)=>{if(c)return l(c);o()})})})}clear(e){return v(this,null,function*(){if(this.isRedis5OrHigher()){yield this.client.flushDb();return}return new Promise((t,n)=>{this.client.flushdb((i,s)=>{if(i)return n(i);t()})})})}remove(e,t){return v(this,null,function*(){yield Promise.all(e.map(n=>this.deleteKey(n)))})}deleteKey(e){return v(this,null,function*(){if(this.isRedis5OrHigher()){yield this.client.del(e);return}return new Promise((t,n)=>{this.client.del(e,(i,s)=>{if(i)return n(i);t()})})})}loadRedis(){try{return this.clientType==="ioredis/cluster"?Kt.load("ioredis"):Kt.load(this.clientType)}catch(e){throw new Z(`Cannot use cache because ${this.clientType} is not installed. Please run "npm i ${this.clientType}".`)}}detectRedisVersion(){if(this.clientType==="redis")try{const e=this.client.set;e&&e.length<=3?this.redisMajorVersion=5:this.redisMajorVersion=3}catch(e){this.redisMajorVersion=3}}isRedis5OrHigher(){return this.clientType!=="redis"?!1:this.redisMajorVersion!==void 0&&this.redisMajorVersion>=5}}class NF{constructor(e){this.connection=e;const{schema:t}=this.connection.driver.options,n=this.connection.driver.database,s=(typeof this.connection.options.cache=="object"?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheDatabase=n,this.queryResultCacheSchema=t,this.queryResultCacheTable=this.connection.driver.buildTableName(s,t,n)}connect(){return v(this,null,function*(){})}disconnect(){return v(this,null,function*(){})}synchronize(e){return v(this,null,function*(){e=this.getQueryRunner(e);const t=this.connection.driver;(yield e.hasTable(this.queryResultCacheTable))||(yield e.createTable(new hn({database:this.queryResultCacheDatabase,schema:this.queryResultCacheSchema,name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:t.options.type==="spanner"?"uuid":"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]})))})}getFromCache(e,t){t=this.getQueryRunner(t);const n=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?n.where(`${n.escape("cache")}.${n.escape("identifier")} = :identifier`).setParameters({identifier:this.connection.driver.options.type==="mssql"?new Fr(e.identifier,"nvarchar"):e.identifier}).cache(!1).getRawOne():e.query?this.connection.driver.options.type==="oracle"?n.where(`dbms_lob.compare(${n.escape("cache")}.${n.escape("query")}, :query) = 0`,{query:e.query}).cache(!1).getRawOne():n.where(`${n.escape("cache")}.${n.escape("query")} = :query`).setParameters({query:this.connection.driver.options.type==="mssql"?new Fr(e.query,"nvarchar"):e.query}).cache(!1).getRawOne():Promise.resolve(void 0)}isExpired(e){const t=typeof e.duration=="string"?parseInt(e.duration):e.duration;return(typeof e.time=="string"?parseInt(e.time):e.time)+t<Date.now()}storeInCache(e,t,n){return v(this,null,function*(){const i=n===void 0||(n==null?void 0:n.getReplicationMode())==="slave";(n===void 0||i)&&(n=this.connection.createQueryRunner("master"));let s=e;if(this.connection.driver.options.type==="mssql"&&(s={identifier:new Fr(e.identifier,"nvarchar"),time:new Fr(e.time,"bigint"),duration:new Fr(e.duration,"int"),query:new Fr(e.query,"nvarchar"),result:new Fr(e.result,"nvarchar")}),t&&t.identifier){const a=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(s);a.where(`${a.escape("identifier")} = :condition`,{condition:s.identifier}),yield a.execute()}else if(t&&t.query){const a=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(s);this.connection.driver.options.type==="oracle"?a.where('dbms_lob.compare("query", :condition) = 0',{condition:s.query}):a.where(`${a.escape("query")} = :condition`,{condition:s.query}),yield a.execute()}else this.connection.driver.options.type==="spanner"&&!s.id&&(s.id=ZT()),yield n.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(s).execute();i&&(yield n.release())})}clear(e){return v(this,null,function*(){return this.getQueryRunner(e).clearTable(this.queryResultCacheTable)})}remove(e,t){return v(this,null,function*(){const n=t||this.getQueryRunner();yield Promise.all(e.map(i=>{const s=n.manager.createQueryBuilder();return s.delete().from(this.queryResultCacheTable).where(`${s.escape("identifier")} = :identifier`,{identifier:i}).execute()})),t||(yield n.release())})}getQueryRunner(e){return e||this.connection.createQueryRunner()}}class Xb{constructor(e){this.connection=e}create(){if(!this.connection.options.cache)throw new Z("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");const e=this.connection.options.cache;return e.provider&&typeof e.provider=="function"?e.provider(this.connection):e.type==="redis"||e.type==="ioredis"||e.type==="ioredis/cluster"?new CF(this.connection,e.type):new NF(this.connection)}}class AF{constructor(e){this.connection=e}load(e,t,n,i){return n&&n.isReleased&&(n=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,n,i):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,n,i):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,n,i):this.loadManyToManyNotOwner(e,t,n,i)}loadManyToOneOrOneToOneOwner(e,t,n,i){const s=Array.isArray(t)?t:[t],a=e.entityMetadata.name,o=i||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,c=e.entityMetadata.primaryColumns,h=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map(f=>`${e.entityMetadata.name}.${f.propertyName} = ${l}.${f.referencedColumn.propertyName}`).join(" AND ");if(o.innerJoin(e.entityMetadata.target,a,h),c.length===1)o.where(`${a}.${c[0].propertyPath} IN (:...${a+"_"+c[0].propertyName})`),o.setParameter(a+"_"+c[0].propertyName,s.map(f=>c[0].getEntityValue(f,!0)));else{const f=s.map((d,m)=>c.map((y,T)=>{const b=a+"_entity_"+m+"_"+T;return o.setParameter(b,y.getEntityValue(d,!0)),a+"."+y.propertyPath+" = :"+b}).join(" AND ")).map(d=>"("+d+")").join(" OR ");o.where(f)}return jn.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadOneToManyOrOneToOneNotOwner(e,t,n,i){const s=Array.isArray(t)?t:[t],a=e.inverseRelation.joinColumns,o=i||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.inverseRelation.entityMetadata.target,e.propertyName),l=o.expressionMap.mainAlias.name;if(a.length===1)o.where(`${l}.${a[0].propertyPath} IN (:...${l+"_"+a[0].propertyName})`),o.setParameter(l+"_"+a[0].propertyName,s.map(c=>a[0].referencedColumn.getEntityValue(c,!0)));else{const c=s.map((u,h)=>a.map((f,d)=>{const m=l+"_entity_"+h+"_"+d;return o.setParameter(m,f.referencedColumn.getEntityValue(u,!0)),l+"."+f.propertyPath+" = :"+m}).join(" AND ")).map(u=>"("+u+")").join(" OR ");o.where(c)}return jn.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyOwner(e,t,n,i){const s=Array.isArray(t)?t:[t],a=e.joinColumns.reduce((f,d)=>(f[d.propertyName]=s.map(m=>d.referencedColumn.getEntityValue(m,!0)),f),{}),o=i||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),l=o.expressionMap.mainAlias.name,c=e.junctionEntityMetadata.tableName,u=e.joinColumns.map(f=>`${c}.${f.propertyName} IN (:...${f.propertyName})`),h=e.inverseJoinColumns.map(f=>`${c}.${f.propertyName}=${l}.${f.referencedColumn.propertyName}`);return o.innerJoin(c,c,[...u,...h].join(" AND ")).setParameters(a),jn.joinEagerRelations(o,o.alias,o.expressionMap.mainAlias.metadata),o.getMany()}loadManyToManyNotOwner(e,t,n,i){const s=Array.isArray(t)?t:[t],a=i||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),o=a.expressionMap.mainAlias.name,l=e.junctionEntityMetadata.tableName,c=e.inverseRelation.joinColumns.map(f=>`${l}.${f.propertyName} = ${o}.${f.referencedColumn.propertyName}`),u=e.inverseRelation.inverseJoinColumns.map(f=>`${l}.${f.propertyName} IN (:...${f.propertyName})`),h=e.inverseRelation.inverseJoinColumns.reduce((f,d)=>(f[d.propertyName]=s.map(m=>d.referencedColumn.getEntityValue(m,!0)),f),{});return a.innerJoin(l,l,[...c,...u].join(" AND ")).setParameters(h),jn.joinEagerRelations(a,a.alias,a.expressionMap.mainAlias.metadata),a.getMany()}enableLazyLoad(e,t,n){const i=this,s="__"+e.propertyName+"__",a="__promise_"+e.propertyName+"__",o="__has_"+e.propertyName+"__",l=(u,h)=>(u[s]=h,u[o]=!0,delete u[a],h),c=(u,h)=>(delete u[o],delete u[s],u[a]=h,h.then(f=>u[a]===h?l(u,f):f),h);Object.defineProperty(t,e.propertyName,{get:function(){if(this[o]===!0||this[s]!==void 0)return Promise.resolve(this[s]);if(this[a])return this[a];const u=i.load(e,this,n).then(h=>e.isOneToOne||e.isManyToOne?h.length===0?null:h[0]:h);return c(this,u)},set:function(u){u instanceof Promise?c(this,u):l(this,u)},configurable:!0,enumerable:!1})}}n_();class xF{constructor(e){this["@instanceof"]=Symbol.for("DataSource"),this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.entityMetadatasMap=new Map,n_(),this.name=e.name||"default",this.options=e,this.logger=new Jb().create(this.options.logger,this.options.logging),this.driver=new oF().create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new s3,this.metadataTableName=e.metadataTableName||"typeorm_metadata",this.queryResultCache=e.cache?new Xb(this).create():void 0,this.relationLoader=new AF(this),this.relationIdLoader=new e_(this),this.isInitialized=!1}get isConnected(){return this.isInitialized}get mongoManager(){if(!de.isMongoEntityManager(this.manager))throw new Z("MongoEntityManager is only available for MongoDB databases.");return this.manager}get sqljsManager(){if(!de.isSqljsEntityManager(this.manager))throw new Z("SqljsEntityManager is only available for Sqljs databases.");return this.manager}setOptions(e){return Object.assign(this.options,e),(e.logger||e.logging)&&(this.logger=new Jb().create(e.logger||this.options.logger,e.logging||this.options.logging)),e.namingStrategy&&(this.namingStrategy=e.namingStrategy),e.cache&&(this.queryResultCache=new Xb(this).create()),e.database&&(this.driver.database=Be.buildDriverOptions(this.options).database),this}initialize(){return v(this,null,function*(){if(this.isInitialized)throw new L2(this.name);yield this.driver.connect(),this.queryResultCache&&(yield this.queryResultCache.connect()),_t.assign(this,{isInitialized:!0});try{yield this.buildMetadatas(),yield this.driver.afterConnect(),this.options.dropSchema&&(yield this.dropDatabase()),this.options.migrationsRun&&(yield this.runMigrations({transaction:this.options.migrationsTransactionMode})),this.options.synchronize&&(yield this.synchronize())}catch(e){throw yield this.destroy(),e}return this})}connect(){return v(this,null,function*(){return this.initialize()})}destroy(){return v(this,null,function*(){if(!this.isInitialized)throw new Ro(this.name);yield this.driver.disconnect(),this.queryResultCache&&(yield this.queryResultCache.disconnect()),_t.assign(this,{isInitialized:!1})})}close(){return v(this,null,function*(){return this.destroy()})}synchronize(e=!1){return v(this,null,function*(){if(!this.isInitialized)throw new Ro(this.name);e&&(yield this.dropDatabase()),yield this.driver.createSchemaBuilder().build()})}dropDatabase(){return v(this,null,function*(){const e=this.createQueryRunner();try{if(this.driver.options.type==="mssql"||Be.isMySQLFamily(this.driver)||this.driver.options.type==="aurora-mysql"||Be.isSQLiteFamily(this.driver)){const t=[];if(this.entityMetadatas.forEach(n=>{n.database&&t.indexOf(n.database)===-1&&t.push(n.database)}),t.length===0&&this.driver.database&&t.push(this.driver.database),t.length===0)yield e.clearDatabase();else for(const n of t)yield e.clearDatabase(n)}else yield e.clearDatabase()}finally{yield e.release()}})}runMigrations(e){return v(this,null,function*(){var i;if(!this.isInitialized)throw new Ro(this.name);const t=new Af(this);return t.transaction=(e==null?void 0:e.transaction)||((i=this.options)==null?void 0:i.migrationsTransactionMode)||"all",t.fake=e&&e.fake||!1,yield t.executePendingMigrations()})}undoLastMigration(e){return v(this,null,function*(){if(!this.isInitialized)throw new Ro(this.name);const t=new Af(this);t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,yield t.undoLastMigration()})}showMigrations(){return v(this,null,function*(){if(!this.isInitialized)throw new Ro(this.name);return yield new Af(this).showMigrations()})}hasMetadata(e){return!!this.findMetadata(e)}getMetadata(e){const t=this.findMetadata(e);if(!t)throw new U2(e);return t}getRepository(e){return this.manager.getRepository(e)}getTreeRepository(e){return this.manager.getTreeRepository(e)}getMongoRepository(e){if(this.driver.options.type!=="mongodb")throw new Z("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)}getCustomRepository(e){return this.manager.getCustomRepository(e)}transaction(e,t){return v(this,null,function*(){return this.manager.transaction(e,t)})}query(e,t,n){return v(this,null,function*(){if(de.isMongoEntityManager(this.manager))throw new Z("Queries aren't supported by MongoDB.");if(n&&n.isReleased)throw new RT;const i=n||this.createQueryRunner();try{return yield i.query(e,t)}finally{n||(yield i.release())}})}sql(e,...t){return v(this,null,function*(){const{query:n,parameters:i}=ch({driver:this.driver,strings:e,expressions:t});return yield this.query(n,i)})}createQueryBuilder(e,t,n){if(de.isMongoEntityManager(this.manager))throw new Z("Query Builder is not supported by MongoDB.");if(t){t=Be.buildAlias(this.driver,void 0,t);const i=this.getMetadata(e);return new ml(this,n).select(t).from(i.target,t)}else return new ml(this,e)}createQueryRunner(e="master"){const t=this.driver.createQueryRunner(e),n=this.createEntityManager(t);return Object.assign(t,{manager:n}),t}getManyToManyMetadata(e,t){const n=this.getMetadata(e).findRelationWithPropertyPath(t);if(!n)throw new Z(`Relation "${t}" was not found in ${e} entity.`);if(!n.isManyToMany)throw new Z(`Relation "${e}#${t}" does not have a many-to-many relationship.You can use this method only on many-to-many relations.`);return n.junctionEntityMetadata}createEntityManager(e){return new q3().create(this,e)}findMetadata(e){const t=this.entityMetadatasMap.get(e);if(t)return t;for(const[n,i]of this.entityMetadatasMap){if(de.isEntitySchema(e)&&i.name===e.options.name)return i;if(typeof e=="string"){if(e.indexOf(".")!==-1){if(i.tablePath===e)return i}else if(i.name===e||i.tableName===e)return i}if(_t.isObjectWithName(e)&&typeof e.name=="string"){if(e.name.indexOf(".")!==-1){if(i.tablePath===e.name)return i}else if(i.name===e.name||i.tableName===e.name)return i}}}buildMetadatas(){return v(this,null,function*(){const e=new yF(this),t=new o3,n=_t.mixedListToArray(this.options.subscribers||[]),i=yield e.buildSubscribers(n);_t.assign(this,{subscribers:i});const s=_t.mixedListToArray(this.options.entities||[]),a=yield e.buildEntityMetadatas(s);_t.assign(this,{entityMetadatas:a,entityMetadatasMap:new Map(a.map(c=>[c.target,c]))});const o=_t.mixedListToArray(this.options.migrations||[]),l=yield e.buildMigrations(o);_t.assign(this,{migrations:l}),t.validateMany(this.entityMetadatas.filter(c=>c.tableType!=="view"),this.driver);for(const c of a)de.isBaseEntityConstructor(c.target)&&c.target.useDataSource(this)})}defaultReplicationModeForReads(){if("replication"in this.driver.options&&this.driver.options.replication){const e=this.driver.options.replication.defaultMode;if(e)return e}return"slave"}}function xr(){const r=Kt.getGlobalVariable();return r.typeormMetadataArgsStorage||(r.typeormMetadataArgsStorage=new CT),r.typeormMetadataArgsStorage}function ki(r,e){return function(t,n){let i;typeof r=="string"||typeof r=="function"?i=r:r&&(e=r,i=r.type),e||(e={});const s=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,n):void 0;if(!i&&s&&(i=s),!e.type&&i&&(e.type=i),e.type==="hstore"&&!e.hstoreType&&(e.hstoreType=s===Object?"object":"string"),typeof r=="function")xr().embeddeds.push({target:t.constructor,propertyName:n,isArray:s===Array||e.array===!0,prefix:e.prefix!==void 0?e.prefix:void 0,type:r});else{if(!e.type)throw new rq(t,n);e.unique===!0&&xr().uniques.push({target:t.constructor,columns:[n]}),xr().columns.push({target:t.constructor,propertyName:n,mode:"regular",options:e}),e.generated&&xr().generations.push({target:t.constructor,propertyName:n,strategy:typeof e.generated=="string"?e.generated:"increment"})}}}function RF(r){return function(e,t){xr().columns.push({target:e.constructor,propertyName:t,mode:"createDate",options:{}})}}function MF(r,e){const t={};let n;return n="increment",_t.isObject(e)&&Object.assign(t,e),function(i,s){t.type||(n==="increment"||n==="identity"?t.type=Number:n==="uuid"?t.type="uuid":n==="rowid"&&(t.type="int")),t.primary=!0,xr().columns.push({target:i.constructor,propertyName:s,mode:"regular",options:t}),xr().generations.push({target:i.constructor,propertyName:s,strategy:n})}}function PF(r,e){const t=(_t.isObject(r)?r:e)||{},n=r;return function(i){xr().tables.push({target:i,name:n,type:"regular",orderBy:t.orderBy?t.orderBy:void 0,engine:t.engine?t.engine:void 0,database:t.database?t.database:void 0,schema:t.schema?t.schema:void 0,synchronize:t.synchronize,withoutRowid:t.withoutRowid,comment:t.comment?t.comment:void 0})}}var IF=Object.defineProperty,OF=Object.getOwnPropertyDescriptor,Dr=(r,e,t,n)=>{for(var i=n>1?void 0:n?OF(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&IF(e,t,i),i};let Bn=class{constructor(){wn(this,"id");wn(this,"time");wn(this,"finishTime");wn(this,"shape");wn(this,"color");wn(this,"consistency");wn(this,"frequency");wn(this,"surface");wn(this,"odor");wn(this,"buoyancy");wn(this,"size")}get duration(){return this.time&&this.finishTime?this.finishTime.valueOf()-this.time.valueOf():0}};Dr([MF()],Bn.prototype,"id",2);Dr([RF()],Bn.prototype,"time",2);Dr([ki({type:"datetime",nullable:!0,default:0})],Bn.prototype,"finishTime",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"shape",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"color",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"consistency",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"frequency",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"surface",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"odor",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"buoyancy",2);Dr([ki({type:"varchar",nullable:!0,default:""})],Bn.prototype,"size",2);Bn=Dr([PF("stool_records")],Bn);Object.assign(window||global,{localforage:_2});let If=null;function $F(){return v(this,null,function*(){return If||(If=yield A2({locateFile:r=>`https://sql.js.org/dist/${r}`})),If})}let du=null;function DF(){return v(this,null,function*(){Pv({title:"初始化中"});try{const r=yield $F();du=new xF({type:"sqljs",driver:r,autoSave:!0,useLocalForage:!0,location:"database",entities:[Bn],synchronize:!0,logging:!1}),yield du.initialize(),tu()}catch(r){tu()}})}function _i(){if(!du)throw new Error("数据库未初始化，请先调用 initTypeORM()");return du.getRepository(Bn)}function LF(){return v(this,null,function*(){yield _i().createQueryBuilder().delete().from(Bn).execute()})}function qF(){return v(this,null,function*(){yield DF()})}const l_=Lt({__name:"App",setup(r){return y$(e=>{qF()}),Ku(e=>{e!=null&&e.path?Ea.invoke({url:`/${e.path}`,query:e.query}):Ea.invoke({url:"/"})}),m$(()=>{}),()=>{}}});NI(l_);function kF(r){return!r||typeof r!="object"||Array.isArray(r)?"":Object.entries(r).filter(([e,t])=>t!=null).map(([e,t])=>{const n=encodeURIComponent(e);return Array.isArray(t)?t.filter(i=>i!=null).map(i=>`${n}=${encodeURIComponent(i)}`).join("&"):`${n}=${encodeURIComponent(t)}`}).join("&")}const BF=RD(),Zb={invoke(r){if(r.query){const n=kF(r.query);r.url.includes("?")?r.url+=`&${n}`:r.url+=`?${n}`}r.url.startsWith("http")||(JSON.parse("false")?r.url="/fg-api"+r.url:r.url=BF+r.url),r.timeout=6e4,r.header=Tt(Xe({},r.header),{"Content-Type":"application/json; charset=utf-8",platform:CD});const t=Ju().validToken;return t&&(r.header.Authorization=`Bearer ${t}`),r}},FF={install(){ba("request",Zb),ba("uploadFile",Zb)}};function UF(){const r=xD();if(!/%.+?%/.test(r))return;const t=TT(r);!t||t===r||oO({title:t})}const VF=Lt({__name:"default",setup(r){return Ku(()=>{UF()}),(e,t)=>Bt(e.$slots,"default")}});function jF(){const r=l0(l_);return r.use(fT),r.use(f2),r.use(TD),r.use(FF),r.component("layout-default-uni",VF),r.component("global-ku-root",w2),{app:r}}jF().app.use(wI).mount("#app");const WF="data:image/svg+xml,%3csvg%20t='1758682502345'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1300'%20width='200'%20height='200'%3e%3cpath%20d='M867.958133%20395.630591H254.624519v424.622195h613.333614c54.387256%200%2098.476654-95.0547%2098.476654-212.311098s-44.089397-212.311097-98.476654-212.311097z'%20fill='%23F4DDB2'%20p-id='1301'%3e%3c/path%3e%3cpath%20d='M156.147865%20607.941688a212.311097%2098.476654%2090%201%200%20196.953307%200%20212.311097%2098.476654%2090%201%200-196.953307%200Z'%20fill='%2391B6FF'%20p-id='1302'%3e%3c/path%3e%3cpath%20d='M254.624519%20395.630591c-9.47987%200-18.643745%202.89596-27.319627%208.285887%2041.097438%2025.531651%2071.157027%20107.206534%2071.157027%20204.02721s-30.061589%20178.49356-71.157027%20204.027211c8.675881%205.389926%2017.839756%208.285887%2027.319627%208.285887%2054.387256%200%2098.476654-95.0547%2098.476653-212.311098%200-117.260397-44.089397-212.315097-98.476653-212.315097z'%20fill='%237DA8FF'%20p-id='1303'%3e%3c/path%3e%3cpath%20d='M966.434787%20607.941688c0-117.256397-44.089397-212.311097-98.476654-212.311097H254.624519c54.387256%200%2098.476654%2095.0547%2098.476653%20212.311097l44.257395%20321.391606c4.121944%2029.931591%2034.483529%2048.709334%2063.105138%2039.025467l54.391256-18.401749a48.127342%2048.127342%200%200%201%2030.325585-0.173997l98.976647%2032.227559a48.129342%2048.129342%200%200%200%2030.675581-0.293996l90.65076-31.44757a48.121342%2048.121342%200%200%201%2031.339572-0.071999l93.238725%2031.867564a48.127342%2048.127342%200%200%200%2029.201601%200.613992l55.223245-16.313777c22.821688-6.741908%2037.29149-29.149601%2034.043535-52.723279z'%20fill='%23D8ECFE'%20p-id='1304'%3e%3c/path%3e%3cpath%20d='M742.185853%20950.197009a48.121342%2048.121342%200%200%200-31.339572%200.071999l-79.484913%2027.575623%2012.797825%204.165943a48.129342%2048.129342%200%200%200%2030.675581-0.293996l79.192917-27.473624zM490.543293%20949.783015a48.127342%2048.127342%200%200%200-30.325585%200.173997l-40.537446%2013.715813c11.68984%207.247901%2026.455638%209.53587%2040.785443%204.687936l42.729415-14.455803z'%20fill='%23D8ECFE'%20p-id='1305'%3e%3c/path%3e%3cpath%20d='M1008.532211%20913.641509l-42.097424-305.699821c0-117.256397-44.089397-212.311097-98.476654-212.311097h-54.637253c54.387256%200%2098.476654%2095.0547%2098.476654%20212.311097l42.097424%20305.699821c3.245956%2023.573678-11.221847%2045.981371-34.043534%2052.723279l-40.615445%2011.997836%2010.827852%203.699949a48.127342%2048.127342%200%200%200%2029.201601%200.613992l55.223245-16.313777c22.821688-6.739908%2037.28949-29.147601%2034.043534-52.721279z'%20fill='%23B3DAFE'%20p-id='1306'%3e%3c/path%3e%3cpath%20d='M828.798669%20192.203372H80.678897V39.409461h819.030802v81.882881c0%2039.163465-31.747566%2070.911031-70.91103%2070.91103z'%20fill='%232B4D66'%20p-id='1307'%3e%3c/path%3e%3cpath%20d='M845.072446%2039.409461v81.882881c0%2039.163465-31.747566%2070.911031-70.91303%2070.91103h54.639253c39.163465%200%2070.91303-31.747566%2070.91303-70.91103V39.409461z'%20fill='%23234459'%20p-id='1308'%3e%3c/path%3e%3cpath%20d='M226.406905%20562.028316H193.357356a14.199806%2014.199806%200%200%201-14.201805-14.201806V192.203372H80.678897v401.494511c0%2033.235546%2026.943632%2060.179177%2060.179177%2060.179177h85.548831c16.08178%200%2029.119602-13.037822%2029.119601-29.119602v-33.60954c0-16.08178-13.037822-29.119602-29.119601-29.119602z'%20fill='%232B4D66'%20p-id='1309'%3e%3c/path%3e%3cpath%20d='M226.406905%20562.028316H193.357356a14.199806%2014.199806%200%200%201-14.201805-14.201806V192.203372H124.518298v355.623138a14.199806%2014.199806%200%200%200%2014.201805%2014.201806h33.049549c16.08178%200%2029.119602%2013.037822%2029.119601%2029.119602v33.60954c0%2016.08178-13.037822%2029.119602-29.119601%2029.119602h54.639253c16.08178%200%2029.119602-13.037822%2029.119601-29.119602v-33.60954c-0.002-16.08178-13.039822-29.119602-29.121601-29.119602z'%20fill='%23234459'%20p-id='1310'%3e%3c/path%3e%3cpath%20d='M1023.392008%20911.593537l-36.725498-266.696354c-1.127985-8.207888-8.711881-13.949809-16.905768-12.813825a14.997795%2014.997795%200%200%200-12.811825%2016.905769l36.725498%20266.696354c2.251969%2016.353776-7.603896%2031.617568-23.43568%2036.291504l-55.221245%2016.313777a32.93955%2032.93955%200%200%201-20.101725-0.423995l-93.238725-31.867564a63.439133%2063.439133%200%200%200-41.109438%200.093999l-90.648761%2031.44757a33.319544%2033.319544%200%200%201-21.117711%200.201997l-98.978647-32.227559a63.533131%2063.533131%200%200%200-39.773456%200.227997l-54.391257%2018.401748c-16.975768%206.071917-40.595445-5.15193-43.439406-26.863633l-44.121397-320.379619c-1.425981-65.575103-11.173847-141.662063-55.875236-196.275317h555.736402c17.809757%200%2035.939509%2015.457789%2051.045302%2043.527405%2016.681772%2030.993576%2027.78162%2074.118987%2031.255573%20121.42834%200.605992%208.261887%207.805893%2014.481802%2016.055781%2013.86181a14.999795%2014.999795%200%200%200%2013.86181-16.05778c-3.775948-51.427297-16.11978-98.820649-34.755525-133.450176-19.453734-36.611499-48.521337-59.711184-77.462941-59.309189H254.614519c-21.979699%200-42.781415%2011.825838-60.459173%2033.579541V207.203167H613.451613c8.285887%200%2014.999795-6.715908%2014.999795-14.999795s-6.713908-14.999795-14.999795-14.999795H95.678692V54.409256h789.031212v66.883086c0%2030.831578-25.081657%2055.913236-55.913235%2055.913235h-141.678063c-8.285887%200-14.999795%206.715908-14.999795%2014.999795s6.713908%2014.999795%2014.999795%2014.999795h141.678063c47.373352%200%2085.912825-38.539473%2085.912825-85.912825V54.409256h50.679307c8.285887%200%2014.999795-6.715908%2014.999795-14.999795s-6.713908-14.999795-14.999795-14.999795H14.999795c-8.285887%200-14.999795%206.715908-14.999795%2014.999795s6.713908%2014.999795%2014.999795%2014.999795h50.679307v539.288627c0%2041.453433%2033.723539%2075.178972%2075.178972%2075.178972h85.548831c24.327667%200%2044.121397-19.791729%2044.121396-44.119397v-33.60954c0-24.327667-19.791729-44.119397-44.121396-44.119397H194.155346v-72.611007c16.10578-39.993453%2038.595472-63.787128%2060.459173-63.787128%2067.175082%209.845865%2083.986852%20142.936046%2083.478859%20197.317302%201.161984%2078.112932-27.105629%20192.109374-83.478859%20197.297303-25.127656%200-50.725306-31.187574-66.805087-81.390887a14.999795%2014.999795%200%200%200-28.569609%209.149874c20.809715%2064.975112%2055.57324%20102.240602%2095.374696%20102.240603h114.646433l13.237819%2096.132685c4.113944%2036.529501%2045.37738%2064.555117%2082.770868%2051.1893l54.393256-18.401748a33.353544%2033.353544%200%200%201%2020.871715-0.119998l98.976647%2032.227559a63.487132%2063.487132%200%200%200%2040.23745-0.383995l90.64876-31.44957a33.259545%2033.259545%200%200%201%2021.573705-0.047999l93.238726%2031.865564c11.257846%203.487952%2022.759689%204.969932%2038.301476%200.807989l55.223245-16.313777c30.167588-8.911878%2048.949331-37.995481%2044.657389-69.157054zM226.406905%20577.028111c7.787894%200%2014.121807%206.333913%2014.121807%2014.119807v33.60954c0%207.785894-6.333913%2014.119807-14.121807%2014.119807H140.858074c-24.911659%200-45.179382-20.267723-45.179382-45.179382v-386.494716h68.477064v340.621343c0%2016.10178%2013.099821%2029.201601%2029.2016%2029.201601h33.049549z%20m85.798827%20228.21688c18.355749-20.859715%2032.765552-53.155273%2041.347434-84.068851l11.577842%2084.068851z'%20p-id='1311'%3e%3c/path%3e%3cpath%20d='M889.767835%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1312'%3e%3c/path%3e%3cpath%20d='M813.108883%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1313'%3e%3c/path%3e%3cpath%20d='M736.429932%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1314'%3e%3c/path%3e%3cpath%20d='M429.774124%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1315'%3e%3c/path%3e%3cpath%20d='M506.433076%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1316'%3e%3c/path%3e%3cpath%20d='M659.77098%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1317'%3e%3c/path%3e%3cpath%20d='M583.092028%20607.947688m-14.999795%200a14.999795%2014.999795%200%201%200%2029.99959%200%2014.999795%2014.999795%200%201%200-29.99959%200Z'%20p-id='1318'%3e%3c/path%3e%3c/svg%3e";function HF(r){return r?r.__v_isVNode===!0:!1}function QF(r){const e=[],t=n=>{Array.isArray(n)&&n.forEach(i=>{var s;HF(i)&&(e.push(i),(s=i.component)!=null&&s.subTree&&(e.push(i.component.subTree),t(i.component.subTree.children)),i.children&&t(i.children))})};return t(r),e}const eE=(r,e)=>{const t=r.indexOf(e);return t===-1?r.findIndex(n=>e.key!==void 0&&e.key!==null&&n.type===e.type&&n.key===e.key):t};function zF(r,e,t){const n=r&&r.subTree&&r.subTree.children?QF(r.subTree.children):[];t.sort((s,a)=>eE(n,s.vnode)-eE(n,a.vnode));const i=t.map(s=>s.proxy);e.sort((s,a)=>{const o=i.indexOf(s),l=i.indexOf(a);return o-l})}function c_(r){const e=nn([]),t=nn([]),n=Cn();return{children:e,linkChildren:s=>{Qr(r,Object.assign({link:l=>{l.proxy&&(t.push(l),e.push(l.proxy),zF(n,e,t))},unlink:l=>{const c=t.indexOf(l);e.splice(c,1),t.splice(c,1)},children:e,internalChildren:t},s))}}}function GF(){const r=ge(""),e=ge(0),t=ge(0),n=ge(0),i=ge(0),s=ge(0),a=ge(0);function o(c){const u=c.touches[0];r.value="",e.value=0,t.value=0,n.value=0,i.value=0,s.value=u.clientX,a.value=u.clientY}function l(c){const u=c.touches[0];e.value=u.clientX-s.value,t.value=u.clientY-a.value,n.value=Math.abs(e.value),i.value=Math.abs(t.value),r.value=n.value>i.value?"horizontal":n.value<i.value?"vertical":""}return{touchStart:o,touchMove:l,direction:r,deltaX:e,deltaY:t,offsetX:n,offsetY:i,startX:s,startY:a}}var u_=60,h_=u_*60,f_=h_*24,KF=f_*7,za=1e3,Of=u_*za,tE=h_*za,YF=f_*za,JF=KF*za,Kp="millisecond",Ta="second",_a="minute",Sa="hour",ts="day",Dc="week",Vr="month",d_="quarter",ns="year",Ca="date",XF="YYYY-MM-DDTHH:mm:ssZ",nE="Invalid Date",ZF=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,eU=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;const tU={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}};var qd=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},nU=function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),s=n%60;return(t<=0?"+":"-")+qd(i,2,"0")+":"+qd(s,2,"0")},rU=function r(e,t){if(e.date()<t.date())return-r(t,e);var n=(t.year()-e.year())*12+(t.month()-e.month()),i=e.clone().add(n,Vr),s=t-i<0,a=e.clone().add(n+(s?-1:1),Vr);return+(-(n+(t-i)/(s?i-a:a-i))||0)},iU=function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},sU=function(e){var t={M:Vr,y:ns,w:Dc,d:ts,D:Ca,h:Sa,m:_a,s:Ta,ms:Kp,Q:d_};return t[e]||String(e||"").toLowerCase().replace(/s$/,"")},aU=function(e){return e===void 0};const oU={s:qd,z:nU,m:rU,a:iU,p:sU,u:aU};var Xo="en",qs={};qs[Xo]=tU;var p_="$isDayjsObject",Yp=function(e){return e instanceof dh||!!(e&&e[p_])},pu=function r(e,t,n){var i;if(!e)return Xo;if(typeof e=="string"){var s=e.toLowerCase();qs[s]&&(i=s),t&&(qs[s]=t,i=s);var a=e.split("-");if(!i&&a.length>1)return r(a[0])}else{var o=e.name;qs[o]=e,i=o}return!n&&i&&(Xo=i),i||!n&&Xo},yn=function(e,t){if(Yp(e))return e.clone();var n=typeof t=="object"?t:{};return n.date=e,n.args=arguments,new dh(n)},lU=function(e,t){return yn(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})},Jt=oU;Jt.l=pu;Jt.i=Yp;Jt.w=lU;var cU=function(e){var t=e.date,n=e.utc;if(t===null)return new Date(NaN);if(Jt.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var i=t.match(ZF);if(i){var s=i[2]-1||0,a=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,a)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,a)}}return new Date(t)},dh=function(){function r(t){this.$L=pu(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p_]=!0}var e=r.prototype;return e.parse=function(n){this.$d=cU(n),this.init()},e.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},e.$utils=function(){return Jt},e.isValid=function(){return this.$d.toString()!==nE},e.isSame=function(n,i){var s=yn(n);return this.startOf(i)<=s&&s<=this.endOf(i)},e.isAfter=function(n,i){return yn(n)<this.startOf(i)},e.isBefore=function(n,i){return this.endOf(i)<yn(n)},e.$g=function(n,i,s){return Jt.u(n)?this[i]:this.set(s,n)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(n,i){var s=this,a=Jt.u(i)?!0:i,o=Jt.p(n),l=function(b,S){var N=Jt.w(s.$u?Date.UTC(s.$y,S,b):new Date(s.$y,S,b),s);return a?N:N.endOf(ts)},c=function(b,S){var N=[0,0,0,0],C=[23,59,59,999];return Jt.w(s.toDate()[b].apply(s.toDate("s"),(a?N:C).slice(S)),s)},u=this.$W,h=this.$M,f=this.$D,d="set"+(this.$u?"UTC":"");switch(o){case ns:return a?l(1,0):l(31,11);case Vr:return a?l(1,h):l(0,h+1);case Dc:{var m=this.$locale().weekStart||0,y=(u<m?u+7:u)-m;return l(a?f-y:f+(6-y),h)}case ts:case Ca:return c(d+"Hours",0);case Sa:return c(d+"Minutes",1);case _a:return c(d+"Seconds",2);case Ta:return c(d+"Milliseconds",3);default:return this.clone()}},e.endOf=function(n){return this.startOf(n,!1)},e.$set=function(n,i){var s,a=Jt.p(n),o="set"+(this.$u?"UTC":""),l=(s={},s[ts]=o+"Date",s[Ca]=o+"Date",s[Vr]=o+"Month",s[ns]=o+"FullYear",s[Sa]=o+"Hours",s[_a]=o+"Minutes",s[Ta]=o+"Seconds",s[Kp]=o+"Milliseconds",s)[a],c=a===ts?this.$D+(i-this.$W):i;if(a===Vr||a===ns){var u=this.clone().set(Ca,1);u.$d[l](c),u.init(),this.$d=u.set(Ca,Math.min(this.$D,u.daysInMonth())).$d}else l&&this.$d[l](c);return this.init(),this},e.set=function(n,i){return this.clone().$set(n,i)},e.get=function(n){return this[Jt.p(n)]()},e.add=function(n,i){var s=this,a;n=Number(n);var o=Jt.p(i),l=function(f){var d=yn(s);return Jt.w(d.date(d.date()+Math.round(f*n)),s)};if(o===Vr)return this.set(Vr,this.$M+n);if(o===ns)return this.set(ns,this.$y+n);if(o===ts)return l(1);if(o===Dc)return l(7);var c=(a={},a[_a]=Of,a[Sa]=tE,a[Ta]=za,a)[o]||1,u=this.$d.getTime()+n*c;return Jt.w(u,this)},e.subtract=function(n,i){return this.add(n*-1,i)},e.format=function(n){var i=this,s=this.$locale();if(!this.isValid())return s.invalidDate||nE;var a=n||XF,o=Jt.z(this),l=this.$H,c=this.$m,u=this.$M,h=s.weekdays,f=s.months,d=s.meridiem,m=function(N,C,I,H){return N&&(N[C]||N(i,a))||I[C].slice(0,H)},y=function(N){return Jt.s(l%12||12,N,"0")},T=d||function(S,N,C){var I=S<12?"AM":"PM";return C?I.toLowerCase():I},b=function(N){switch(N){case"YY":return String(i.$y).slice(-2);case"YYYY":return Jt.s(i.$y,4,"0");case"M":return u+1;case"MM":return Jt.s(u+1,2,"0");case"MMM":return m(s.monthsShort,u,f,3);case"MMMM":return m(f,u);case"D":return i.$D;case"DD":return Jt.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return m(s.weekdaysMin,i.$W,h,2);case"ddd":return m(s.weekdaysShort,i.$W,h,3);case"dddd":return h[i.$W];case"H":return String(l);case"HH":return Jt.s(l,2,"0");case"h":return y(1);case"hh":return y(2);case"a":return T(l,c,!0);case"A":return T(l,c,!1);case"m":return String(c);case"mm":return Jt.s(c,2,"0");case"s":return String(i.$s);case"ss":return Jt.s(i.$s,2,"0");case"SSS":return Jt.s(i.$ms,3,"0");case"Z":return o}return null};return a.replace(eU,function(S,N){return N||b(S)||o.replace(":","")})},e.utcOffset=function(){return-Math.round(this.$d.getTimezoneOffset()/15)*15},e.diff=function(n,i,s){var a=this,o=Jt.p(i),l=yn(n),c=(l.utcOffset()-this.utcOffset())*Of,u=this-l,h=function(){return Jt.m(a,l)},f;switch(o){case ns:f=h()/12;break;case Vr:f=h();break;case d_:f=h()/3;break;case Dc:f=(u-c)/JF;break;case ts:f=(u-c)/YF;break;case Sa:f=u/tE;break;case _a:f=u/Of;break;case Ta:f=u/za;break;default:f=u;break}return s?f:Jt.a(f)},e.daysInMonth=function(){return this.endOf(Vr).$D},e.$locale=function(){return qs[this.$L]},e.locale=function(n,i){if(!n)return this.$L;var s=this.clone(),a=pu(n,i,!0);return a&&(s.$L=a),s},e.clone=function(){return Jt.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},r}(),m_=dh.prototype;yn.prototype=m_;[["$ms",Kp],["$s",Ta],["$m",_a],["$H",Sa],["$W",ts],["$M",Vr],["$y",ns],["$D",Ca]].forEach(function(r){m_[r[1]]=function(e){return this.$g(e,r[0],r[1])}});yn.extend=function(r,e){return r.$i||(r(e,dh,yn),r.$i=!0),yn};yn.locale=pu;yn.isDayjs=Yp;yn.unix=function(r){return yn(r*1e3)};yn.en=qs[Xo];yn.Ls=qs;yn.p={};const uU=Tt(Xe({},xn),{height:jt(0),anchors:eo(),safeAreaInsetBottom:qe(!1),showScrollbar:bg,duration:Qu(300),contentDraggable:bg}),hU={name:"wd-floating-panel",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},fU=Lt(Tt(Xe({},hU),{props:uU,emits:["update:height","height-change"],setup(r,{emit:e}){const t=GF(),n=r,i=e,s=ge(n.height),a=.2;let o;const l=ge(0),c=ge(!1),u=Me(()=>({min:n.anchors[0]?n.anchors[0]:100,max:n.anchors[n.anchors.length-1]?n.anchors[n.anchors.length-1]:Math.round(l.value*.6)})),h=Me(()=>n.anchors.length>=2?n.anchors:[u.value.min,u.value.max]),f=Me(()=>{const S={height:ui(u.value.max),transform:`translateY(calc(100% + ${ui(-s.value)}))`,transition:c.value?"none":`transform ${n.duration}ms cubic-bezier(0.18, 0.89, 0.32, 1.28)`};return`${Oi(S)}${n.customStyle}`}),d=S=>{s.value=S,i("update:height",S)},m=S=>{t.touchStart(S),c.value=!0,o=-s.value},y=S=>{if(S.currentTarget.dataset.id=="content"&&!n.contentDraggable)return;t.touchMove(S);const C=t.deltaY.value+o;d(-b(C))},T=()=>{c.value=!1,d(gg(h.value,s.value)),s.value!==-o&&i("height-change",{height:s.value})},b=S=>{const N=Math.abs(S),{min:C,max:I}=u.value;return N>I?-(I+(N-I)*a):N<C?-(C-(C-N)*a):S};return Ge(()=>n.height,S=>{s.value=S}),Ge(u,()=>{d(gg(h.value,s.value))},{immediate:!0}),Xr(()=>{const{windowHeight:S}=Hu();l.value=S}),(S,N)=>{const C=Yt,I=Tp;return _e(),Ne(C,{class:Nt(`wd-floating-panel ${S.customClass} ${S.safeAreaInsetBottom?"is-safe":""}`),style:zt(f.value),onTouchstartPassive:m,onTouchmovePassive:y,onTouchend:T,onTouchcancel:T},{default:re(()=>[X(C,{class:Nt("wd-floating-panel__header")},{default:re(()=>[X(C,{class:Nt("wd-floating-panel__header-bar")})]),_:1}),X(I,{class:Nt("wd-floating-panel__content"),"data-id":"content","show-scrollbar":S.showScrollbar,"scroll-y":"",onTouchmove:Ja(y,["stop","prevent"])},{default:re(()=>[Bt(S.$slots,"default",{},void 0,!0)]),_:3},8,["show-scrollbar"])]),_:3},8,["class","style"])}}})),dU=cn(fU,[["__scopeId","data-v-b3b199e2"]]),y_=Lt({__name:"stools-panel",props:{list:{},heights:{default:()=>[10,30]},showSettings:{type:Boolean}},setup(r,{expose:e}){const t=r,n=ge({height:0,windowHeight:0,anchors:[]}),i=Me(()=>n.value.height===n.value.anchors[0]);function s(){n.value.height=n.value.anchors[0]}const a=Np(s,1e3,{leading:!0});function o(){n.value.windowHeight=Hu().windowHeight,n.value.anchors=t.heights.map(d=>Math.round(d/100*n.value.windowHeight)),a()}function l(d){Mi({url:`/pages/record?id=${d}`})}function c(){Mi({url:"/pages/calendar"})}function u(){Mi({url:"/pages/setting"})}const h=a,f=()=>n.value.height=n.value.anchors[n.value.anchors.length-1];return o(),e({hide:h,show:f}),(d,m)=>{const y=Yt,T=Wn(kn("wd-button"),Va),b=Wn(kn("wd-floating-panel"),dU);return _e(),Gn(Ht,null,[Su(X(y,{class:"fixed left-0 top-0 size-screen",onTouchstart:pt(h)},null,8,["onTouchstart"]),[[Mu,!pt(i)]]),X(b,{height:pt(n).height,"onUpdate:height":m[0]||(m[0]=S=>pt(n).height=S),mask:"",class:"shadow-[0_-2px_8px_rgba(0,0,0,0.1)]",anchors:pt(n).anchors},{default:re(()=>[X(y,{class:"size-full flex flex-[1_0] flex-col"},{default:re(()=>[X(y,{class:"flex-[1_0] overflow-auto"},{default:re(()=>[X(y,{class:"p-sc2min"},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(d.list,(S,N)=>(_e(),Ne(y,{key:S.id,class:"flex justify-between"},{default:re(()=>[X(y,{class:"center"},{default:re(()=>[Ze(vt(N+1)+"# 💩 "+vt(S.time.toLocaleString()),1)]),_:2},1024),X(T,{class:"shrink-0",type:"text",onClick:C=>l(S.id)},{default:re(()=>[Ze(" 查看 ")]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),d.showSettings?(_e(),Ne(y,{key:0,class:"center flex-[0_0]"},{default:re(()=>[X(T,{type:"text",icon:"calendar",class:"mr-1em!",onClick:c},{default:re(()=>[Ze(" 日历 ")]),_:1}),X(T,{type:"text",icon:"setting",onClick:u},{default:re(()=>[Ze(" 设置 ")]),_:1})]),_:1})):gt("",!0)]),_:1})]),_:1},8,["height","anchors"])],64)}}});class ph{add(e){return v(this,null,function*(){return yield _i().save(e)})}findById(e){return v(this,null,function*(){return yield _i().findOneBy({id:e})})}findAll(){return v(this,null,function*(){return yield _i().find()})}update(e,t){return v(this,null,function*(){const n=yield this.findById(e);return n?(Object.assign(n,t),yield _i().save(n)):null})}delete(e){return v(this,null,function*(){return(yield _i().delete(e)).affected!==0})}findByConditions(e){return v(this,null,function*(){return yield _i().findBy(e)})}findByDateRange(n){return v(this,arguments,function*(e,t=new Date){const i=new Date(t);return i.setDate(i.getDate()-e),yield _i().createQueryBuilder("stool").where("stool.time >= :fromDate AND stool.time <= :toDate",{fromDate:i,toDate:t}).orderBy("stool.time","DESC").getMany()})}findAllGroupedByDay(){return v(this,null,function*(){const e=yield _i().createQueryBuilder("stool").select(["stool.id","stool.time","stool.shape","stool.color"]).orderBy("stool.time","DESC").getMany(),t={};return e.forEach(n=>{const i=new Date(n.time).toISOString().split("T")[0];t[i]||(t[i]=[]),t[i].push({id:n.id,time:n.time,shape:n.shape,color:n.color})}),t})}}class pU{constructor(){wn(this,"ss",new ph)}poop(){return v(this,null,function*(){this.ss.add(new Bn)})}listPoopRecent(e=7){return v(this,null,function*(){return this.ss.findByDateRange(e)})}}const mU=Lt({__name:"poop",setup(r){const e=to(),t=new pU,n=ge([]),i=ge(!1),s=Gv(),a=ge();function o(){return v(this,null,function*(){n.value=yield t.listPoopRecent()})}function l(){return v(this,null,function*(){var c;i.value=!0;try{yield t.poop(),yield o(),i.value=!1,e.show({msg:"💩顺利诞生",position:"top"}),(c=a.value)==null||c.show()}catch(u){i.value=!1}})}return o(),(c,u)=>{const h=Wn(kn("wd-loading"),xp),f=Yt,d=vp,m=Pr("layout-default-uni"),y=Pr("global-ku-root");return _e(),Ne(y,null,{default:re(()=>[X(m,null,{default:re(()=>[X(f,{class:"size-screen center flex-col"},{default:re(()=>[Su(X(f,{class:"absolute top-[min(50vw,50vh)]"},{default:re(()=>[X(h,{color:pt(s).themeVars.colorTheme},null,8,["color"])]),_:1},512),[[Mu,pt(i)]]),X(f,{class:"animate-pulse cursor-pointer transition-transform active:scale-110 active:filter-brightness-110",onClick:l},{default:re(()=>[X(d,{class:"h-[min(50vw,50vh)] w-[min(50vw,50vh)]",src:WF,mode:"aspectFit"})]),_:1})]),_:1}),X(y_,{ref_key:"panelRef",ref:a,list:pt(n),"show-settings":""},null,8,["list"])]),_:1})]),_:1})}}}),yU=Object.freeze(Object.defineProperty({__proto__:null,default:mU},Symbol.toStringTag,{value:"Module"})),{translate:vr}=ps("calendar-view"),gU=Me(()=>[vr("weeks.sun"),vr("weeks.mon"),vr("weeks.tue"),vr("weeks.wed"),vr("weeks.thu"),vr("weeks.fri"),vr("weeks.sat")]);function vn(r,e){const t=new Date(r),n=new Date(e||""),i=t.getFullYear(),s=n.getFullYear(),a=t.getMonth(),o=n.getMonth(),l=t.getDate(),c=n.getDate();return i===s?a===o?l===c?0:l>c?1:-1:a===o?0:a>o?1:-1:i>s?1:-1}function Er(r,e){const t=new Date(r),n=new Date(e),i=t.getFullYear(),s=n.getFullYear(),a=t.getMonth(),o=n.getMonth();return i===s?a===o?0:a>o?1:-1:i>s?1:-1}function g_(r,e){const t=new Date(r),n=new Date(e),i=t.getFullYear(),s=n.getFullYear();return i===s?0:i>s?1:-1}function kd(r,e){return 32-new Date(r,e-1,32).getDate()}function b_(r){return yn(r).format(vr("monthTitle"))}function bU(r){return r>=7&&(r=r%7),gU.value[r]}function E_(r){return yn(r).format(vr("yearTitle"))}function EU(r,e){const t=[],n=new Date(r);for(n.setDate(1);Er(n.getTime(),e)<1;)t.push(n.getTime()),n.setMonth(n.getMonth()+1);return t}function wU(r,e){const t=[],n=new Date(r);for(n.setMonth(0),n.setDate(1);g_(n.getTime(),e)<1;)t.push(n.getTime()),n.setFullYear(n.getFullYear()+1);return t}function ha(r,e){e>=7&&(e=e%7);const t=new Date(r);t.setHours(0,0,0,0);const n=t.getFullYear(),i=t.getMonth(),s=t.getDate(),a=t.getDay(),o=new Date(n,i,s-(7+a-e)%7),l=new Date(n,i,s+6-(7+a-e)%7);return[o.getTime(),l.getTime()]}function vU(r,e){return(r-e)/(24*60*60*1e3)+1}function Jp(r,e){const t=new Date(r);return t.setDate(t.getDate()+e),t.getTime()}const TU=r=>Jp(r,-1),_U=r=>Jp(r,1);function SU(r,e){const t=new Date(r),n=new Date(e),i=t.getFullYear(),s=n.getFullYear();let a=t.getMonth();const o=n.getMonth();return a=(i-s)*12+a,a-o+1}function CU(r,e){const t=new Date(r);return t.setMonth(t.getMonth()+e),t.getTime()}function NU(r){if(At(r)){const e=(r[0]||"00:00:00").split(":").map(n=>parseInt(n)),t=(r[1]||"00:00:00").split(":").map(n=>parseInt(n));return[e,t]}else{const e=(r||"00:00:00").split(":").map(t=>parseInt(t));return[e,e]}}function w_(r,e){const t=new Date(r);return t.setHours(e[0]),t.setMinutes(e[1]),t.setSeconds(e[2]),t.getTime()}const $f=(r,e)=>{let t=-1;const n=Array(r<0?0:r);for(;++t<r;)n[t]=e(t);return n},mc=r=>{const e=new Date(r);return[e.getHours(),e.getMinutes(),e.getSeconds()]};function Df({date:r,minDate:e,maxDate:t,isHideSecond:n,filter:i}){const s=vn(r,e),a=vn(r,t);let o=0,l=23,c=0,u=59,h=0,f=59;if(s===0){const b=mc(e),S=mc(r);o=b[0],b[0]===S[0]&&(c=b[1],b[1]===S[1]&&(h=b[2]))}if(a===0){const b=mc(t),S=mc(r);l=b[0],b[0]===S[0]&&(u=b[1],b[1]===S[1]&&(f=b[2]))}let d=[],m=$f(24,b=>({label:vr("hour",Mn(b)),value:b,disabled:b<o||b>l})),y=$f(60,b=>({label:vr("minute",Mn(b)),value:b,disabled:b<c||b>u})),T=[];return i&&fn(i)&&(m=i({type:"hour",values:m}),y=i({type:"minute",values:y})),n||(T=$f(60,b=>({label:vr("second",Mn(b)),value:b,disabled:b<h||b>f})),i&&fn(i)&&(T=i({type:"second",values:T}))),d=n?[m,y]:[m,y,T],d}function v_(r,e,t){const n=["is-"+r];return t.indexOf("range")>-1&&At(e)&&(!e||!e[1])&&n.push("is-without-end"),n.join(" ")}const AU={type:en(String),date:en(Number),value:en([Number,Array]),minDate:en(Number),maxDate:en(Number),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:qe(!1),defaultTime:{type:[Array]},showTitle:qe(!0)},xU={options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},RU=Lt(Tt(Xe({},xU),{__name:"year",props:AU,emits:["change"],setup(r,{emit:e}){const t=r,n=e,i=to("wd-year"),{translate:s}=ps("calendar-view"),a=ge([]),o=Me(()=>b=>v_(b,t.value,t.type)),l=Me(()=>b=>E_(b));Ge([()=>t.type,()=>t.date,()=>t.value,()=>t.minDate,()=>t.maxDate,()=>t.formatter],()=>{u()},{deep:!0,immediate:!0});function c(b){return yn(b).format(s("month",b))}function u(){const b=[],N=new Date(t.date).getFullYear(),C=t.value;if(!(t.type.indexOf("range")>-1&&C&&!At(C))){for(let I=0;I<12;I++){const H=new Date(N,I,1).getTime();let Q=h(H);!Q&&Er(H,Date.now())===0&&(Q="current");const te=T(H,I,Q);b.push(te)}a.value=$t(b)}}function h(b){if(t.type==="monthrange"&&At(t.value)){const[S,N]=t.value||[];return S&&Er(b,S)===0?N&&Er(S,N)===0?"same":"start":N&&Er(b,N)===0?"end":S&&N&&Er(b,S)===1&&Er(b,N)===-1?"middle":""}else return t.value&&Er(b,t.value)===0?"selected":""}function f(b){const S=a.value[b];if(!S.disabled)switch(t.type){case"month":m(S);break;case"monthrange":y(S);break;default:m(S)}}function d(b){return t.defaultTime&&t.defaultTime.length>0?w_(b,t.defaultTime[0]):b}function m(b){b.type!=="selected"&&n("change",{value:d(b.date)})}function y(b){let S=[];const[N,C]=At(t.value)?t.value||[]:[],I=Er(b.date,N);if(!(!t.allowSameDay&&!C&&I===0)){if(N&&!C&&I>-1)if(t.maxRange&&SU(b.date,N)>t.maxRange){const H=CU(N,t.maxRange-1);S=[N,d(H)],i.show({msg:t.rangePrompt||s("rangePromptMonth",t.maxRange)})}else S=[N,d(b.date)];else S=[d(b.date),null];n("change",{value:S})}}function T(b,S,N){let C={date:b,text:S+1,topInfo:"",bottomInfo:"",type:N,disabled:Er(b,t.minDate)===-1||Er(b,t.maxDate)===1,isLastRow:S>=8};return t.formatter&&fn(t.formatter)&&(C=t.formatter(C)),C}return(b,S)=>{const N=Yt;return _e(),Gn(Ht,null,[X(zu,{selector:"wd-year"}),X(N,{class:"wd-year year"},{default:re(()=>[b.showTitle?(_e(),Ne(N,{key:0,class:"wd-year__title"},{default:re(()=>[Ze(vt(l.value(b.date)),1)]),_:1})):gt("",!0),X(N,{class:"wd-year__months"},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(a.value,(C,I)=>(_e(),Ne(N,{key:I,class:Nt(`wd-year__month ${C.disabled?"is-disabled":""} ${C.isLastRow?"is-last-row":""} ${C.type?o.value(C.type):""}`),onClick:H=>f(I)},{default:re(()=>[X(N,{class:"wd-year__month-top"},{default:re(()=>[Ze(vt(C.topInfo),1)]),_:2},1024),X(N,{class:"wd-year__month-text"},{default:re(()=>[Ze(vt(c(C.date)),1)]),_:2},1024),X(N,{class:"wd-year__month-bottom"},{default:re(()=>[Ze(vt(C.bottomInfo),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})],64)}}})),MU=cn(RU,[["__scopeId","data-v-17be344c"]]),PU={type:en(String),value:en([Number,Array]),minDate:en(Number),maxDate:en(Number),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:qe(!1),showPanelTitle:qe(!1),defaultTime:{type:[Array]},panelHeight:en(Number)},IU={options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},OU=Lt(Tt(Xe({},IU),{__name:"year-panel",props:PU,emits:["change"],setup(r,{expose:e,emit:t}){const n=r,i=t,s=ge(0),a=ge(0),o=Me(()=>n.panelHeight+(n.showPanelTitle?26:16)),l=Me(()=>wU(n.minDate,n.maxDate).map((m,y)=>({date:m,height:y===0?200:245}))),c=Me(()=>E_(l.value[a.value].date));gn(()=>{u()});function u(){return v(this,null,function*(){yield jr();let m=null;At(n.value)?m=n.value[0]:Cc(n.value)&&(m=n.value),m||(m=Date.now());let y=0;for(let T=0;T<l.value.length&&g_(l.value[T].date,m)!==0;T++)y+=l.value[T]?Number(l.value[T].height):0;s.value=0,y>0&&(yield jr(),s.value=y+45)})}const h=m=>{if(l.value.length<=1)return;const y=Math.max(0,m.detail.scrollTop);f(y)};function f(m){let y=0;for(let T=0;T<l.value.length;T++)if(y=y+l.value[T].height,m<y){a.value=T;return}}function d({value:m}){i("change",{value:m})}return e({scrollIntoView:u}),(m,y)=>{const T=Yt,b=Tp;return _e(),Ne(T,{class:"wd-year-panel"},{default:re(()=>[m.showPanelTitle?(_e(),Ne(T,{key:0,class:"wd-year-panel__title"},{default:re(()=>[Ze(vt(c.value),1)]),_:1})):gt("",!0),X(b,{class:"wd-year-panel__container",style:zt(`height: ${o.value}px`),"scroll-y":"",onScroll:h,"scroll-top":s.value},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(l.value,(S,N)=>(_e(),Ne(T,{key:N,id:`year${N}`},{default:re(()=>[X(MU,{type:m.type,date:S.date,value:m.value,"min-date":m.minDate,"max-date":m.maxDate,"max-range":m.maxRange,formatter:m.formatter,"range-prompt":m.rangePrompt,"allow-same-day":m.allowSameDay,"default-time":m.defaultTime,showTitle:N!==0,onChange:d},null,8,["type","date","value","min-date","max-date","max-range","formatter","range-prompt","allow-same-day","default-time","showTitle"])]),_:2},1032,["id"]))),128))]),_:1},8,["style","scroll-top"])]),_:1})}}})),$U=cn(OU,[["__scopeId","data-v-1a697570"]]),DU=Tt(Xe({},xn),{loading:qe(!1),loadingColor:lt("#4D80F0"),columnsHeight:jt(217),valueKey:lt("value"),labelKey:lt("label"),immediateChange:qe(!1),modelValue:{type:[String,Number,Boolean,Array,Array,Array],default:"",required:!0},columns:eo(),columnChange:Function});function Lc(r,e,t){let n=At(r)?r:[r];const i=new Set(r.map(Us));if(i.size!==1&&i.has("object"))throw Error("The columns are correct");return At(r[0])||(n=[n]),n.map(a=>a.map(o=>{if(!Fs(o))return{[e]:o,[t]:o};if(!o.hasOwnProperty(e)&&!o.hasOwnProperty(t))throw Error("Can't find valueKey and labelKey in columns");return o.hasOwnProperty(t)||(o[t]=o[e]),o.hasOwnProperty(e)||(o[e]=o[t]),o}))}const LU={name:"wd-picker-view",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},qU=Lt(Tt(Xe({},LU),{props:DU,emits:["change","pickstart","pickend","update:modelValue"],setup(r,{expose:e,emit:t}){const n=r,i=t,s=ge([]),a=ge(35),o=ge([]);Ge([()=>n.modelValue,()=>n.columns],(E,A)=>{Ua(A[1],E[1])||(At(E[1])&&E[1].length>0?s.value=Lc(E[1],n.valueKey,n.labelKey):(s.value=[],o.value=[])),Mt(E[0])&&c(E[0])},{deep:!0,immediate:!0});const{proxy:l}=Cn();function c(E){if(s.value.length===0){o.value=[];return}(E===""||!Mt(E)||At(E)&&E.length===0)&&(E=s.value.map(x=>x[0][n.valueKey])),Us(E),E=At(E)?E:[E],E=E.slice(0,s.value.length);let A=$t(o.value);E.forEach((x,$)=>{let B=s.value[$].findIndex(K=>K[n.valueKey].toString()===x.toString());B=B===-1?0:B,A=h($,B,A)}),o.value=A.slice(0,E.length)}function u(E){let A=$t(E);return E.forEach((x,$)=>{x=Yo(x,0,s.value[$].length-1),A=h($,x,A)}),A}function h(E,A,x){const $=s.value[E];if(!$||!$[A])throw Error(`The value to select with Col:${E} Row:${A} is incorrect`);const B=$t(x);if(B[E]=A,$[A].disabled){const K=$.slice(0,A).reverse().findIndex(ue=>!ue.disabled),ae=$.slice(A+1).findIndex(ue=>!ue.disabled);K!==-1?B[E]=A-1-K:ae!==-1?B[E]=A+1+ae:B[E]===void 0&&(B[E]=0)}return B}function f({detail:{value:E}}){E=E.map(x=>Number(x||0));const A=m(E);o.value=$t(E),bn(()=>{o.value=u(E),n.columnChange?n.columnChange.length<4?(n.columnChange(l.$.exposed,T(),A||0,()=>{}),y(A||0)):n.columnChange(l.$.exposed,T(),A||0,()=>{y(A||0)}):y(A||0)})}function d(E,A){return!E||!A?-1:E.findIndex(($,B)=>$!==A[B])}function m(E){E=E.slice(0,s.value.length);const A=$t(o.value);let x=$t(o.value);E.forEach((K,ae)=>{K=Yo(K,0,s.value[ae].length-1),K!==A[ae]&&(x=h(ae,K,x))});const $=d(x,A);if($===-1)return;const B=x[$];return x.length===1?B:$}function y(E){const A=b();Ua(A,n.modelValue)||(i("update:modelValue",A),setTimeout(()=>{i("change",{picker:l.$.exposed,value:A,index:E})},0))}function T(){const E=o.value.map((A,x)=>s.value[x][A]);return E.length===1?E[0]:E}function b(){const{valueKey:E}=n,A=o.value.map((x,$)=>s.value[$][x][E]);return A.length===1?A[0]:A}function S(){const{labelKey:E}=n;return o.value.map((A,x)=>s.value[x][A][E])}function N(E){return o.value[E]}function C(E){return s.value[E]}function I(E,A,x=0){s.value[E]=Lc(A,n.valueKey,n.labelKey).reduce(($,B)=>$.concat(B),[]),o.value=h(E,x,o.value)}function H(){return $t(s.value)}function Q(){return o.value}function te(E){At(E)&&E.length&&(s.value=Lc(E,n.valueKey,n.labelKey))}function V(){i("pickstart")}function J(){i("pickend")}return e({getSelects:T,getValues:b,setColumnData:I,getColumnsData:H,getColumnData:C,getColumnIndex:N,getLabels:S,getSelectedIndex:Q,resetColumns:te}),(E,A)=>{const x=Yt,$=XP,B=QP;return _e(),Ne(x,{class:Nt(`wd-picker-view ${E.customClass}`),style:zt(E.customStyle)},{default:re(()=>[E.loading?(_e(),Ne(x,{key:0,class:"wd-picker-view__loading"},{default:re(()=>[X(xp,{color:E.loadingColor},null,8,["color"])]),_:1})):gt("",!0),X(x,{style:zt(`height: ${E.columnsHeight-20}px;`)},{default:re(()=>[X(B,{"mask-class":"wd-picker-view__mask","indicator-class":"wd-picker-view__roller","indicator-style":`height: ${a.value}px;`,style:zt(`height: ${E.columnsHeight-20}px;`),value:o.value,"immediate-change":E.immediateChange,onChange:f,onPickstart:V,onPickend:J},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(s.value,(K,ae)=>(_e(),Ne($,{key:ae,class:"wd-picker-view-column"},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(K,(ue,L)=>(_e(),Ne(x,{key:L,class:Nt(`wd-picker-view-column__item ${ue.disabled?"wd-picker-view-column__item--disabled":""}  ${o.value[ae]==L?"wd-picker-view-column__item--active":""}`),style:zt(`line-height: ${a.value}px;`)},{default:re(()=>[Ze(vt(ue[E.labelKey]),1)]),_:2},1032,["class","style"]))),128))]),_:2},1024))),128))]),_:1},8,["indicator-style","style","value","immediate-change"])]),_:1},8,["style"])]),_:1},8,["class","style"])}}})),Xp=cn(qU,[["__scopeId","data-v-e413638e"]]),kU={type:en(String),date:en(Number),value:en([Number,Array,null]),minDate:en(Number),maxDate:en(Number),firstDayOfWeek:en(Number),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:qe(!1),defaultTime:{type:[Array]},showTitle:qe(!0)},BU={options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},FU=Lt(Tt(Xe({},BU),{__name:"month",props:kU,emits:["change"],setup(r,{emit:e}){const t=r,n=e,{translate:i}=ps("calendar-view"),s=ge([]),a=to("wd-month"),o=Me(()=>{const E=t.firstDayOfWeek>=7?t.firstDayOfWeek%7:t.firstDayOfWeek;return(7+new Date(t.date).getDay()-E)%7}),l=Me(()=>E=>v_(E,t.value,t.type)),c=Me(()=>E=>b_(E)),u=Me(()=>{const E={};return E.marginLeft=`${100/7*o.value}%`,Oi(E)}),h=E=>{const A=new Date(E),x=A.getDate(),$=kd(A.getFullYear(),A.getMonth()+1),B=o.value+$,K=Math.ceil(B/7);return Math.ceil((o.value+x)/7)===K};Ge([()=>t.type,()=>t.date,()=>t.value,()=>t.minDate,()=>t.maxDate,()=>t.formatter],()=>{f()},{deep:!0,immediate:!0});function f(){const E=[],A=new Date(t.date),x=A.getFullYear(),$=A.getMonth(),B=kd(x,$+1);let K=t.value;(t.type==="week"||t.type==="weekrange")&&K&&(K=S());for(let ae=1;ae<=B;ae++){const ue=new Date(x,$,ae).getTime();let L=d(ue,K);!L&&vn(ue,Date.now())===0&&(L="current");const Se=J(ue,ae,L);E.push(Se)}s.value=E}function d(E,A){switch(t.type){case"date":case"datetime":return m(E);case"dates":return y(E);case"daterange":case"datetimerange":return T(E,A);case"week":return b(E,A);case"weekrange":return b(E,A);default:return m(E)}}function m(E){return t.value&&vn(E,t.value)===0?"selected":""}function y(E){const{value:A}=t;let x="";if(!At(A))return x;const $=B=>A.some(K=>vn(B,K)===0);if($(E)){const B=TU(E),K=_U(E),ae=$(B),ue=$(K);ae&&ue?x="multiple-middle":ae?x="end":ue?x="start":x="multiple-selected"}return x}function T(E,A){const[x,$]=At(A)?A:[];return x&&vn(E,x)===0?t.allowSameDay&&$&&vn(x,$)===0?"same":"start":$&&vn(E,$)===0?"end":x&&$&&vn(E,x)===1&&vn(E,$)===-1?"middle":""}function b(E,A){const[x,$]=At(A)?A:[];return x&&vn(E,x)===0?"start":$&&vn(E,$)===0?"end":x&&$&&vn(E,x)===1&&vn(E,$)===-1?"middle":""}function S(){if(t.type==="week")return ha(t.value,t.firstDayOfWeek);{const[E,A]=t.value||[];if(E){const x=ha(E,t.firstDayOfWeek);if(A){const $=ha(A,t.firstDayOfWeek);return[x[0],$[1]]}else return x}return[]}}function N(E){const A=s.value[E];switch(t.type){case"date":case"datetime":I(A);break;case"dates":H(A);break;case"daterange":case"datetimerange":Q(A);break;case"week":te(A);break;case"weekrange":V(A);break;default:I(A)}}function C(E,A=!1){return E=t.defaultTime&&t.defaultTime.length>0?w_(E,A?t.defaultTime[1]:t.defaultTime[0]):E,E<t.minDate?t.minDate:E>t.maxDate?t.maxDate:E}function I(E){E.disabled||E.type!=="selected"&&n("change",{value:C(E.date),type:"start"})}function H(E){if(E.disabled)return;const A=$t(At(t.value)?t.value:[]),x=A.findIndex(B=>B&&vn(B,E.date)===0),$=x===-1?[...A,C(E.date)]:A.filter((B,K)=>K!==x);n("change",{value:$})}function Q(E){if(E.disabled)return;let A=[],x="";const[$,B]=$t(At(t.value)?t.value:[]),K=vn(E.date,$);if(!(!t.allowSameDay&&K===0&&(t.type==="daterange"||t.type==="datetimerange")&&!B)){if($&&!B&&K>-1)if(t.maxRange&&vU(E.date,$)>t.maxRange){const ae=Jp($,t.maxRange-1);A=[$,C(ae,!0)],a.show({msg:t.rangePrompt||i("rangePrompt",t.maxRange)})}else A=[$,C(E.date,!0)];else t.type==="datetimerange"&&$&&B?K===0?(x="start",A=t.value):vn(E.date,B)===0?(x="end",A=t.value):A=[C(E.date),null]:A=[C(E.date),null];n("change",{value:A,type:x||(A[1]?"end":"start")})}}function te(E){const[A]=ha(E.date,t.firstDayOfWeek);J(A,new Date(A).getDate()).disabled||n("change",{value:C(A)+24*60*60*1e3})}function V(E){const[A]=ha(E.date,t.firstDayOfWeek);if(J(A,new Date(A).getDate()).disabled)return;let x=[];const[$,B]=$t(At(t.value)?t.value:[]),[K]=$?ha($,t.firstDayOfWeek):[],ae=vn(A,K);if($&&!B&&ae>-1){if(!t.allowSameDay&&ae===0)return;x=[C(K)+24*60*60*1e3,C(A)+24*60*60*1e3]}else x=[C(A)+24*60*60*1e3,null];n("change",{value:x})}function J(E,A,x){let $={date:E,text:A,topInfo:"",bottomInfo:"",type:x,disabled:vn(E,t.minDate)===-1||vn(E,t.maxDate)===1,isLastRow:h(E)};return t.formatter&&fn(t.formatter)&&($=t.formatter($)),$}return(E,A)=>{const x=Yt;return _e(),Ne(x,null,{default:re(()=>[X(zu,{selector:"wd-month"}),X(x,{class:"month"},{default:re(()=>[X(x,{class:"wd-month"},{default:re(()=>[E.showTitle?(_e(),Ne(x,{key:0,class:"wd-month__title"},{default:re(()=>[Ze(vt(c.value(E.date)),1)]),_:1})):gt("",!0),X(x,{class:"wd-month__days"},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(s.value,($,B)=>(_e(),Ne(x,{key:B,class:Nt(`wd-month__day ${$.disabled?"is-disabled":""} ${$.isLastRow?"is-last-row":""} ${$.type?l.value($.type):""}`),style:zt(B===0?u.value:""),onClick:K=>N(B)},{default:re(()=>[X(x,{class:"wd-month__day-container"},{default:re(()=>[Bt(E.$slots,"default",zd(xu({item:$})),()=>[X(x,{class:"wd-month__day-top"},{default:re(()=>[Ze(vt($.topInfo),1)]),_:2},1024),X(x,{class:"wd-month__day-text"},{default:re(()=>[Ze(vt($.text),1)]),_:2},1024),X(x,{class:"wd-month__day-bottom"},{default:re(()=>[Ze(vt($.bottomInfo),1)]),_:2},1024)],!0)]),_:2},1024)]),_:2},1032,["class","style","onClick"]))),128))]),_:3})]),_:3})]),_:3})]),_:3})}}})),UU=cn(FU,[["__scopeId","data-v-54efcd7e"]]),VU={type:en(String),value:en([Number,Array,null]),minDate:en(Number),maxDate:en(Number),firstDayOfWeek:en(Number),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:qe(!1),showPanelTitle:qe(!1),defaultTime:{type:[Array]},panelHeight:en(Number),timeFilter:Function,hideSecond:qe(!1),immediateChange:qe(!1)},jU={options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},WU=Lt(Tt(Xe({},jU),{__name:"month-panel",props:VU,emits:["change","pickstart","pickend"],setup(r,{expose:e,emit:t}){const n=r,i=t,{translate:s}=ps("calendar-view"),a=ge(0),o=ge(0),l=ge([]),c=ge(""),u=ge(""),h=Np(E=>{i("change",{value:E})},50),f=Me(()=>{let E=[];if(n.type==="datetime"&&Cc(n.value)){const A=new Date(n.value);A.setHours(l.value[0]),A.setMinutes(l.value[1]),A.setSeconds(n.hideSecond?0:l.value[2]);const x=A.getTime();E=S(x)||[]}else if(At(n.value)&&n.type==="datetimerange"){const[A,x]=n.value,$=c.value==="start"?A:x,B=new Date($||"");B.setHours(l.value[0]),B.setMinutes(l.value[1]),B.setSeconds(n.hideSecond?0:l.value[2]);const K=B.getTime(),ae=[A,x];c.value==="start"?ae[0]=K:ae[1]=K,E=S(ae,c.value)||[]}return E}),d=Me(()=>b_(T.value[o.value].date)),m=Me(()=>E=>bU(E-1)),y=Me(()=>c.value?n.panelHeight-125:n.panelHeight),T=Me(()=>EU(n.minDate,n.maxDate).map((E,A)=>{const x=(7+new Date(E).getDay()-n.firstDayOfWeek)%7,$=kd(new Date(E).getFullYear(),new Date(E).getMonth()+1),B=Math.ceil((x+$)/7);return{height:B*64+(B-1)*4+(A===0?0:45),date:E}}));Ge(()=>n.type,E=>{(E==="datetime"&&n.value||E==="datetimerange"&&At(n.value)&&n.value&&n.value.length>0&&n.value[0])&&C(n.value,"start")},{deep:!0,immediate:!0}),Ge(()=>n.value,E=>{Ua(E,u.value)||(n.type==="datetime"&&E||n.type==="datetimerange"&&E&&At(E)&&E.length>0&&E[0])&&C(E,"start")},{deep:!0,immediate:!0}),gn(()=>{b()});function b(){return v(this,null,function*(){yield jr();let E=0;At(n.value)?E=[...n.value].sort((B,K)=>(B||0)-(K||0))[0]:Cc(n.value)&&(E=n.value),E||(E=Date.now());let A=0,x=-1;for(let $=0;$<T.value.length;$++){if(Er(T.value[$].date,E)===0){x=$;const B=new Date(E),K=B.getDate(),ue=(7+new Date(B.getFullYear(),B.getMonth(),1).getDay()-n.firstDayOfWeek)%7,L=Math.floor((ue+K-1)/7);A+=L*64+L*4;break}A+=T.value[$]?Number(T.value[$].height):0}a.value=0,A>0&&(yield jr(),a.value=A+(x>0?45:0))})}function S(E,A){return n.type==="datetime"?Df({date:E,minDate:n.minDate,maxDate:n.maxDate,filter:n.timeFilter,isHideSecond:n.hideSecond}):A==="start"&&At(n.value)?Df({date:E[0],minDate:n.minDate,maxDate:n.value[1]?n.value[1]:n.maxDate,filter:n.timeFilter,isHideSecond:n.hideSecond}):Df({date:E[1],minDate:E[0],maxDate:n.maxDate,filter:n.timeFilter,isHideSecond:n.hideSecond})}function N(E,A){let x=new Date;n.type==="datetime"?x=new Date(E):At(E)&&(A==="start"?x=new Date(E[0]||""):x=new Date(E[1]||""));const $=x.getHours(),B=x.getMinutes(),K=x.getSeconds();return n.hideSecond?[$,B]:[$,B,K]}function C(E,A){At(E)&&E[0]&&E[1]&&A==="start"&&c.value==="start"&&(A="end"),c.value=A||"",l.value=N(E,A||"")}function I({value:E,type:A}){Ua(E,n.value)||(u.value=E,h(E)),n.type.indexOf("time")>-1&&C(E,A)}function H({value:E}){if(n.value){if(n.type==="datetime"&&Cc(n.value)){const A=new Date(n.value);A.setHours(E[0]),A.setMinutes(E[1]),A.setSeconds(n.hideSecond?0:E[2]);const x=A.getTime();h(x)}else if(At(n.value)&&n.type==="datetimerange"){const[A,x]=n.value,$=c.value==="start"?A:x,B=new Date($||"");B.setHours(E[0]),B.setMinutes(E[1]),B.setSeconds(n.hideSecond?0:E[2]);const K=B.getTime();if(K===$)return;const ae=[A,x];c.value==="start"?ae[0]=K:ae[1]=K,u.value=ae,h(ae)}}}function Q(){i("pickstart")}function te(){i("pickend")}const V=E=>{if(T.value.length<=1)return;const A=Math.max(0,E.detail.scrollTop);J(A)};function J(E){let A=0;for(let x=0;x<T.value.length;x++)if(A=A+T.value[x].height,E<A){o.value=x;return}}return e({scrollIntoView:b}),(E,A)=>{const x=Yt,$=Tp;return _e(),Ne(x,{class:"wd-month-panel"},{default:re(()=>[E.showPanelTitle?(_e(),Ne(x,{key:0,class:"wd-month-panel__title"},{default:re(()=>[Ze(vt(d.value),1)]),_:1})):gt("",!0),X(x,{class:"wd-month-panel__weeks"},{default:re(()=>[(_e(),Gn(Ht,null,fi(7,B=>X(x,{key:B,class:"wd-month-panel__week"},{default:re(()=>[Ze(vt(m.value(B+E.firstDayOfWeek)),1)]),_:2},1024)),64))]),_:1}),X($,{class:Nt(`wd-month-panel__container ${c.value?"wd-month-panel__container--time":""}`),style:zt(`height: ${y.value}px`),"scroll-y":"",onScroll:V,"scroll-top":a.value},{default:re(()=>[(_e(!0),Gn(Ht,null,fi(T.value,(B,K)=>(_e(),Ne(x,{key:K,id:`month${K}`},{default:re(()=>[X(UU,{type:E.type,date:B.date,value:E.value,"min-date":E.minDate,"max-date":E.maxDate,"first-day-of-week":E.firstDayOfWeek,formatter:E.formatter,"max-range":E.maxRange,"range-prompt":E.rangePrompt,"allow-same-day":E.allowSameDay,"default-time":E.defaultTime,showTitle:K!==0,onChange:I},{default:re(({item:ae})=>[Bt(E.$slots,"default",zd(xu({item:ae})),void 0,!0)]),_:2},1032,["type","date","value","min-date","max-date","first-day-of-week","formatter","max-range","range-prompt","allow-same-day","default-time","showTitle"])]),_:2},1032,["id"]))),128))]),_:3},8,["class","style","scroll-top"]),c.value?(_e(),Ne(x,{key:1,class:"wd-month-panel__time"},{default:re(()=>[E.type==="datetimerange"?(_e(),Ne(x,{key:0,class:"wd-month-panel__time-label"},{default:re(()=>[X(x,{class:"wd-month-panel__time-text"},{default:re(()=>[Ze(vt(c.value==="start"?pt(s)("startTime"):pt(s)("endTime")),1)]),_:1})]),_:1})):gt("",!0),X(x,{class:"wd-month-panel__time-picker"},{default:re(()=>[f.value.length?(_e(),Ne(Xp,{key:0,modelValue:l.value,"onUpdate:modelValue":A[0]||(A[0]=B=>l.value=B),columns:f.value,"columns-height":125,"immediate-change":E.immediateChange,onChange:H,onPickstart:Q,onPickend:te},null,8,["modelValue","columns","immediate-change"])):gt("",!0)]),_:1})]),_:1})):gt("",!0)]),_:3})}}})),HU=cn(WU,[["__scopeId","data-v-a478bfb5"]]),QU=Tt(Xe({},xn),{modelValue:en([Number,Array,null]),type:lt("date"),minDate:jt(new Date(new Date().getFullYear(),new Date().getMonth()-6,new Date().getDate()).getTime()),maxDate:jt(new Date(new Date().getFullYear(),new Date().getMonth()+6,new Date().getDate(),23,59,59).getTime()),firstDayOfWeek:jt(0),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:qe(!1),showPanelTitle:qe(!0),defaultTime:{type:[String,Array],default:"00:00:00"},panelHeight:jt(378),timeFilter:Function,hideSecond:qe(!1),immediateChange:qe(!1)}),zU={name:"wd-calendar-view",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},GU=Lt(Tt(Xe({},zU),{props:QU,emits:["change","update:modelValue","pickstart","pickend"],setup(r,{expose:e,emit:t}){const n=r,i=t,s=ge([]),a=ge(),o=ge();Ge(()=>n.defaultTime,d=>{s.value=NU(d)},{deep:!0,immediate:!0});function l(){const d=c();d.scrollIntoView&&d.scrollIntoView()}function c(){return n.type.indexOf("month")>-1?a.value:o.value}function u({value:d}){i("update:modelValue",d),i("change",{value:d})}function h(){i("pickstart")}function f(){i("pickend")}return e({scrollIntoView:l}),(d,m)=>{const y=Yt;return _e(),Ne(y,{class:Nt(`wd-calendar-view ${d.customClass}`)},{default:re(()=>[d.type==="month"||d.type==="monthrange"?(_e(),Ne($U,{key:0,ref_key:"yearPanelRef",ref:a,type:d.type,value:d.modelValue,"min-date":d.minDate,"max-date":d.maxDate,formatter:d.formatter,"max-range":d.maxRange,"range-prompt":d.rangePrompt,"allow-same-day":d.allowSameDay,"show-panel-title":d.showPanelTitle,"default-time":s.value,"panel-height":d.panelHeight,onChange:u},null,8,["type","value","min-date","max-date","formatter","max-range","range-prompt","allow-same-day","show-panel-title","default-time","panel-height"])):(_e(),Ne(HU,{key:1,ref_key:"monthPanelRef",ref:o,type:d.type,value:d.modelValue,"min-date":d.minDate,"max-date":d.maxDate,"first-day-of-week":d.firstDayOfWeek,formatter:d.formatter,"max-range":d.maxRange,"range-prompt":d.rangePrompt,"allow-same-day":d.allowSameDay,"show-panel-title":d.showPanelTitle,"default-time":s.value,"panel-height":d.panelHeight,"immediate-change":d.immediateChange,"time-filter":d.timeFilter,"hide-second":d.hideSecond,onChange:u,onPickstart:h,onPickend:f},{default:re(({item:T})=>[Bt(d.$slots,"default",zd(xu({item:T})),void 0,!0)]),_:3},8,["type","value","min-date","max-date","first-day-of-week","formatter","max-range","range-prompt","allow-same-day","show-panel-title","default-time","panel-height","immediate-change","time-filter","hide-second"]))]),_:3},8,["class"])}}})),KU=cn(GU,[["__scopeId","data-v-de6e0fe2"]]);var kr=(r=>(r.hard_lumps="hard_lumps",r.sausage_lumpy="sausage_lumpy",r.sausage_smooth="sausage_smooth",r.snake_smooth="snake_smooth",r.soft_blobs="soft_blobs",r.fluffy_mushy="fluffy_mushy",r.watery="watery",r))(kr||{}),Br=(r=>(r.brown="brown",r.green="green",r.yellow="yellow",r.black="black",r.red="red",r.pale="pale",r.clay="clay",r.orange="orange",r))(Br||{}),T_=(r=>(r.hard="hard",r.soft="soft",r.loose="loose",r.watery="watery",r.sticky="sticky",r.foamy="foamy",r))(T_||{}),__=(r=>(r.constipation="constipation",r.normal="normal",r.diarrhea="diarrhea",r.tenesmus="tenesmus",r))(__||{}),S_=(r=>(r.smooth="smooth",r.rough="rough",r.mucus="mucus",r.blood="blood",r.pus="pus",r.undigested="undigested",r))(S_||{}),C_=(r=>(r.mild="mild",r.moderate="moderate",r.strong="strong",r.foul="foul",r.sour="sour",r.fishy="fishy",r))(C_||{}),N_=(r=>(r.sinking="sinking",r.floating="floating",r))(N_||{}),A_=(r=>(r.small="small",r.medium="medium",r.large="large",r.huge="huge",r))(A_||{});function rE(r){var t;const e=`${r[0].label}-${r[1].label}-${r[2].label} ${r[3].label}:${r[4].label}:${(t=r[5])==null?void 0:t.label}`;return new Date(e).toLocaleString()}function Bd(r){const e=new Date(r),t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),i=e.getDate().toString().padStart(2,"0");return`${t}-${n}-${i}`}function YU(r,e=!0){if(!r||r.length===0)return;const t=r.map(i=>new Date(i).getTime()),n=Math.min(...t);return e?Bd(n):n}function x_(r){const e=qi(),t=e[e.length-2],n=e[e.length-1];r||pd(),(!t||t.route===n.route)&&lv({url:"/pages/poop"}),pd()}const JU=Lt({__name:"calendar",setup(r){const e=ge(),t=ge(new Date().getTime()),n=ge(),i=ge(),s=Me(()=>{const m=i.value;if(!m)return;const y=Object.keys(m);return YU(y,!1)}),a=new ph,o=Me(()=>{var m;return(m=i.value)==null?void 0:m[Bd(t.value)]}),l=Me(()=>!!i.value),c={[kr.hard_lumps]:"●",[kr.sausage_lumpy]:"〓",[kr.sausage_smooth]:"■",[kr.snake_smooth]:"▬",[kr.soft_blobs]:"◆",[kr.fluffy_mushy]:"◈",[kr.watery]:"~"},u={[Br.brown]:"#8B4513",[Br.green]:"#228B22",[Br.yellow]:"#FFD700",[Br.black]:"#000000",[Br.red]:"#DC143C",[Br.pale]:"#D3D3D3",[Br.clay]:"#CD5C5C",[Br.orange]:"#FF8C00"};function h(){e.value.scrollIntoView()}function f(){return v(this,null,function*(){Pv();try{i.value=yield a.findAllGroupedByDay(),tu()}catch(m){tu()}})}function d(m){var I;const y=Bd(m),T=(I=i.value[y])!=null?I:[],b=T[0];if(!b)return;let S=u[b.color],N=c[b.shape];const C=T.length;if(!S||!N)N=c[kr.sausage_smooth];else{if(S&&N)return{color:S,shape:N,num:C};S?N||(N=c[kr.sausage_smooth]):S=u[Br.black]}return{color:S,shape:N,num:C}}return f(),(m,y)=>{const T=Wn(kn("wd-button"),Va),b=Yt,S=Pr("layout-default-uni"),N=Pr("global-ku-root");return _e(),Ne(N,null,{default:re(()=>[X(S,null,{default:re(()=>[X(b,{class:"size-screen"},{default:re(()=>[X(b,{class:"box-border size-full flex flex-col p-1"},{default:re(()=>[X(b,{class:"flex flex-[0_0] justify-between"},{default:re(()=>[X(T,{type:"icon",icon:"arrow-left",onClick:y[0]||(y[0]=C=>pt(x_)("/pages/poop"))}),X(T,{onClick:h},{default:re(()=>[Ze(" 回到选中 ")]),_:1})]),_:1}),X(b,{class:"flex-[1_0]"},{default:re(()=>[pt(l)?(_e(),Ne(KU,{key:0,ref_key:"calendarRef",ref:e,modelValue:pt(t),"onUpdate:modelValue":y[2]||(y[2]=C=>En(t)?t.value=C:null),"min-date":pt(s),"max-date":Date.now(),"panel-height":700},{default:re(({item:C})=>[X(b,{class:"relative center",onClick:y[1]||(y[1]=I=>pt(n).show())},{default:re(()=>{var I;return[X(b,null,{default:re(()=>[Ze(vt(C.text),1)]),_:2},1024),X(b,{class:Nt(["absolute bottom--1.2em",[`c-${(I=d(C.date))==null?void 0:I.color}`]])},{default:re(()=>{var H;return[Ze(vt((H=d(C.date))==null?void 0:H.shape),1)]}),_:2},1032,["class"]),X(b,{class:"absolute bottom--0.5em right-0.7em text-0.8em c-primary"},{default:re(()=>{var H;return[Ze(vt(((H=d(C.date))==null?void 0:H.num)||""),1)]}),_:2},1024)]}),_:2},1024)]),_:1},8,["modelValue","min-date","max-date"])):gt("",!0)]),_:1})]),_:1})]),_:1}),X(y_,{ref_key:"panelRef",ref:n,list:pt(o)},null,8,["list"])]),_:1})]),_:1})}}}),XU=Object.freeze(Object.defineProperty({__proto__:null,default:JU},Symbol.toStringTag,{value:"Module"})),ZU=Tt(Xe({},xn),{title:String,value:Qu(""),icon:String,label:String,isLink:qe(!1),to:String,replace:qe(!1),clickable:qe(!1),size:String,border:qe(void 0),titleWidth:String,center:qe(!1),required:qe(!1),vertical:qe(!1),prop:String,rules:eo(),customIconClass:lt(""),customLabelClass:lt(""),customValueClass:lt(""),customTitleClass:lt(""),valueAlign:lt("right"),ellipsis:qe(!1),useTitleSlot:qe(!0),markerSide:lt("before")}),e4={name:"wd-cell",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},t4=Lt(Tt(Xe({},e4),{props:ZU,emits:["click"],setup(r,{emit:e}){const t=r,n=e,i=Vw(),s=jv(),a=Me(()=>!!(Mt(t.border)?t.border:s.border.value)),{parent:o}=Mp(Pp),l=Me(()=>o&&t.prop&&o.errorMessages&&o.errorMessages[t.prop]?o.errorMessages[t.prop]:""),c=Me(()=>{let f=!1;if(o&&o.props.rules){const d=o.props.rules;for(const m in d)Object.prototype.hasOwnProperty.call(d,m)&&m===t.prop&&Array.isArray(d[m])&&(f=d[m].some(y=>y.required))}return t.required||t.rules.some(d=>d.required)||f}),u=Me(()=>{const f=i.icon||t.icon,d=i.title&&t.useTitleSlot||t.title,m=i.label||t.label;return f||d||m});function h(){const f=t.to;(t.clickable||t.isLink)&&n("click"),f&&t.isLink&&(t.replace?lv({url:f}):Mi({url:f}))}return(f,d)=>{const m=ju,y=Yt;return _e(),Ne(y,{class:Nt(["wd-cell",a.value?"is-border":"",f.size?"is-"+f.size:"",f.center?"is-center":"",f.customClass]),style:zt(f.customStyle),"hover-class":f.isLink||f.clickable?"is-hover":"none","hover-stay-time":70,onClick:h},{default:re(()=>[X(y,{class:Nt(["wd-cell__wrapper",f.vertical?"is-vertical":""])},{default:re(()=>[u.value?(_e(),Ne(y,{key:0,class:"wd-cell__left",style:zt(f.titleWidth?"min-width:"+f.titleWidth+";max-width:"+f.titleWidth+";":"")},{default:re(()=>[c.value&&f.markerSide==="before"?(_e(),Ne(m,{key:0,class:"wd-cell__required wd-cell__required--left"},{default:re(()=>[Ze("*")]),_:1})):gt("",!0),Bt(f.$slots,"icon",{},()=>[f.icon?(_e(),Ne(er,{key:0,name:f.icon,"custom-class":`wd-cell__icon  ${f.customIconClass}`},null,8,["name","custom-class"])):gt("",!0)],!0),X(y,{class:"wd-cell__title"},{default:re(()=>[f.useTitleSlot&&f.$slots.title?Bt(f.$slots,"title",{key:0},void 0,!0):f.title?(_e(),Ne(m,{key:1,class:Nt(f.customTitleClass)},{default:re(()=>[Ze(vt(f.title),1)]),_:1},8,["class"])):gt("",!0),Bt(f.$slots,"label",{},()=>[f.label?(_e(),Ne(y,{key:0,class:Nt(`wd-cell__label ${f.customLabelClass}`)},{default:re(()=>[Ze(vt(f.label),1)]),_:1},8,["class"])):gt("",!0)],!0)]),_:3}),c.value&&f.markerSide==="after"?(_e(),Ne(m,{key:1,class:"wd-cell__required"},{default:re(()=>[Ze("*")]),_:1})):gt("",!0)]),_:3},8,["style"])):gt("",!0),X(y,{class:"wd-cell__right"},{default:re(()=>[X(y,{class:"wd-cell__body"},{default:re(()=>[X(y,{class:Nt(`wd-cell__value ${f.customValueClass} wd-cell__value--${f.valueAlign} ${f.ellipsis?"wd-cell__value--ellipsis":""}`)},{default:re(()=>[Bt(f.$slots,"default",{},()=>[Ze(vt(f.value),1)],!0)]),_:3},8,["class"]),f.isLink?(_e(),Ne(er,{key:0,"custom-class":"wd-cell__arrow-right",name:"arrow-right"})):Bt(f.$slots,"right-icon",{key:1},void 0,!0)]),_:3}),l.value?(_e(),Ne(y,{key:0,class:"wd-cell__error-message"},{default:re(()=>[Ze(vt(l.value),1)]),_:1})):gt("",!0)]),_:3})]),_:3},8,["class"])]),_:3},8,["class","style","hover-class"])}}})),mh=cn(t4,[["__scopeId","data-v-14cc99f7"]]),n4=Tt(Xe({},xn),{customLabelClass:lt(""),customValueClass:lt(""),customViewClass:lt(""),label:String,placeholder:String,disabled:qe(!1),readonly:qe(!1),loading:qe(!1),loadingColor:lt("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:qe(!1),size:String,labelWidth:lt("33%"),useDefaultSlot:qe(!1),useLabelSlot:qe(!1),error:qe(!1),alignRight:qe(!1),beforeConfirm:Function,closeOnClickModal:qe(!0),safeAreaInsetBottom:qe(!0),ellipsis:qe(!1),columnsHeight:jt(217),valueKey:lt("value"),labelKey:lt("label"),modelValue:{type:[String,Number,Array],default:""},columns:{type:Array,default:()=>[]},columnChange:Function,displayFormat:Function,zIndex:jt(15),prop:String,rules:eo(),immediateChange:qe(!1),rootPortal:qe(!1),clearable:qe(!1),markerSide:lt("before")}),r4={name:"wd-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},i4=Lt(Tt(Xe({},r4),{props:n4,emits:["confirm","open","cancel","clear","update:modelValue"],setup(r,{expose:e,emit:t}){const{translate:n}=ps("picker"),i=r,s=t,a=ge(null),o=ge(!1),l=ge(!1),c=ge(""),u=ge(""),h=ge([]),f=ge([]),d=ge(!1),m=ge(!1),y=Me(()=>i.loading||o.value);Ge(()=>i.displayFormat,L=>{L&&fn(L),a.value&&a.value.getSelectedIndex().length!==0&&C(i.modelValue)},{immediate:!0,deep:!0}),Ge(()=>i.modelValue,L=>{u.value=L,C(L)},{deep:!0,immediate:!0}),Ge(()=>i.columns,L=>{h.value=$t(L),f.value=$t(L),L.length===0?(u.value=At(i.modelValue)?[]:"",c.value=""):C(i.modelValue)},{deep:!0,immediate:!0}),Ge(()=>i.columnChange,L=>{L&&fn(L)},{deep:!0,immediate:!0});const T=Me(()=>i.clearable&&!i.disabled&&!i.readonly&&c.value.length>0),b=Me(()=>!i.disabled&&!i.readonly&&!T.value),S=Me(()=>{const L=["wd-picker__cell"];return i.disabled&&L.push("is-disabled"),i.readonly&&L.push("is-readonly"),i.error&&L.push("is-error"),c.value||L.push("wd-picker__cell--placeholder"),L.join(" ")}),{proxy:N}=Cn();gn(()=>{C(i.modelValue)}),Xr(()=>{h.value=$t(i.columns),f.value=$t(i.columns)});function C(L){At(L)&&L.length>0||Mt(L)&&!At(L)&&L!==""?a.value?bn(()=>{x(a.value.getSelects())}):x(I(L)):c.value=""}function I(L){const Se=Lc(i.columns,i.valueKey,i.labelKey);if(i.columns.length===0||L===""||!Mt(L)||At(L)&&L.length===0)return;const Ae=Us(L);if(["string","number","boolean","array"].indexOf(Ae)===-1)return[];L=At(L)?L:[L],L=L.slice(0,Se.length),L.length===0&&(L=Se.map(()=>0));let Ye=[];L.forEach((et,ut)=>{let Ee=Se[ut].findIndex($e=>$e[i.valueKey].toString()===et.toString());Ee=Ee===-1?0:Ee,Ye.push(Ee)});const mt=Ye.map((et,ut)=>Se[ut][et]);return mt.length===1?mt[0]:mt}function H(){te()}function Q(){V()}function te(){i.disabled||i.readonly||(s("open"),l.value=!0,u.value=i.modelValue,h.value=f.value)}function V(){l.value=!1,s("cancel");let L=setTimeout(()=>{clearTimeout(L),Mt(a.value)&&a.value.resetColumns(f.value)},300)}function J(){if(y.value)return;if(d.value){m.value=!0;return}const{beforeConfirm:L}=i;L&&fn(L)?L(u.value,Se=>{Se&&E()},N.$.exposed):E()}function E(){if(y.value||i.disabled){l.value=!1;return}const L=a.value.getSelects(),Se=a.value.getValues(),Ae=a.value.getColumnsData();l.value=!1,f.value=$t(Ae),s("update:modelValue",Se),x(L),s("confirm",{value:Se,selectedItems:L})}function A({value:L}){u.value=L}function x(L){if(At(L)&&!L.length||!L)return;const{valueKey:Se,labelKey:Ae}=i;c.value=(i.displayFormat||jO)(L,{valueKey:Se,labelKey:Ae})}function $(){}function B(){d.value=!0}function K(){d.value=!1,m.value&&(m.value=!1,J())}function ae(L){o.value=L}function ue(){const L=At(u.value)?[]:"";s("update:modelValue",L),s("clear")}return e({close:Q,open:H,setLoading:ae}),(L,Se)=>{const Ae=Yt;return _e(),Ne(Ae,{class:Nt(`wd-picker ${L.disabled?"is-disabled":""} ${L.size?"is-"+L.size:""} ${L.alignRight?"is-align-right":""} ${L.error?"is-error":""} ${L.customClass}`),style:zt(L.customStyle)},{default:re(()=>[L.$slots.default?(_e(),Ne(Ae,{key:1,onClick:te},{default:re(()=>[Bt(L.$slots,"default",{},void 0,!0)]),_:3})):(_e(),Ne(mh,{key:0,title:L.label,value:c.value?c.value:L.placeholder||pt(n)("placeholder"),required:L.required,size:L.size,"title-width":L.labelWidth,prop:L.prop,rules:L.rules,clickable:!L.disabled&&!L.readonly,"value-align":L.alignRight?"right":"left","custom-class":S.value,"custom-style":L.customStyle,"custom-title-class":L.customLabelClass,"custom-value-class":L.customValueClass,ellipsis:L.ellipsis,"use-title-slot":!!L.$slots.label,"marker-side":L.markerSide,onClick:te},Fw({"right-icon":re(()=>[b.value?(_e(),Ne(er,{key:0,"custom-class":"wd-picker__arrow",name:"arrow-right"})):T.value?(_e(),Ne(Ae,{key:1,onClick:Ja(ue,["stop"])},{default:re(()=>[X(er,{"custom-class":"wd-picker__clear",name:"error-fill"})]),_:1})):gt("",!0)]),_:2},[L.$slots.label?{name:"title",fn:re(()=>[Bt(L.$slots,"label",{},void 0,!0)]),key:"0"}:void 0]),1032,["title","value","required","size","title-width","prop","rules","clickable","value-align","custom-class","custom-style","custom-title-class","custom-value-class","ellipsis","use-title-slot","marker-side"])),X(Rp,{modelValue:l.value,"onUpdate:modelValue":Se[1]||(Se[1]=ve=>l.value=ve),position:"bottom","hide-when-close":!1,"close-on-click-modal":L.closeOnClickModal,"z-index":L.zIndex,"safe-area-inset-bottom":L.safeAreaInsetBottom,"root-portal":L.rootPortal,onClose:V,"custom-class":"wd-picker__popup"},{default:re(()=>[X(Ae,{class:"wd-picker__wraper"},{default:re(()=>[X(Ae,{class:"wd-picker__toolbar",onTouchmove:$},{default:re(()=>[X(Ae,{class:"wd-picker__action wd-picker__action--cancel",onClick:V},{default:re(()=>[Ze(vt(L.cancelButtonText||pt(n)("cancel")),1)]),_:1}),L.title?(_e(),Ne(Ae,{key:0,class:"wd-picker__title"},{default:re(()=>[Ze(vt(L.title),1)]),_:1})):gt("",!0),X(Ae,{class:Nt(`wd-picker__action ${y.value?"is-loading":""}`),onClick:J},{default:re(()=>[Ze(vt(L.confirmButtonText||pt(n)("done")),1)]),_:1},8,["class"])]),_:1}),X(Xp,{ref_key:"pickerViewWd",ref:a,"custom-class":L.customViewClass,modelValue:u.value,"onUpdate:modelValue":Se[0]||(Se[0]=ve=>u.value=ve),columns:h.value,loading:y.value,"loading-color":L.loadingColor,"columns-height":L.columnsHeight,"value-key":L.valueKey,"label-key":L.labelKey,"immediate-change":L.immediateChange,onChange:A,onPickstart:B,onPickend:K,"column-change":L.columnChange},null,8,["custom-class","modelValue","columns","loading","loading-color","columns-height","value-key","label-key","immediate-change","column-change"])]),_:1})]),_:1},8,["modelValue","close-on-click-modal","z-index","safe-area-inset-bottom","root-portal"])]),_:3},8,["class","style"])}}})),s4=cn(i4,[["__scopeId","data-v-e8a8e208"]]),a4={name:"wd-form",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},o4=Lt(Tt(Xe({},a4),{props:A$,setup(r,{expose:e}){const{show:t}=to("wd-form-toast"),n=r,{children:i,linkChildren:s}=c_(Pp);let a=nn({});s({props:n,errorMessages:a}),Ge(()=>n.model,()=>{n.resetOnChange&&u()},{immediate:!0,deep:!0});function o(f){return v(this,null,function*(){const d=[];let m=!0;const y=[],T=l(),b=At(f)?f:Mt(f)?[f]:[],S=b.length>0?b.reduce((C,I)=>(T[I]&&(C[I]=T[I]),C),{}):T;for(const C in S){const I=S[C],H=qv(n.model,C);if(I&&I.length>0)for(const Q of I){if(Q.required&&(!Mt(H)||H==="")){d.push({prop:C,message:Q.message}),m=!1;break}if(Q.pattern&&!Q.pattern.test(H)){d.push({prop:C,message:Q.message}),m=!1;break}const N=Q,{validator:te}=N,V=Gl(N,["validator"]);if(te){const J=te(H,V);Nc(J)?y.push(J.then(E=>{typeof E=="string"?(d.push({prop:C,message:E}),m=!1):typeof E=="boolean"&&!E&&(d.push({prop:C,message:Q.message}),m=!1)}).catch(E=>{const A=Mt(E)?Cp(E)?E:E.message||Q.message:Q.message;d.push({prop:C,message:A}),m=!1})):J||(d.push({prop:C,message:Q.message}),m=!1)}}}return yield Promise.all(y),c(d),m&&(b.length?b.forEach(u):u()),{valid:m,errors:d}})}function l(){const f=$t(n.rules),d=i.map(m=>m.prop);return Object.keys(f).forEach(m=>{d.includes(m)||delete f[m]}),i.forEach(m=>{Mt(m.prop)&&Mt(m.rules)&&m.rules.length&&(f[m.prop]?f[m.prop]=[...f[m.prop],...m.rules]:f[m.prop]=m.rules)}),f}function c(f){const d=i.map(y=>y.prop).filter(Boolean),m=f.filter(y=>y.message&&d.includes(y.prop));m.length&&(m.sort((y,T)=>d.indexOf(y.prop)-d.indexOf(T.prop)),n.errorType==="toast"?t(m[0].message):n.errorType==="message"&&m.forEach(y=>{a[y.prop]=y.message}))}function u(f){f?a[f]="":Object.keys(a).forEach(d=>{a[d]=""})}function h(){u()}return e({validate:o,reset:h}),(f,d)=>{const m=Yt;return _e(),Ne(m,{class:Nt(`wd-form ${f.customClass}`),style:zt(f.customStyle)},{default:re(()=>[Bt(f.$slots,"default",{},void 0,!0),n.errorType==="toast"?(_e(),Ne(zu,{key:0,selector:"wd-form-toast"})):gt("",!0)]),_:3},8,["class","style"])}}})),l4=cn(o4,[["__scopeId","data-v-e513a788"]]),c4=Tt(Xe({},xn),{modelValue:en([String,Number]),loading:qe(!1),loadingColor:lt("#4D80F0"),columnsHeight:jt(217),valueKey:lt("value"),labelKey:lt("label"),type:lt("datetime"),filter:Function,formatter:Function,columnFormatter:Function,minDate:jt(new Date(new Date().getFullYear()-10,0,1).getTime()),maxDate:jt(new Date(new Date().getFullYear()+10,11,31).getTime()),minHour:jt(0),maxHour:jt(23),minMinute:jt(0),maxMinute:jt(59),useSecond:qe(!1),minSecond:jt(0),maxSecond:jt(59),immediateChange:qe(!1)});function si(r,e,t=!1){const n=[],i=new Date(r);if(e==="time"){const s=String(r).split(":");n.push(parseInt(s[0]),parseInt(s[1])),t&&s[2]&&n.push(parseInt(s[2]))}else n.push(i.getFullYear(),i.getMonth()+1),e==="date"?n.push(i.getDate()):e==="datetime"&&(n.push(i.getDate(),i.getHours(),i.getMinutes()),t&&n.push(i.getSeconds()));return n}const u4={name:"wd-datetime-picker-view",virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},iE=Lt(Tt(Xe({},u4),{props:c4,emits:["change","pickstart","pickend","update:modelValue"],setup(r,{expose:e,emit:t}){const n=A=>Mt(A)&&!Number.isNaN(A),i=(A,x)=>{let $=-1;const B=A<0?0:A,K=Array(B);for(;++$<A;)K[$]=x($);return K},s=(A,x)=>32-new Date(A,x-1,32).getDate(),a=r,o=t,l=ge(),c=ge(null),u=ge([]),h=ge([]),f=ge(!1),{proxy:d}=Cn(),m=Np(()=>{if(!f.value)return;const A=C(a.modelValue);A===c.value?u.value=T():H(A)},50);Ge(()=>a.modelValue,(A,x)=>{if(A===x)return;const $=C(A);H($)},{deep:!0,immediate:!0}),Ge(()=>a.type,A=>{},{deep:!0,immediate:!0}),Ge([()=>a.type,()=>a.filter,()=>a.formatter,()=>a.columnFormatter,()=>a.minDate,()=>a.maxDate,()=>a.minHour,()=>a.maxHour,()=>a.minMinute,()=>a.maxMinute,()=>a.minSecond,()=>a.maxSecond,()=>a.useSecond],()=>{m()},{deep:!0,immediate:!0}),Xr(()=>{f.value=!0;const A=C(a.modelValue);H(A)});function y({value:A}){h.value=A;const x=Q();o("update:modelValue",x),o("change",{value:x,picker:d.$.exposed})}function T(){const{formatter:A,columnFormatter:x}=a;return x?x(d.$.exposed):S().map($=>$.values.map(B=>({label:A?A($.type,Mn(B)):Mn(B),value:B})))}function b(A){u.value=A}function S(){const{filter:A}=a;return N().map(({type:x,range:$})=>{let B=i($[1]-$[0]+1,K=>$[0]+K);return A&&(B=A(x,B)),{type:x,values:B}})}function N(){if(a.type==="time"){const et=[{type:"hour",range:[a.minHour,a.maxHour]},{type:"minute",range:[a.minMinute,a.maxMinute]}];return a.useSecond&&et.push({type:"second",range:[a.minSecond,a.maxSecond]}),et}const{maxYear:A,maxDate:x,maxMonth:$,maxHour:B,maxMinute:K,maxSecond:ae}=I("max",c.value),{minYear:ue,minDate:L,minMonth:Se,minHour:Ae,minMinute:ve,minSecond:Ye}=I("min",c.value),mt=[{type:"year",range:[ue,A]},{type:"month",range:[Se,$]},{type:"date",range:[L,x]},{type:"hour",range:[Ae,B]},{type:"minute",range:[ve,K]}];return a.type==="datetime"&&a.useSecond&&mt.push({type:"second",range:[Ye,ae]}),a.type==="date"&&mt.splice(3,2),a.type==="year-month"&&mt.splice(2,3),a.type==="year"&&mt.splice(1,4),mt}function C(A){const x=a.type!=="time";if(x&&!n(A)?A=a.minDate:!x&&!A&&(A=a.useSecond?`${Mn(a.minHour)}:00:00`:`${Mn(a.minHour)}:00`),!x){let[$,B,K="00"]=(Cp(A)?A:A.toString()).split(":");return $=Mn(Yo(Number($),a.minHour,a.maxHour)),B=Mn(Yo(Number(B),a.minMinute,a.maxMinute)),a.useSecond?(K=Mn(Yo(Number(K),a.minSecond,a.maxSecond)),`${$}:${B}:${K}`):`${$}:${B}`}return A=Math.min(Math.max(Number(A),a.minDate),a.maxDate),A}function I(A,x){const $=new Date(x),B=new Date(a[`${A}Date`]),K=B.getFullYear();let ae=1,ue=1,L=0,Se=0,Ae=0;return A==="max"&&(ae=12,ue=s($.getFullYear(),$.getMonth()+1),L=23,Se=59,Ae=59),$.getFullYear()===K&&(ae=B.getMonth()+1,$.getMonth()+1===ae&&(ue=B.getDate(),$.getDate()===ue&&(L=B.getHours(),$.getHours()===L&&(Se=B.getMinutes(),$.getMinutes()===Se&&(Ae=B.getSeconds()))))),{[`${A}Year`]:K,[`${A}Month`]:ae,[`${A}Date`]:ue,[`${A}Hour`]:L,[`${A}Minute`]:Se,[`${A}Second`]:Ae}}function H(A){const x=si(A,a.type,a.useSecond);a.modelValue!==A&&(o("update:modelValue",A),o("change",{value:A,picker:d.$.exposed})),c.value=A,u.value=T(),h.value=x}function Q(){var et;const{type:A,useSecond:x}=a;let $="";const B=((et=l.value)==null?void 0:et.getValues())||[],K=At(B)?B:[B];if(A==="time")return x?$=`${Mn(K[0])}:${Mn(K[1])}:${Mn(K[2])}`:$=`${Mn(K[0])}:${Mn(K[1])}`,$;const ae=K[0]&&parseInt(K[0]),ue=A==="year"?1:K[1]&&parseInt(K[1]),L=s(Number(ae),Number(ue));let Se=1;A!=="year-month"&&A!=="year"&&(Se=(Number(K[2])&&parseInt(String(K[2])))>L?L:K[2]&&parseInt(String(K[2])));let Ae=0,ve=0,Ye=0;A==="datetime"&&(Ae=Number(K[3])&&parseInt(K[3]),ve=Number(K[4])&&parseInt(K[4]),x&&(Ye=Number(K[5])&&parseInt(K[5])));const mt=new Date(Number(ae),Number(ue)-1,Number(Se),Ae,ve,Ye).getTime();return $=C(mt),$}function te(A){if(a.type==="time"||a.type==="year-month"||a.type==="year")return;const x=A.getValues(),$=Number(x[0]),B=Number(x[1]),K=s($,B);let ae=Number(x[2]);ae=ae>K?K:ae;let ue=0,L=0,Se=0;a.type==="datetime"&&(ue=Number(x[3]),L=Number(x[4]),a.useSecond&&(Se=Number(x[5])));const Ae=new Date($,B-1,ae,ue,L,Se).getTime();c.value=C(Ae);const ve=T(),Ye=A.getSelectedIndex().slice(0);ve.forEach((mt,et)=>{const ut=et+1,Ee=ve[ut];ut>ve.length-1||A.setColumnData(ut,Ee,Ye[ut]<=Ee.length-1?Ye[ut]:0)})}function V(){o("pickstart")}function J(){o("pickend")}function E(){var x;const A=(x=l.value)==null?void 0:x.getSelects();if(A!=null)return At(A)?A:[A]}return e({updateColumns:T,setColumns:b,getSelects:E,correctValue:C,getOriginColumns:S}),(A,x)=>(_e(),Ne(Xp,{ref_key:"datePickerview",ref:l,"custom-class":A.customClass,"custom-style":A.customStyle,"immediate-change":A.immediateChange,modelValue:h.value,"onUpdate:modelValue":x[0]||(x[0]=$=>h.value=$),columns:u.value,"columns-height":A.columnsHeight,columnChange:te,loading:A.loading,"loading-color":A.loadingColor,onChange:y,onPickstart:V,onPickend:J},null,8,["custom-class","custom-style","immediate-change","modelValue","columns","columns-height","loading","loading-color"]))}})),h4=Tt(Xe({},xn),{label:String,placeholder:String,disabled:qe(!1),readonly:qe(!1),loading:qe(!1),loadingColor:lt("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:qe(!1),size:String,labelWidth:lt("33%"),error:qe(!1),alignRight:qe(!1),closeOnClickModal:qe(!0),safeAreaInsetBottom:qe(!0),ellipsis:qe(!1),columnsHeight:jt(217),valueKey:lt("value"),labelKey:lt("label"),modelValue:en([String,Number,Array]),type:lt("datetime"),minDate:jt(new Date(new Date().getFullYear()-10,0,1).getTime()),maxDate:jt(new Date(new Date().getFullYear()+10,11,31,23,59,59).getTime()),minHour:jt(0),maxHour:jt(23),minMinute:jt(0),maxMinute:jt(59),useSecond:qe(!1),minSecond:jt(0),maxSecond:jt(59),filter:Function,formatter:Function,displayFormat:Function,beforeConfirm:Function,displayFormatTabLabel:Function,defaultValue:[String,Number,Array],zIndex:jt(15),prop:String,rules:eo(),customCellClass:lt(""),customViewClass:lt(""),customLabelClass:lt(""),customValueClass:lt(""),immediateChange:qe(!1),rootPortal:qe(!1),clearable:qe(!1),markerSide:lt("before")}),f4={name:"wd-datetime-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},d4=Lt(Tt(Xe({},f4),{props:h4,emits:["change","open","toggle","cancel","confirm","clear","update:modelValue"],setup(r,{expose:e,emit:t}){const n=r,i=t,{translate:s}=ps("datetime-picker"),a=ge(),o=ge(),l=ge(""),c=ge(!1),u=ge(!0),h=ge(!1),f=ge([]),d=ge(""),m=ge(""),y=ge(!1),T=ge(!1),b=ge(!1),{proxy:S}=Cn(),N=Me(()=>{const z=["wd-datetime-picker__cell"];return n.disabled&&z.push("is-disabled"),n.readonly&&z.push("is-readonly"),n.error&&z.push("is-error"),z.join(" ")});Ge(()=>n.modelValue,(z,Te)=>{Ua(z,Te)||(At(z)?(h.value=!0,d.value=$t(A(!0)),m.value=$t(A(!0,!0))):d.value=$t(A()),bn(()=>{et(!1,!1,!0)}))},{deep:!0,immediate:!0}),Ge(()=>n.displayFormat,z=>{z&&fn(z)},{deep:!0,immediate:!0}),Ge(()=>n.filter,z=>{z&&fn(z)},{deep:!0,immediate:!0}),Ge(()=>n.formatter,z=>{z&&fn(z)},{deep:!0,immediate:!0}),Ge(()=>n.beforeConfirm,z=>{z&&fn(z)},{deep:!0,immediate:!0}),Ge(()=>n.displayFormatTabLabel,z=>{z&&fn(z)},{deep:!0,immediate:!0}),Ge(()=>n.defaultValue,z=>{At(z)||h.value?(d.value=$t(A(!0)),m.value=$t(A(!0,!0))):d.value=$t(A())},{deep:!0,immediate:!0});const C=Me(()=>n.clearable&&!n.disabled&&!n.readonly&&(!At(l.value)&&l.value||At(l.value)&&(l.value[0]||l.value[1]))),I=Me(()=>!n.disabled&&!n.readonly&&!C.value);function H(z,Te,j,G,M){const{type:q,useSecond:se}=n;switch(q){case"datetime":{const[le,be,xe,Le,Pe,oe]=M;if(Te==="year")return z?j>le:j<le;if(Te==="month"&&G[0]===le)return z?j>be:j<be;if(Te==="date"&&G[0]===le&&G[1]===be)return z?j>xe:j<xe;if(Te==="hour"&&G[0]===le&&G[1]===be&&G[2]===xe)return z?j>Le:j<Le;if(Te==="minute"&&G[0]===le&&G[1]===be&&G[2]===xe&&G[3]===Le)return z?j>Pe:j<Pe;if(se&&Te==="second"&&G[0]===le&&G[1]===be&&G[2]===xe&&G[3]===Le&&G[4]===Pe)return z?j>oe:j<oe;break}case"year-month":{const[le,be]=M;if(Te==="year")return z?j>le:j<le;if(Te==="month"&&G[0]===le)return z?j>be:j<be;break}case"year":{const[le]=M;if(Te==="year")return z?j>le:j<le;break}case"date":{const[le,be,xe]=M;if(Te==="year")return z?j>le:j<le;if(Te==="month"&&G[0]===le)return z?j>be:j<be;if(Te==="date"&&G[0]===le&&G[1]===be)return z?j>xe:j<xe;break}case"time":{const[le,be,xe]=M;if(Te==="hour")return z?j>le:j<le;if(Te==="minute"&&G[0]===le)return z?j>be:j<be;if(se&&Te==="second"&&G[0]===le&&G[1]===be)return z?j>xe:j<xe;break}}return!1}function Q(z){return V(z,"start")}function te(z){return V(z,"end")}const V=(z,Te)=>{if(!z)return[];const{type:j}=n,G=Te==="start",{formatter:M}=n,q=z.correctValue(d.value),se=z.correctValue(m.value),le=si(G?q:se,j,n.useSecond),be=si(G?se:q,j,n.useSecond);return z.getOriginColumns().map((Le,Pe)=>Le.values.map(oe=>{const fe=H(G,Le.type,oe,le,be);return{label:M?M(Le.type,Mn(oe)):Mn(oe),value:oe,disabled:fe}}))};Xr(()=>{const{modelValue:z}=n;At(z)?(h.value=!0,d.value=$t(A(!0)),m.value=$t(A(!0,!0))):d.value=$t(A())}),gn(()=>{et(!1,!1,!0)});function J(z){let Te=z==="before"?d.value:m.value,j=[];return Te&&(j=si(Te,n.type,n.useSecond)),j.map(M=>({[n.labelKey]:Mn(M),[n.valueKey]:M}))}function E(){}function A(z,Te){const{modelValue:j,defaultValue:G,maxDate:M,minDate:q,type:se}=n;if(z){const le=Te?1:0,be=At(j)?j[le]:"",xe=At(G)?G[le]:"",Le=se==="time"?yn(M).format("HH:mm"):M,Pe=se==="time"?yn(q).format("HH:mm"):q;return be||xe||(Te?Le:Pe)}else return Mt(j||G)?j||G:""}function x(){B()}function $(){L()}function B(){n.disabled||n.readonly||(i("open"),h.value?(c.value=!0,u.value=!0,d.value=$t(A(!0,!1)),m.value=$t(A(!0,!0))):(c.value=!0,d.value=$t(A())),et(!0,!1,!0))}function K(){u.value=!u.value;const z=u.value?a.value:o.value;z.setColumns(z.updateColumns()),i("toggle",u.value?d.value:m.value)}function ae({value:z}){if(a.value&&!(h.value&&!o.value))if(h.value){const Te=si(z,n.type,n.useSecond),j=si(m.value,n.type,n.useSecond),M=a.value.getOriginColumns().some((q,se)=>H(!0,q.type,Te[se],Te,j));d.value=$t(M?m.value:z),bn(()=>{f.value=[mt(),$t(f.value[1])],i("change",{value:[d.value,m.value]}),a.value&&a.value.setColumns(a.value.updateColumns()),o.value&&o.value.setColumns(o.value.updateColumns())})}else d.value=$t(z),i("change",{value:d.value})}function ue({value:z}){if(!a.value||!o.value)return;const Te=si(z,n.type),j=si(d.value,n.type),M=o.value.getOriginColumns().some((q,se)=>H(!1,q.type,Te[se],Te,j));m.value=$t(M?d.value:z),bn(()=>{f.value=[$t(f.value[0]),mt(1)],i("change",{value:[d.value,m.value]}),a.value&&a.value.setColumns(a.value.updateColumns()),o.value&&o.value.setColumns(o.value.updateColumns())})}function L(){c.value=!1,setTimeout(()=>{h.value?(d.value=$t(A(!0)),m.value=$t(A(!0,!0))):d.value=$t(A())},200),i("cancel")}function Se(){if(n.loading||b.value)return;if(y.value){T.value=!0;return}const{beforeConfirm:z}=n;z?z(h.value?[d.value,m.value]:d.value,Te=>{Te&&Ye()},S.$.exposed):Ye()}function Ae(){y.value=!0}function ve(){y.value=!1,setTimeout(()=>{T.value&&(T.value=!1,Se())},50)}function Ye(){if(n.loading||b.value||n.disabled){c.value=!1;return}const z=h.value?[d.value,m.value]:d.value;c.value=!1,i("update:modelValue",z),i("confirm",{value:z}),et(!1,!0)}function mt(z=0){if(h.value){let Te=[];return z===0?Te=(a.value?a.value.getSelects():void 0)||d.value&&J("before"):Te=(o.value?o.value.getSelects():void 0)||m.value&&J("after"),ut(Te,!0)}else return""}function et(z=!1,Te=!1,j=!1){if(h.value){const G=j?d.value&&J("before")||[]:a.value&&a.value.getSelects&&a.value.getSelects()||[],M=j?m.value&&J("after")||[]:o.value&&o.value.getSelects&&o.value.getSelects()||[];l.value=z?l.value:[n.modelValue[0]||Te?ut(G):"",n.modelValue[1]||Te?ut(M):""],f.value=[ut(G,!0),ut(M,!0)]}else{const G=j?d.value&&J("before")||[]:a.value&&a.value.getSelects&&a.value.getSelects()||[];l.value=$t(n.modelValue||Te?ut(G):"")}}function ut(z,Te=!1){if(z.length===0)return"";if(Te&&n.displayFormatTabLabel)return n.displayFormatTabLabel(z);if(n.displayFormat)return n.displayFormat(z);if(n.formatter){const j={year:["year"],datetime:n.useSecond?["year","month","date","hour","minute","second"]:["year","month","date","hour","minute"],date:["year","month","date"],time:n.useSecond?["hour","minute","second"]:["hour","minute"],"year-month":["year","month"]};return z.map((G,M)=>n.formatter(j[n.type][M],G.value)).join("")}switch(n.type){case"year":return z[0].label;case"date":return`${z[0].label}-${z[1].label}-${z[2].label}`;case"year-month":return`${z[0].label}-${z[1].label}`;case"time":return n.useSecond?`${z[0].label}:${z[1].label}:${z[2].label}`:`${z[0].label}:${z[1].label}`;case"datetime":return n.useSecond?`${z[0].label}-${z[1].label}-${z[2].label} ${z[3].label}:${z[4].label}:${z[5].label}`:`${z[0].label}-${z[1].label}-${z[2].label} ${z[3].label}:${z[4].label}`}}function Ee(z){b.value=z}function $e(){i("clear"),i("update:modelValue",""),et(!1,!0)}return e({open:x,close:$,setLoading:Ee}),(z,Te)=>{const j=ju,G=Yt,M=Wn(kn("wd-icon"),er);return _e(),Ne(G,{class:Nt(`wd-datetime-picker ${z.customClass}`),style:zt(z.customStyle)},{default:re(()=>[z.$slots.default?(_e(),Ne(G,{key:1,onClick:B},{default:re(()=>[Bt(z.$slots,"default",{},void 0,!0)]),_:3})):(_e(),Ne(mh,{key:0,title:z.label,required:z.required,size:z.size,"title-width":z.labelWidth,prop:z.prop,rules:z.rules,clickable:!z.disabled&&!z.readonly,"value-align":z.alignRight?"right":"left","custom-class":N.value,"custom-style":z.customStyle,"custom-title-class":z.customLabelClass,"custom-value-class":z.customValueClass,ellipsis:z.ellipsis,"use-title-slot":!!z.$slots.label,"marker-side":z.markerSide,onClick:B},Fw({default:re(()=>[h.value?(_e(),Gn(Ht,{key:0},[pt(At)(l.value)?(_e(),Ne(G,{key:0},{default:re(()=>[X(j,{class:Nt(l.value[0]?"":"wd-datetime-picker__placeholder")},{default:re(()=>[Ze(vt(l.value[0]?l.value[0]:z.placeholder||pt(s)("placeholder")),1)]),_:1},8,["class"]),Ze(" "+vt(pt(s)("to"))+" ",1),X(j,{class:Nt(l.value[1]?"":"wd-datetime-picker__placeholder")},{default:re(()=>[Ze(vt(l.value[1]?l.value[1]:z.placeholder||pt(s)("placeholder")),1)]),_:1},8,["class"])]),_:1})):(_e(),Ne(G,{key:1,class:"wd-datetime-picker__cell-placeholder"},{default:re(()=>[Ze(vt(z.placeholder||pt(s)("placeholder")),1)]),_:1}))],64)):(_e(),Ne(G,{key:1,class:Nt(l.value?"":"wd-datetime-picker__placeholder")},{default:re(()=>[Ze(vt(l.value?l.value:z.placeholder||pt(s)("placeholder")),1)]),_:1},8,["class"]))]),"right-icon":re(()=>[I.value?(_e(),Ne(M,{key:0,"custom-class":"wd-datetime-picker__arrow",name:"arrow-right"})):C.value?(_e(),Ne(G,{key:1,onClick:Ja($e,["stop"])},{default:re(()=>[X(M,{"custom-class":"wd-datetime-picker__clear",name:"error-fill"})]),_:1})):gt("",!0)]),_:2},[z.$slots.label?{name:"title",fn:re(()=>[Bt(z.$slots,"label",{},void 0,!0)]),key:"0"}:void 0]),1032,["title","required","size","title-width","prop","rules","clickable","value-align","custom-class","custom-style","custom-title-class","custom-value-class","ellipsis","use-title-slot","marker-side"])),X(Rp,{modelValue:c.value,"onUpdate:modelValue":Te[2]||(Te[2]=q=>c.value=q),position:"bottom","hide-when-close":!1,"close-on-click-modal":z.closeOnClickModal,"safe-area-inset-bottom":z.safeAreaInsetBottom,"z-index":z.zIndex,"root-portal":z.rootPortal,onClose:L,"custom-class":"wd-datetime-picker__popup"},{default:re(()=>[X(G,{class:"wd-datetime-picker__wraper"},{default:re(()=>[X(G,{class:"wd-datetime-picker__toolbar",onTouchmove:E},{default:re(()=>[X(G,{class:"wd-datetime-picker__action wd-datetime-picker__action--cancel",onClick:L},{default:re(()=>[Ze(vt(z.cancelButtonText||pt(s)("cancel")),1)]),_:1}),z.title?(_e(),Ne(G,{key:0,class:"wd-datetime-picker__title"},{default:re(()=>[Ze(vt(z.title),1)]),_:1})):gt("",!0),X(G,{class:Nt(`wd-datetime-picker__action ${z.loading||b.value?"is-loading":""}`),onClick:Se},{default:re(()=>[Ze(vt(z.confirmButtonText||pt(s)("confirm")),1)]),_:1},8,["class"])]),_:1}),h.value?(_e(),Ne(G,{key:0,class:"wd-datetime-picker__region-tabs"},{default:re(()=>[X(G,{class:Nt(`wd-datetime-picker__region ${u.value?"is-active":""} `),onClick:K},{default:re(()=>[X(G,null,{default:re(()=>[Ze(vt(pt(s)("start")),1)]),_:1}),X(G,{class:"wd-datetime-picker__region-time"},{default:re(()=>[Ze(vt(f.value[0]),1)]),_:1})]),_:1},8,["class"]),X(G,{class:Nt(`wd-datetime-picker__region ${u.value?"":"is-active"}`),onClick:K},{default:re(()=>[X(G,null,{default:re(()=>[Ze(vt(pt(s)("end")),1)]),_:1}),X(G,{class:"wd-datetime-picker__region-time"},{default:re(()=>[Ze(vt(f.value[1]),1)]),_:1})]),_:1},8,["class"])]),_:1})):gt("",!0),X(G,{class:Nt(u.value?"wd-datetime-picker__show":"wd-datetime-picker__hidden")},{default:re(()=>[X(iE,{"custom-class":z.customViewClass,ref_key:"datetimePickerView",ref:a,type:z.type,modelValue:d.value,"onUpdate:modelValue":Te[0]||(Te[0]=q=>d.value=q),loading:z.loading||b.value,"loading-color":z.loadingColor,"columns-height":z.columnsHeight,"value-key":z.valueKey,"label-key":z.labelKey,formatter:z.formatter,filter:z.filter,"column-formatter":pt(At)(z.modelValue)?Q:void 0,"max-hour":z.maxHour,"min-hour":z.minHour,"max-date":z.maxDate,"min-date":z.minDate,"max-minute":z.maxMinute,"min-minute":z.minMinute,"use-second":z.useSecond,"min-second":z.minSecond,"max-second":z.maxSecond,"immediate-change":z.immediateChange,onChange:ae,onPickstart:Ae,onPickend:ve},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","use-second","min-second","max-second","immediate-change"])]),_:1},8,["class"]),X(G,{class:Nt(u.value?"wd-datetime-picker__hidden":"wd-datetime-picker__show")},{default:re(()=>[X(iE,{"custom-class":z.customViewClass,ref_key:"datetimePickerView1",ref:o,type:z.type,modelValue:m.value,"onUpdate:modelValue":Te[1]||(Te[1]=q=>m.value=q),loading:z.loading||b.value,"loading-color":z.loadingColor,"columns-height":z.columnsHeight,"value-key":z.valueKey,"label-key":z.labelKey,formatter:z.formatter,filter:z.filter,"column-formatter":pt(At)(z.modelValue)?te:void 0,"max-hour":z.maxHour,"min-hour":z.minHour,"max-date":z.maxDate,"min-date":z.minDate,"max-minute":z.maxMinute,"min-minute":z.minMinute,"use-second":z.useSecond,"min-second":z.minSecond,"max-second":z.maxSecond,"immediate-change":z.immediateChange,onChange:ue,onPickstart:Ae,onPickend:ve},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","use-second","min-second","max-second","immediate-change"])]),_:1},8,["class"])]),_:1})]),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index","root-portal"])]),_:3},8,["class","style"])}}})),sE=cn(d4,[["__scopeId","data-v-629b5d0e"]]),p4=Lt({__name:"record",setup(r){const e=ge(0),t=new ph,n=ge({}),i=to(),s=ge(0),a=ge(0),o={time:[{required:!0,message:"请选择开始时间",trigger:"blur"}]},l=ge(),c=Object.entries(kr).map(([C,I])=>({value:I,label:C})),u=Object.entries(Br).map(([C,I])=>({value:I,label:C})),h=Object.entries(T_).map(([C,I])=>({value:I,label:C})),f=Object.entries(__).map(([C,I])=>({value:I,label:C})),d=Object.entries(S_).map(([C,I])=>({value:I,label:C})),m=Object.entries(C_).map(([C,I])=>({value:I,label:C})),y=Object.entries(N_).map(([C,I])=>({value:I,label:C})),T=Object.entries(A_).map(([C,I])=>({value:I,label:C}));function b(){return v(this,null,function*(){var C;try{if(!(yield(C=l.value)==null?void 0:C.validate()))return;const H={time:n.value.time,finishTime:n.value.finishTime,shape:n.value.shape,color:n.value.color,consistency:n.value.consistency,frequency:n.value.frequency,surface:n.value.surface,odor:n.value.odor,buoyancy:n.value.buoyancy,size:n.value.size},Q=yield t.update(e.value,H);i.success("添加成功"),Object.assign(Q,{time:new Date,finishTime:void 0,shape:void 0,color:void 0,consistency:void 0,frequency:void 0,surface:void 0,odor:void 0,buoyancy:void 0,size:void 0}),setTimeout(()=>{Mi({url:"/pages/calendar"})})}catch(I){i.error(`添加失败: ${I.message}`)}})}function S(){pd()}function N(){return v(this,null,function*(){var C,I,H,Q;n.value=yield t.findById(e.value),s.value=(I=(C=n.value.time)==null?void 0:C.getTime())!=null?I:0,a.value=(Q=(H=n.value.finishTime)==null?void 0:H.getTime())!=null?Q:0})}return Uv(C=>{e.value=C==null?void 0:C.id,N()}),(C,I)=>{const H=Wn(kn("wd-cell"),mh),Q=Wn(kn("wd-picker"),s4),te=Wn(kn("wd-button"),Va),V=Yt,J=Wn(kn("wd-form"),l4),E=Pr("layout-default-uni"),A=Pr("global-ku-root");return _e(),Ne(A,null,{default:re(()=>[X(E,null,{default:re(()=>[X(V,{class:"p-4"},{default:re(()=>[X(J,{ref_key:"formRef",ref:l,model:n.value,rules:o},{default:re(()=>[X(H,{label:"开始时间",prop:"time"},{default:re(()=>[X(sE,{modelValue:s.value,"onUpdate:modelValue":I[0]||(I[0]=x=>s.value=x),type:"datetime",placeholder:"请选择开始时间","default-value":Date.now(),"use-second":"","display-format":pt(rE)},null,8,["modelValue","default-value","display-format"])]),_:1}),X(H,{label:"结束时间",prop:"finishTime"},{default:re(()=>[X(sE,{modelValue:a.value,"onUpdate:modelValue":I[1]||(I[1]=x=>a.value=x),type:"datetime",placeholder:"请选择结束时间","default-value":Date.now(),"use-second":"","display-format":pt(rE)},null,8,["modelValue","default-value","display-format"])]),_:1}),X(H,{label:"形状",prop:"shape"},{default:re(()=>[X(Q,{modelValue:n.value.shape,"onUpdate:modelValue":I[2]||(I[2]=x=>n.value.shape=x),columns:pt(c),placeholder:"请选择形状"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"颜色",prop:"color"},{default:re(()=>[X(Q,{modelValue:n.value.color,"onUpdate:modelValue":I[3]||(I[3]=x=>n.value.color=x),columns:pt(u),placeholder:"请选择颜色"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"质地",prop:"consistency"},{default:re(()=>[X(Q,{modelValue:n.value.consistency,"onUpdate:modelValue":I[4]||(I[4]=x=>n.value.consistency=x),columns:pt(h),placeholder:"请选择质地"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"频率",prop:"frequency"},{default:re(()=>[X(Q,{modelValue:n.value.frequency,"onUpdate:modelValue":I[5]||(I[5]=x=>n.value.frequency=x),columns:pt(f),placeholder:"请选择频率"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"表面",prop:"surface"},{default:re(()=>[X(Q,{modelValue:n.value.surface,"onUpdate:modelValue":I[6]||(I[6]=x=>n.value.surface=x),columns:pt(d),placeholder:"请选择表面特征"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"气味",prop:"odor"},{default:re(()=>[X(Q,{modelValue:n.value.odor,"onUpdate:modelValue":I[7]||(I[7]=x=>n.value.odor=x),columns:pt(m),placeholder:"请选择气味"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"浮沉",prop:"buoyancy"},{default:re(()=>[X(Q,{modelValue:n.value.buoyancy,"onUpdate:modelValue":I[8]||(I[8]=x=>n.value.buoyancy=x),columns:pt(y),placeholder:"请选择浮沉情况"},null,8,["modelValue","columns"])]),_:1}),X(H,{label:"大小",prop:"size"},{default:re(()=>[X(Q,{modelValue:n.value.size,"onUpdate:modelValue":I[9]||(I[9]=x=>n.value.size=x),columns:pt(T),placeholder:"请选择大小"},null,8,["modelValue","columns"])]),_:1}),X(V,{class:"mt-6 flex"},{default:re(()=>[X(te,{class:"mr-2 flex-1",type:"info",onClick:S},{default:re(()=>[Ze(" 取消 ")]),_:1}),X(te,{class:"flex-1",type:"primary",onClick:b},{default:re(()=>[Ze(" 提交 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}}),m4=cn(p4,[["__scopeId","data-v-f65f5385"]]),y4=Object.freeze(Object.defineProperty({__proto__:null,default:m4},Symbol.toStringTag,{value:"Module"})),g4={name:"wd-cell-group",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},b4=Lt(Tt(Xe({},g4),{props:N$,setup(r){const e=r,{linkChildren:t}=c_(Vv);return t({props:e}),(n,i)=>{const s=ju,a=Yt;return _e(),Ne(a,{class:Nt(["wd-cell-group",n.border?"is-border":"",n.customClass]),style:zt(n.customStyle)},{default:re(()=>[n.title||n.value||n.useSlot?(_e(),Ne(a,{key:0,class:"wd-cell-group__title"},{default:re(()=>[X(a,{class:"wd-cell-group__left"},{default:re(()=>[n.$slots.title?Bt(n.$slots,"title",{key:1},void 0,!0):(_e(),Ne(s,{key:0},{default:re(()=>[Ze(vt(n.title),1)]),_:1}))]),_:3}),X(a,{class:"wd-cell-group__right"},{default:re(()=>[n.$slots.value?Bt(n.$slots,"value",{key:1},void 0,!0):(_e(),Ne(s,{key:0},{default:re(()=>[Ze(vt(n.value),1)]),_:1}))]),_:3})]),_:3})):gt("",!0),X(a,{class:"wd-cell-group__body"},{default:re(()=>[Bt(n.$slots,"default",{},void 0,!0)]),_:3})]),_:3},8,["class","style"])}}})),E4=cn(b4,[["__scopeId","data-v-2284820d"]]),w4=Lt({__name:"setting",setup(r){const e=to(),t=D$(),n=new ph,i=[{title:"清空数据",icon:"clear",onClick(){return v(this,null,function*(){const o=yield t.confirm({title:"确认清空",msg:"确定要清空所有数据吗？此操作不可恢复！"}).catch(()=>{});if((o==null?void 0:o.action)==="confirm")try{yield LF(),e.success("数据已清空，稍后将重启"),setTimeout(()=>{qM({url:"/pages/poop"})},2e3)}catch(l){e.error("清空数据失败")}})}},{title:"导入数据",icon:"upload"},{title:"导出数据",icon:"download1",disabled:!0,onClick(){return v(this,null,function*(){try{const o=yield n.findAll(),l=JSON.stringify(o,null,2);if(typeof window!="undefined"&&window.Blob){const c=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(c),h=document.createElement("a");h.href=u,h.download=`poop-rect-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(u)}else{const c=`${uni.env.USER_DATA_PATH}/poop-rect-${new Date().toISOString().slice(0,10)}.json`;yield uni.getFileSystemManager().writeFile({filePath:c,data:l,encoding:"utf8",success:()=>{e.success(`数据已导出到: ${c}`)},fail:u=>{e.error("导出失败")}})}e.success("导出成功，请等待下载")}catch(o){e.error("导出数据失败")}})}}];return(o,l)=>{const c=Wn(kn("wd-button"),Va),u=Yt,h=Wn(kn("wd-cell"),mh),f=Wn(kn("wd-cell-group"),E4),d=Pr("layout-default-uni"),m=Pr("global-ku-root");return _e(),Ne(m,null,{default:re(()=>[X(d,null,{default:re(()=>[X(u,{class:"box-border size-screen flex flex-col p-sc2"},{default:re(()=>[X(u,{class:"mb-sc2 flex flex-[0_0] items-center"},{default:re(()=>[X(c,{type:"icon",icon:"arrow-left",onClick:l[0]||(l[0]=y=>pt(x_)("/pages/poop"))})]),_:1}),X(f,{class:"flex-[1_0] overflow-auto"},{default:re(()=>[(_e(),Gn(Ht,null,fi(i,y=>X(h,di({key:y.title,"custom-icon-class":"c-primary","is-link":y.onClick&&!y.disabled},y,{label:y.onClick&&!y.disabled?"":"开发中"}),null,16,["is-link","label"])),64))]),_:1})]),_:1})]),_:1})]),_:1})}}}),v4=Object.freeze(Object.defineProperty({__proto__:null,default:w4},Symbol.toStringTag,{value:"Module"}));function T4(r){return Fn.get("/foo",{name:r})}function _4(r,e={immediate:!1}){const t=ge(!1),n=ge(!1),i=ge(e.initialData),s=a=>v(this,null,function*(){return t.value=!0,r(a).then(o=>(i.value=o,n.value=!1,i.value)).catch(o=>{throw n.value=o,o}).finally(()=>{t.value=!1})});return e.immediate&&s({}),{loading:t,error:n,data:i,run:s}}const S4=Lt({__name:"request",setup(r){ge("http://laf.run/signup?code=ohaOgIX");const e=void 0,{loading:t,data:n,run:i}=_4(()=>T4("菲鸽"),{immediate:!0,initialData:e});function s(){n.value=e}return(a,o)=>{const l=U0,c=Yt;return _e(),Ne(c,{class:"p-6 text-center"},{default:re(()=>[X(c,{class:"my-2 text-center"},{default:re(()=>[X(l,{type:"primary",size:"mini",class:"w-160px",onClick:pt(i)},{default:re(()=>[Ze(" 发送请求 ")]),_:1},8,["onClick"])]),_:1}),X(c,{class:"h-16"},{default:re(()=>[pt(t)?(_e(),Ne(c,{key:0},{default:re(()=>[Ze(" loading... ")]),_:1})):(_e(),Gn(Ht,{key:1},[X(c,{class:"text-xl"},{default:re(()=>[Ze(" 请求数据如下 ")]),_:1}),X(c,{class:"text-green leading-8"},{default:re(()=>[Ze(vt(JSON.stringify(pt(n))),1)]),_:1})],64))]),_:1}),X(c,{class:"my-6 text-center"},{default:re(()=>[X(l,{type:"warn",size:"mini",class:"w-160px",disabled:!pt(n),onClick:s},{default:re(()=>[Ze(" 重置数据 ")]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),C4=Lt({__name:"index",setup(r){return(e,t)=>{const n=Yt,i=Pr("layout-default-uni"),s=Pr("global-ku-root");return _e(),Ne(s,null,{default:re(()=>[X(i,null,{default:re(()=>[X(n,{class:"text-center"},{default:re(()=>[X(n,{class:"m-8"},{default:re(()=>[Ze(" http://localhost:9000/#/pages-sub/demo/index ")]),_:1}),X(n,{class:"my-4 text-green-500"},{default:re(()=>[Ze(" 分包页面demo ")]),_:1}),X(n,{class:"text-blue-500"},{default:re(()=>[Ze(" 分包页面里面的components示例 ")]),_:1}),X(n,null,{default:re(()=>[X(S4)]),_:1})]),_:1})]),_:1})]),_:1})}}}),N4=cn(C4,[["__scopeId","data-v-e5653412"]]),A4=Object.freeze(Object.defineProperty({__proto__:null,default:N4},Symbol.toStringTag,{value:"Module"}));</script>
    <style rel="stylesheet" crossorigin>uni-toast{position:fixed;top:0;right:0;bottom:0;left:0;z-index:999;display:block;box-sizing:border-box;pointer-events:none;font-size:16px}.uni-sample-toast{position:fixed;z-index:999;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;max-width:80%}.uni-simple-toast__text{display:inline-block;vertical-align:middle;color:#fff;background-color:rgba(17,17,17,.7);padding:10px 20px;border-radius:5px;font-size:13px;text-align:center;max-width:100%;word-break:break-word;white-space:normal}uni-toast .uni-mask{pointer-events:auto}.uni-toast{position:fixed;z-index:999;width:8em;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(17,17,17,.7);text-align:center;border-radius:5px;color:#fff}.uni-toast *{box-sizing:border-box}.uni-toast__icon{margin:20px 0 0;width:38px!important;height:38px!important;vertical-align:baseline!important}.uni-icon_toast{margin:15px 0 0}.uni-icon_toast.uni-icon-success-no-circle:before{color:#fff;font-size:55px}.uni-icon_toast.uni-loading{margin:20px 0 0;width:38px;height:38px;vertical-align:baseline}.uni-toast__content{margin:0 0 15px}*{margin:0;-webkit-tap-highlight-color:transparent}html,body{-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%;height:100%}body{overflow-x:hidden;font-size:16px}uni-app,uni-page,uni-page-wrapper,uni-page-body{display:block;box-sizing:border-box;width:100%}uni-page-wrapper{position:relative}#app,uni-app,uni-page,uni-page-wrapper{height:100%}.uni-mask{position:fixed;z-index:999;top:0;right:0;left:0;bottom:0;background:rgba(0,0,0,.5)}.uni-fade-enter-active,.uni-fade-leave-active{transition-duration:.25s;transition-property:opacity;transition-timing-function:ease}.uni-fade-enter-from,.uni-fade-leave-active{opacity:0}.uni-loading,uni-button[loading]:before{background-color:transparent;background-image:url(data:image/svg+xml;base64,\ PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgxMDB2MTAwSDB6Ii8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTlFOUU5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTMwKSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iIzk4OTY5NyIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgzMCAxMDUuOTggNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjOUI5OTlBIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDYwIDc1Ljk4IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0EzQTFBMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA2NSA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNBQkE5QUEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDU4LjY2IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0IyQjJCMiIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgxNTAgNTQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjQkFCOEI5IiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKDE4MCA1MCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDMkMwQzEiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTE1MCA0NS45OCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNDQkNCQ0IiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTEyMCA0MS4zNCA2NSkiLz48cmVjdCB3aWR0aD0iNyIgaGVpZ2h0PSIyMCIgeD0iNDYuNSIgeT0iNDAiIGZpbGw9IiNEMkQyRDIiIHJ4PSI1IiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1IDY1KSIvPjxyZWN0IHdpZHRoPSI3IiBoZWlnaHQ9IjIwIiB4PSI0Ni41IiB5PSI0MCIgZmlsbD0iI0RBREFEQSIgcng9IjUiIHJ5PSI1IiB0cmFuc2Zvcm09InJvdGF0ZSgtNjAgMjQuMDIgNjUpIi8+PHJlY3Qgd2lkdGg9IjciIGhlaWdodD0iMjAiIHg9IjQ2LjUiIHk9IjQwIiBmaWxsPSIjRTJFMkUyIiByeD0iNSIgcnk9IjUiIHRyYW5zZm9ybT0icm90YXRlKC0zMCAtNS45OCA2NSkiLz48L3N2Zz4=);background-repeat:no-repeat}.uni-loading{width:20px;height:20px;display:inline-block;vertical-align:middle;animation:uni-loading 1s steps(12,end) infinite;background-size:100%}@keyframes uni-loading{0%{transform:rotate3d(0,0,1,0)}to{transform:rotate3d(0,0,1,360deg)}}html{--primary-color: #007aff;--UI-BG: #fff;--UI-BG-1: #f7f7f7;--UI-BG-2: #fff;--UI-BG-3: #f7f7f7;--UI-BG-4: #4c4c4c;--UI-BG-5: #fff;--UI-FG: #000;--UI-FG-0: rgba(0, 0, 0, .9);--UI-FG-HALF: rgba(0, 0, 0, .9);--UI-FG-1: rgba(0, 0, 0, .5);--UI-FG-2: rgba(0, 0, 0, .3);--UI-FG-3: rgba(0, 0, 0, .1)}uni-page[data-type] uni-page-body{background-color:transparent}body:after{position:fixed;content:"";left:-1000px;top:-1000px;animation:shadow-preload .1s;animation-delay:3s}@keyframes shadow-preload{0%{background-image:url(https://cdn.dcloud.net.cn/img/shadow-grey.png)}to{background-image:url(https://cdn.dcloud.net.cn/img/shadow-grey.png)}}.uni-async-error{position:absolute;left:0;right:0;top:0;bottom:0;color:#999;padding:100px 10px;text-align:center}.uni-async-loading{box-sizing:border-box;width:100%;padding:50px;text-align:center}.uni-async-loading .uni-loading{width:30px;height:30px}uni-view{display:block}uni-view[hidden]{display:none}uni-image{width:320px;height:240px;display:inline-block;overflow:hidden;position:relative}uni-image[hidden]{display:none}uni-image>div{width:100%;height:100%;background-repeat:no-repeat}uni-image>img{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:block;position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}uni-image>.uni-image-will-change{will-change:transform}@keyframes once-show{0%{top:0}}uni-resize-sensor,uni-resize-sensor>div{position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden}uni-resize-sensor{display:block;z-index:-1;visibility:hidden;animation:once-show 1ms}uni-resize-sensor>div>div{position:absolute;left:0;top:0}uni-resize-sensor>div:first-child>div{width:100000px;height:100000px}uni-resize-sensor>div:last-child>div{width:200%;height:200%}@font-face{font-family:wd-icons;src:url(https://at.alicdn.com/t/c/font_4245058_s5cpwl25n7o.woff2?t=1696817709651) format("woff2"),url(https://at.alicdn.com/t/c/font_4245058_s5cpwl25n7o.woff?t=1696817709651) format("woff"),url(https://at.alicdn.com/t/c/font_4245058_s5cpwl25n7o.ttf?t=1696817709651) format("truetype");font-weight:400;font-style:normal}.wd-icon[data-v-bef80b7c]{display:inline-block;font-family:wd-icons!important;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.wd-icon[data-v-bef80b7c]:before{display:inline-block}.wd-icon--image[data-v-bef80b7c]{width:1em;height:1em}.wd-icon__image[data-v-bef80b7c]{width:100%;height:100%}.wd-icon-usergroup-clear[data-v-bef80b7c]:before{content:""}.wd-icon-user-circle[data-v-bef80b7c]:before{content:""}.wd-icon-user-talk[data-v-bef80b7c]:before{content:""}.wd-icon-user-clear[data-v-bef80b7c]:before{content:""}.wd-icon-user[data-v-bef80b7c]:before{content:""}.wd-icon-usergroup-add[data-v-bef80b7c]:before{content:""}.wd-icon-usergroup[data-v-bef80b7c]:before{content:""}.wd-icon-user-add[data-v-bef80b7c]:before{content:""}.wd-icon-user-avatar[data-v-bef80b7c]:before{content:""}.wd-icon-pointing-hand[data-v-bef80b7c]:before{content:""}.wd-icon-cursor[data-v-bef80b7c]:before{content:""}.wd-icon-fullsreen[data-v-bef80b7c]:before{content:""}.wd-icon-cloud-download[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-down-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-edit[data-v-bef80b7c]:before{content:""}.wd-icon-fullscreen-exit[data-v-bef80b7c]:before{content:""}.wd-icon-circle1[data-v-bef80b7c]:before{content:""}.wd-icon-close-normal[data-v-bef80b7c]:before{content:""}.wd-icon-browse[data-v-bef80b7c]:before{content:""}.wd-icon-browse-off[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-up-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-add-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-add1[data-v-bef80b7c]:before{content:""}.wd-icon-add-circle1[data-v-bef80b7c]:before{content:""}.wd-icon-download1[data-v-bef80b7c]:before{content:""}.wd-icon-link[data-v-bef80b7c]:before{content:""}.wd-icon-edit-1[data-v-bef80b7c]:before{content:""}.wd-icon-jump[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-down-circle[data-v-bef80b7c]:before{content:""}.wd-icon-delete1[data-v-bef80b7c]:before{content:""}.wd-icon-filter-clear[data-v-bef80b7c]:before{content:""}.wd-icon-check-rectangle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-minus-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-play[data-v-bef80b7c]:before{content:""}.wd-icon-pause-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-filter1[data-v-bef80b7c]:before{content:""}.wd-icon-move[data-v-bef80b7c]:before{content:""}.wd-icon-login[data-v-bef80b7c]:before{content:""}.wd-icon-minus-circle[data-v-bef80b7c]:before{content:""}.wd-icon-close-circle[data-v-bef80b7c]:before{content:""}.wd-icon-logout[data-v-bef80b7c]:before{content:""}.wd-icon-search1[data-v-bef80b7c]:before{content:""}.wd-icon-pause-circle[data-v-bef80b7c]:before{content:""}.wd-icon-play-circle[data-v-bef80b7c]:before{content:""}.wd-icon-more1[data-v-bef80b7c]:before{content:""}.wd-icon-minus-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-stop[data-v-bef80b7c]:before{content:""}.wd-icon-scan1[data-v-bef80b7c]:before{content:""}.wd-icon-close-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-rollback[data-v-bef80b7c]:before{content:""}.wd-icon-a-order-adjustmentcolumn[data-v-bef80b7c]:before{content:""}.wd-icon-pause[data-v-bef80b7c]:before{content:""}.wd-icon-ellipsis[data-v-bef80b7c]:before{content:""}.wd-icon-cloud-upload[data-v-bef80b7c]:before{content:""}.wd-icon-stop-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-clear[data-v-bef80b7c]:before{content:""}.wd-icon-remove[data-v-bef80b7c]:before{content:""}.wd-icon-zoom-out[data-v-bef80b7c]:before{content:""}.wd-icon-thumb-down[data-v-bef80b7c]:before{content:""}.wd-icon-setting1[data-v-bef80b7c]:before{content:""}.wd-icon-save[data-v-bef80b7c]:before{content:""}.wd-icon-unfold-more[data-v-bef80b7c]:before{content:""}.wd-icon-zoom-in[data-v-bef80b7c]:before{content:""}.wd-icon-thumb-up[data-v-bef80b7c]:before{content:""}.wd-icon-unfold-less[data-v-bef80b7c]:before{content:""}.wd-icon-play-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-poweroff[data-v-bef80b7c]:before{content:""}.wd-icon-share[data-v-bef80b7c]:before{content:""}.wd-icon-refresh1[data-v-bef80b7c]:before{content:""}.wd-icon-link-unlink[data-v-bef80b7c]:before{content:""}.wd-icon-upload[data-v-bef80b7c]:before{content:""}.wd-icon-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-stop-circle[data-v-bef80b7c]:before{content:""}.wd-icon-backtop-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-caret-down[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-left1[data-v-bef80b7c]:before{content:""}.wd-icon-help-circle[data-v-bef80b7c]:before{content:""}.wd-icon-help-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-time-filled[data-v-bef80b7c]:before{content:""}.wd-icon-close-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-info-circle[data-v-bef80b7c]:before{content:""}.wd-icon-info-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-check1[data-v-bef80b7c]:before{content:""}.wd-icon-help[data-v-bef80b7c]:before{content:""}.wd-icon-error[data-v-bef80b7c]:before{content:""}.wd-icon-check-circle[data-v-bef80b7c]:before{content:""}.wd-icon-error-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-error-circle[data-v-bef80b7c]:before{content:""}.wd-icon-check-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-check-circle-filled[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-up[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-up-circle[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-right[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-down-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-caret-up-small[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-right-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-caret-right-small[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-right1[data-v-bef80b7c]:before{content:""}.wd-icon-backtop[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-up1[data-v-bef80b7c]:before{content:""}.wd-icon-caret-up[data-v-bef80b7c]:before{content:""}.wd-icon-backward[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-down1[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-left[data-v-bef80b7c]:before{content:""}.wd-icon-caret-right[data-v-bef80b7c]:before{content:""}.wd-icon-caret-left[data-v-bef80b7c]:before{content:""}.wd-icon-page-last[data-v-bef80b7c]:before{content:""}.wd-icon-next[data-v-bef80b7c]:before{content:""}.wd-icon-swap[data-v-bef80b7c]:before{content:""}.wd-icon-round[data-v-bef80b7c]:before{content:""}.wd-icon-previous[data-v-bef80b7c]:before{content:""}.wd-icon-enter[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-down[data-v-bef80b7c]:before{content:""}.wd-icon-caret-down-small[data-v-bef80b7c]:before{content:""}.wd-icon-swap-right[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-left-circle[data-v-bef80b7c]:before{content:""}.wd-icon-caret-left-small[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-right-circle[data-v-bef80b7c]:before{content:""}.wd-icon-a-chevron-leftdouble[data-v-bef80b7c]:before{content:""}.wd-icon-chevron-left-rectangle[data-v-bef80b7c]:before{content:""}.wd-icon-a-chevron-rightdouble[data-v-bef80b7c]:before{content:""}.wd-icon-page-first[data-v-bef80b7c]:before{content:""}.wd-icon-forward[data-v-bef80b7c]:before{content:""}.wd-icon-view-column[data-v-bef80b7c]:before{content:""}.wd-icon-view-module[data-v-bef80b7c]:before{content:""}.wd-icon-format-vertical-align-right[data-v-bef80b7c]:before{content:""}.wd-icon-view-list[data-v-bef80b7c]:before{content:""}.wd-icon-order-descending[data-v-bef80b7c]:before{content:""}.wd-icon-format-horizontal-align-bottom[data-v-bef80b7c]:before{content:""}.wd-icon-queue[data-v-bef80b7c]:before{content:""}.wd-icon-menu-fold[data-v-bef80b7c]:before{content:""}.wd-icon-menu-unfold[data-v-bef80b7c]:before{content:""}.wd-icon-format-horizontal-align-top[data-v-bef80b7c]:before{content:""}.wd-icon-a-rootlist[data-v-bef80b7c]:before{content:""}.wd-icon-order-ascending[data-v-bef80b7c]:before{content:""}.wd-icon-format-vertical-align-left[data-v-bef80b7c]:before{content:""}.wd-icon-format-horizontal-align-center[data-v-bef80b7c]:before{content:""}.wd-icon-format-vertical-align-center[data-v-bef80b7c]:before{content:""}.wd-icon-swap-left[data-v-bef80b7c]:before{content:""}.wd-icon-flag[data-v-bef80b7c]:before{content:""}.wd-icon-code[data-v-bef80b7c]:before{content:""}.wd-icon-cart[data-v-bef80b7c]:before{content:""}.wd-icon-attach[data-v-bef80b7c]:before{content:""}.wd-icon-chart[data-v-bef80b7c]:before{content:""}.wd-icon-creditcard[data-v-bef80b7c]:before{content:""}.wd-icon-calendar[data-v-bef80b7c]:before{content:""}.wd-icon-app[data-v-bef80b7c]:before{content:""}.wd-icon-books[data-v-bef80b7c]:before{content:""}.wd-icon-barcode[data-v-bef80b7c]:before{content:""}.wd-icon-chart-pie[data-v-bef80b7c]:before{content:""}.wd-icon-chart-bar[data-v-bef80b7c]:before{content:""}.wd-icon-chart-bubble[data-v-bef80b7c]:before{content:""}.wd-icon-bulletpoint[data-v-bef80b7c]:before{content:""}.wd-icon-bianjiliebiao[data-v-bef80b7c]:before{content:""}.wd-icon-image[data-v-bef80b7c]:before{content:""}.wd-icon-laptop[data-v-bef80b7c]:before{content:""}.wd-icon-hourglass[data-v-bef80b7c]:before{content:""}.wd-icon-call[data-v-bef80b7c]:before{content:""}.wd-icon-mobile-vibrate[data-v-bef80b7c]:before{content:""}.wd-icon-mail[data-v-bef80b7c]:before{content:""}.wd-icon-notification-filled[data-v-bef80b7c]:before{content:""}.wd-icon-desktop[data-v-bef80b7c]:before{content:""}.wd-icon-history[data-v-bef80b7c]:before{content:""}.wd-icon-discount-filled[data-v-bef80b7c]:before{content:""}.wd-icon-dashboard[data-v-bef80b7c]:before{content:""}.wd-icon-discount[data-v-bef80b7c]:before{content:""}.wd-icon-heart-filled[data-v-bef80b7c]:before{content:""}.wd-icon-chat1[data-v-bef80b7c]:before{content:""}.wd-icon-a-controlplatform[data-v-bef80b7c]:before{content:""}.wd-icon-gift[data-v-bef80b7c]:before{content:""}.wd-icon-photo[data-v-bef80b7c]:before{content:""}.wd-icon-play-circle-stroke[data-v-bef80b7c]:before{content:""}.wd-icon-notification[data-v-bef80b7c]:before{content:""}.wd-icon-cloud[data-v-bef80b7c]:before{content:""}.wd-icon-gender-female[data-v-bef80b7c]:before{content:""}.wd-icon-fork[data-v-bef80b7c]:before{content:""}.wd-icon-layers[data-v-bef80b7c]:before{content:""}.wd-icon-lock-off[data-v-bef80b7c]:before{content:""}.wd-icon-location[data-v-bef80b7c]:before{content:""}.wd-icon-mobile[data-v-bef80b7c]:before{content:""}.wd-icon-qrcode[data-v-bef80b7c]:before{content:""}.wd-icon-home1[data-v-bef80b7c]:before{content:""}.wd-icon-time[data-v-bef80b7c]:before{content:""}.wd-icon-heart[data-v-bef80b7c]:before{content:""}.wd-icon-lock-on[data-v-bef80b7c]:before{content:""}.wd-icon-print[data-v-bef80b7c]:before{content:""}.wd-icon-slash[data-v-bef80b7c]:before{content:""}.wd-icon-usb[data-v-bef80b7c]:before{content:""}.wd-icon-tools[data-v-bef80b7c]:before{content:""}.wd-icon-wifi[data-v-bef80b7c]:before{content:""}.wd-icon-star-filled[data-v-bef80b7c]:before{content:""}.wd-icon-server[data-v-bef80b7c]:before{content:""}.wd-icon-sound[data-v-bef80b7c]:before{content:""}.wd-icon-a-precisemonitor[data-v-bef80b7c]:before{content:""}.wd-icon-service[data-v-bef80b7c]:before{content:""}.wd-icon-tips[data-v-bef80b7c]:before{content:""}.wd-icon-pin[data-v-bef80b7c]:before{content:""}.wd-icon-secured[data-v-bef80b7c]:before{content:""}.wd-icon-star[data-v-bef80b7c]:before{content:""}.wd-icon-gender-male[data-v-bef80b7c]:before{content:""}.wd-icon-shop[data-v-bef80b7c]:before{content:""}.wd-icon-money-circle[data-v-bef80b7c]:before{content:""}.wd-icon-file-word[data-v-bef80b7c]:before{content:""}.wd-icon-file-unknown[data-v-bef80b7c]:before{content:""}.wd-icon-folder-open[data-v-bef80b7c]:before{content:""}.wd-icon-file-pdf[data-v-bef80b7c]:before{content:""}.wd-icon-folder[data-v-bef80b7c]:before{content:""}.wd-icon-folder-add[data-v-bef80b7c]:before{content:""}.wd-icon-file[data-v-bef80b7c]:before{content:""}.wd-icon-file-image[data-v-bef80b7c]:before{content:""}.wd-icon-file-powerpoint[data-v-bef80b7c]:before{content:""}.wd-icon-file-add[data-v-bef80b7c]:before{content:""}.wd-icon-file-icon[data-v-bef80b7c]:before{content:""}.wd-icon-file-paste[data-v-bef80b7c]:before{content:""}.wd-icon-file-excel[data-v-bef80b7c]:before{content:""}.wd-icon-file-copy[data-v-bef80b7c]:before{content:""}.wd-icon-video1[data-v-bef80b7c]:before{content:""}.wd-icon-wallet[data-v-bef80b7c]:before{content:""}.wd-icon-ie[data-v-bef80b7c]:before{content:""}.wd-icon-logo-codepen[data-v-bef80b7c]:before{content:""}.wd-icon-github-filled[data-v-bef80b7c]:before{content:""}.wd-icon-ie-filled[data-v-bef80b7c]:before{content:""}.wd-icon-apple[data-v-bef80b7c]:before{content:""}.wd-icon-windows-filled[data-v-bef80b7c]:before{content:""}.wd-icon-internet[data-v-bef80b7c]:before{content:""}.wd-icon-github[data-v-bef80b7c]:before{content:""}.wd-icon-windows[data-v-bef80b7c]:before{content:""}.wd-icon-apple-filled[data-v-bef80b7c]:before{content:""}.wd-icon-chrome-filled[data-v-bef80b7c]:before{content:""}.wd-icon-chrome[data-v-bef80b7c]:before{content:""}.wd-icon-android[data-v-bef80b7c]:before{content:""}.wd-icon-edit-outline[data-v-bef80b7c]:before{content:""}.wd-icon-detection[data-v-bef80b7c]:before{content:""}.wd-icon-check-outline[data-v-bef80b7c]:before{content:""}.wd-icon-close[data-v-bef80b7c]:before{content:""}.wd-icon-check[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-left[data-v-bef80b7c]:before{content:""}.wd-icon-computer[data-v-bef80b7c]:before{content:""}.wd-icon-clock[data-v-bef80b7c]:before{content:""}.wd-icon-check-bold[data-v-bef80b7c]:before{content:""}.wd-icon-bags[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-down[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-right[data-v-bef80b7c]:before{content:""}.wd-icon-circle[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-thin-down[data-v-bef80b7c]:before{content:""}.wd-icon-camera[data-v-bef80b7c]:before{content:""}.wd-icon-close-bold[data-v-bef80b7c]:before{content:""}.wd-icon-add-circle[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-thin-up[data-v-bef80b7c]:before{content:""}.wd-icon-add[data-v-bef80b7c]:before{content:""}.wd-icon-keyboard-delete[data-v-bef80b7c]:before{content:""}.wd-icon-transfer[data-v-bef80b7c]:before{content:""}.wd-icon-eye-close[data-v-bef80b7c]:before{content:""}.wd-icon-delete[data-v-bef80b7c]:before{content:""}.wd-icon-download[data-v-bef80b7c]:before{content:""}.wd-icon-picture[data-v-bef80b7c]:before{content:""}.wd-icon-refresh[data-v-bef80b7c]:before{content:""}.wd-icon-read[data-v-bef80b7c]:before{content:""}.wd-icon-note[data-v-bef80b7c]:before{content:""}.wd-icon-phone[data-v-bef80b7c]:before{content:""}.wd-icon-lenovo[data-v-bef80b7c]:before{content:""}.wd-icon-home[data-v-bef80b7c]:before{content:""}.wd-icon-search[data-v-bef80b7c]:before{content:""}.wd-icon-fill-camera[data-v-bef80b7c]:before{content:""}.wd-icon-fill-arrow-down[data-v-bef80b7c]:before{content:""}.wd-icon-arrow-up[data-v-bef80b7c]:before{content:""}.wd-icon-delete-thin[data-v-bef80b7c]:before{content:""}.wd-icon-filter[data-v-bef80b7c]:before{content:""}.wd-icon-evaluation[data-v-bef80b7c]:before{content:""}.wd-icon-close-outline[data-v-bef80b7c]:before{content:""}.wd-icon-dong[data-v-bef80b7c]:before{content:""}.wd-icon-error-fill[data-v-bef80b7c]:before{content:""}.wd-icon-chat[data-v-bef80b7c]:before{content:""}.wd-icon-decrease[data-v-bef80b7c]:before{content:""}.wd-icon-copy[data-v-bef80b7c]:before{content:""}.wd-icon-setting[data-v-bef80b7c]:before{content:""}.wd-icon-subscribe[data-v-bef80b7c]:before{content:""}.wd-icon-jdm[data-v-bef80b7c]:before{content:""}.wd-icon-spool[data-v-bef80b7c]:before{content:""}.wd-icon-warning[data-v-bef80b7c]:before{content:""}.wd-icon-wifi-error[data-v-bef80b7c]:before{content:""}.wd-icon-star-on[data-v-bef80b7c]:before{content:""}.wd-icon-rotate[data-v-bef80b7c]:before{content:""}.wd-icon-translate-bold[data-v-bef80b7c]:before{content:""}.wd-icon-keyboard-collapse[data-v-bef80b7c]:before{content:""}.wd-icon-keywords[data-v-bef80b7c]:before{content:""}.wd-icon-scan[data-v-bef80b7c]:before{content:""}.wd-icon-view[data-v-bef80b7c]:before{content:""}.wd-icon-phone-compute[data-v-bef80b7c]:before{content:""}.wd-icon-video[data-v-bef80b7c]:before{content:""}.wd-icon-thin-arrow-left[data-v-bef80b7c]:before{content:""}.wd-icon-goods[data-v-bef80b7c]:before{content:""}.wd-icon-list[data-v-bef80b7c]:before{content:""}.wd-icon-warn-bold[data-v-bef80b7c]:before{content:""}.wd-icon-more[data-v-bef80b7c]:before{content:""}.wd-loading[data-v-4224d8d3]{font-size:0;line-height:0;vertical-align:middle;display:inline-block;width:var(--wot-loading-size, 32px);height:var(--wot-loading-size, 32px)}.wd-loading__body[data-v-4224d8d3]{width:100%;height:100%;animation:wd-rotate-4224d8d3 .8s linear infinite;animation-duration:2s}.wd-loading__svg[data-v-4224d8d3]{width:100%;height:100%;background-size:cover;background-repeat:no-repeat}@keyframes wd-rotate-4224d8d3{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.wd-transition[data-v-60fd6c07]{transition-timing-function:ease}.wd-fade-enter[data-v-60fd6c07],.wd-fade-leave-to[data-v-60fd6c07]{opacity:0}.wd-fade-enter-active[data-v-60fd6c07],.wd-fade-leave-active[data-v-60fd6c07]{transition-property:opacity}.wd-fade-up-enter[data-v-60fd6c07],.wd-fade-up-leave-to[data-v-60fd6c07]{transform:translate3d(0,100%,0);opacity:0}.wd-fade-down-enter[data-v-60fd6c07],.wd-fade-down-leave-to[data-v-60fd6c07]{transform:translate3d(0,-100%,0);opacity:0}.wd-fade-left-enter[data-v-60fd6c07],.wd-fade-left-leave-to[data-v-60fd6c07]{transform:translate3d(-100%,0,0);opacity:0}.wd-fade-right-enter[data-v-60fd6c07],.wd-fade-right-leave-to[data-v-60fd6c07]{transform:translate3d(100%,0,0);opacity:0}.wd-slide-up-enter[data-v-60fd6c07],.wd-slide-up-leave-to[data-v-60fd6c07]{transform:translate3d(0,100%,0)}.wd-slide-down-enter[data-v-60fd6c07],.wd-slide-down-leave-to[data-v-60fd6c07]{transform:translate3d(0,-100%,0)}.wd-slide-left-enter[data-v-60fd6c07],.wd-slide-left-leave-to[data-v-60fd6c07]{transform:translate3d(-100%,0,0)}.wd-slide-right-enter[data-v-60fd6c07],.wd-slide-right-leave-to[data-v-60fd6c07]{transform:translate3d(100%,0,0)}.wd-zoom-in-enter[data-v-60fd6c07],.wd-zoom-in-leave-to[data-v-60fd6c07]{opacity:0;transform:scale(.8)}.wd-zoom-out-enter[data-v-60fd6c07],.wd-zoom-out-leave-to[data-v-60fd6c07]{transform:scale(1.2);opacity:0}.wd-zoom-in-enter-active[data-v-60fd6c07],.wd-zoom-in-leave-active[data-v-60fd6c07],.wd-zoom-out-enter-active[data-v-60fd6c07],.wd-zoom-out-leave-active[data-v-60fd6c07],.wd-fade-up-enter-active[data-v-60fd6c07],.wd-fade-up-leave-active[data-v-60fd6c07],.wd-fade-down-enter-active[data-v-60fd6c07],.wd-fade-down-leave-active[data-v-60fd6c07],.wd-fade-left-enter-active[data-v-60fd6c07],.wd-fade-left-leave-active[data-v-60fd6c07],.wd-fade-right-enter-active[data-v-60fd6c07],.wd-fade-right-leave-active[data-v-60fd6c07]{transition-property:opacity,transform}.wd-slide-up-enter-active[data-v-60fd6c07],.wd-slide-up-leave-active[data-v-60fd6c07],.wd-slide-down-enter-active[data-v-60fd6c07],.wd-slide-down-leave-active[data-v-60fd6c07],.wd-slide-left-enter-active[data-v-60fd6c07],.wd-slide-left-leave-active[data-v-60fd6c07],.wd-slide-right-enter-active[data-v-60fd6c07],.wd-slide-right-leave-active[data-v-60fd6c07]{transition-property:transform}.wot-theme-dark .wd-overlay[data-v-43633df7]{background:var(--wot-overlay-bg-dark, rgba(0, 0, 0, .75))}.wd-overlay[data-v-43633df7]{position:fixed;left:0;top:0;right:0;bottom:0;background:var(--wot-overlay-bg, rgba(0, 0, 0, .65))}.wd-toast[data-v-d24ac773]{display:inline-block;max-width:var(--wot-toast-max-width, 300px);padding:var(--wot-toast-padding, 16px 24px);background-color:var(--wot-toast-bg, var(--wot-overlay-bg, rgba(0, 0, 0, .65)));border-radius:var(--wot-toast-radius, 8px);color:var(--wot-toast-color, var(--wot-color-white, rgb(255, 255, 255)));transition:all .2s;font-size:var(--wot-toast-fs, var(--wot-fs-content, 14px));box-sizing:border-box;box-shadow:var(--wot-toast-box-shadow, 0px 6px 16px 0px rgba(0, 0, 0, .08))}.wd-toast.is-vertical[data-v-d24ac773]{flex-direction:column}.wd-toast__msg[data-v-d24ac773]{font-size:var(--wot-toast-fs, var(--wot-fs-content, 14px));word-break:break-all;line-height:var(--wot-toast-line-height, 20px);text-align:left;font-family:San Francisco,Rotobo,arial,PingFang SC,Noto SansCJK,Microsoft Yahei,sans-serif}[data-v-d24ac773] .wd-toast__icon{display:inline-block;margin-right:var(--wot-toast-icon-margin-right, 12px);font-size:var(--wot-toast-icon-size, 32px)}[data-v-d24ac773] .wd-toast__icon.is-vertical{margin-right:0;margin-bottom:var(--wot-toast-icon-margin-bottom, 12px)}.wd-toast__iconWrap[data-v-d24ac773]{font-size:0;line-height:0;vertical-align:middle}.wd-toast__iconBox[data-v-d24ac773]{display:block;width:100%;height:100%}.wd-toast__iconSvg[data-v-d24ac773]{width:var(--wot-toast-icon-size, 32px);height:var(--wot-toast-icon-size, 32px);background-size:cover;background-repeat:no-repeat}.wd-toast__loading[data-v-d24ac773]{margin-bottom:var(--wot-toast-loading-margin-bottom, 16px);display:inline-block}.wd-toast--top[data-v-d24ac773]{transform:translate3d(0,-40vh,0)}.wd-toast--middle-top[data-v-d24ac773]{transform:translate3d(0,-18.8vh,0)}.wd-toast--bottom[data-v-d24ac773]{transform:translate3d(0,40vh,0)}.wd-toast--with-icon[data-v-d24ac773]{min-width:var(--wot-toast-with-icon-min-width, 150px);display:inline-flex;align-items:center}.wd-toast--loading[data-v-d24ac773]{min-width:auto;padding:var(--wot-toast-loading-padding, 10px)}.wot-theme-dark .wd-popup-wrapper[data-v-950f6ca5] .wd-popup{background:var(--wot-dark-background2, #1b1b1b)}.wot-theme-dark .wd-popup-wrapper[data-v-950f6ca5] .wd-popup__close{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-popup-wrapper[data-v-950f6ca5] .wd-popup{position:fixed;max-height:100%;overflow-y:auto;background:#fff}[data-v-950f6ca5] .wd-popup__close{position:absolute;top:10px;right:10px;color:var(--wot-popup-close-color, #666);font-size:var(--wot-popup-close-size, 24px);transform:rotate(-45deg)}[data-v-950f6ca5] .wd-popup--center{left:50%;top:50%;transform:translate3d(-50%,-50%,0);transform-origin:0% 0%}[data-v-950f6ca5] .wd-popup--center.wd-zoom-in-enter,[data-v-950f6ca5] .wd-popup--center.wd-zoom-in-leave-to{transform:scale(.8) translate3d(-50%,-50%,0)!important}[data-v-950f6ca5] .wd-popup--center.is-deep.wd-zoom-in-enter,[data-v-950f6ca5] .wd-popup--center.is-deep.wd-zoom-in-leave-to{transform:scale(.1) translate3d(-50%,-50%,0)!important}[data-v-950f6ca5] .wd-popup--left{top:0;bottom:0;left:0}[data-v-950f6ca5] .wd-popup--right{top:0;right:0;bottom:0}[data-v-950f6ca5] .wd-popup--top{top:0;left:0;right:0}[data-v-950f6ca5] .wd-popup--bottom{right:0;bottom:0;left:0}uni-button{position:relative;display:block;margin-left:auto;margin-right:auto;padding-left:14px;padding-right:14px;box-sizing:border-box;font-size:18px;text-align:center;text-decoration:none;line-height:2.55555556;border-radius:5px;-webkit-tap-highlight-color:transparent;overflow:hidden;color:#000;background-color:#f8f8f8;cursor:pointer}uni-button[hidden]{display:none!important}uni-button:after{content:" ";width:200%;height:200%;position:absolute;top:0;left:0;border:1px solid rgba(0,0,0,.2);transform:scale(.5);transform-origin:0 0;box-sizing:border-box;border-radius:10px}uni-button[native]{padding-left:0;padding-right:0}uni-button[native] .uni-button-cover-view-wrapper{border:inherit;border-color:inherit;border-radius:inherit;background-color:inherit}uni-button[native] .uni-button-cover-view-inner{padding-left:14px;padding-right:14px}uni-button uni-cover-view{line-height:inherit;white-space:inherit}uni-button[type=default]{color:#000;background-color:#f8f8f8}uni-button[type=primary]{color:#fff;background-color:#007aff}uni-button[type=warn]{color:#fff;background-color:#e64340}uni-button[disabled]{color:rgba(255,255,255,.6);cursor:not-allowed}uni-button[disabled][type=default],uni-button[disabled]:not([type]){color:rgba(0,0,0,.3);background-color:#f7f7f7}uni-button[disabled][type=primary]{background-color:rgba(0,122,255,.6)}uni-button[disabled][type=warn]{background-color:#ec8b89}uni-button[type=primary][plain]{color:#007aff;border:1px solid #007aff;background-color:transparent}uni-button[type=primary][plain][disabled]{color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}uni-button[type=primary][plain]:after{border-width:0}uni-button[type=default][plain]{color:#353535;border:1px solid #353535;background-color:transparent}uni-button[type=default][plain][disabled]{color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}uni-button[type=default][plain]:after{border-width:0}uni-button[plain]{color:#353535;border:1px solid #353535;background-color:transparent}uni-button[plain][disabled]{color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}uni-button[plain]:after{border-width:0}uni-button[plain][native] .uni-button-cover-view-inner{padding:0}uni-button[type=warn][plain]{color:#e64340;border:1px solid #e64340;background-color:transparent}uni-button[type=warn][plain][disabled]{color:rgba(0,0,0,.2);border-color:rgba(0,0,0,.2)}uni-button[type=warn][plain]:after{border-width:0}uni-button[size=mini]{display:inline-block;line-height:2.3;font-size:13px;padding:0 1.34em}uni-button[size=mini][native]{padding:0}uni-button[size=mini][native] .uni-button-cover-view-inner{padding:0 1.34em}uni-button[loading]:not([disabled]){cursor:progress}uni-button[loading]:before{content:" ";display:inline-block;width:18px;height:18px;vertical-align:middle;animation:uni-loading 1s steps(12,end) infinite;background-size:100%}uni-button[loading][type=primary]{color:rgba(255,255,255,.6);background-color:#0062cc}uni-button[loading][type=primary][plain]{color:#007aff;background-color:transparent}uni-button[loading][type=default]{color:rgba(0,0,0,.6);background-color:#dedede}uni-button[loading][type=default][plain]{color:#353535;background-color:transparent}uni-button[loading][type=warn]{color:rgba(255,255,255,.6);background-color:#ce3c39}uni-button[loading][type=warn][plain]{color:#e64340;background-color:transparent}uni-button[loading][native]:before{content:none}.button-hover{color:rgba(0,0,0,.6);background-color:#dedede}.button-hover[plain]{color:rgba(53,53,53,.6);border-color:rgba(53,53,53,.6);background-color:transparent}.button-hover[type=primary]{color:rgba(255,255,255,.6);background-color:#0062cc}.button-hover[type=primary][plain]{color:rgba(0,122,255,.6);border-color:rgba(0,122,255,.6);background-color:transparent}.button-hover[type=default]{color:rgba(0,0,0,.6);background-color:#dedede}.button-hover[type=default][plain]{color:rgba(53,53,53,.6);border-color:rgba(53,53,53,.6);background-color:transparent}.button-hover[type=warn]{color:rgba(255,255,255,.6);background-color:#ce3c39}.button-hover[type=warn][plain]{color:rgba(230,67,64,.6);border-color:rgba(230,67,64,.6);background-color:transparent}.wot-theme-dark .wd-button.is-info[data-v-7f9ef195]{background:var(--wot-dark-background4, #323233);color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-button.is-plain[data-v-7f9ef195]{background:transparent}.wot-theme-dark .wd-button.is-plain.is-info[data-v-7f9ef195]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-button.is-plain.is-info[data-v-7f9ef195]:after{border-color:var(--wot-dark-background5, #646566)}.wot-theme-dark .wd-button.is-text.is-disabled[data-v-7f9ef195]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959));background:transparent}.wot-theme-dark .wd-button.is-icon[data-v-7f9ef195]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-button.is-icon.is-disabled[data-v-7f9ef195]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959));background:transparent}.wd-button[data-v-7f9ef195]{margin-left:initial;margin-right:initial;position:relative;display:inline-block;-webkit-appearance:none;outline:none;background:transparent;box-sizing:border-box;border:none;border-radius:0;color:var(--wot-button-normal-color, var(--wot-color-title, var(--wot-color-black, rgb(0, 0, 0))));transition:opacity .2s;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-weight:400}.wd-button[data-v-7f9ef195]:before{position:absolute;top:50%;left:50%;width:100%;height:100%;background:var(--wot-color-black, rgb(0, 0, 0));border:inherit;border-color:var(--wot-color-black, rgb(0, 0, 0));border-radius:inherit;transform:translate(-50%,-50%);opacity:0;content:" "}.wd-button[data-v-7f9ef195]:after{border:none;border-radius:0}.wd-button__content[data-v-7f9ef195]{display:flex;justify-content:center;align-items:center;height:100%}.wd-button--active[data-v-7f9ef195]:active:before{opacity:.15}.wd-button.is-disabled[data-v-7f9ef195]{opacity:var(--wot-button-disabled-opacity, .6)}.wd-button__loading[data-v-7f9ef195]{margin-right:5px;animation:wd-rotate-7f9ef195 .8s linear infinite;animation-duration:2s}.wd-button__loading-svg[data-v-7f9ef195]{width:100%;height:100%;background-size:cover;background-repeat:no-repeat}.wd-button.is-primary[data-v-7f9ef195]{background:var(--wot-button-primary-bg-color, var(--wot-color-theme, #4d80f0));color:var(--wot-button-primary-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-button.is-success[data-v-7f9ef195]{background:var(--wot-button-success-bg-color, var(--wot-color-success, #34d19d));color:var(--wot-button-success-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-button.is-info[data-v-7f9ef195]{background:var(--wot-button-info-bg-color, #f0f0f0);color:var(--wot-button-info-color, var(--wot-color-title, var(--wot-color-black, rgb(0, 0, 0))))}.wd-button.is-warning[data-v-7f9ef195]{background:var(--wot-button-warning-bg-color, var(--wot-color-warning, #f0883a));color:var(--wot-button-warning-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-button.is-error[data-v-7f9ef195]{background:var(--wot-button-error-bg-color, var(--wot-color-danger, #fa4350));color:var(--wot-button-error-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-button.is-small[data-v-7f9ef195]{height:var(--wot-button-small-height, 28px);padding:var(--wot-button-small-padding, 0 12px);border-radius:var(--wot-button-small-radius, 2px);font-size:var(--wot-button-small-fs, var(--wot-fs-secondary, 12px));font-weight:400}.wd-button.is-small .wd-button__loading[data-v-7f9ef195]{width:var(--wot-button-small-loading, 14px);height:var(--wot-button-small-loading, 14px)}.wd-button.is-medium[data-v-7f9ef195]{height:var(--wot-button-medium-height, 36px);padding:var(--wot-button-medium-padding, 0 16px);border-radius:var(--wot-button-medium-radius, 4px);font-size:var(--wot-button-medium-fs, var(--wot-fs-content, 14px));min-width:120px}.wd-button.is-medium.is-round.is-icon[data-v-7f9ef195]{min-width:0;border-radius:50%}.wd-button.is-medium.is-round.is-text[data-v-7f9ef195]{border-radius:0;min-width:0}.wd-button.is-medium .wd-button__loading[data-v-7f9ef195]{width:var(--wot-button-medium-loading, 18px);height:var(--wot-button-medium-loading, 18px)}.wd-button.is-large[data-v-7f9ef195]{height:var(--wot-button-large-height, 44px);padding:var(--wot-button-large-padding, 0 36px);border-radius:var(--wot-button-large-radius, 8px);font-size:var(--wot-button-large-fs, var(--wot-fs-title, 16px))}.wd-button.is-large[data-v-7f9ef195]:after{border-radius:var(--wot-button-large-radius, 8px)}.wd-button.is-large .wd-button__loading[data-v-7f9ef195]{width:var(--wot-button-large-loading, 24px);height:var(--wot-button-large-loading, 24px)}.wd-button.is-round[data-v-7f9ef195]{border-radius:999px}.wd-button.is-text[data-v-7f9ef195]{color:var(--wot-button-primary-bg-color, var(--wot-color-theme, #4d80f0));min-width:0;padding:4px 0}.wd-button.is-text[data-v-7f9ef195]:after{display:none}.wd-button.is-text.wd-button--active[data-v-7f9ef195]{opacity:var(--wot-button-text-hover-opacity, .7)}.wd-button.is-text.wd-button--active[data-v-7f9ef195]:active:before{display:none}.wd-button.is-text.is-disabled[data-v-7f9ef195]{color:var(--wot-button-normal-disabled-color, rgba(0, 0, 0, .25));background:transparent}.wd-button.is-plain[data-v-7f9ef195]{background:var(--wot-button-plain-bg-color, var(--wot-color-white, rgb(255, 255, 255)));border:1px solid currentColor}.wd-button.is-plain.is-primary[data-v-7f9ef195]{color:var(--wot-button-primary-bg-color, var(--wot-color-theme, #4d80f0))}.wd-button.is-plain.is-success[data-v-7f9ef195]{color:var(--wot-button-success-bg-color, var(--wot-color-success, #34d19d))}.wd-button.is-plain.is-info[data-v-7f9ef195]{color:var(--wot-button-info-plain-normal-color, rgba(0, 0, 0, .85));border-color:var(--wot-button-info-plain-border-color, rgba(0, 0, 0, .45))}.wd-button.is-plain.is-warning[data-v-7f9ef195]{color:var(--wot-button-warning-bg-color, var(--wot-color-warning, #f0883a))}.wd-button.is-plain.is-error[data-v-7f9ef195]{color:var(--wot-button-error-bg-color, var(--wot-color-danger, #fa4350))}.wd-button.is-hairline[data-v-7f9ef195]{border-width:0}.wd-button.is-hairline.is-plain[data-v-7f9ef195]{position:relative}.wd-button.is-hairline.is-plain[data-v-7f9ef195]:after{position:absolute;display:block;content:" ";pointer-events:none;width:200%;height:200%;left:0;top:0;border:1px solid var(--wot-color-border-light, #e8e8e8);transform:scale(.5);box-sizing:border-box;transform-origin:left top}.wd-button.is-hairline.is-plain[data-v-7f9ef195]:before{border-radius:inherit}.wd-button.is-hairline.is-plain[data-v-7f9ef195]:after{border-color:inherit}.wd-button.is-hairline.is-plain.is-round[data-v-7f9ef195]:after{border-radius:inherit!important}.wd-button.is-hairline.is-plain.is-large[data-v-7f9ef195]:after{border-radius:calc(2 * var(--wot-button-large-radius, 8px))}.wd-button.is-hairline.is-plain.is-medium[data-v-7f9ef195]:after{border-radius:calc(2 * var(--wot-button-medium-radius, 4px))}.wd-button.is-hairline.is-plain.is-small[data-v-7f9ef195]:after{border-radius:calc(2 * var(--wot-button-small-radius, 2px))}.wd-button.is-block[data-v-7f9ef195]{display:block}.wd-button.is-icon[data-v-7f9ef195]{width:var(--wot-button-icon-size, 40px);height:var(--wot-button-icon-size, 40px);padding:0;border-radius:50%;color:var(--wot-button-icon-color, rgba(0, 0, 0, .65))}.wd-button.is-icon[data-v-7f9ef195]:after{display:none}.wd-button.is-icon[data-v-7f9ef195] .wd-button__icon{margin-right:0}.wd-button.is-icon.is-disabled[data-v-7f9ef195]{color:var(--wot-button-icon-disabled-color, var(--wot-color-icon-disabled, #a7a7a7));background:transparent}[data-v-7f9ef195] .wd-button__icon{display:block;margin-right:6px;font-size:var(--wot-button-icon-fs, 18px);vertical-align:middle}.wd-button__text[data-v-7f9ef195]{-webkit-user-select:none;-moz-user-select:none;user-select:none;white-space:nowrap}@keyframes wd-rotate-7f9ef195{0%{transform:rotate(0)}to{transform:rotate(360deg)}}uni-text[selectable]{cursor:auto;-webkit-user-select:text;-moz-user-select:text;user-select:text}uni-text{white-space:pre-line}uni-input{display:block;font-size:16px;line-height:1.4em;height:1.4em;min-height:1.4em;overflow:hidden}uni-input[hidden]{display:none}.uni-input-wrapper,.uni-input-placeholder,.uni-input-form,.uni-input-input{outline:none;border:none;padding:0;margin:0;text-decoration:inherit}.uni-input-wrapper,.uni-input-form{display:flex;position:relative;width:100%;height:100%;flex-direction:column;justify-content:center}.uni-input-placeholder,.uni-input-input{width:100%}.uni-input-placeholder{position:absolute;top:auto!important;left:0;color:gray;overflow:hidden;text-overflow:clip;white-space:pre;word-break:keep-all;pointer-events:none;line-height:inherit}.uni-input-input{position:relative;display:block;height:100%;background:none;color:inherit;opacity:1;font:inherit;line-height:inherit;letter-spacing:inherit;text-align:inherit;text-indent:inherit;text-transform:inherit;text-shadow:inherit}.uni-input-input[type=search]::-webkit-search-cancel-button,.uni-input-input[type=search]::-webkit-search-decoration{display:none}.uni-input-input::-webkit-outer-spin-button,.uni-input-input::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}.uni-input-input[type=number]{-moz-appearance:textfield}.uni-input-input:disabled{-webkit-text-fill-color:currentcolor}.wot-theme-dark .wd-input[data-v-921fb1ee]{background:var(--wot-dark-background2, #1b1b1b)}.wot-theme-dark .wd-input[data-v-921fb1ee]:after{background:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}.wot-theme-dark .wd-input.is-not-empty[data-v-921fb1ee]:not(.is-disabled):after{background-color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-input__inner[data-v-921fb1ee]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-input__inner[data-v-921fb1ee]::-webkit-input-placeholder{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-input__count[data-v-921fb1ee]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8));background:transparent}.wot-theme-dark .wd-input__count-current[data-v-921fb1ee]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-input[data-v-921fb1ee] .wd-input__icon,.wot-theme-dark .wd-input[data-v-921fb1ee] .wd-input__clear{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)));background:transparent}.wot-theme-dark .wd-input.is-cell[data-v-921fb1ee]{background-color:var(--wot-dark-background2, #1b1b1b);line-height:var(--wot-cell-line-height, 24px)}.wot-theme-dark .wd-input.is-cell.is-border[data-v-921fb1ee]{position:relative}.wot-theme-dark .wd-input.is-cell.is-border[data-v-921fb1ee]:after{position:absolute;display:block;content:"";width:calc(100% - var(--wot-input-cell-padding, 10px));height:1px;left:var(--wot-input-cell-padding, 10px);top:0;transform:scaleY(.5);background:var(--wot-dark-border-color, #3a3a3c)}.wot-theme-dark .wd-input.is-disabled .wd-input__inner[data-v-921fb1ee]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959));background:transparent}.wot-theme-dark .wd-input__label[data-v-921fb1ee]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-input[data-v-921fb1ee]{position:relative;-webkit-tap-highlight-color:transparent;text-align:left;background:var(--wot-input-bg, var(--wot-color-white, rgb(255, 255, 255)))}.wd-input[data-v-921fb1ee]:after{position:absolute;content:"";bottom:0;left:0;right:0;height:1px;background:var(--wot-input-border-color, #dadada);transform:scaleY(.5);transition:background-color .2s ease-in-out}.wd-input.is-not-empty[data-v-921fb1ee]:not(.is-disabled):after{background-color:var(--wot-input-not-empty-border-color, #262626)}.wd-input__label[data-v-921fb1ee]{position:relative;display:flex;width:var(--wot-input-cell-label-width, 33%);color:var(--wot-cell-title-color, rgba(0, 0, 0, .85));margin-right:var(--wot-cell-padding, var(--wot-size-side-padding, 15px));box-sizing:border-box;font-size:var(--wot-input-fs, var(--wot-cell-title-fs, 14px));flex-shrink:0}.wd-input__label-inner[data-v-921fb1ee]{display:inline-block;font-size:var(--wot-input-fs, var(--wot-cell-title-fs, 14px));line-height:var(--wot-cell-line-height, 24px)}.wd-input__required[data-v-921fb1ee]{font-size:var(--wot-cell-required-size, 18px);color:var(--wot-cell-required-color, var(--wot-color-danger, #fa4350));margin-left:var(--wot-cell-required-margin, 4px)}.wd-input__required--left[data-v-921fb1ee]{margin-left:0;margin-right:var(--wot-cell-required-margin, 4px)}.wd-input__body[data-v-921fb1ee]{flex:1}.wd-input__value[data-v-921fb1ee]{position:relative;display:flex;flex-direction:row;align-items:center}.wd-input__prefix[data-v-921fb1ee]{margin-right:var(--wot-input-icon-margin, 8px);font-size:var(--wot-input-fs, var(--wot-cell-title-fs, 14px));line-height:initial}.wd-input__prefix[data-v-921fb1ee] .wd-input__icon,.wd-input__prefix[data-v-921fb1ee] .wd-input__clear{margin-left:0}.wd-input__suffix[data-v-921fb1ee]{flex-shrink:0;line-height:initial}.wd-input__error-message[data-v-921fb1ee]{color:var(--wot-form-item-error-message-color, var(--wot-color-danger, #fa4350));font-size:var(--wot-form-item-error-message-font-size, var(--wot-fs-secondary, 12px));line-height:var(--wot-form-item-error-message-line-height, 24px);text-align:left;vertical-align:middle}.wd-input.is-disabled .wd-input__inner[data-v-921fb1ee]{color:var(--wot-input-disabled-color, #d9d9d9);background:transparent}.wd-input.is-error .wd-input__inner[data-v-921fb1ee]{color:var(--wot-input-error-color, var(--wot-color-danger, #fa4350));background:transparent}.wd-input.is-no-border[data-v-921fb1ee]:after{display:none}.wd-input.is-no-border .wd-input__inner[data-v-921fb1ee]{height:var(--wot-input-inner-height-no-border, 24px);padding-top:0;padding-bottom:0}.wd-input.is-cell[data-v-921fb1ee]{display:flex;align-items:flex-start;padding:var(--wot-input-cell-padding, 10px) var(--wot-input-padding, var(--wot-size-side-padding, 15px));background-color:var(--wot-input-cell-bg, var(--wot-color-white, rgb(255, 255, 255)))}.wd-input.is-cell.is-error[data-v-921fb1ee]:after{background:var(--wot-input-cell-border-color, var(--wot-color-border-light, #e8e8e8))}.wd-input.is-cell[data-v-921fb1ee] .wd-input__icon,.wd-input.is-cell[data-v-921fb1ee] .wd-input__clear{display:inline-flex;align-items:center;height:var(--wot-input-cell-height, 24px);line-height:var(--wot-input-cell-height, 24px)}.wd-input.is-cell .wd-input__prefix[data-v-921fb1ee]{display:inline-block;margin-right:var(--wot-cell-icon-right, 4px)}.wd-input.is-cell .wd-input__inner[data-v-921fb1ee]{height:var(--wot-input-cell-height, 24px)}.wd-input.is-cell.wd-input[data-v-921fb1ee]:after{display:none}.wd-input.is-cell.is-center[data-v-921fb1ee]{align-items:center}.wd-input.is-cell.is-border[data-v-921fb1ee]{position:relative}.wd-input.is-cell.is-border[data-v-921fb1ee]:after{position:absolute;display:block;content:"";width:calc(100% - var(--wot-input-cell-padding, 10px));height:1px;left:var(--wot-input-cell-padding, 10px);top:0;transform:scaleY(.5);background:var(--wot-color-border-light, #e8e8e8)}.wd-input.is-large[data-v-921fb1ee]{padding:var(--wot-input-cell-padding-large, 12px)}.wd-input.is-large .wd-input__prefix[data-v-921fb1ee],.wd-input.is-large .wd-input__label-inner[data-v-921fb1ee],.wd-input.is-large .wd-input__inner[data-v-921fb1ee]{font-size:var(--wot-input-fs-large, var(--wot-cell-title-fs-large, 16px))}.wd-input.is-large .wd-input__count[data-v-921fb1ee]{font-size:var(--wot-input-count-fs-large, 14px)}.wd-input.is-large[data-v-921fb1ee] .wd-input__icon,.wd-input.is-large[data-v-921fb1ee] .wd-input__clear{font-size:var(--wot-input-icon-size-large, 18px)}.wd-input__inner[data-v-921fb1ee]{flex:1;height:var(--wot-input-inner-height, 34px);font-size:var(--wot-input-fs, var(--wot-cell-title-fs, 14px));color:var(--wot-input-color, #262626);outline:none;border:none;background:none;padding:0;box-sizing:border-box}.wd-input__inner[data-v-921fb1ee]::-webkit-input-placeholder{color:var(--wot-input-placeholder-color, #bfbfbf)}.wd-input__inner.is-align-right[data-v-921fb1ee]{text-align:right}.wd-input__readonly-mask[data-v-921fb1ee]{position:absolute;top:0;left:0;z-index:2;width:100%;height:100%}[data-v-921fb1ee] .wd-input__icon{margin-left:var(--wot-input-icon-margin, 8px);font-size:var(--wot-input-icon-size, 16px);color:var(--wot-input-icon-color, #bfbfbf);vertical-align:middle;background:var(--wot-input-bg, var(--wot-color-white, rgb(255, 255, 255)))}[data-v-921fb1ee] .wd-input__clear{margin-left:var(--wot-input-icon-margin, 8px);font-size:var(--wot-input-icon-size, 16px);color:var(--wot-input-clear-color, #585858);vertical-align:middle;background:var(--wot-input-bg, var(--wot-color-white, rgb(255, 255, 255)))}.wd-input__count[data-v-921fb1ee]{margin-left:15px;font-size:var(--wot-input-count-fs, 14px);color:var(--wot-input-count-color, #bfbfbf);vertical-align:middle;background:var(--wot-input-bg, var(--wot-color-white, rgb(255, 255, 255)))}.wd-input__count-current[data-v-921fb1ee]{color:var(--wot-input-count-current-color, #262626)}.wd-input__count-current.is-error[data-v-921fb1ee]{color:var(--wot-input-error-color, var(--wot-color-danger, #fa4350))}.wd-input .wd-input__count[data-v-921fb1ee],.wd-input .wd-input__count-current[data-v-921fb1ee]{display:inline-flex}.wot-theme-dark .wd-input__placeholder[data-v-921fb1ee]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wd-input__placeholder[data-v-921fb1ee]{color:var(--wot-input-placeholder-color, #bfbfbf)}.wd-input__placeholder.is-error[data-v-921fb1ee]{color:var(--wot-input-error-color, var(--wot-color-danger, #fa4350))}.wot-theme-dark .wd-message-box__body[data-v-6722d1fb]{background-color:var(--wot-dark-background2, #1b1b1b)}.wot-theme-dark .wd-message-box__title[data-v-6722d1fb]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-message-box__content[data-v-6722d1fb]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-message-box__content[data-v-6722d1fb]::-webkit-scrollbar-thumb{background:var(--wot-dark-border-color, #3a3a3c)}[data-v-6722d1fb] .wd-message-box,.wd-message-box[data-v-6722d1fb]{border-radius:var(--wot-message-box-radius, 16px);overflow:hidden}.wd-message-box__container[data-v-6722d1fb]{width:var(--wot-message-box-width, 300px);box-sizing:border-box}.wd-message-box__body[data-v-6722d1fb]{background-color:var(--wot-message-box-bg, var(--wot-color-white, rgb(255, 255, 255)));padding:var(--wot-message-box-padding, 25px 24px 0)}.wd-message-box__body.is-no-title[data-v-6722d1fb]{padding:25px 24px 0}.wd-message-box__title[data-v-6722d1fb]{text-align:center;font-size:var(--wot-message-box-title-fs, 16px);color:var(--wot-message-box-title-color, rgba(0, 0, 0, .85));line-height:20px;font-weight:500;padding-top:5px;padding-bottom:10px}.wd-message-box__content[data-v-6722d1fb]{max-height:var(--wot-message-box-content-max-height, 264px);color:var(--wot-message-box-content-color, #666666);font-size:var(--wot-message-box-content-fs, 14px);text-align:center;overflow:auto;line-height:20px}.wd-message-box__content[data-v-6722d1fb]::-webkit-scrollbar{width:var(--wot-message-box-content-scrollbar-width, 4px)}.wd-message-box__content[data-v-6722d1fb]::-webkit-scrollbar-thumb{width:var(--wot-message-box-content-scrollbar-width, 4px);background:var(--wot-message-box-content-scrollbar-color, rgba(0, 0, 0, .1));border-radius:calc(var(--wot-message-box-content-scrollbar-width, 4px) / 2)}.wd-message-box__input-error[data-v-6722d1fb]{min-height:18px;margin-top:2px;color:var(--wot-message-box-input-error-color, var(--wot-input-error-color, var(--wot-color-danger, #fa4350)));text-align:left}.wd-message-box__input-error.is-hidden[data-v-6722d1fb]{visibility:hidden}.wd-message-box__actions[data-v-6722d1fb]{padding:24px}[data-v-6722d1fb] .wd-message-box__actions-btn:not(:last-child){margin-right:16px}.wd-message-box__flex[data-v-6722d1fb]{display:flex}.wd-message-box__block[data-v-6722d1fb]{display:block}.wd-message-box__cancel[data-v-6722d1fb]{margin-right:16px}.border-and-fixed[data-v-2a9101ae]{position:fixed;bottom:0;left:0;right:0;border-top:1px solid #eee;box-sizing:border-box}.bulge[data-v-2a9101ae]{position:absolute;top:-20px;left:50%;transform-origin:top center;transform:translate(-50%) scale(.5) translateY(-33%);display:flex;justify-content:center;align-items:center;width:7.8125rem;height:7.8125rem;border-radius:50%;background-color:#fff;box-shadow:inset 0 0 0 1px #fefefe}uni-swiper,uni-scroll-view{flex:1;height:100%;overflow:hidden}uni-image{width:100%;height:100%;vertical-align:middle}#app .wd-floating-panel .uni-scroll-view-content{display:flex;flex-direction:column}.test{color:red;background-color:rgba(255,0,0,.384)}:root,uni-page-body{--screen-min: min(1vw, 1vh);--screen-max: max(1vw, 1vh)}*,:before,:after{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgb(0 0 0 / 0);--un-ring-shadow:0 0 rgb(0 0 0 / 0);--un-shadow-inset: ;--un-shadow:0 0 rgb(0 0 0 / 0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgb(147 197 253 / .5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }::backdrop{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-pan-x: ;--un-pan-y: ;--un-pinch-zoom: ;--un-scroll-snap-strictness:proximity;--un-ordinal: ;--un-slashed-zero: ;--un-numeric-figure: ;--un-numeric-spacing: ;--un-numeric-fraction: ;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgb(0 0 0 / 0);--un-ring-shadow:0 0 rgb(0 0 0 / 0);--un-shadow-inset: ;--un-shadow:0 0 rgb(0 0 0 / 0);--un-ring-inset: ;--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgb(147 197 253 / .5);--un-blur: ;--un-brightness: ;--un-contrast: ;--un-drop-shadow: ;--un-grayscale: ;--un-hue-rotate: ;--un-invert: ;--un-saturate: ;--un-sepia: ;--un-backdrop-blur: ;--un-backdrop-brightness: ;--un-backdrop-contrast: ;--un-backdrop-grayscale: ;--un-backdrop-hue-rotate: ;--un-backdrop-invert: ;--un-backdrop-opacity: ;--un-backdrop-saturate: ;--un-backdrop-sepia: }.i-carbon-code{--un-icon:url("data:image/svg+xml;utf8,%3Csvg viewBox='0 0 32 32' display='inline-block' vertical-align='middle' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='m31 16l-7 7l-1.41-1.41L28.17 16l-5.58-5.59L24 9zM1 16l7-7l1.41 1.41L3.83 16l5.58 5.59L8 23zm11.42 9.484L17.64 6l1.932.517L14.352 26z'/%3E%3C/svg%3E");-webkit-mask:var(--un-icon) no-repeat;mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;background-color:currentColor;color:inherit;display:inline-block;vertical-align:middle;width:1.2em;height:1.2em}.i-carbon-home{--un-icon:url("data:image/svg+xml;utf8,%3Csvg viewBox='0 0 32 32' display='inline-block' vertical-align='middle' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M16.612 2.214a1.01 1.01 0 0 0-1.242 0L1 13.419l1.243 1.572L4 13.621V26a2.004 2.004 0 0 0 2 2h20a2.004 2.004 0 0 0 2-2V13.63L29.757 15L31 13.428ZM18 26h-4v-8h4Zm2 0v-8a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v8H6V12.062l10-7.79l10 7.8V26Z'/%3E%3C/svg%3E");-webkit-mask:var(--un-icon) no-repeat;mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;background-color:currentColor;color:inherit;display:inline-block;vertical-align:middle;width:1.2em;height:1.2em}.i-carbon-user{--un-icon:url("data:image/svg+xml;utf8,%3Csvg viewBox='0 0 32 32' display='inline-block' vertical-align='middle' width='1.2em' height='1.2em' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7m10 28h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z'/%3E%3C/svg%3E");-webkit-mask:var(--un-icon) no-repeat;mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;background-color:currentColor;color:inherit;display:inline-block;vertical-align:middle;width:1.2em;height:1.2em}.center{display:flex;align-items:center;justify-content:center}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}[end~="1"]{inset-inline-end:.25rem}[start~="-1"]{inset-inline-start:-.25rem}.-right-3{right:-.75rem}.bottom--0\.5em{bottom:-.5em}.bottom--1\.2em{bottom:-1.2em}.left-0{left:0}.right-0{right:0}.right-0\.7em{right:.7em}.top-\[min\(50vw\,50vh\)\]{top:min(50vw,50vh)}.top-0{top:0}.m-8{margin:2rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}.mb-sc2{margin-bottom:calc(var(--screen-max) * 2)}.mr-1em\!{margin-right:1em!important}.mr-2{margin-right:.5rem}.ms,[ms=""]{margin-inline-start:1rem}.mt-2px{margin-top:2px}.mt-6{margin-top:1.5rem}.mt-6rpx{margin-top:.1875rem}.box-border{box-sizing:border-box}.block{display:block}.hidden{display:none}.size-full{width:100%;height:100%}.size-screen{width:100vw;height:100vh}[size~="20"]{width:5rem;height:5rem}.h-\[min\(50vw\,50vh\)\]{height:min(50vw,50vh)}.h-16{height:4rem}.h-2{height:.5rem}.h-200rpx{height:6.25rem}.h-20px{height:20px}.h-5{height:1.25rem}.h-50px{height:50px}.min-w-5{min-width:1.25rem}.w-\[min\(50vw\,50vh\)\]{width:min(50vw,50vh)}.w-160px{width:160px}.w-2{width:.5rem}.w-200rpx{width:6.25rem}.w-20px{width:20px}.flex{display:flex}.flex-\[0_0\]{flex:0 0}.flex-\[1_0\]{flex:1 0}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.flex-col{flex-direction:column}.active\:scale-110:active{--un-scale-x:1.1;--un-scale-y:1.1;transform:translate(var(--un-translate-x)) translateY(var(--un-translate-y)) translateZ(var(--un-translate-z)) rotate(var(--un-rotate)) rotateX(var(--un-rotate-x)) rotateY(var(--un-rotate-y)) rotate(var(--un-rotate-z)) skew(var(--un-skew-x)) skewY(var(--un-skew-y)) scaleX(var(--un-scale-x)) scaleY(var(--un-scale-y)) scaleZ(var(--un-scale-z))}.transform{transform:translate(var(--un-translate-x)) translateY(var(--un-translate-y)) translateZ(var(--un-translate-z)) rotate(var(--un-rotate)) rotateX(var(--un-rotate-x)) rotateY(var(--un-rotate-y)) rotate(var(--un-rotate-z)) skew(var(--un-skew-x)) skewY(var(--un-skew-y)) scaleX(var(--un-scale-x)) scaleY(var(--un-scale-y)) scaleZ(var(--un-scale-z))}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.cursor-pointer{cursor:pointer}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.overflow-auto{overflow:auto}.border{border-width:1px}.rounded-full{border-radius:9999px}.bg-\#f56c6c{--un-bg-opacity:1;background-color:rgba(245,108,108,var(--un-bg-opacity))}.bg-white{--un-bg-opacity:1;background-color:rgba(255,255,255,var(--un-bg-opacity))}[stroke-width~="3.5"]{stroke-width:3.5px}.p-1,.p1{padding:.25rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-sc2{padding:calc(var(--screen-max) * 2)}.p-sc2min{padding:calc(var(--screen-min) * 2)}.px{padding-left:1rem;padding-right:1rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-3{padding-left:.75rem;padding-right:.75rem}.text-center{text-align:center}.text-0\.8em{font-size:.8em}.text-12px{font-size:12px}.text-20px{font-size:20px}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.text-blue-500{--un-text-opacity:1;color:rgba(59,130,246,var(--un-text-opacity))}.text-green{--un-text-opacity:1;color:rgba(74,222,128,var(--un-text-opacity))}.text-green-500{--un-text-opacity:1;color:rgba(34,197,94,var(--un-text-opacity))}.text-white{--un-text-opacity:1;color:rgba(255,255,255,var(--un-text-opacity))}.c-primary{color:var(--wot-color-theme,#0957DE)}.leading-8{line-height:2rem}.tab,[tab=""]{-moz-tab-size:4;-o-tab-size:4;tab-size:4}.shadow-\[0_-2px_8px_rgba\(0\,0\,0\,0\.1\)\]{--un-shadow:0 -2px 8px var(--un-shadow-color, rgba(0, 0, 0, .1));box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.outline{outline-style:solid}.ring{--un-ring-width:3px;--un-ring-offset-shadow:var(--un-ring-inset) 0 0 0 var(--un-ring-offset-width) var(--un-ring-offset-color);--un-ring-shadow:var(--un-ring-inset) 0 0 0 calc(var(--un-ring-width) + var(--un-ring-offset-width)) var(--un-ring-color);box-shadow:var(--un-ring-offset-shadow),var(--un-ring-shadow),var(--un-shadow)}.blur{--un-blur:blur(8px);filter:var(--un-blur) var(--un-brightness) var(--un-contrast) var(--un-drop-shadow) var(--un-grayscale) var(--un-hue-rotate) var(--un-invert) var(--un-saturate) var(--un-sepia)}.active\:filter-brightness-110:active{--un-brightness:brightness(1.1);filter:var(--un-blur) var(--un-brightness) var(--un-contrast) var(--un-drop-shadow) var(--un-grayscale) var(--un-hue-rotate) var(--un-invert) var(--un-saturate) var(--un-sepia)}.filter{filter:var(--un-blur) var(--un-brightness) var(--un-contrast) var(--un-drop-shadow) var(--un-grayscale) var(--un-hue-rotate) var(--un-invert) var(--un-saturate) var(--un-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}[duration~="200"]{transition-duration:.2s}.ease{transition-timing-function:cubic-bezier(.4,0,.2,1)}.pb-safe{padding-bottom:env(safe-area-inset-bottom)}uni-modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:999;display:block;box-sizing:border-box}.uni-modal{position:fixed;z-index:999;width:80%;max-width:300px;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#fff;text-align:center;border-radius:3px;overflow:hidden}.uni-modal *{box-sizing:border-box}.uni-modal__hd{padding:1em 1.6em .3em}.uni-modal__title{font-weight:400;font-size:18px;word-wrap:break-word;word-break:break-all;white-space:pre-wrap;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.uni-modal__bd{padding:1.3em 1.6em;min-height:40px;font-size:15px;line-height:1.4;word-wrap:break-word;word-break:break-all;white-space:pre-wrap;color:#999;max-height:400px;overflow-x:hidden;overflow-y:auto}.uni-modal__textarea{resize:none;border:0;margin:0;width:90%;padding:10px;font-size:20px;outline:none;border:none;background-color:#eee;text-decoration:inherit;line-height:1.2}.uni-modal__ft{position:relative;line-height:48px;font-size:18px;display:flex}.uni-modal__ft:after{content:" ";position:absolute;left:0;top:0;right:0;height:1px;border-top:1px solid #d5d5d6;color:#d5d5d6;transform-origin:0 0;transform:scaleY(.5)}.uni-modal__btn{display:block;flex:1;color:#3cc51f;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:relative;cursor:pointer}.uni-modal__btn:active{background-color:#eee}.uni-modal__btn:after{content:" ";position:absolute;left:0;top:0;width:1px;bottom:0;border-left:1px solid #d5d5d6;color:#d5d5d6;transform-origin:0 0;transform:scaleX(.5)}.uni-modal__btn:first-child:after{display:none}.uni-modal__btn_default{color:#353535}.uni-modal__btn_primary{color:#007aff}uni-scroll-view{display:block;width:100%}uni-scroll-view[hidden]{display:none}.uni-scroll-view{position:relative;-webkit-overflow-scrolling:touch;width:100%;height:100%;max-height:inherit}.uni-scroll-view-scrollbar-hidden::-webkit-scrollbar{display:none}.uni-scroll-view-scrollbar-hidden{-moz-scrollbars:none;scrollbar-width:none}.uni-scroll-view-content{width:100%;height:100%}.uni-scroll-view-refresher{position:relative;overflow:hidden;flex-shrink:0}.uni-scroll-view-refresher-container{position:absolute;width:100%;bottom:0;display:flex;flex-direction:column-reverse}.uni-scroll-view-refresh{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:row;justify-content:center;align-items:center}.uni-scroll-view-refresh-inner{display:flex;align-items:center;justify-content:center;line-height:0;width:40px;height:40px;border-radius:50%;background-color:#fff;box-shadow:0 1px 6px rgba(0,0,0,.118),0 1px 4px rgba(0,0,0,.118)}.uni-scroll-view-refresh__spinner{transform-origin:center center;animation:uni-scroll-view-refresh-rotate 2s linear infinite}.uni-scroll-view-refresh__spinner>circle{stroke:currentColor;stroke-linecap:round;animation:uni-scroll-view-refresh-dash 2s linear infinite}@keyframes uni-scroll-view-refresh-rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes uni-scroll-view-refresh-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}.wot-theme-dark .wd-floating-panel[data-v-b3b199e2],.wot-theme-dark .wd-floating-panel__content[data-v-b3b199e2]{background:var(--wot-dark-background2, #1b1b1b)}.wd-floating-panel[data-v-b3b199e2]{position:fixed;bottom:0;left:0;z-index:var(--wot-floating-panel-z-index, 99);display:flex;flex-direction:column;box-sizing:border-box;width:100vw;border-top-left-radius:var(--wot-floating-panel-radius, 16px);border-top-right-radius:var(--wot-floating-panel-radius, 16px);background-color:var(--wot-floating-panel-bg, var(--wot-color-white, rgb(255, 255, 255)));touch-action:none;will-change:transform}.wd-floating-panel.is-safe[data-v-b3b199e2]{padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.wd-floating-panel[data-v-b3b199e2]:after{position:absolute;bottom:-100vh;display:block;width:100vw;height:100vh;content:"";background-color:inherit}.wd-floating-panel__header[data-v-b3b199e2]{display:flex;justify-content:center;align-items:center;height:var(--wot-floating-panel-header-height, 30px);cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.wd-floating-panel__header-bar[data-v-b3b199e2]{width:var(--wot-floating-panel-bar-width, 20px);height:var(--wot-floating-panel-bar-height, 3px);background-color:var(--wot-floating-panel-bar-bg, var(--wot-color-gray-5, #c8c9cc));border-radius:var(--wot-floating-panel-bar-radius, 4px)}.wd-floating-panel__content[data-v-b3b199e2]{flex:1;min-width:0;min-height:0;background-color:var(--wot-floating-panel-content-bg, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-year__title[data-v-17be344c],.wot-theme-dark .wd-year__months[data-v-17be344c]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-year__month.is-disabled .wd-year__month-text[data-v-17be344c]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}.wd-year__title[data-v-17be344c]{display:flex;align-items:center;justify-content:center;height:45px;font-size:var(--wot-calendar-panel-title-fs, 14px);color:var(--wot-calendar-panel-title-color, rgba(0, 0, 0, .85))}.wd-year__months[data-v-17be344c]{display:flex;flex-wrap:wrap;font-size:var(--wot-calendar-day-fs, 16px);color:var(--wot-calendar-day-color, rgba(0, 0, 0, .85))}.wd-year__month[data-v-17be344c]{position:relative;width:25%;height:var(--wot-calendar-day-height, 64px);line-height:var(--wot-calendar-day-height, 64px);text-align:center;margin-bottom:var(--wot-calendar-item-margin-bottom, 4px)}.wd-year__month.is-disabled .wd-year__month-text[data-v-17be344c]{color:var(--wot-calendar-disabled-color, rgba(0, 0, 0, .25))}.wd-year__month.is-current[data-v-17be344c]{color:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0))}.wd-year__month.is-selected[data-v-17be344c]{color:#fff}.wd-year__month.is-selected .wd-year__month-text[data-v-17be344c]{border-radius:var(--wot-calendar-active-border, 8px);background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0))}.wd-year__month.is-middle[data-v-17be344c]{background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09))}.wd-year__month.is-start[data-v-17be344c]{color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-year__month.is-start[data-v-17be344c]:after{position:absolute;top:0;right:0;left:50%;bottom:0;content:"";background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09))}.wd-year__month.is-start .wd-year__month-text[data-v-17be344c]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));border-radius:var(--wot-calendar-active-border, 8px) 0 0 var(--wot-calendar-active-border, 8px)}.wd-year__month.is-start.is-without-end[data-v-17be344c]:after{display:none}.wd-year__month.is-end[data-v-17be344c]{color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-year__month.is-end[data-v-17be344c]:after{position:absolute;top:0;left:0;right:50%;bottom:0;content:"";background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09))}.wd-year__month.is-end .wd-year__month-text[data-v-17be344c]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));border-radius:0 var(--wot-calendar-active-border, 8px) var(--wot-calendar-active-border, 8px) 0}.wd-year__month.is-same[data-v-17be344c]{color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-year__month.is-same .wd-year__month-text[data-v-17be344c]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));border-radius:var(--wot-calendar-active-border, 8px)}.wd-year__month.is-last-row[data-v-17be344c]{margin-bottom:0}.wd-year__month-text[data-v-17be344c]{width:var(--wot-calendar-month-width, 50px);margin:0 auto;text-align:center}.wd-year__month-top[data-v-17be344c]{position:absolute;top:10px;left:0;right:0;line-height:1.1;font-size:var(--wot-calendar-info-fs, 10px);text-align:center}.wd-year__month-bottom[data-v-17be344c]{position:absolute;bottom:10px;left:0;right:0;line-height:1.1;font-size:var(--wot-calendar-info-fs, 10px);text-align:center}.wot-theme-dark .wd-year-panel__title[data-v-1a697570]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)));box-shadow:0 4px 8px rgba(255,255,255,.02)}.wd-year-panel[data-v-1a697570]{font-size:var(--wot-calendar-fs, 16px);padding:var(--wot-calendar-panel-padding, 0 12px)}.wd-year-panel__title[data-v-1a697570]{padding:5px 0;text-align:center;font-size:var(--wot-calendar-panel-title-fs, 14px);color:var(--wot-calendar-panel-title-color, rgba(0, 0, 0, .85));box-shadow:0 4px 8px rgba(0,0,0,.02)}uni-picker-view-column{flex:1;position:relative;height:100%;overflow:hidden}uni-picker-view-column[hidden]{display:none}.uni-picker-view-group{height:100%;overflow:hidden}.uni-picker-view-mask{transform:translateZ(0)}.uni-picker-view-indicator,.uni-picker-view-mask{position:absolute;left:0;width:100%;z-index:3;pointer-events:none}.uni-picker-view-mask{top:0;height:100%;margin:0 auto;background-image:linear-gradient(180deg,rgba(255,255,255,.95),rgba(255,255,255,.6)),linear-gradient(0deg,rgba(255,255,255,.95),rgba(255,255,255,.6));background-position:top,bottom;background-size:100% 102px;background-repeat:no-repeat;transform:translateZ(0)}.uni-picker-view-indicator{height:34px;top:50%;transform:translateY(-50%)}.uni-picker-view-content{position:absolute;top:0;left:0;width:100%;will-change:transform;padding:102px 0;cursor:pointer}.uni-picker-view-content>*{height:var(--picker-view-column-indicator-height);overflow:hidden}.uni-picker-view-indicator:before{top:0;border-top:1px solid #e5e5e5;transform-origin:0 0;transform:scaleY(.5)}.uni-picker-view-indicator:after{bottom:0;border-bottom:1px solid #e5e5e5;transform-origin:0 100%;transform:scaleY(.5)}.uni-picker-view-indicator:after,.uni-picker-view-indicator:before{content:" ";position:absolute;left:0;right:0;height:1px;color:#e5e5e5}uni-picker-view{display:block}.uni-picker-view-wrapper{display:flex;position:relative;overflow:hidden;height:100%}uni-picker-view[hidden]{display:none}.wot-theme-dark .wd-picker-view__columns[data-v-e413638e]{background:var(--wot-dark-background2, #1b1b1b)}.wot-theme-dark .wd-picker-view[data-v-e413638e] .wd-picker-view__roller{background:var(--wot-dark-background4, #323233)}.wot-theme-dark .wd-picker-view-column[data-v-e413638e]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-picker-view-column__item--disabled[data-v-e413638e]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}.wd-picker-view[data-v-e413638e]{position:relative;padding:10px 0}.wd-picker-view__columns[data-v-e413638e]{position:relative;display:flex;background:var(--wot-picker-bg, var(--wot-color-white, rgb(255, 255, 255)));overflow:hidden;align-items:center}[data-v-e413638e] .wd-picker-view__mask{position:absolute;top:0;left:0;width:100%;height:100%;background:var(--wot-picker-mask, linear-gradient(180deg, hsla(0, 0%, 100%, .9), hsla(0, 0%, 100%, .25))) linear-gradient(0deg,rgba(255,255,255,.9),rgba(255,255,255,.25));background-position:top,bottom;background-repeat:no-repeat;z-index:2;pointer-events:none;filter:blur(4px)}.wd-picker-view__loading[data-v-e413638e]{position:absolute;display:flex;top:0;right:0;bottom:0;left:0;align-items:center;justify-content:center;z-index:3;background:var(--wot-picker-loading-bg, rgba(var(--wot-color-white, rgb(255, 255, 255)), .8))}[data-v-e413638e] .wd-picker-view__roller{background:#f5f5f5;z-index:0}[data-v-e413638e] .wd-picker-view__roller:before,[data-v-e413638e] .wd-picker-view__roller:after{display:none}.wd-picker-view-column[data-v-e413638e]{flex:1;font-size:var(--wot-picker-column-fs, 16px);color:var(--wot-picker-column-color, rgba(0, 0, 0, .85));text-align:center;transition-timing-function:cubic-bezier(.28,.8,.63,1)}.wd-picker-view-column__item[data-v-e413638e]{padding:var(--wot-picker-column-padding, 0 var(--wot-size-side-padding-small, 6px));overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.wd-picker-view-column__item--disabled[data-v-e413638e]{color:var(--wot-picker-column-disabled-color, rgba(0, 0, 0, .25))}.wot-theme-dark .wd-month__title[data-v-54efcd7e],.wot-theme-dark .wd-month__days[data-v-54efcd7e]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-month__day.is-disabled .wd-month__day-text[data-v-54efcd7e]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}.wd-month__title[data-v-54efcd7e]{display:flex;align-items:center;justify-content:center;height:45px;font-size:var(--wot-calendar-panel-title-fs, 14px);color:var(--wot-calendar-panel-title-color, rgba(0, 0, 0, .85))}.wd-month__days[data-v-54efcd7e]{display:flex;flex-wrap:wrap;font-size:var(--wot-calendar-day-fs, 16px);color:var(--wot-calendar-day-color, rgba(0, 0, 0, .85))}.wd-month__day[data-v-54efcd7e]{position:relative;width:14.285%;height:var(--wot-calendar-day-height, 64px);line-height:var(--wot-calendar-day-height, 64px);text-align:center;margin-bottom:var(--wot-calendar-item-margin-bottom, 4px)}.wd-month__day.is-disabled .wd-month__day-text[data-v-54efcd7e]{color:var(--wot-calendar-disabled-color, rgba(0, 0, 0, .25))}.wd-month__day.is-current[data-v-54efcd7e]{color:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0))}.wd-month__day.is-selected .wd-month__day-container[data-v-54efcd7e],.wd-month__day.is-multiple-selected .wd-month__day-container[data-v-54efcd7e]{border-radius:var(--wot-calendar-active-border, 8px);background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-month__day.is-middle .wd-month__day-container[data-v-54efcd7e]{background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09))}.wd-month__day.is-multiple-middle .wd-month__day-container[data-v-54efcd7e]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-month__day.is-start[data-v-54efcd7e]:after{position:absolute;content:"";height:var(--wot-calendar-day-height, 64px);top:0;right:0;left:50%;background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09));z-index:1}.wd-month__day.is-start.is-without-end[data-v-54efcd7e]:after{display:none}.wd-month__day.is-start .wd-month__day-container[data-v-54efcd7e]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)));border-radius:var(--wot-calendar-active-border, 8px) 0 0 var(--wot-calendar-active-border, 8px)}.wd-month__day.is-end[data-v-54efcd7e]:after{position:absolute;content:"";height:var(--wot-calendar-day-height, 64px);top:0;left:0;right:50%;background:var(--wot-calendar-range-color, rgba(77, 128, 240, .09));z-index:1}.wd-month__day.is-end .wd-month__day-container[data-v-54efcd7e]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)));border-radius:0 var(--wot-calendar-active-border, 8px) var(--wot-calendar-active-border, 8px) 0}.wd-month__day.is-same .wd-month__day-container[data-v-54efcd7e]{background:var(--wot-calendar-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-calendar-selected-color, var(--wot-color-white, rgb(255, 255, 255)));border-radius:var(--wot-calendar-active-border, 8px)}.wd-month__day.is-last-row[data-v-54efcd7e]{margin-bottom:0}.wd-month__day-container[data-v-54efcd7e]{position:relative;z-index:2}.wd-month__day-text[data-v-54efcd7e]{font-weight:var(--wot-calendar-day-fw, 500)}.wd-month__day-top[data-v-54efcd7e]{position:absolute;top:10px;left:0;right:0;line-height:1.1;font-size:var(--wot-calendar-info-fs, 10px);text-align:center}.wd-month__day-bottom[data-v-54efcd7e]{position:absolute;bottom:10px;left:0;right:0;line-height:1.1;font-size:var(--wot-calendar-info-fs, 10px);text-align:center}.wot-theme-dark .wd-month-panel__title[data-v-a478bfb5]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-month-panel__weeks[data-v-a478bfb5]{box-shadow:0 4px 8px rgba(255,255,255,.02);color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-month-panel__time-label[data-v-a478bfb5]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-month-panel__time-label[data-v-a478bfb5]:after{background:var(--wot-dark-background4, #323233)}.wd-month-panel[data-v-a478bfb5]{font-size:var(--wot-calendar-fs, 16px)}.wd-month-panel__title[data-v-a478bfb5]{padding:5px 0;text-align:center;font-size:var(--wot-calendar-panel-title-fs, 14px);color:var(--wot-calendar-panel-title-color, rgba(0, 0, 0, .85));padding:var(--wot-calendar-panel-padding, 0 12px)}.wd-month-panel__weeks[data-v-a478bfb5]{display:flex;height:var(--wot-calendar-week-height, 36px);line-height:var(--wot-calendar-week-height, 36px);box-shadow:0 4px 8px rgba(0,0,0,.02);color:var(--wot-calendar-week-color, rgba(0, 0, 0, .85));font-size:var(--wot-calendar-week-fs, 12px);padding:var(--wot-calendar-panel-padding, 0 12px)}.wd-month-panel__week[data-v-a478bfb5]{flex:1;text-align:center}.wd-month-panel__container[data-v-a478bfb5]{padding:var(--wot-calendar-panel-padding, 0 12px);box-sizing:border-box}.wd-month-panel__time[data-v-a478bfb5]{display:flex;box-shadow:0 -4px 8px rgba(0,0,0,.02)}.wd-month-panel__time-label[data-v-a478bfb5]{position:relative;flex:1;font-size:var(--wot-picker-column-fs, 16px);text-align:center;line-height:125px;color:var(--wot-picker-column-color, rgba(0, 0, 0, .85))}.wd-month-panel__time-label[data-v-a478bfb5]:after{position:absolute;content:"";height:35px;top:50%;left:0;right:0;transform:translateY(-50%);background:var(--wot-picker-column-select-bg, #f5f5f5);z-index:0}.wd-month-panel__time-text[data-v-a478bfb5]{position:relative;z-index:1}.wd-month-panel__time-picker[data-v-a478bfb5]{flex:3}.wot-theme-dark .wd-cell[data-v-14cc99f7]{background-color:var(--wot-dark-background2, #1b1b1b);color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-cell__value[data-v-14cc99f7]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-cell__label[data-v-14cc99f7]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-cell.is-hover[data-v-14cc99f7]{background-color:var(--wot-dark-background4, #323233)}.wot-theme-dark .wd-cell.is-border .wd-cell__wrapper[data-v-14cc99f7]{position:relative}.wot-theme-dark .wd-cell.is-border .wd-cell__wrapper[data-v-14cc99f7]:after{position:absolute;display:block;content:"";width:100%;height:1px;left:0;top:0;transform:scaleY(.5);background:var(--wot-dark-border-color, #3a3a3c)}.wot-theme-dark .wd-cell[data-v-14cc99f7] .wd-cell__arrow-right{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wd-cell[data-v-14cc99f7]{position:relative;padding-left:var(--wot-cell-padding, var(--wot-size-side-padding, 15px));background-color:var(--wot-color-white, rgb(255, 255, 255));text-decoration:none;color:var(--wot-cell-title-color, rgba(0, 0, 0, .85));line-height:var(--wot-cell-line-height, 24px);-webkit-tap-highlight-color:transparent;box-sizing:border-box;width:100%;overflow:hidden}.wd-cell.is-border .wd-cell__wrapper[data-v-14cc99f7]{position:relative}.wd-cell.is-border .wd-cell__wrapper[data-v-14cc99f7]:after{position:absolute;display:block;content:"";width:100%;height:1px;left:0;top:0;transform:scaleY(.5);background:var(--wot-color-border-light, #e8e8e8)}.wd-cell__wrapper[data-v-14cc99f7]{position:relative;display:flex;padding:var(--wot-cell-wrapper-padding, 10px) var(--wot-cell-padding, var(--wot-size-side-padding, 15px)) var(--wot-cell-wrapper-padding, 10px) 0;justify-content:space-between;align-items:flex-start;overflow:hidden}.wd-cell__wrapper.is-vertical[data-v-14cc99f7]{display:block}.wd-cell__wrapper.is-vertical .wd-cell__right[data-v-14cc99f7]{margin-top:var(--wot-cell-vertical-top, 16px)}.wd-cell__wrapper.is-vertical .wd-cell__value[data-v-14cc99f7]{text-align:left}.wd-cell__wrapper.is-vertical .wd-cell__left[data-v-14cc99f7]{margin-right:0}.wd-cell__wrapper.is-label[data-v-14cc99f7]{padding:var(--wot-cell-wrapper-padding-with-label, 16px) var(--wot-cell-padding, var(--wot-size-side-padding, 15px)) var(--wot-cell-wrapper-padding-with-label, 16px) 0}.wd-cell__left[data-v-14cc99f7]{position:relative;flex:1;display:flex;text-align:left;font-size:var(--wot-cell-title-fs, 14px);box-sizing:border-box;margin-right:var(--wot-cell-padding, var(--wot-size-side-padding, 15px))}.wd-cell__right[data-v-14cc99f7]{position:relative;flex:1;min-width:0}.wd-cell__title[data-v-14cc99f7]{font-size:var(--wot-cell-title-fs, 14px)}.wd-cell__required[data-v-14cc99f7]{font-size:var(--wot-cell-required-size, 18px);color:var(--wot-cell-required-color, var(--wot-color-danger, #fa4350));margin-left:var(--wot-cell-required-margin, 4px)}.wd-cell__required--left[data-v-14cc99f7]{margin-left:0;margin-right:var(--wot-cell-required-margin, 4px)}.wd-cell__label[data-v-14cc99f7]{margin-top:2px;font-size:var(--wot-cell-label-fs, 12px);color:var(--wot-cell-label-color, rgba(0, 0, 0, .45))}[data-v-14cc99f7] .wd-cell__icon{display:block;position:relative;margin-right:var(--wot-cell-icon-right, 4px);font-size:var(--wot-cell-icon-size, 16px);height:var(--wot-cell-line-height, 24px);line-height:var(--wot-cell-line-height, 24px)}.wd-cell__body[data-v-14cc99f7]{display:flex;min-width:0}.wd-cell__value[data-v-14cc99f7]{position:relative;flex:1;font-size:var(--wot-cell-value-fs, 14px);color:var(--wot-cell-value-color, rgba(0, 0, 0, .85));vertical-align:middle}.wd-cell__value--left[data-v-14cc99f7]{text-align:left}.wd-cell__value--right[data-v-14cc99f7]{text-align:right}.wd-cell__value--ellipsis[data-v-14cc99f7]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:0}[data-v-14cc99f7] .wd-cell__arrow-right{display:block;margin-left:8px;width:var(--wot-cell-arrow-size, 18px);font-size:var(--wot-cell-arrow-size, 18px);color:var(--wot-cell-arrow-color, rgba(0, 0, 0, .25));height:var(--wot-cell-line-height, 24px);line-height:var(--wot-cell-line-height, 24px)}.wd-cell__error-message[data-v-14cc99f7]{color:var(--wot-form-item-error-message-color, var(--wot-color-danger, #fa4350));font-size:var(--wot-form-item-error-message-font-size, var(--wot-fs-secondary, 12px));line-height:var(--wot-form-item-error-message-line-height, 24px);text-align:left;vertical-align:middle}.wd-cell.is-link[data-v-14cc99f7]{-webkit-tap-highlight-color:var(--wot-cell-tap-bg, rgba(0, 0, 0, .06))}.wd-cell.is-hover[data-v-14cc99f7]{background-color:var(--wot-cell-tap-bg, rgba(0, 0, 0, .06))}.wd-cell.is-large .wd-cell__title[data-v-14cc99f7]{font-size:var(--wot-cell-title-fs-large, 16px)}.wd-cell.is-large .wd-cell__wrapper[data-v-14cc99f7]{padding-top:var(--wot-cell-wrapper-padding-large, 12px);padding-bottom:var(--wot-cell-wrapper-padding-large, 12px)}.wd-cell.is-large .wd-cell__label[data-v-14cc99f7]{font-size:var(--wot-cell-label-fs-large, 14px)}.wd-cell.is-large .wd-cell__value[data-v-14cc99f7]{font-size:var(--wot-cell-value-fs-large, 16px)}.wd-cell.is-large[data-v-14cc99f7] .wd-cell__icon{font-size:var(--wot-cell-icon-size-large, 18px)}.wd-cell.is-center .wd-cell__wrapper[data-v-14cc99f7]{align-items:center}.wot-theme-dark .wd-picker__action--cancel[data-v-e8a8e208]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-picker__action.is-loading[data-v-e8a8e208]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-picker[data-v-e8a8e208] .wd-picker__arrow,.wot-theme-dark .wd-picker[data-v-e8a8e208] .wd-picker__clear{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-picker[data-v-e8a8e208] .wd-picker__cell--placeholder .wd-cell__value{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}[data-v-e8a8e208] .wd-picker__popup{border-radius:16px 16px 0 0}[data-v-e8a8e208] .wd-picker__cell.is-disabled .wd-cell__value{color:var(--wot-input-disabled-color, #d9d9d9);cursor:not-allowed}[data-v-e8a8e208] .wd-picker__cell.is-error .wd-cell__value,[data-v-e8a8e208] .wd-picker__cell.is-error .wd-picker__arrow{color:var(--wot-input-error-color, var(--wot-color-danger, #fa4350))}[data-v-e8a8e208] .wd-picker__cell.is-large .wd-picker__arrow,[data-v-e8a8e208] .wd-picker__cell.is-large .wd-picker__clear{font-size:var(--wot-cell-icon-size-large, 18px)}[data-v-e8a8e208] .wd-picker__cell--placeholder .wd-cell__value{color:var(--wot-input-placeholder-color, #bfbfbf)}[data-v-e8a8e208] .wd-picker__arrow,[data-v-e8a8e208] .wd-picker__clear{display:block;font-size:var(--wot-cell-icon-size, 16px);color:var(--wot-cell-arrow-color, rgba(0, 0, 0, .25));line-height:var(--wot-cell-line-height, 24px)}[data-v-e8a8e208] .wd-picker__clear{color:var(--wot-cell-clear-color, #585858)}.wd-picker__wraper[data-v-e8a8e208]{padding-bottom:var(--window-bottom)}.wd-picker__toolbar[data-v-e8a8e208]{position:relative;display:flex;font-size:var(--wot-picker-toolbar-fs, var(--wot-fs-title, 16px));height:var(--wot-picker-toolbar-height, 54px);line-height:var(--wot-picker-action-height, 16px);justify-content:space-between;align-items:center;box-sizing:border-box}.wd-picker__action[data-v-e8a8e208]{display:block;border:none;outline:none;font-size:var(--wot-picker-toolbar-fs, var(--wot-fs-title, 16px));color:var(--wot-picker-toolbar-finish-color, var(--wot-color-theme, #4d80f0));background:transparent;padding:24px 15px 14px}.wd-picker__action--cancel[data-v-e8a8e208]{color:var(--wot-picker-toolbar-cancel-color, #666666)}.wd-picker__action.is-loading[data-v-e8a8e208]{color:var(--wot-picker-loading-button-color, rgba(0, 0, 0, .25))}.wd-picker__title[data-v-e8a8e208]{display:block;float:1;color:var(--wot-picker-toolbar-title-color, rgba(0, 0, 0, .85))}.wot-theme-dark .wd-datetime-picker__placeholder[data-v-629b5d0e]{color:var(--wot-dark-color-gray, var(--wot-color-secondary, #595959))}.wot-theme-dark .wd-datetime-picker[data-v-629b5d0e] .wd-datetime-picker__arrow,.wot-theme-dark .wd-datetime-picker[data-v-629b5d0e] .wd-datetime-picker__clear,.wot-theme-dark .wd-datetime-picker__action--cancel[data-v-629b5d0e],.wot-theme-dark .wd-datetime-picker__region[data-v-629b5d0e]{color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-datetime-picker__region.is-active[data-v-629b5d0e]{background:var(--wot-picker-region-bg-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}[data-v-629b5d0e] .wd-datetime-picker__cell.is-disabled .wd-cell__value{color:var(--wot-input-disabled-color, #d9d9d9);cursor:not-allowed}[data-v-629b5d0e] .wd-datetime-picker__cell.is-error .wd-cell__value,[data-v-629b5d0e] .wd-datetime-picker__cell.is-error .wd-datetime-picker__arrow{color:var(--wot-input-error-color, var(--wot-color-danger, #fa4350))}[data-v-629b5d0e] .wd-datetime-picker__cell.is-large .wd-datetime-picker__arrow{font-size:var(--wot-cell-icon-size-large, 18px)}[data-v-629b5d0e] .wd-datetime-picker__cell .wd-cell__value--ellipsis uni-view{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}[data-v-629b5d0e] .wd-datetime-picker__cell .wd-cell__value--ellipsis uni-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:100%}.wd-datetime-picker__placeholder[data-v-629b5d0e]{color:var(--wot-input-placeholder-color, #bfbfbf)}[data-v-629b5d0e] .wd-datetime-picker__arrow{display:block;font-size:var(--wot-cell-icon-size, 16px);color:var(--wot-cell-arrow-color, rgba(0, 0, 0, .25));line-height:var(--wot-cell-line-height, 24px)}[data-v-629b5d0e] .wd-datetime-picker__clear{display:block;font-size:var(--wot-cell-icon-size, 16px);color:var(--wot-cell-clear-color, #585858);line-height:var(--wot-cell-line-height, 24px)}[data-v-629b5d0e] .wd-datetime-picker__popup{border-radius:16px 16px 0 0}.wd-datetime-picker__wraper[data-v-629b5d0e]{padding-bottom:var(--window-bottom)}.wd-datetime-picker__toolbar[data-v-629b5d0e]{position:relative;display:flex;font-size:var(--wot-picker-toolbar-fs, var(--wot-fs-title, 16px));height:var(--wot-picker-toolbar-height, 54px);line-height:var(--wot-picker-action-height, 16px);justify-content:space-between;align-items:center;box-sizing:border-box}.wd-datetime-picker__action[data-v-629b5d0e]{display:block;border:none;outline:none;font-size:var(--wot-picker-toolbar-fs, var(--wot-fs-title, 16px));color:var(--wot-picker-toolbar-finish-color, var(--wot-color-theme, #4d80f0));background:transparent;padding:24px 15px 14px}.wd-datetime-picker__action--cancel[data-v-629b5d0e]{color:var(--wot-picker-toolbar-cancel-color, #666666)}.wd-datetime-picker__action.is-loading[data-v-629b5d0e]{color:var(--wot-picker-loading-button-color, rgba(0, 0, 0, .25))}.wd-datetime-picker__title[data-v-629b5d0e]{display:block;float:1;color:var(--wot-picker-toolbar-title-color, rgba(0, 0, 0, .85))}.wd-datetime-picker__region-tabs[data-v-629b5d0e]{display:flex}.wd-datetime-picker__region[data-v-629b5d0e]{width:50%;display:inline-block;color:var(--wot-picker-region-color, rgba(0, 0, 0, .45));text-align:center;padding:14px 0;font-size:var(--wot-picker-region-fs, 14px);line-height:16px;transition:all .15s ease-out}.wd-datetime-picker__region.is-active[data-v-629b5d0e]{background:var(--wot-picker-region-bg-active-color, var(--wot-color-theme, #4d80f0));color:var(--wot-color-white, rgb(255, 255, 255))}.wd-datetime-picker__region-time[data-v-629b5d0e]{font-size:16px;margin-top:2px}.wd-datetime-picker__hidden[data-v-629b5d0e]{visibility:hidden;overflow:hidden;height:0}.wd-datetime-picker__show[data-v-629b5d0e]{visibility:visible;height:auto}[data-v-f65f5385] .wd-form-item__body{flex:1}[data-v-f65f5385] .wd-cell__wrapper{display:flex;align-items:center;justify-content:center;justify-content:space-between}.wot-theme-dark .wd-cell-group[data-v-2284820d]{background-color:var(--wot-dark-background2, #1b1b1b)}.wot-theme-dark .wd-cell-group.is-border .wd-cell-group__title[data-v-2284820d]{position:relative}.wot-theme-dark .wd-cell-group.is-border .wd-cell-group__title[data-v-2284820d]:after{position:absolute;display:block;content:"";width:100%;height:1px;left:0;bottom:0;transform:scaleY(.5);background:var(--wot-dark-border-color, #3a3a3c)}.wot-theme-dark .wd-cell-group__title[data-v-2284820d]{background:var(--wot-dark-background2, #1b1b1b);color:var(--wot-dark-color, var(--wot-color-white, rgb(255, 255, 255)))}.wot-theme-dark .wd-cell-group__right[data-v-2284820d]{color:var(--wot-dark-color3, rgba(232, 230, 227, .8))}.wot-theme-dark .wd-cell-group__body[data-v-2284820d]{background:var(--wot-dark-background2, #1b1b1b)}.wd-cell-group[data-v-2284820d]{background-color:var(--wot-color-white, rgb(255, 255, 255))}.wd-cell-group.is-border .wd-cell-group__title[data-v-2284820d]{position:relative}.wd-cell-group.is-border .wd-cell-group__title[data-v-2284820d]:after{position:absolute;display:block;content:"";width:100%;height:1px;left:0;bottom:0;transform:scaleY(.5);background:var(--wot-color-border-light, #e8e8e8)}.wd-cell-group__title[data-v-2284820d]{position:relative;display:flex;justify-content:space-between;padding:var(--wot-cell-group-padding, 13px var(--wot-cell-padding, var(--wot-size-side-padding, 15px)));background:var(--wot-color-white, rgb(255, 255, 255));font-size:var(--wot-cell-group-title-fs, var(--wot-fs-title, 16px));color:var(--wot-cell-group-title-color, rgba(0, 0, 0, .85));font-weight:var(--wot-fw-medium, 500);line-height:1.43}.wd-cell-group__right[data-v-2284820d]{color:var(--wot-cell-group-value-color, var(--wot-color-content, #262626));font-size:var(--wot-cell-group-value-fs, var(--wot-fs-content, 14px))}.wd-cell-group__body[data-v-2284820d]{background:var(--wot-color-white, rgb(255, 255, 255))}</style>
  </head>

  <body>
    <div id="app"><!--app-html--></div>

  </body>
</html>
